no,type,status,summary,description
ISIS-3060,Improvement,In Progress,"[Performance] Don't copy Facets between FacetHolders, use unique FacetHolders instead","Also maybe cleanup some MM code, commented to be hackery."
ISIS-3059,Improvement,Resolved,Bump Spring Boot 2.6.7 -> 2.7.0,"Regression-tests and Demo work fine (based on H2), However, I do see glitches with a maria-db based app of mine,"
ISIS-3058,Bug,Resolved,[Regression] WicketViewer: Detached Entities on Standalone Collection of Viewmodels.,
ISIS-3057,Improvement,Closed,"move packages for excel extension applib, is all",
ISIS-3056,Bug,In Progress,[Wicket Viewer] Action Button Coloring broken on mixedin Actions,We have action button coloring based on member-id pattern matching. This seems broken when the action is mixed in.
ISIS-3055,Wish,Open,"[Wicket Viewer] Make Table Header ""Sticky""","When 'Show all' is selected for lists, the header scrolls out of the visible area alongside data rows."
ISIS-3054,Bug,Resolved,[Regression] Wicket Viewer: non-scalar autoComplete is broken,"autoComplete...() supporting methods are broken when it comes to multichoice inputs, while choices...() works perfectly fine

from https://the-asf.slack.com/archives/CFC42LWBV/p1652772052794179"
ISIS-3053,Bug,Resolved,"[Regression] Wicket Viewer: Click on no-arg Action with ARE_YOU_SURE Semantics does nothing, when has Tooltip",Client side java-script error. Bootstrap complains about popover binding only allowed once.
ISIS-3052,Bug,Open,How to get row selection and add+remove on collections?,"In ECP HRM we are on nightly version 2.0.0-M7.20220511-0321-29cd16bf

In the view of security > role manager > application role provided by Isis, one can see that both collections (permissions and users) have a additional column with checkboxes to enable selection of rows in the table. Those selections are applied to both add and remove buttons/actions in the table. See next screenshot:  !EcpHrm-SecurityRoleManagerApplicationRoleView.jpg|width=1029,height=284!

How can one apply that same behaviour to application specific domain objects. Every attempt trying to mimic this in the communication channel collection in the organisation domain object of ECP HRM fails. See next screenshot:

!EcpHrm-HowToDefineAddRemoveButtonsToCollection.jpg|width=1037,height=355!

The ""Remove communication channel"" action is defined explicitly as an mixin, but for the RoleManager collections no mixins seem to be defined. So how should this work?

 "
ISIS-3051,Improvement,Open,"[Validation] Fail early, if declared and mixed-in Actions share same Member-id.","Update: 

if a declared method and a mixed-in method share the same member-id, the declared method takes precedence - we need to change that behavior and instead fail early, with MM validation error, not allowing this sort of method action overriding
"
ISIS-3050,Bug,Closed,[Wicket Viewer] (none) badge rendering glitches,"See ECP HRM application; when a new domain object (communication channel) is created a few string fields are filled with the default value ""<span class=""badge bg-light placeholder-literal-null"">(none)</span>"". Probably the intention was ""(none)""."
ISIS-3049,Bug,In Progress,Functional issues with demo app,"- menu - domain objects - nature stateful returns error - nice kitten ;-)
- menu - prototyping - all namespaces returns error
- menu -actions - associate with - remove child : field / choice lacking
Same for 'no longer favourite'
- menu - actions - domain event is broken
- menu - collections - domain event is broken
- menu - temporal type - offsetdatetime: date picker / validation issue
Same with offset time
Same with zoned
- menu - more types - calendar events is broken"
ISIS-3048,Improvement,Open,Suggested UI improvements (after review demo app),"- menu - actions - dependent arguments - multichoices: lacks spacing line between arguments in pop-up


- menu -featured - tabdemo: after editing a property on 2nd or 3rd tab, the ui returns to the first tab - I would like it to remain on the tab of the property

(My personal taste)
- some black lines maybe too black compared to rest of the page? (Like separation line between headers and collection details)"
ISIS-3047,Improvement,Open,[kroviz] Document CORS Workaround via HTTPD,"* https://stackoverflow.com/questions/3076414/ways-to-circumvent-the-same-origin-policy
 * https://stackoverflow.com/questions/25455969/spring-boot-with-embedded-tomcat-behind-apache-proxy
 * [https://www.google.com/search?q=setup+apache+httpd+to+solve+CORS&rlz=1C1GCEA_en&oq=setup+apache+httpd+to+solve+CORS&aqs=chrome..69i57j33i160l2.17473j1j7&sourceid=chrome&ie=UTF-8]
 * [https://ubiq.co/tech-blog/enable-cors-apache-web-server/]
 * https://www.digitalocean.com/community/tutorials/how-to-install-the-apache-web-server-on-ubuntu-20-04-de"
ISIS-3046,Improvement,Closed,"isis-mavendeps-xxxtest were removed, but I think they are still in docs / pptx slide.",
ISIS-3045,Improvement,Closed,UX: Explanatory tooltip/description for 'Clear Hints' Button.,End-users most certainly don't know what the 'Clear Hints' button does.
ISIS-3044,Improvement,Reopened,[kroviz] Fix Various UI Glitches,"* LogEntry.type empty for menuBars
 * Blob sizes are not shown"
ISIS-3043,Improvement,Open,[kroviz] [Ongoing] Dependency Upgrade,"* PdfJs
 * FullCalendar
 * Photo Viewer \{ zCanvas | pixiJs | BabylonJs | Tridi | PhotoSphere | ... }
 * Video Player \{ ...}
 * etc."
ISIS-3042,Improvement,Open,[kroviz] Add some Examples (Kitchensink),"* PdfJs
 * FullCalendar
 * Photo Viewer \{ zCanvas | pixiJs | BabylonJs | Tridi | PhotoSphere | ... }
 * Video Player \{ ...}
 * etc."
ISIS-3041,Documentation,Open,[Ongoing] Site/Doc Maintenance,Ongoing task across releases.
ISIS-3040,Improvement,In Progress,[Wicket Viewer] Bring in PDF/JS (extension),Also provide a demo showcase.
ISIS-3039,Improvement,In Progress,[Wicket Viewer] Resurrect Calendar Event View (fullcalendar extension),Also provide a demo showcase.
ISIS-3038,Improvement,Closed,[Wicket Viewer] MarkupComponent to support rendering (none) badge for null,"For consistency with other value-types, markup based value types should also render a (none) badge when null."
ISIS-3037,New Feature,Closed,Persona interface to unify PersonaWithFinder and PersonaWithBuilderScript,
ISIS-3036,Improvement,Closed,[invalid] Remove BuilderScriptAbstract#setPrereq as it is now useless.,"BuilderScriptAbstract was simplified to take a single generic type, but unfortunately that breaks setPrereq which relied upon the other type.

as there are other ways of accomplishing this use case, just remove.

 

Don't forget to update the docs, though.

 "
ISIS-3035,Improvement,Open,[Wish] Log Stacktrace alongside ERROR to Console,"I have an issue with a (kind of) swallowed exception. IsisInteraction.executeInternal stumbles over an
{code:java}
org.springframework.dao.IncorrectResultSizeDataAccessException: More than one result was returned from Query.getSingleResult(); nested exception is javax.persistence.NonUniqueResultException: More than one result was returned from Query.getSingleResult(){code}
The (Wicket) UI shows:
{code:java}
[object not found]: object not found (incorrect result size data access exception): More than one result was returned from Query.getSingleResult() 
{code}
Console shows:
{code:java}
2022-05-03 12:08:07.051 ERROR 22432 — [nio-8080-exec-4] o.a.i.c.i.s.IsisInteraction : failed to execute an interaction
{code}
 
I would prefer to have the stacktrace logged to console as well.

c.f. https://the-asf.slack.com/archives/CFC42LWBV/p1651573266998419"
ISIS-3034,Improvement,Closed,[Metamodel] Unify HiddenTypeFacet and HiddenObjectFacet,No reason to have 2 facets for the same purpose. Also prone to errors.
ISIS-3033,Improvement,Closed,[Wicket Viewer] Inconsistent Form Field Widths with Action Prompt,Seen with date-picker and select2.
ISIS-3032,Improvement,Closed,[Wicket Viewer] Consistent Placeholder Rendering (none) + (suppressed),Currently we define (none) as placeholder for missing/empty values and (suppressed) as placeholder for eg. password values. To allow consistent rendering we need to express a unique CSS class for styling these.
ISIS-3031,New Feature,Resolved,Provide mechanism for UserMementoRefiners to be honoured in integration tests.,
ISIS-3030,Bug,Open,Multiple level drop down List issue,"Here has a mulitiple level drop down list.   

 

 
{code:java}
    @Property(editing = Editing.ENABLED)
    @Getter
    @Setter
    private String tc1Name;    

      @Property(editing = Editing.ENABLED)
    @Getter
    @Setter
    private String tc2Name;    


      @Property(editing = Editing.ENABLED)
    @Getter
    @Setter
    private String tc3Name;    


      @Property(editing = Editing.ENABLED)
    @Getter
    @Setter
    private String tc4Name;    

public List<String> choices0Create() {
        List<Tc1Object> list = tc1ObjectRepo.findAll();
        List<String> nameList = list.stream().map(i -> i.getTechCapabL1Name()).
            distinct().collect(Collectors.toList());
        return nameList;
}    

public String default0Create() {
        return getTc1Name();
}    
public List<String> choices1Create(String tc1Name) {
        System.out.println(""tc1Name: "" + tc1Name);
        Tc1Object tc1 = tc1ObjectRepo.findByTechCapabL1Name(tc1Name);
        System.out.println(""tc1: "" + tc1);
        List<Tc2Object> list = tc2ObjectRepo.findByTc1Object(tc1);
        List<String> nameList = list.stream().map(i -> i.getTechCapabL2Name()).
           distinct().collect(Collectors.toList());
        return nameList;
}    

public String default1Create() {
        return getTc2Name();
    }    

public List<String> choices2Create(String tc2Name) {
        System.out.println(""tc2Name: "" + tc2Name);
        Tc2Object tc2 = tc2ObjectRepo.findByTechCapabL2Name(tc2Name);
        System.out.println(""tc2: "" + tc2);
        List<Tc3Object> list = tc3ObjectRepo.findByTc2Object(tc2);
        System.out.println(""tc list :"" + list);
        List<String> nameList = list.stream().map(i -> 
           i.getTechCapabL3Name()).distinct().
           collect(Collectors.toList());
        return nameList;
}    

public String default2Create() {
        return getTc3Name();
}    

public List<String> choices3Create(String tc3Name) {
        Tc3Object tc3 = tc3ObjectRepo.findByTechCapabL3Name(tc3Name);
        List<Tc4Object> list = tc4ObjectRepo.findByTc3Object(tc3);
        List<String> nameList = list.stream().map(i -> i.getTechCapabL4Name()).distinct().
            collect(Collectors.toList());
        return nameList;
}    
public String default3Create() {
        return getTc4Name();
}
    
@Action(semantics = SemanticsOf.NON_IDEMPOTENT)   
@ActionLayout(promptStyle = PromptStyle.DIALOG_MODAL)   
public CtlgObject create(
final String tc1Name, 
final String tc2Name, 
final String tc3Name, 
final String tc4Name,
            
final String baseTechName) 
{        
         setTc1Name(tc1Name);        
         setTc2Name(tc2Name);        
         setTc3Name(tc3Name);        
         setTc4Name(tc4Name);        
         return repositoryService.persist(new CtlgObject(tc1Name, 
tc2Name, tc3Name, tc4Name, baseTechName));

} {code}
 

 

-----------------

in  choices2Create(String tc2Name) function ,  value of tc2Name is equal  tc1Name ,it's equal  the first drop dwon list value ,not the second drop down list value ."
ISIS-3029,Bug,Open,"Schema ""isisextensionssecman"" does not exists","I use Postgresql .when I try ISIS secman extension ,find following issue :

 

Call: CREATE TABLE isisExtensionsSecman.ApplicationUserRoles (roleId BIGINT NOT NULL, userId BIGINT NOT NULL, PRIMARY KEY (roleId, userId))
Query: DataModifyQuery(sql=""CREATE TABLE isisExtensionsSecman.ApplicationUserRoles (roleId BIGINT NOT NULL, userId BIGINT NOT NULL, PRIMARY KEY (roleId, userId))"")
[EL Warning]: 2022-04-27 14:08:56.375--ServerSession(1942100755)--Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.7.10.v20211216-fe64cd39c3): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: org.postgresql.util.PSQLException: Error schema""isisextensionssecman""  does not exits .

 

Anctullay I have  created isisextensionssecman in Postgresql Database . Seems it's cause by Postgres  names case sensitive issue .

 

when I change the configuration as following according to the document :

[https://isis.apache.org/security/2.0.0-M7/secman/setting-up.html#examples]

 

isis:

    persistence:

        schema:

              auto-create-schemas: abdb

It's still has  the issue , seems isisextensionssecman is hard coding in program .

 

 "
ISIS-3028,Bug,Closed,[Wicket Viewer] Scalar Value Validator might pass Wrapped Values to ObjectManager for Adoption,ObjectManager needs to handle cases where it gets asked to adopt an object that is already a ManagedObject.
ISIS-3027,Improvement,Closed,[Metamodel] Improved Warning Message for non-eagerly introspected Types,"e.g.
Introspecting class 'java.util.function.Supplier' of sort ABSTRACT, after the metamodel had been fully introspected and is now locked. One reason this can happen is if you are attempting to invoke an action through the WrapperFactory on a service class incorrectly annotated with Spring's @Service annotation instead of @DomainService."
ISIS-3026,Bug,Closed,[Wicket Viewer] CSS class generated for property name may clash with predefined ones,"E.g. property by then name 'placeholder' clashes with predefined CSS class 'placeholder', which messes up HTML rendering."
ISIS-3025,Improvement,Closed,[Wicket Viewer] Make link color a CSS var '--link-color',"Allow for simple application.css override like
{code:css}
:root {
  --link-color: steelblue;
  --link-color-hover: rgb(10, 70, 140);
}
{code}
"
ISIS-3024,Improvement,Closed,[Wicket Viewer] Add Form Label Decorator,"Form labels support the mandatory marker, should support colon suffix and may support ellipsification in the future.

Hence add a newform label specific decorator to viewer-commons."
ISIS-3023,Improvement,Closed,[Wicket Viewer] Max Width for Form Labels,"Current width ratio of form label vs form field is 30/100. Which on wider screens may cause a large amount of white space between label and field.

Idea is to cap label width at eg. max 220px or a rem equivalent."
ISIS-3022,Bug,Closed,[Wicket Viewer] Regression: entity link click no longer honors CTRL key down,"Open link in new browser tab, with CTRL key down click, no longer works on entity links."
ISIS-3021,Improvement,Closed,[Metamodel] Improved Validation Message for DomainServices when missing Namespace,Separate messages for either DomainService or DomainObject.
ISIS-3020,Improvement,Closed,[Programming Model] Support Multivariate Parameter Supporting Methods,Re-enable  v1 backward compatibility. Remove restrictions on validateNXxxx(...).
ISIS-3019,Bug,Closed,[Metamodel] @Domain.Exclude not working as a Method Veto Marker,"git clone [https://github.com/apache/isis-app-demo] .

git checkout main-SNAPSHOT

first regression: 

[https://github.com/apache/isis-app-demo/blob/main-SNAPSHOT/webapp/src/main/java/petclinic/webapp/application/services/homepage/HomePageViewModel_bookVisit.java#L47]

 

second regression:

[https://github.com/apache/isis-app-demo/blob/main-SNAPSHOT/webapp/src/main/java/petclinic/webapp/application/services/homepage/HomePageViewModel_bookVisit.java#L46]

- adding `@Domain.Exclude` as a workaround didn't work.

 "
ISIS-3018,Bug,Closed,[Duplicate] DataRowWkt is looking up DataRow by uuid and it causes NPE,"This is a hardly reproducible bug, and even more hard to fix it:

Every time DataRow is created, a new UUID is associated to it. DataRow is created by DataTableModel lazily. DataTableModel can be recreated by its memento, and of cource it is sometimes recreated during deserialization. 

DataRowWkt is a representation of DataRow connected by DataTableModel (or its memento), and UUID. But recreation of DataTableModel creates new UUID for rows, so DataRowWkt, after deserialization, can't find the DataRow object by the _original_ UUID. Clicking to the checkbox on the row of the wicket table this causes an NPE (datarow still null,  DataRowToggleWkt.getBindable(DataRow) can not call getSelectToggle()).

The origin of the bug is the invalid DataRow representation (the uuid), which is recreated  (a new one associated) every time, when DataTableModel serialized and deserialized.

My suggestion is to use the getBookmark of ManagedObject maybe in form of a String, and use this String to identify the DataRow instead of UUID.

This is more consistent method to identify the datarow. (If String is too brute force solution, it could be any of OidDto or UUID depending on the ManagedObject supports Bookmark)

So DataTableModel.lookupDataRow, and DataRowWkt should be changed as well.

 

Other solution, to save the UUIDs into the DataTableModel Memento, using the index somehow as the association base, and use them in the recreation.

 

It would be a good idea to protect DataRowToggleWkt from the null datarow value as well, or at least from the NPE caused by the unsuccessful row lookup.

 

 "
ISIS-3017,Improvement,Closed,[Wicket Viewer] WebRequestCycleForIsis does not display recognizable error.,"In WebRequestCycleForIsis onException there is a code:
{code:java}
val exceptionRecognizerService = getExceptionRecognizerService();
val recognizedIfAny = exceptionRecognizerService.recognize(ex);
if(recognizedIfAny.isPresent()) {
    return respondGracefully(cycle);
} {code}
So it recognizes the error, but does not display it.

 

Maybe

 
{code:java}
val exceptionRecognizerService = getExceptionRecognizerService();
val recognizedIfAny = exceptionRecognizerService.recognize(ex);
if(recognizedIfAny.isPresent()) {
    getMessageBroker().ifPresent(broker->{
        String msg = recognizedIfAny.get().toMessage(getCommonContext().getTranslationService());
        if (msg != null) {
            broker.addMessage(
                    msg);
        }
    });
    return respondGracefully(cycle);
}
 {code}
could work well."
ISIS-3016,Bug,Closed,[Wicket Viewer] JGrowlUtil does not escape multiline characters well.,"JGrowlUtil does not escape control chars (for example \n) in the string in escape method, so they are inserted directly, so resulting javascript code could have syntax error. "
ISIS-3015,Improvement,Open,"[Wicket Viewer] Property Edit via FormExecutorDefault, will not display Recoverable Exception","During property edit, FormExecutorDefault does not display database error, because it checks 
{code:java}
!formExecutorContext.isWithinInlinePrompt(){code}
 condition. 

It would be nice if ExceptionRecognizerService/ExceptionRecognizer could mark the exception in Recognition if:
 * The exception should be displayed as message in Action/Property/Inline edit.
 * This feature default to configuration

This protocol should be supported in FormExecutorDefault.

Anyway, the current protocol does not work at all, it forwards the exception, but does not display the error page neither due to the WebRequestCycleForIsis and the JGrowlUtil bug. "
ISIS-3014,Question,Open,Enum typed property value display is incorrect," 

In Isis enum values can have title (@Title) property to display user friendly.

For example:

 

 
{code:java}
public enum PublicationMode {
  jupyter_notebook(""Jupyter notebook""),
  jupyter_notebook_pdf_email(""Jupyter notebook PDF fájl levélhez""),
  site_json_data(""Hely JSON adata"");

  private final String title;

  PublicationMode(String title) {
    this.title = title;
  }

  @Title
  public String getTitle() {
    return title;
  }
} {code}
It works very well everywhere in Isis, except:

 

Wicket viewer uses StringPanel to display it (according to ValueChoicesSelect2PanelFactory).
 * It would be better to display it as ValueFallbackPanel instead of StringPanel. in view mode, ValueChoicesSelect2Panel works well in edit mode.
 * ValueFallbackPanel  should display ManagedObjects.titleOf(objectAdapter), overriding newTextFieldValueModel and return an overridden kind of TextFieldValueModel<String> for example (which is not possible now, because it is a final method). Other solution to create a good converter and facet."
ISIS-3013,Bug,Closed,[Wicket Viewer] ComponentHintKey can cause NPE,"There is two method to access key value in ComponentHintKey  according to the getKey() method: accessing the component directly if exists, or the componentProvider.  But componentProvider is transient: after the serialization/deserialization cycle it can not be accessed, causing NullPointerException in getKey(). (Wicket viewer caches the page, so serialization is a must)

Solution: gain access to the component directly on serialization:

 
{code:java}
private void writeObject(ObjectOutputStream oos)
        throws IOException {
    if (componentProvider != null && component == null) {
        try {
            component = componentProvider.get();
        } catch (Exception ignored) {
// Maybe some log is necessary or throw the error
        }
    }
    oos.defaultWriteObject();
} {code}
 "
ISIS-3012,Bug,Closed,"[RO] Exception Handling depends on javax.jdo, which is not always provided","This JDO dependency in RO is just used for Exception recognition, but then when using JPA the javax.jdo Exception classes are never provided, which leads to a javax/jdo/JDOException class not found, triggered by any unrelated exception that passes through the RO Exception recognition code.

Fix is to add a new SPI for Exception Root cause finding, then decouple RO and JDO."
ISIS-3011,Improvement,Open,"[kroviz] Iterate Over menuBars Actions in Order to Find Out, Which Are (To Be) Disabled",See: https://the-asf.slack.com/archives/CFC42LWBV/p1650459541270369
ISIS-3010,Improvement,Closed,"[JDO] Add Support for JPA annotations, as DN allows these",
ISIS-3009,Bug,Closed,Entity change publishing in demo app seemingly broken.,"[https://demo-wicket.jdo.isis.incode.work/wicket/entity/demo.DomainObjectEntityChangePublishingEnabledEntity:2]

see attachment for animation

resulting in:
 * java.lang.RuntimeException
 * unrecoverable error: 'unexpected: owner is a mixin ManagedObject.SimpleManagedObject(specification=ObjectSpecificationDefault@44ec4a73[class=demoapp.dom.domain.objects.DomainObject.entityChangePublishing.DomainObjectEntityChangePublishingEntity_updatePropertyUsingAction,type=MIXIN,superclass=java.lang.Object], pojo=demoapp.dom.domain.objects.DomainObject.entityChangePublishing.DomainObjectEntityChangePublishingEntity_updatePropertyUsingAction@31703d6)'
 * org.apache.isis.commons.internal.exceptions._Exceptions#unrecoverableFormatted(_Exceptions.java:148)
 * org.apache.isis.core.metamodel.interactions.InteractionHead#of(InteractionHead.java:80)
 * org.apache.isis.core.metamodel.interactions.InteractionHead#regular(InteractionHead.java:56)
 * org.apache.isis.core.metamodel.spec.ManagedObjects$VisibilityUtil#createVisibleInteractionContext(ManagedObjects.java:866)
 * org.apache.isis.core.metamodel.spec.ManagedObjects$VisibilityUtil#isVisible(ManagedObjects.java:851)
 * org.apache.isis.core.runtimeservices.executor.MemberExecutorServiceDefault#filteredIfRequired(MemberExecutorServiceDefault.java:310)
 * org.apache.isis.core.runtimeservices.executor.MemberExecutorServiceDefault#invokeAction(MemberExecutorServiceDefault.java:185)
 * org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract#doInvoke(ActionInvocationFacetForDomainEventAbstract.java:131)
 * org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract#lambda$invoke$1(ActionInvocationFacetForDomainEventAbstract.java:99)
 * org.apache.isis.commons.functional.Try#call(Try.java:55)
 * org.apache.isis.core.runtimeservices.transaction.TransactionServiceSpring#callTransactional(TransactionServiceSpring.java:108)
 * org.apache.isis.applib.services.xactn.TransactionalProcessor#callWithinCurrentTransactionElseCreateNew(TransactionalProcessor.java:100)
 * org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract#invoke(ActionInvocationFacetForDomainEventAbstract.java:98)
 * org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault#executeInternal(ObjectActionDefault.java:421)
 * org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionMixedIn#execute(ObjectActionMixedIn.java:162)
 * org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault#executeWithRuleChecking(ObjectActionDefault.java:389)
 * org.apache.isis.core.metamodel.interactions.managed.ManagedAction#invokeWithRuleChecking(ManagedAction.java:150)
 * org.apache.isis.core.metamodel.interactions.managed.ActionInteraction#invokeWithRuleChecking(ActionInteraction.java:157)
 * org.apache.isis.viewer.wicket.model.models.ActionModelImpl#executeActionAndReturnResult(ActionModelImpl.java:128)
 * org.apache.isis.viewer.wicket.ui.panels.FormExecutorDefault#lambda$executeAndProcessResults$6(FormExecutorDefault.java:134)
 * org.apache.isis.commons.functional.Either$Left#fold(Either.java:127)
 * org.apache.isis.viewer.wicket.ui.panels.FormExecutorDefault#executeAndProcessResults(FormExecutorDefault.java:133)
 * org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract#onOkSubmitted(PromptFormAbstract.java:121)
 * org.apache.isis.viewer.wicket.ui.util.Wkt$4#onSubmit(Wkt.java:241)
 * org.apache.wicket.ajax.markup.html.form.AjaxButton$1#onSubmit(AjaxButton.java:113)"
ISIS-3008,Bug,In Progress,[Wicket Viewer] Pending Parameter Glitches,"Changing (n-1)-th argument clears n-th argument.
(see attachment)"
ISIS-3007,Wish,Open,[Wish] Composite Value Types: flattened prompt (vs prompt within a prompt),"invoking an action that takes a composite value type, it's necessary to click in twice.  Can this be streamlined?

Ideally, I would like that the parameters are ""flattened"", so that there is only a single prompt.   If there is >1 parameter, then perhaps some sort of fieldset or border to show the parameters that make up the composite type.

See attachment.

 "
ISIS-3006,Improvement,Closed,[Wicket Viewer] Several UI Glitches,"as observed in [https://simpleapp.jdo-snapshot.isis.incode.work/wicket/entity/simple.SimpleObject:1]
h4. 2.0.0-M7.20220414-0303-2bfd2108.20220414-1723-82b15168

 

1. updateName action not aligned - WON'T FIX (always was that way: associated action group below property is slightly indented; I think makes sense for the human eye)

!image-2022-04-14-18-46-10-895.png|width=212,height=114!

2. Notes field is not full width... - FIXED

!image-2022-04-14-18-47-11-634.png|width=494,height=138!

... when click in, the prompt box is full width

 

!image-2022-04-14-18-48-11-094.png|width=496,height=83!

 

3. when click into the prompt for editing notes, the notes field does NOT have focus; requires a further click (or pressing tab) to gain focus. - FIXED

4. tabbing around, cannot tab to the notes field; so it's therefore only possible to activate using a mouse. - FIXED

!image-2022-04-14-18-50-44-741.png|width=448,height=186!

^^^ press tab here does not give focus to the 'edit' button of the notes field

5. when run fixtures, the drop-down seems too narrow.  I think we used to use the entire width of the panel, which I still prefer.  But anyway, it is not the same width as the drop-down, so is inconsistent in and of itself.

!image-2022-04-14-18-52-57-553.png|width=370,height=176!

6. The parameters field has multiLine=10, but the UI here ^^^ only shows a couple of rows. - FIXED

7. (also present in M6) the menu drop down overlaps the menu bar, I find it ugly (used to be directly underneath) - FIXED

!image-2022-04-14-18-55-12-188.png|width=358,height=150!

 

 

 

 

 "
ISIS-3005,Bug,Closed,[Wicket Viewer] DataRowToggle might throw after issuing a Blob Download,See discussion https://the-asf.slack.com/archives/CFC42LWBV/p1649780318577199
ISIS-3004,Improvement,Closed,[Programming Model] Deprecate superfluous @DomainService.logicalTypeName,"DomainServices are managed by Spring. Use Spring Bean naming semantics only. 

The framework should not offer an alternative mechanism here, as this potentially just leads to confusion.

Note: DomainObjects are not managed by Spring, hence its perfectly justified to keep the @DomainObject.logicalTypeName."
ISIS-3003,Improvement,Closed,[Extensions] Reinstate Command Replay Service,Fix REST communication. Add 'real' tests if possible.
ISIS-3002,New Feature,Open,Bring in extensions/core/outbox-publisher (from incode-platform),"and then remove mappings entirely, cf ISIS-2999"
ISIS-3001,Improvement,Resolved,Move subdomains/excel to extensions/applib/excel,and then remove subdomains entirely (cf ISIS-2999)
ISIS-3000,Improvement,Closed,[RO] Relocate the RO client from mappings-restclient to isis-viewer-restfulobjects-client ,
ISIS-2999,Improvement,Resolved,Remove subdomains and mappings artifacts, ... these APIs aren't an area where our framework should be imposing any opinions on how to do.
ISIS-2998,Bug,Resolved,maven projects not being deployed at end.,"see for example [https://github.com/apache/maven-deploy-plugin/pull/1,] [https://github.com/apache/maven-plugins/pull/138] "
ISIS-2997,Improvement,Closed,[Applib] new Interface MetamodelListener for Convenience to listen on Metamodel Events,"Usage example ...
{code:java}
@Service
public class SeedService implements MetamodelListener {

    @Override
    public void onMetamodelLoaded() {
        // seed database entities
    }
}
{code}
"
ISIS-2996,Bug,Open,[kroviz] Checksum validation failed -> isis-client-kroviz-2.0.0-M7.pom/jar,"{code}
Downloading from github: https://github.com/orgs/apache/packages?repo_name=isis/org/apache/isis/incubator/clients/isis-client-kroviz/2.0.0-M7/isis-client-kroviz-2.0.0-M7.pom
[WARNING] Checksum validation failed, expected <!DOCTYPE but is 2957fa1aa94bb336f1dde747283c052fdf453828 from github for https://github.com/orgs/apache/packages?repo_name=isis/org/apache/isis/incubator/clients/isis-client-kroviz/2.0
.0-M7/isis-client-kroviz-2.0.0-M7.pom
[WARNING] Could not validate integrity of download from https://github.com/orgs/apache/packages?repo_name=isis/org/apache/isis/incubator/clients/isis-client-kroviz/2.0.0-M7/isis-client-kroviz-2.0.0-M7.pom
org.eclipse.aether.transfer.ChecksumFailureException: Checksum validation failed, expected <!DOCTYPE but is d84a4bb255fdcd07ee4a129ac9a472b33fb40af1
    at org.eclipse.aether.connector.basic.ChecksumValidator.validateExternalChecksums (ChecksumValidator.java:174)
    at org.eclipse.aether.connector.basic.ChecksumValidator.validate (ChecksumValidator.java:103)
    at org.eclipse.aether.connector.basic.BasicRepositoryConnector$GetTaskRunner.runTask (BasicRepositoryConnector.java:460)
    at org.eclipse.aether.connector.basic.BasicRepositoryConnector$TaskRunner.run (BasicRepositoryConnector.java:364)
    at org.eclipse.aether.util.concurrency.RunnableErrorForwarder$1.run (RunnableErrorForwarder.java:75)
    at org.eclipse.aether.connector.basic.BasicRepositoryConnector$DirectExecutor.execute (BasicRepositoryConnector.java:628)
    at org.eclipse.aether.connector.basic.BasicRepositoryConnector.get (BasicRepositoryConnector.java:262)
    at org.eclipse.aether.internal.impl.DefaultArtifactResolver.performDownloads (DefaultArtifactResolver.java:514)
    at org.eclipse.aether.internal.impl.DefaultArtifactResolver.resolve (DefaultArtifactResolver.java:402)
    at org.eclipse.aether.internal.impl.DefaultArtifactResolver.resolveArtifacts (DefaultArtifactResolver.java:229)
    at org.eclipse.aether.internal.impl.DefaultArtifactResolver.resolveArtifact (DefaultArtifactResolver.java:207)
    at org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.loadPom (DefaultArtifactDescriptorReader.java:244)
    at org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.readArtifactDescriptor (DefaultArtifactDescriptorReader.java:175)
    at org.eclipse.aether.internal.impl.collect.DefaultDependencyCollector.resolveCachedArtifactDescriptor (DefaultDependencyCollector.java:538)
    at org.eclipse.aether.internal.impl.collect.DefaultDependencyCollector.getArtifactDescriptorResult (DefaultDependencyCollector.java:523)
    at org.eclipse.aether.internal.impl.collect.DefaultDependencyCollector.processDependency (DefaultDependencyCollector.java:410)
    at org.eclipse.aether.internal.impl.collect.DefaultDependencyCollector.processDependency (DefaultDependencyCollector.java:362)
    at org.eclipse.aether.internal.impl.collect.DefaultDependencyCollector.process (DefaultDependencyCollector.java:349)
    at org.eclipse.aether.internal.impl.collect.DefaultDependencyCollector.collectDependencies (DefaultDependencyCollector.java:254)
    at org.eclipse.aether.internal.impl.DefaultRepositorySystem.collectDependencies (DefaultRepositorySystem.java:284)
    at org.apache.maven.project.DefaultProjectDependenciesResolver.resolve (DefaultProjectDependenciesResolver.java:170)
    at org.apache.maven.lifecycle.internal.LifecycleDependencyResolver.getDependencies (LifecycleDependencyResolver.java:243)
    at org.apache.maven.lifecycle.internal.LifecycleDependencyResolver.resolveProjectDependencies (LifecycleDependencyResolver.java:147)
    at org.apache.maven.lifecycle.internal.MojoExecutor.ensureDependenciesAreResolved (MojoExecutor.java:248)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:202)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:156)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:148)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject (LifecycleModuleBuilder.java:117)
    at org.apache.maven.lifecycle.internal.builder.multithreaded.MultiThreadedBuilder$1.call (MultiThreadedBuilder.java:196)
    at org.apache.maven.lifecycle.internal.builder.multithreaded.MultiThreadedBuilder$1.call (MultiThreadedBuilder.java:186)
    at java.util.concurrent.FutureTask.run (FutureTask.java:264)
    at java.util.concurrent.Executors$RunnableAdapter.call (Executors.java:515)
    at java.util.concurrent.FutureTask.run (FutureTask.java:264)
    at java.util.concurrent.ThreadPoolExecutor.runWorker (ThreadPoolExecutor.java:1128)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run (ThreadPoolExecutor.java:628)
    at java.lang.Thread.run (Thread.java:829)
[WARNING] Checksum validation failed, expected <!DOCTYPE but is d84a4bb255fdcd07ee4a129ac9a472b33fb40af1 from github for https://github.com/orgs/apache/packages?repo_name=isis/org/apache/isis/incubator/clients/isis-client-kroviz/2.0
.0-M7/isis-client-kroviz-2.0.0-M7.pom
Downloaded from github: https://github.com/orgs/apache/packages?repo_name=isis/org/apache/isis/incubator/clients/isis-client-kroviz/2.0.0-M7/isis-client-kroviz-2.0.0-M7.pom (153 kB at 84 kB/s)
[WARNING] The POM for org.apache.isis.incubator.clients:isis-client-kroviz:jar:2.0.0-M7 is invalid, transitive dependencies (if any) will not be available, enable debug logging for more details
Downloading from Apache Repository: https://repository.apache.org/org/apache/isis/incubator/clients/isis-client-kroviz/2.0.0-M7/isis-client-kroviz-2.0.0-M7.jar
Downloading from github: https://github.com/orgs/apache/packages?repo_name=isis/org/apache/isis/incubator/clients/isis-client-kroviz/2.0.0-M7/isis-client-kroviz-2.0.0-M7.jar
[WARNING] Checksum validation failed, expected <!DOCTYPE but is dceef51f90ed664c955cfac59c374841542564fa from github for https://github.com/orgs/apache/packages?repo_name=isis/org/apache/isis/incubator/clients/isis-client-kroviz/2.0
.0-M7/isis-client-kroviz-2.0.0-M7.jar
[WARNING] Could not validate integrity of download from https://github.com/orgs/apache/packages?repo_name=isis/org/apache/isis/incubator/clients/isis-client-kroviz/2.0.0-M7/isis-client-kroviz-2.0.0-M7.jar
org.eclipse.aether.transfer.ChecksumFailureException: Checksum validation failed, expected <!DOCTYPE but is 9d31a8f534f4cc51fb0eec428407ed1d7b0adce3
    at org.eclipse.aether.connector.basic.ChecksumValidator.validateExternalChecksums (ChecksumValidator.java:174)
    at org.eclipse.aether.connector.basic.ChecksumValidator.validate (ChecksumValidator.java:103)
    at org.eclipse.aether.connector.basic.BasicRepositoryConnector$GetTaskRunner.runTask (BasicRepositoryConnector.java:460)
    at org.eclipse.aether.connector.basic.BasicRepositoryConnector$TaskRunner.run (BasicRepositoryConnector.java:364)
    at org.eclipse.aether.util.concurrency.RunnableErrorForwarder$1.run (RunnableErrorForwarder.java:75)
    at org.eclipse.aether.connector.basic.BasicRepositoryConnector$DirectExecutor.execute (BasicRepositoryConnector.java:628)
    at org.eclipse.aether.connector.basic.BasicRepositoryConnector.get (BasicRepositoryConnector.java:262)
    at org.eclipse.aether.internal.impl.DefaultArtifactResolver.performDownloads (DefaultArtifactResolver.java:514)
    at org.eclipse.aether.internal.impl.DefaultArtifactResolver.resolve (DefaultArtifactResolver.java:402)
    at org.eclipse.aether.internal.impl.DefaultArtifactResolver.resolveArtifacts (DefaultArtifactResolver.java:229)
    at org.eclipse.aether.internal.impl.DefaultRepositorySystem.resolveDependencies (DefaultRepositorySystem.java:340)
    at org.apache.maven.project.DefaultProjectDependenciesResolver.resolve (DefaultProjectDependenciesResolver.java:191)
    at org.apache.maven.lifecycle.internal.LifecycleDependencyResolver.getDependencies (LifecycleDependencyResolver.java:243)
    at org.apache.maven.lifecycle.internal.LifecycleDependencyResolver.resolveProjectDependencies (LifecycleDependencyResolver.java:147)
    at org.apache.maven.lifecycle.internal.MojoExecutor.ensureDependenciesAreResolved (MojoExecutor.java:248)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:202)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:156)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute (MojoExecutor.java:148)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject (LifecycleModuleBuilder.java:117)
    at org.apache.maven.lifecycle.internal.builder.multithreaded.MultiThreadedBuilder$1.call (MultiThreadedBuilder.java:196)
    at org.apache.maven.lifecycle.internal.builder.multithreaded.MultiThreadedBuilder$1.call (MultiThreadedBuilder.java:186)
    at java.util.concurrent.FutureTask.run (FutureTask.java:264)
    at java.util.concurrent.Executors$RunnableAdapter.call (Executors.java:515)
    at java.util.concurrent.FutureTask.run (FutureTask.java:264)
    at java.util.concurrent.ThreadPoolExecutor.runWorker (ThreadPoolExecutor.java:1128)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run (ThreadPoolExecutor.java:628)
    at java.lang.Thread.run (Thread.java:829)
[WARNING] Checksum validation failed, expected <!DOCTYPE but is 9d31a8f534f4cc51fb0eec428407ed1d7b0adce3 from github for https://github.com/orgs/apache/packages?repo_name=isis/org/apache/isis/incubator/clients/isis-client-kroviz/2.0
.0-M7/isis-client-kroviz-2.0.0-M7.jar
Downloaded from github: https://github.com/orgs/apache/packages?repo_name=isis/org/apache/isis/incubator/clients/isis-client-kroviz/2.0.0-M7/isis-client-kroviz-2.0.0-M7.jar (153 kB at 97 kB/s)
{code}"
ISIS-2995,Task,Closed,[Task] Verify IsisModuleSecurityBypass does bypass Password Hash Generation,"Even when IsisModuleSecurityBypass.class  is included in DemoAppWicketJpa, BCrypt action are logged to the console (using parameters:  -Xms1G -Djava.security.egd=file:///dev/./urandom -Djava.security.debug=""provider,engine=SecureRandom"")

See:   https://the-asf.slack.com/archives/CFC42LWBV/p1649400664122289?thread_ts=1648577147.703919&cid=CFC42LWBV"
ISIS-2994,Improvement,Closed,[Viewers] Consolidate direct Uses of Facets into a Utility,"Viewers should not directly access facets. Use a layer of abstraction instead. 

That's also an opportunity for consolidating code fragments that all try to accomplish the same thing."
ISIS-2993,Improvement,Closed,[Commons] Replace Result<T> with more general purpose Try<T>,Also an opportunity to get rid of difficult to comprehend concepts in Result<T>.
ISIS-2992,Bug,Closed,"[Applib] VirtualClock.nowAt(LocalDate.parse(""2014-05-18"")) fails.","I had to use the Instant overload...

 
 val testDateTime = LocalDate.parse(""2014-05-18"");
val testInstant = Instant.from(testDateTime.atStartOfDay().toInstant(ZoneOffset.UTC));
val virtualClock = VirtualClock.nowAt(testInstant);"
ISIS-2991,Improvement,Open,[Java17+] Replace Spring's Nullable with Jakarta's,"An new Jakarta 2.x API version was released, that includes a Nullable annotation.

As Jakarta is the industry standard, batch replace 
import org.springframework.lang.Nullable;
with
import jakarta.annotation.Nullable;"
ISIS-2990,Bug,Closed,[Duplicate] Clean build and run displays ClassNotFoundException: com.sun.xml.bind.v2.ContextFactory,"I cloned the isis-app-simpleapp repository, switched to JDO branch, built project, and ran via the 'java -jar target/simpleapp-jdo-webapp-2.0.0-M7-exec.jar' command.  Same result for JPA branch.

Error on console:

```

java.lang.RuntimeException: unrecoverable error: 'Error obtaining JAXBContext for class; object class is 'org.apache.isis.schema.cmd.v2.CommandDto'' with cause ...
        at org.apache.isis.commons.internal.exceptions._Exceptions.unrecoverable(_Exceptions.java:144) ~[isis-commons-2.0.0-M7.jar!/:2.0.0-M7]
        at org.apache.isis.commons.internal.resources._Xml.verboseException(_Xml.java:201) ~[isis-commons-2.0.0-M7.jar!/:2.0.0-M7]
        at org.apache.isis.commons.internal.resources._Xml.contextOf(_Xml.java:226) ~[isis-commons-2.0.0-M7.jar!/:2.0.0-M7]
        at java.util.concurrent.ConcurrentHashMap.computeIfAbsent(ConcurrentHashMap.java:1705) ~[?:?]
        at org.apache.isis.commons.internal.resources._Xml.jaxbContextFor(_Xml.java:217) ~[isis-commons-2.0.0-M7.jar!/:2.0.0-M7]
        at org.apache.isis.applib.util.JaxbUtil.jaxbContextFor(JaxbUtil.java:111) ~[isis-applib-2.0.0-M7.jar!/:2.0.0-M7]
        at org.apache.isis.applib.util.schema.CommandDtoUtils.getJaxbContext(CommandDtoUtils.java:57) ~[isis-applib-2.0.0-M7.jar!/:2.0.0-M7]
        at org.apache.isis.applib.util.schema.CommandDtoUtils.init(CommandDtoUtils.java:50) ~[isis-applib-2.0.0-M7.jar!/:2.0.0-M7]
        at org.apache.isis.commons.internal.concurrent._ConcurrentTask$3.innerCall(_ConcurrentTask.java:150) ~[isis-commons-2.0.0-M7.jar!/:2.0.0-M7]
        at org.apache.isis.commons.internal.concurrent._ConcurrentTask$3.innerCall(_ConcurrentTask.java:146) ~[isis-commons-2.0.0-M7.jar!/:2.0.0-M7]
        at org.apache.isis.commons.internal.concurrent._ConcurrentTask$1.innerCall(_ConcurrentTask.java:109) ~[isis-commons-2.0.0-M7.jar!/:2.0.0-M7]
        at org.apache.isis.commons.internal.concurrent._ConcurrentTask.run(_ConcurrentTask.java:86) ~[isis-commons-2.0.0-M7.jar!/:2.0.0-M7]
        at java.util.concurrent.ForkJoinTask$AdaptedRunnableAction.exec(ForkJoinTask.java:1406) ~[?:?]
        at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290) ~[?:?]
        at java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1016) ~[?:?]
        at java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:1665) ~[?:?]
        at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1598) ~[?:?]
        at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:177) ~[?:?]
Caused by: javax.xml.bind.JAXBException: Implementation of JAXB-API has not been found on module path or classpath.
        at javax.xml.bind.ContextFinder.newInstance(ContextFinder.java:232) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
        at javax.xml.bind.ContextFinder.find(ContextFinder.java:375) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
        at javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:691) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
        at javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:632) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
        at org.apache.isis.commons.internal.resources._Xml.contextOf(_Xml.java:224) ~[isis-commons-2.0.0-M7.jar!/:2.0.0-M7]
        ... 15 more
Caused by: java.lang.ClassNotFoundException: com.sun.xml.bind.v2.ContextFactory
        at jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:602) ~[?:?]
        at jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:178) ~[?:?]
        at java.lang.ClassLoader.loadClass(ClassLoader.java:521) ~[?:?]
        at javax.xml.bind.ServiceLoaderUtil.nullSafeLoadClass(ServiceLoaderUtil.java:92) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
        at javax.xml.bind.ServiceLoaderUtil.safeLoadClass(ServiceLoaderUtil.java:125) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
        at javax.xml.bind.ContextFinder.newInstance(ContextFinder.java:230) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
        at javax.xml.bind.ContextFinder.find(ContextFinder.java:375) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
        at javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:691) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
        at javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:632) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
        at org.apache.isis.commons.internal.resources._Xml.contextOf(_Xml.java:224) ~[isis-commons-2.0.0-M7.jar!/:2.0.0-M7]
        ... 15 more

```"
ISIS-2989,Wish,Open,[Wish] Many of the wicket components have hard-coded strings.,"Many of the wicket components have hard-coded strings, we can not translate them. Most important examples:  BooleanPanel (Yes, No, Not set), GenericTitleColumn (Related, Object)"
ISIS-2988,Wish,Open,[Wish] Wicket localization is not bound to ISIS po translation model,We have to use .properties file to translate strings in wicket viewer which is inconvenient. Moreover we have to subclass IsisWicketApplication to place the properties file. It would be very nice to use the po file to translate Wicket strings. 
ISIS-2987,Improvement,Closed,"Although PoReader could translate text without context, can't read it from a file","In PoReader  translate(TranslationContext,  String,  ContextAndMsgId.Type) can handle both of contextual and contextless (more generic) translations, which is a good thing. But as org.apache.isis.core.runtimeservices.i18n.po.Block reads the po file, we can not define generic translation, context is a must (contextlist should be non-empty).

Maybe a new State (GENCONTEXT) is sugested:
{code:java}
private enum State {
    CONTEXT(""^#: (?<value>.+)$""),
    GENCONTEXT(""^#:\s*$""),
    MSGID(""^msgid \""(?<value>.+)\""$""),
    MSGID_PLURAL(""^msgid_plural \""(?<value>.+)\""$""),
    MSGSTR(""^msgstr \""(?<value>.+)\""$""),
    MSGSTR0(""^msgstr\\[0\\] \""(?<value>.+)\""$""),
    MSGSTR1(""^msgstr\\[1\\] \""(?<value>.+)\""$""); {code}
and in parseLine:

 
{code:java}
if (state == State.CONTEXT) {
    final Matcher contextMatcher = state.pattern.matcher(line);
    if (contextMatcher.matches()) {
        final String context = contextMatcher.group(""value"");
        contextList.add(context);
        return this;
    } else {
        state = State.GENCONTEXT;
    }
}


if (state == State.GENCONTEXT) {
    final Matcher contextMatcher = state.pattern.matcher(line);
    if (contextMatcher.matches()) {
        contextList.add("""");
        return this;
    } else {
        state = State.MSGID;
        // fallthrough (there may not have been any more context)
    }
}
 {code}
Maybe contextList is better to be Set, not a List.

 

In this case we can use 
{code:java}
#: 
msgid ""Anonymous""
msgstr ""Anonim felhasználó""
{code}
As generic context.

 

 

 "
ISIS-2986,Bug,Open,Some ValueSemanticsProvider does not take into account the null value,"Many of the provided ValueSemanticsProvider, especially 
 * JavaSqlDateValueSemantics,
 * JavaSqlTimeStampValueSemantics
 * JavaSqlTimeValueSemantics
 * JavaUtilDateValueSemantics

throws NullPointerException, when converted through  toDelegateValue and fromDelegateValue, as the parameter can be null.

Some other provider could be involved, too.

 "
ISIS-2985,Bug,Open,"Modal dialog ""X"" button  does not close interaction well","Pressing X in header of the modal dialog does not remove the panel from nestedPanelStack in ModalDialog. This causes a strange behaivor: pressing X closes the dialog, but opening again, we have to press the Cancel button 2 times. Maybe ModalDialog should have a closehandler.  (Modal.setUseCloseHandler(true), and override onClose) In this case onClose occurs when X is pressed and when Cancel/Ok is pressed either."
ISIS-2984,Bug,Open,@GeneratedValue(strategy = GenerationType.SEQUENCE) no longer works after migrating to 2.0.0.M7,"DB: mysql 8

Tested project: Demo App SimpleApp 2.0.0.M7

When this is used:
{code:java}
GenerationType.SEQUENCE{code}
Error:
{code:java}
Caused by: java.lang.IllegalArgumentException: The persistence layer does not recognize given object of type domainapp.modules.simple.dom.so.SimpleObject, meaning the object has no identifier that associates it with the persistence layer. (most likely, because the object is detached, eg. was not persisted after being new-ed up)
    at org.apache.isis.commons.internal.exceptions._Exceptions.illegalArgument(_Exceptions.java:79) ~[isis-commons-2.0.0-M7.jar:2.0.0-M7]
    at org.apache.isis.persistence.jpa.integration.entity.JpaEntityFacetFactory$JpaEntityFacet.identifierFor(JpaEntityFacetFactory.java:135) ~[isis-persistence-jpa-integration-2.0.0-M7.jar:2.0.0-M7]
    at org.apache.isis.core.metamodel.objectmanager.ObjectManager.autoBookmarked(ObjectManager.java:207) ~[isis-core-metamodel-2.0.0-M7.jar:2.0.0-M7]
    at org.apache.isis.core.metamodel.objectmanager.ObjectManager.adapt(ObjectManager.java:158) ~[isis-core-metamodel-2.0.0-M7.jar:2.0.0-M7]
    at org.apache.isis.core.metamodel.objectmanager.ObjectManager.adapt(ObjectManager.java:130) ~[isis-core-metamodel-2.0.0-M7.jar:2.0.0-M7]
    at org.apache.isis.persistence.jpa.applib.integration.IsisEntityListener.onPrePersist(IsisEntityListener.java:73) ~[isis-persistence-jpa-applib-2.0.0-M7.jar:2.0.0-M7]
    at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
    at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]
    at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
    at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]
    at org.eclipse.persistence.internal.security.PrivilegedAccessHelper.invokeMethod(PrivilegedAccessHelper.java:530) ~[org.eclipse.persistence.core-2.7.10.jar:?]
    at org.eclipse.persistence.internal.jpa.metadata.listeners.EntityListener.invokeMethod(EntityListener.java:322) ~[org.eclipse.persistence.jpa-2.7.10.jar:?]
    at org.eclipse.persistence.internal.jpa.metadata.listeners.EntityListener.invokeMethod(EntityListener.java:346) ~[org.eclipse.persistence.jpa-2.7.10.jar:?]
    at org.eclipse.persistence.internal.jpa.metadata.listeners.EntityListener.prePersist(EntityListener.java:453) ~[org.eclipse.persistence.jpa-2.7.10.jar:?]
    at org.eclipse.persistence.descriptors.DescriptorEventManager.notifyListener(DescriptorEventManager.java:746) ~[org.eclipse.persistence.core-2.7.10.jar:?]
    at org.eclipse.persistence.descriptors.DescriptorEventManager.notifyEJB30Listeners(DescriptorEventManager.java:672) ~[org.eclipse.persistence.core-2.7.10.jar:?]
    at org.eclipse.persistence.descriptors.DescriptorEventManager.executeEvent(DescriptorEventManager.java:233) ~[org.eclipse.persistence.core-2.7.10.jar:?]
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.registerNewObjectClone(UnitOfWorkImpl.java:4468) ~[org.eclipse.persistence.core-2.7.10.jar:?]
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.registerNotRegisteredNewObjectForPersist(UnitOfWorkImpl.java:4445) ~[org.eclipse.persistence.core-2.7.10.jar:?]
    at org.eclipse.persistence.internal.sessions.RepeatableWriteUnitOfWork.registerNotRegisteredNewObjectForPersist(RepeatableWriteUnitOfWork.java:523) ~[org.eclipse.persistence.core-2.7.10.jar:?]
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.registerNewObjectForPersist(UnitOfWorkImpl.java:4387) ~[org.eclipse.persistence.core-2.7.10.jar:?]{code}
Basically the entity does not get a auto-generated primary key. This worked before in 2.0.0.M6

Thanks!"
ISIS-2983,Bug,In Progress,[Wicket Viewer] Infinite Loop with Visibility Advisors in Tables,"Reported by Martin Hesse:

I just had a case where when all members of type A are hidden, then rendering a collection of instances of type B that have a field of type A will result in an endless loop (M6).
... but the problem went away when I explicitly vetoed visibility of the member (field) of type A in type B"
ISIS-2982,Bug,Resolved,I18n does not load translation files,"PoReader does not check ALL translation candidates.

In PoReader.readPoElseNull(final Locale locale)
{code:java}
for (final String candidate : candidates) {
    final List<String> lines = readUrl(candidate);
    if(lines != null) {
        return lines;
    }
} {code}
always returns at the first candidate, regardless of existing of the file/resource, as readUrl never returns null, because readUrl is a stream collect. I think it should carry on loading resources when lines == null || lines.size() == 0.

If I had translation_hu.po, it was the last candidate, it was never loaded. "
ISIS-2981,Improvement,Closed,[Wicket Viewer] Login/rememberMe not working across App-Restarts when Prototyping,"Login with remember me stores login secrets with cookies. However, after app restart, on loading (secret recovery), decryption fails with
javax.crypto.BadPaddingException: Given final block not properly padded. Such issues can arise if a bad key is used during decryption.

Which seems correct behavior, as the salt changes with each app restart. 
However, for a prototyping scenario we'd rather want to keep a fixed salt.
"
ISIS-2980,Bug,Closed,[Metamodel] Default layout not loaded due to missing GridReader,"GridSystemServiceBootstrap does not initialize the gridReaderProvider field in its constructor, however it gets the value as a parameter. This prevents loading the default layout, so it jumps to the fallback (as a solution to the NPE)

 "
ISIS-2979,Bug,Open,"Removing any JPA entity in an action, which is in a parameter value, causes ObjectNotFoundException","Good example to create an action, with List<Entity> parameter, and remove these entities from the database in the action body. After the execution, this causes ObjectNotFoundException, because FormExecutorDefault calculates resultResponse with using snapshotArgs of ActionModel, which tries to refresh parameter, but it is deleted. JPA does not distinct detached and removed entity - stated in JpaEntityFacet - and the context treats it as detached (I think it is a good solution in JDO, entities with deleted state are ignored, but JPA sends back a detached state, even if it is deleted). A comment

""//XXX whether DETACHED or REMOVED is currently undecidable (JPA)""

 warns it well, but a better solution is necessary. An acceptable solution is to catch the exception in parameter value refresh operation in EntityUtil.refetch."
ISIS-2978,Bug,Closed,[Commons] Concurrent Threads use wrong ClassLoader ,"h2. Problem description

Followed guide [https://isis.apache.org/docs/2.0.0-M7/starters/simpleapp.html#downloading-&-running] 

My environment:
 * Windows 10
 * openjdk 11.0.2 2019-01-15

 

I use in all cases same JDK.

 

Launching from IDE (IntelliJ) works fine, but when launching the packaged JAR with
{code:java}
somePath\isis-app-simpleapp-jdo\webapp\target> java -jar .\simpleapp-jdo-webapp-2.0.0-M7-exec.jar  {code}
I get next error - see attached log for whole startup log
{code:java}
Caused by: java.lang.ClassNotFoundException: com.sun.xml.bind.v2.ContextFactory
   at jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:583) ~[?:?]
   at jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:178) ~[?:?]
   at java.lang.ClassLoader.loadClass(ClassLoader.java:521) ~[?:?]
   at javax.xml.bind.ServiceLoaderUtil.nullSafeLoadClass(ServiceLoaderUtil.java:92) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
   at javax.xml.bind.ServiceLoaderUtil.safeLoadClass(ServiceLoaderUtil.java:125) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
   at javax.xml.bind.ContextFinder.newInstance(ContextFinder.java:230) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
   at javax.xml.bind.ContextFinder.find(ContextFinder.java:375) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
   at javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:691) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
   at javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:632) ~[jakarta.xml.bind-api-2.3.3.jar!/:2.3.3]
   at org.apache.isis.commons.internal.resources._Xml.contextOf(_Xml.java:224) ~[isis-commons-2.0.0-M7.jar!/:2.0.0-M7]
   ... 15 more
{code}"
ISIS-2977,Improvement,Closed,[Vulnerability] jdom dependency has XXE vulnerability,"https://github.com/advisories/GHSA-2363-cqg2-863c

https://github.com/apache/isis/blob/master/core/pom.xml#L137"
ISIS-2976,Bug,Resolved,[Wicket Viewer] Re-hydrate mixed-in collection issue when jumping between tabs,"Originates from <wicket:container wicket:id=""scalarIfCompact""/> creation."
ISIS-2975,Improvement,Closed,Enable nightly builds using github's own package registry.,
ISIS-2974,Improvement,Closed,Update unittestsupport to use junit v5,
ISIS-2973,Improvement,Open,[Question] Why are large Collections so slow?,"As of SO question

https://stackoverflow.com/questions/71430340/apache-isis-action-to-list-entities-is-too-slow-found-2-issues-questions-on-it"
ISIS-2972,New Feature,Open,[Question] Server Side Pagination for Collections,"Research question as of mailing-list
https://lists.apache.org/thread/19dqmsd94ww5gzjcycqpzpjhn23ttnly 

Can we do this?"
ISIS-2971,Improvement,Open,[Demo] Missing Showcase for Enums (as value-types),"Enums are a special case of value-type, which we have no showcase for yet in the demo."
ISIS-2970,Bug,Closed,[Wicket Viewer] Validation messages for textfield throw IAE,"When creating a new entity from a menuaction and one of the mandatory parameters based on a TEXTfield is left empty, ISIS will throw an exception:

 

 
{code:java}
java.lang.IllegalArgumentException: Parameter message can't be null
    at org.apache.wicket.feedback.FeedbackMessage.<init>(FeedbackMessage.java:123) ~[wicket-core-8.13.0.jar:8.13.0]
    at org.apache.wicket.feedback.FeedbackMessages.error(FeedbackMessages.java:151) ~[wicket-core-8.13.0.jar:8.13.0]
    at org.apache.wicket.Component.error(Component.java:1214) ~[wicket-core-8.13.0.jar:8.13.0]
    at org.apache.isis.viewer.wicket.ui.util.Wkt$18.error(Wkt.java:592) ~[isis-viewer-wicket-ui-2.0.0-M7.jar:2.0.0-M7]
{code}
 

 

Rootcause org.apache.isis.viewer.wicket.ui.util.Wkt calls the wrong error method (from Component instead of FormComponent) for both textFieldWithConverter and passwordFieldWithConverter. Provided a fix."
ISIS-2969,Bug,Closed,ManagedObject's NATURAL_NULL_FIRST Comparator cannot handle null well,Nulled objects will never match any instanceof tests.
ISIS-2968,Improvement,Open,[Validation] Guard against Members that contribute vetoed Domain-Types,"I'm currently not sure what happens if a vetoed type appears as a property-, action-return- or action-parameter-type. That should trigger a MM validation error, such that these types cannot find a sneaky way into the MM."
ISIS-2967,Bug,Resolved,ApplicationUser.@UserLocale is missing MAX_LENGTH definitions,"The @Property and @Parameter both mis a maxlength definition. As a result the script in the M7 migration notes, which states a length of 120, is in conflict with the default of 20 in ISIS. This leads to runtime exceptions:
{code:java}
org.datanucleus.store.rdbms.exceptions.WrongPrecisionException: Wrong precision for column isisExtensionsSecman.ApplicationUser.""language"" : was 120 (according to the JDBC driver) but should be 20 (based on the MetaData definition for field org.apache.isis.extensions.secman.jdo.user.dom.ApplicationUser.language) {code}"
ISIS-2966,Improvement,Closed,Make it an Option whether to include non-essential Mixins or not.,"We could provide a Spring @Configuration class by the name IsisModuleApplibMixins, that imports all mixins (applib) that we currently provide. But that would be up for Devs to use or not or to customize.

Do this for other artifacts analog. IsisModuleXxx ..."
ISIS-2965,Task,In Progress,Release activities for 2.0.0-RC1,
ISIS-2964,Bug,Resolved,UserMemento fails Deserialization as a Viewmodel,"Caused by: java.lang.NoSuchMethodException: org.apache.isis.applib.services.user.UserMemento.<init>()
"
ISIS-2963,Bug,Closed,facet-processing: annotations not recognized on primitive boolean properties,As demonstrated with the demo app.
ISIS-2962,Bug,Closed,[Wicket Viewer] Re-hydrate issues when jumping between tabs in a non-Jaxb view model,"Referenced JDO entities get detached from JDO persistence layer during switching between tabs, which crosses AJAX request boundaries. However, on rendering, referenced JDO entities don't get re-fetched."
ISIS-2961,Bug,Closed,"[Wicket Viewer] When cancelling update on textfield, the cancelled text remains visible (until page refresh)",See screenshots. Can be reproduced in both JPA and JDO simple app.
ISIS-2960,Bug,Open,jdo + jpa : duplicate primary key exception is not propagated to Wicket viewer,
ISIS-2959,Improvement,Open,[Wicket Viewer] menu bar lists which are too long (eg Prototyping) should have a scroll bar.,
ISIS-2958,Bug,Open,IsisToWicketTreeAdapter$TreeModel Deserialization fails to resolve Injection Points,"{{org.apache.isis.viewer.wicket.ui.components.entity.icontitle.EntityIconAndTitlePanel.determineTitle()}}{color:#1d1c1d} would try to resolve the title of the node and then fails with a {color}{{NullPointerException}}

Nodes are view models, not entities.

Current workaround: inject the dependencies via custom TreeAdapter implementation.

 

 "
ISIS-2957,Improvement,Closed,[kroviz] Visualize REST Performance,"Embed data2viz and use it to draw a bubble chart (x: starttime, y: duration, siZe: response size).
C,f, https://www.d3-graph-gallery.com/graph/bubble_template.html"
ISIS-2956,Bug,Closed,[Metamodel] False positive when guarding against JDO Version Annotation Override,"{{domainapp.app.MyType: cannot have @Version annotated on this subclass and any of its supertypes; superclass: domainapp.app.TypeAbstract }}Code roughly looks like this and worked fine until the upgrade to the latest nightly (from M6.20220115 to M6.20220210):
@javax.jdo.annotations.Version(strategy= VersionStrategy.DATE_TIME, column=""version"")
public abstract class TypeAbstract {

@javax.jdo.annotations.PersistenceCapable
@javax.jdo.annotations.Inheritance(strategy=javax.jdo.annotations.InheritanceStrategy.NEW_TABLE)
public class MyType extends TypeAbstract {"
ISIS-2955,Bug,Closed,[kroviz] Build fails on Windows (commands 'cp' and 'mv' not available),"[ERROR] Failed to execute goal org.codehaus.mojo:exec-maven-plugin:3.0.0:exec (copy-jar) on project isis-client-kroviz: Command execution failed. Cannot run program ""cp"" (in directory ""...isis\incubator\clients\kroviz""): CreateProcess error=2, The system cannot find the file specified"
ISIS-2954,Bug,Closed,[Demo] UUID Value-Type Choice Select fails with '... value required',"Event though value is present from choice select drop-down, a validation failure message is produces on drop-down value select."
ISIS-2953,Improvement,Open,[kroviz] Improve Branding,"* use small image for MenuBar
* in case of missing logo, use sensible default 
* overload fixed values for colors, fonts, sizes with values form user specified file (c.f. theme in the wicket viewer)
* refactor About dialog
* refactor Samples"
ISIS-2952,Improvement,Closed,[Testing] Support for declarative Interaction Context Specification,"Proposal:


{code:java}
@Test
@InteractAs(
    userName=""sven"", 
    localeName=""en"", 
    frozenDateTime=""2010-01-01 13:02:04 -03"",
    ...)
void test() { 
  // ...
}
{code}
"
ISIS-2951,Improvement,Closed,[Secman] TenantedAuthorizationFacetDefault to recognize System User as not to be vetoed,It seems that the TenantedAuthorizationFacetDefault will veto visbility of any object because the __system user is not recognized as valid ApplicationUser.
ISIS-2950,Bug,Closed,Various Glitches detected by Trying all Demo Menu Actions,"We detected demo bugs as well as framework bugs, via a new kroViz feature, that would systematically try all demo menu actions.
* demo service provisioning issues
* demo entity registration
* value-type marshalling
* async wrapper execution bug
* ro-viewer not handling null values for properties well"
ISIS-2949,New Feature,Closed,[kroviz] Execute All MenuBar Actions at Once,Collecting HTTP 500 can be done via Event view filtering.
ISIS-2948,Bug,Closed,[RO Viewer] Element-type not correctly represented for Collections.,"I'm on master and get a.m. message for http://localhost:8080/restful/domain-types/demo.JavaLangStringHolder

{code:java}
org.apache.isis.viewer.restfulobjects.rendering.domaintypes.DomainTypeReprRenderer.render(DomainTypeReprRenderer.java:70)
org.apache.isis.viewer.restfulobjects.rendering.Responses.ofOk(Responses.java:67)
org.apache.isis.viewer.restfulobjects.rendering.Responses.ofOk(Responses.java:56)
org.apache.isis.viewer.restfulobjects.viewer.resources.DomainTypeResourceServerside.domainType(DomainTypeResourceServerside.java:134)
java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
java.base/java.lang.reflect.Method.invoke(Method.java:566)
org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:170)
org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:130)
org.jboss.resteasy.core.ResourceMethodInvoker.internalInvokeOnTarget(ResourceMethodInvoker.java:660)
org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTargetAfterFilter(ResourceMethodInvoker.java:524)
org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invokeOnTarget$2(ResourceMethodInvoker.java:474)
org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:364)
org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:476)
org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:434)
org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:408)
org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:69)
org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:492)
org.jboss.resteasy.core.SynchronousDispatcher.lambda$invoke$4(SynchronousDispatcher.java:261)
org.jboss.resteasy.core.SynchronousDispatcher.lambda$preprocess$0(SynchronousDispatcher.java:161)
org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:364)
org.jboss.resteasy.core.SynchronousDispatcher.preprocess(SynchronousDispatcher.java:164)
org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:247)
org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:249)
org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:60)
org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55)
javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsInteractionFilter.lambda$doFilter$1(IsisRestfulObjectsInteractionFilter.java:387)
org.apache.isis.commons.functional.ThrowingRunnable.lambda$toCallable$0(ThrowingRunnable.java:42)
org.apache.isis.commons.functional.Result.of(Result.java:58)
org.apache.isis.core.runtimeservices.transaction.TransactionServiceSpring.callTransactional(TransactionServiceSpring.java:108)
org.apache.isis.applib.services.xactn.TransactionalProcessor.callWithinCurrentTransactionElseCreateNew(TransactionalProcessor.java:100)
org.apache.isis.applib.services.xactn.TransactionalProcessor.runWithinCurrentTransactionElseCreateNew(TransactionalProcessor.java:110)
org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsInteractionFilter.lambda$doFilter$3(IsisRestfulObjectsInteractionFilter.java:386)
org.apache.isis.core.runtimeservices.session.InteractionServiceDefault.runInternal(InteractionServiceDefault.java:329)
org.apache.isis.core.runtimeservices.session.InteractionServiceDefault.run(InteractionServiceDefault.java:272)
org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsInteractionFilter.doFilter(IsisRestfulObjectsInteractionFilter.java:383)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.apache.isis.core.webapp.modules.logonlog.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:60)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:540)
org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:895)
org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1732)
org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
java.base/java.lang.Thread.run(Thread.java:834)
{code}

"
ISIS-2947,New Feature,In Progress,GraphQL viewer,
ISIS-2946,Wish,Open,[Wish] Allow option to have Boolean scalar values toggle,"For a Boolean value to be toggled, it takes the following user actions:

   1. Click on the ""Yes/no"" text next to the checkbox

   2. Since the page just refreshed, scroll down to where the property was

   3. Click on the checkbox

   4. Click on the ""OK"" button

   5. Since the page just refreshed again, scroll down to see that your change took

 

It seems to me that a user usually expects to be able to update a checkbox with a single action and the current behavior is the result of building in a confirmation feature into the Wicket module.  For those who would prefer skip the confirmation step, we can have updates occur automatically.  This would make the checkbox intuitive and allow updates of other scalars without a submit button."
ISIS-2945,Improvement,Closed,[Tooling] Verify support for simplified <p> paragraph syntax within java-doc,Don't require for a java-doc paragraph to have an ending tag </p>.
ISIS-2944,Bug,Closed,[Metamodel] Support Method Discovery is not reliable when not annotated,"Don't fail with 'Action method overloading is not allowed', if the method with conflicting signature is annotated with 
{noformat}
@Domain.Exclude
{noformat}
"
ISIS-2943,Improvement,Closed,Reinstate ApplicationAdvice.APPLIES_EXCLUSIVELY,"Dan: the widget author might want ApplicationAdvice in order to ""take control"" and prevent other views.  So probably that should be reinstated"
ISIS-2942,Bug,Closed,Tenancy Child Removal not working," 

 "
ISIS-2941,Bug,Closed,Regression: Generic numerical primitive Field Editing throws due to missing Conversion,"only affects primitives, eg with double:
{noformat}
 java.lang.IllegalArgumentException
Object has incompatible type java.lang.String,must be an instance of java.lang.Double.
org.apache.isis.commons.internal.exceptions._Exceptions#illegalArgument(_Exceptions.java:79)
org.apache.isis.core.metamodel.spec.ManagedObjects#lambda$5(ManagedObjects.java:157)
org.apache.isis.commons.internal.binding._BindableAbstract#setValue(_BindableAbstract.java:120)
org.apache.isis.viewer.wicket.model.models.ScalarModel#setObject(ScalarModel.java:152)
org.apache.isis.viewer.wicket.ui.components.scalars.TextFieldValueModel#setObject(TextFieldValueModel.java:70)
org.apache.wicket.model.Model#setObject(Model.java:45) 
{noformat}"
ISIS-2940,Bug,Closed,wrapper's call to filterIfRequired results in an empty collection being converted to null.,see https://the-asf.slack.com/archives/CFC42LWBV/p1641738337005100
ISIS-2939,Improvement,Closed,[WON'T DO] Rename o.a.i.applib.annotation to o.a.i.applib.annotations (plural),This has come up as a requirement to ease migration for existing projects from v1 to v2 using Spring's AliasFor annotation.
ISIS-2938,Improvement,Closed,Don't allow DomainObject Annotation on Interfaces,"Add MM validation, to prevent misuse of DomainObject annotation on interfaces."
ISIS-2937,Improvement,Closed,Update Cheatsheets for M7,
ISIS-2936,Bug,Closed,[Regression] Starters are not aware of 'Bill of Materials',Import BOM into Starters. 
ISIS-2935,Bug,Closed,Wrapper: null arguments not properly adapted,"as in M6 nightly : 2.0.0-M6.20211222-0235-1757e8ed

@Parameter(maxLength = VatCode.MAX_LEN, optionality = OPTIONAL) in meta annotations like @VatCode are not picked up by Isis.

Resulted in an error when invoking via wrapper within an integ test:

Method threw 'java.lang.IllegalArgumentException' exception. arguments must be specified for action Action  ...

when using wrapMixin.act(null, ...)"
ISIS-2934,Improvement,Closed,[WON'T DO] Merge up /isis-core/ bill of materials into root pom,See also https://www.baeldung.com/spring-maven-bom
ISIS-2933,Improvement,Closed,[Tooling] Ignore the 'final' keyword with method signatures when generating adoc,
ISIS-2932,Improvement,Closed,Remove the /isis-parent/ module.,Instead merge up into root pom.
ISIS-2931,Bug,Closed,[Wicket] ChoiceProviders for EntityPage Features are populated eagerly.,seeing this for both: action-params with choices and properties with choices
ISIS-2930,Bug,Closed,Use of Collection Annotation w/o specifying a typeOf always yields Object.class,Use of Collection Annotation w/o specifying a typeOf attribute should instead enforce the framework to inspect any generic parameter type.
ISIS-2929,Bug,Closed,[Wicket] Sorting or expanding a table results in new DataTableModel detached from Checkbox-Toggle-Model,"After sorting or expanding a table, the Checkbox-Toggle model from the UI runs out of sync with the DataTableModel used to feed associated actions."
ISIS-2928,New Feature,Resolved,[kroviz] Show Application Logo in MenuBar,
ISIS-2927,New Feature,Open,[Vaa] Use DataTableModel for rendering Collections/Tables,We had recently introduced a new model for collection/table rendering with the Wicket Viewer. The Vaadin Viewer needs to be rewired to use this new DataTableModel.
ISIS-2926,New Feature,Open,[Vaa] Support for Bootstrap Grid Layout,Adopt layout support for rendered pages from the Wicket Viewer.
ISIS-2925,New Feature,Open,[Vaa] Support for all fundemental Value Types,"That is those, that the Demo App features (strings, numbers, temporals, blobs, clobs, ...)."
ISIS-2924,New Feature,Closed,[Vaa] Encapsulate node.js within Vaadin Viewer's Maven Artifacts,"Such that developers don't have to pull node.js for building their domain models.

Experiments with this have been started at https://github.com/apache-isis-committers/isis-lab/tree/master/experiments/vaadin"
ISIS-2923,New Feature,Open,[Vaa] Split the Vaadin Demo into JPA/JDO parts,Just like we did with the Wicket Demo.
ISIS-2922,New Feature,Open,[Vaa] Integrate FilteringTable,https://vaadin.com/directory/component/filteringtable
ISIS-2921,Bug,Closed,ScalarModelWithMultiChoice might throw Exception,"# False positives on ManagedObject check for proper packing, when the ManagedObject is empty.
# Parameters as a Tuple (PAT) when holding entities, these might become detached during parameter negotiation process.

"
ISIS-2920,Improvement,Closed,"[i18n] Remove LocaleProvider, instead use the InteractionContext","LocaleProvider is no longer needed, as we have 'per user locales' now."
ISIS-2919,Improvement,In Progress,Session-scoped Time-zone Support,InteractionContext needs time-zone information for the current user/client.
ISIS-2918,Improvement,Closed,[SecMan] Support for per User Locale,"* Add Locale as supported value-type. 
* Extend ApplicationUser with new property 'locale'.
* Make the SecMan module a provider of a LocaleResolver. 
* Make the framework interactions sensitive to LocaleResolvers."
ISIS-2917,Improvement,Closed,[Wicket Viewer] Allow direct export of Collection Views,"Eg. we have a Collection View for Excel, which does nothing more than render a download link button on its own panel. 

Why not just execute the download directly when one clicks on the menu dropdown link!"
ISIS-2916,Improvement,Closed,Introduce @LogicalTypeName to properly map abstract types onto the security model,"Take for example from the demo a type, which is implemented by JDO/JPA entity types and a viewmodel:

public interface WrapperDoubleHolder { ... }

We need a programming model such that we can declare for this interface, which logical-type it maps to, when deciding whether a logged on user has access to this type or not."
ISIS-2915,Bug,Closed,[Regression] SecMan User Manager throws RuntimeEx on rendering,"Caused by: java.lang.RuntimeException: unrecoverable error: 'action vetoed: [no such associated action newLocalUser for collection org.apache.isis.extensions.secman.applib.user.app.ApplicationUserManager#allUsers() (which is not a collection)] 'action' either does not exist, is disabled or is not visible'
	at org.apache.isis.commons.internal.exceptions._Exceptions.unrecoverable(_Exceptions.java:140) ~[classes/:?]
	at org.apache.isis.core.metamodel.interactions.managed.ActionInteraction.lambda$4(ActionInteraction.java:189) ~[classes/:?]
	at org.apache.isis.core.metamodel.interactions.managed.MemberInteraction.getManagedMemberElseThrow(MemberInteraction.java:114) ~[classes/:?]
	at org.apache.isis.core.metamodel.interactions.managed.ActionInteraction.getManagedActionElseThrow(ActionInteraction.java:183) ~[classes/:?]
	at org.apache.isis.core.metamodel.interactions.managed.ActionInteraction.getManagedActionElseFail(ActionInteraction.java:188) ~[classes/:?]
	at org.apache.isis.viewer.common.model.action.HasActionInteraction.getManagedAction(HasActionInteraction.java:35) ~[classes/:?]"
ISIS-2914,Improvement,Closed,@XmlJavaTypeAdapter on Properties should be optional if the referenced Type has it already,"Dan Haywood ...
Looking at the adding of @XmlJavaTypeAdapter to the fields, eg EmployeeWithEmployment#employment ... I think it ought to be sufficient instead to annotate the entities eg Employment themselves?"
ISIS-2913,New Feature,Closed,[kroviz] Handle Multiple Server Connections (Gracefully),"Connections to multiple servers are already possible, although not nicely presented in the UI.
 * amend system menu (=v) with one entry per (connected) server
 * when server is switched, switch menubar content as well
 * provide a DnD example using the (left hand) dock
 * use  local and remote demo for POC (simpleapp not configured for CORS yet)"
ISIS-2912,New Feature,Resolved,[kroviz] Serve Static Resources Different Than Dynamic Resources,"Investigate if and how static resources (e.g. object-icon) could be served faster.

Currently they are handled like dynamic resources (e.g. object-layout).

 

C.f. https://the-asf.slack.com/archives/CFC42LWBV/p1638545632071000"
ISIS-2911,Bug,Closed,Entity Choice Providers appear detached when using JDO,reproduce ... [Demo/JDO] Nature Stateful Refs Entity
ISIS-2910,Bug,Closed,Viewmodels after Modification must invalidate their memoized Bookmark,"We do memoize Bookmarks for Entities and Viewmodels within their wrapping ManagedObject. However, for Viewmodels we must invalidate the Bookmark whenever there are (property) changes happening."
ISIS-2909,Improvement,Closed,[Demo]  Enable http-2 per default,"{code:java}
 server:
+  http2:
+    enabled: true
{code}

see also https://blog.stackpath.com/glossary-http2/"
ISIS-2908,New Feature,Open,[kroviz] POC for Processing Non-RO Events,"Convert e.g. GeoRSS ([https://disasterscharter.org/charter-portlets/cpi-mvc/activations/feed/rss/]) into events and visualize them on GeoMap.

References:
 * [https://www.javacodegeeks.com/2020/05/rest-using-feeds-to-publish-events.html]
 * [https://www.npmjs.com/package/rss-watcher]

(!) Eventually rss-watcher needs to be modified in order process GeoRSS"
ISIS-2907,Bug,Closed,css-class-fa not applied to menu items based on action classes,"When in the application.yml for isis is configured with:
{code:java}
isis:
  applib:
    annotation:
      action-layout:
        css-class-fa:
          patterns:
            - new.*:fa-plus
            - add.*:fa-plus-square
            - attach.*:fa-plus-square
            - create.*:fa-plus{code}
This will not be applied to:
{code:java}
public class ContactsMenu {
    @Action
    public class newContact{
        public Person act( ...{code}
This workaround works:
{code:java}
public class ContactsMenu { 
    @Action
    @ActionLayout(cssClassFa = ""fa-plus"")
    public class newContact{
        public Person act( ... {code}"
ISIS-2906,Improvement,Closed,"[RO Viewer] JsonRepresentation to preserve Map<K, V> Ordering","Investigate, whether its as simple as replacing an underlying HashMap<K, V> with a LinkedHashMap<K, V>."
ISIS-2905,Wish,Open,[Wish] Provide import/export function for roles,"It would be convenient to be able to test roles and then import them in a prod environment.

Also copy-ing existing and slightly adapting them as a new role would be a use case.

(The way we use the current isissecurity in Estatio, roles can consist of 45 lines)"
ISIS-2904,Bug,Closed,Wicket Viewer: ScalarPropertyModel.getManagedProperty() fails when mixed in ,"ObjectSpecification's getProperty(id), getCollection(id), getAction(id) are ambiguous, as to whether include mixed-in or not.

This suggests refactoring above methods, to take an additional argument to govern, as to whether include mixed-in or not."
ISIS-2903,Bug,Closed,Recreation fails for ViewModels containing Entities,"reproduce ... [Demo] Nature Stateful Refs Entity

Various glitches:
'add Child' ... no choices given
'add All' ... throws
java.lang.IllegalStateException: entity demo.JaxbRefEntity is required to have a memoized ID, otherwise cannot re-attach 

Also click on VM's title (reload page) throws."
ISIS-2902,Improvement,Closed,Harmonize ManagedMember.MemberType and Identifier.Type,"Or at least investigate whether semantics can be made more clear, especially when ManagedMember or Identifier do reference a Mixin.

eg. for mixins these tests are not equivalent, which in the past had lead to framework bugs ...
memberType.isPropertyOrCollection()
identifier.getType().isPropertyOrCollection()"
ISIS-2901,Bug,Closed,Using namedXxx with Mixins does not work,Bug is with the regex vs. imperative name matching logic to determine a FontAwesome css-class-name if any.
ISIS-2900,Improvement,In Progress,wrapMixin(...) should inject into both mixin and mixee and result of action.,
ISIS-2899,Improvement,Closed,[DUPLICATE] Relax arch rule (ArchitectureJdoRules.every_jdo_PersistenceCapable_with_DATASTORE_identityType_must_be_annotated_as_DataStoreIdentity()),This one should only check root entities; subclasses do not need the identity definition
ISIS-2898,New Feature,Closed,[WON'T DO] Add `@LogicalTypeName` as a meta-annotation,"{code:java}
@Column(length = LogicalTypeName.MAX_LEN, allowsNull = ""true"")
@Property(maxLength = LogicalTypeName.MAX_LEN, optionality = OPTIONAL)
@PropertyLayout
@Parameter(maxLength = LogicalTypeName.MAX_LEN, optionality = OPTIONAL)
@ParameterLayout
@Target({ METHOD, FIELD, PARAMETER, ANNOTATION_TYPE })
@Retention(RUNTIME)
public @interface LogicalTypeName {

    int MAX_LEN = 254;

}
 {code}"
ISIS-2897,Bug,Closed,"Wicket viewer caching old instance of mixin (and thus entity), resulting in NPE when invoke action prompt",Mixed in actions on an entity instance do receive a detached mixee (entity) object. Seen with JDO.
ISIS-2896,Bug,Closed,Regression: char/Character Property not rendered correctly,"Instead of showing the property value, the value rendered is 'ScalarPropertyModel'."
ISIS-2895,Bug,Closed,[Not a Problem] Property referencing a DomainObject rendered as empty Box,"Expected to see an icon with link and label, instead it appears as a white box. The link however is active."
ISIS-2894,Bug,Closed,"Metamodel validation ""orphan"" errors if implement interface.","Given:

public interface Succeedable<T>

{ T getSuccessor(); void setSuccessor(T successor); }

when:

public class BankAccount implements Succeedable<BankAccount>

{  @Column(allowsNull = ""true"", name = ""successorId"") @Property(editing = Editing.DISABLED) @PropertyLayout(hidden = Where.PARENTED_TABLES) @Getter @Setter private BankAccount successor; }

then get metamodel validation error:

.BankAccount#getSuccessor(): has annotation @Domain.Include, is assumed to support a property, collection or action. Unmet constraint(s): misspelled prefix or unsupported method signature

~~~~

or:

org.apache.isis.subdomains.base.applib.Chained

and

public class Agreement implements Chained<Agreement>"
ISIS-2893,Bug,Closed,Command log does not publish for mixin actions.,"Predicate org.apache.isis.applib.Identifier.matchesCommand(Command) fails to match, when the action is mixed in.

e.g when the Command's memberId is ""Employment#bookLeave"", and the objectMember.getFeatureIdentifier() is ""Employment_bookLeave#act"""
ISIS-2892,Improvement,Closed,Upgrade Wicket 8.x -> 9.x,Also incorporates transition from Bootstrap 4.6 -> 5.1.
ISIS-2891,Improvement,Closed,Remove @ComponentScan where can be replaced by a Component Listing,"Except for the Demo App, we don't want to use @ComponentScan. That should help reduce Application bootstrapping time."
ISIS-2890,Bug,Closed,@ComponentScan missing in IsisModuleSubdomainsDocxApplib,"In Isis subdomain Docx, due to not including @ComponentScan in IsisModuleSubdomainsDocxApplib the spring beans are not registered."
ISIS-2889,Bug,Resolved,objectSpec 'org.apache.isis.valuetypes.asciidoc.applib.value.AsciiDoc' expected to have EncodableFacet or a registered JsonValueConverter,"{code:java}
https://demo-wicket.jdo.isis.incode.work/restful/objects/demo.JavaLangStringEntity/2 {code}
->

{code}
{
  ""httpStatusCode"": 500,
  ""message"": ""objectSpec 'org.apache.isis.valuetypes.asciidoc.applib.value.AsciiDoc' expected to have EncodableFacet or a registered JsonValueConverter"",
  ""detail"": {
    ""className"": ""java.lang.IllegalArgumentException"",
    ""message"": ""objectSpec 'org.apache.isis.valuetypes.asciidoc.applib.value.AsciiDoc' expected to have EncodableFacet or a registered JsonValueConverter"",
    ""element"": [
      ""org.apache.isis.commons.internal.exceptions._Exceptions.illegalArgument(_Exceptions.java:77)"",
      ""org.apache.isis.viewer.restfulobjects.rendering.domainobjects.JsonValueEncoder.appendValueAndFormat(JsonValueEncoder.java:146)"",
      ""org.apache.isis.viewer.restfulobjects.rendering.domainobjects.ObjectPropertyReprRenderer.addValue(ObjectPropertyReprRenderer.java:120)"",
      ""org.apache.isis.viewer.restfulobjects.rendering.domainobjects.ObjectPropertyReprRenderer.render(ObjectPropertyReprRenderer.java:71)"",
      ""org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer.addProperties(DomainObjectReprRenderer.java:341)"",
      ""org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer.withMembers(DomainObjectReprRenderer.java:294)"",
      ""org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer.render(DomainObjectReprRenderer.java:205)"",
      ""org.apache.isis.viewer.restfulobjects.rendering.Responses.ofOk(Responses.java:67)"",
      ""org.apache.isis.viewer.restfulobjects.rendering.service.conneg.ContentNegotiationServiceForRestfulObjectsV1_0.buildResponseTo(ContentNegotiationServiceForRestfulObjectsV1_0.java:118)"",
      ""org.apache.isis.viewer.restfulobjects.rendering.service.conneg.ContentNegotiationServiceForRestfulObjectsV1_0.buildResponse(ContentNegotiationServiceForRestfulObjectsV1_0.java:100)"",
      ""org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationService.lambda$objectRepresentation$0(RepresentationService.java:111)"",
      ""org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationService.buildResponse(RepresentationService.java:220)"",
      ""org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationService.objectRepresentation(RepresentationService.java:110)"",
      ""org.apache.isis.viewer.restfulobjects.viewer.resources._DomainResourceHelper.objectRepresentation(_DomainResourceHelper.java:98)"",
      ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainObjectResourceServerside.object(DomainObjectResourceServerside.java:186)"",
      ""java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)"",
      ""java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)"",
      ""java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)"",
      ""java.base/java.lang.reflect.Method.invoke(Method.java:564)"",
      ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:170)"",
      ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:130)"",
      ""org.jboss.resteasy.core.ResourceMethodInvoker.internalInvokeOnTarget(ResourceMethodInvoker.java:660)"",
      ""org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTargetAfterFilter(ResourceMethodInvoker.java:524)"",
      ""org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invokeOnTarget$2(ResourceMethodInvoker.java:474)"",
      ""org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:364)"",
      ""org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:476)"",
      ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:434)"",
      ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:408)"",
      ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:69)"",
      ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:492)"",
      ""org.jboss.resteasy.core.SynchronousDispatcher.lambda$invoke$4(SynchronousDispatcher.java:261)"",
      ""org.jboss.resteasy.core.SynchronousDispatcher.lambda$preprocess$0(SynchronousDispatcher.java:161)"",
      ""org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:364)"",
      ""org.jboss.resteasy.core.SynchronousDispatcher.preprocess(SynchronousDispatcher.java:164)"",
      ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:247)"",
      ""org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:249)"",
      ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:60)"",
      ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55)"",
      ""javax.servlet.http.HttpServlet.service(HttpServlet.java:764)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)"",
      ""org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)"",
      ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsInteractionFilter.lambda$doFilter$1(IsisRestfulObjectsInteractionFilter.java:387)"",
      ""org.apache.isis.commons.functional.ThrowingRunnable.lambda$toCallable$0(ThrowingRunnable.java:42)"",
      ""org.apache.isis.commons.functional.Result.of(Result.java:58)"",
      ""org.apache.isis.core.runtimeservices.transaction.TransactionServiceSpring.callTransactional(TransactionServiceSpring.java:108)"",
      ""org.apache.isis.applib.services.xactn.TransactionalProcessor.callWithinCurrentTransactionElseCreateNew(TransactionalProcessor.java:100)"",
      ""org.apache.isis.applib.services.xactn.TransactionalProcessor.runWithinCurrentTransactionElseCreateNew(TransactionalProcessor.java:110)"",
      ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsInteractionFilter.lambda$doFilter$3(IsisRestfulObjectsInteractionFilter.java:386)"",
      ""org.apache.isis.core.runtimeservices.session.InteractionServiceDefault.runInternal(InteractionServiceDefault.java:328)"",
      ""org.apache.isis.core.runtimeservices.session.InteractionServiceDefault.run(InteractionServiceDefault.java:271)"",
      ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsInteractionFilter.doFilter(IsisRestfulObjectsInteractionFilter.java:383)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)"",
      ""org.apache.isis.core.webapp.modules.logonlog.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:60)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)"",
      ""org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)"",
      ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)"",
      ""org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)"",
      ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)"",
      ""org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)"",
      ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)"",
      ""org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)"",
      ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)"",
      ""org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)"",
      ""org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)"",
      ""org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:540)"",
      ""org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)"",
      ""org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)"",
      ""org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)"",
      ""org.apache.catalina.valves.RemoteIpValve.invoke(RemoteIpValve.java:769)"",
      ""org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)"",
      ""org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)"",
      ""org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)"",
      ""org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:895)"",
      ""org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1722)"",
      ""org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)"",
      ""org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)"",
      ""org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)"",
      ""org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)"",
      ""java.base/java.lang.Thread.run(Thread.java:832)""
    ],
    ""causedBy"": null
  }
}
{code}"
ISIS-2888,Improvement,Open,"[Performance] Use EclipseLink for caching of ""findByUsername"" and similar security queries.","observed numerous calls to findByUsername going to the database,
 
Have tried various configuration settings to change EclipseLink cache behaviour but they don’t seem to make a difference.
 
One of them was trying to use QueryMonitor to log cache hits but couldn’t make that output anything. Simple observation of the page showed by rough count of time that page load didn’t vary with different configuration settings.
 
Perhaps @Cache is required on ApplicationUser?
 
Earlier attempts to use QueryResultsCache didn’t work out either since hit the issue with ObjectBulkLoader (https://issues.apache.org/jira/browse/ISIS-2330); but think more important is using EclipseLink caching.  
Using that caching would be more likely to make a big difference and dealing with clearing the cache can be done at a later date if we need to write direct to the database.
 
Any luck with settings to log output from EclipseLink’s QueryMonitor or PerformanceMonitor?
~~~

addendum; things attempted:
 
 - various EclipseLink settings and did find with eclipselink.profiler=QueryMonitor that I could reload the dashboard page and see some output.
This showed that caching was happening for primary key based requests but not others.
 
 - Using XML to configure the named queries gave an error about the class not having an id and seemed to be to do with the inheritance and where things were set - various combinations of which class used didn't help.
 
 - tried to no avail finding a way to have my own named queries so I could set the hint on them.
 
 - tried again with wrapping the findByUsername with queryResultsCache but that gave errors about not being in an interaction context when setting up queryResultsCache bean.
 
 
Final solution that was hacked: rudimentary caching in overridden version of AuthorizorSecman."
ISIS-2887,Improvement,Open,[JUnit] More robustness for layout files if member repeated.,"Repeating a property member  in the layout.xml results in confusion...

eg, when ""bookingIdentifier"" was repeated more than once, this is what was observed:

on the booking page we see for example “Collection Address” both on the main panel and in the “Other” panel.

Using the “Rebuild metamodel” menu option the “other"" list reduces as expected.  However, it loses the on the Collection location panel.

If I edit the booking identifier on the Misc tab and save then the field disappears until I refresh the page.

 "
ISIS-2886,Improvement,Closed,@Lazy may be required for AuthenticationManager,"adding another @Lazy was needed to fix integ tests, hitting a circular dependency issue.
 
The file in question is AuthenticationManager.
 
@Service
@Named(""isis.security.AuthenticationManager"")
@Priority(PriorityPrecedence.FIRST)
public class AuthenticationManager {

@Getter private final @NonNull Can<Authenticator> authenticators;

private final Map<String, String> userByValidationCode = _Maps.newConcurrentHashMap();
private final @NonNull InteractionService interactionService;
private final @NonNull RandomCodeGenerator randomCodeGenerator;
private final @NonNull Can<Registrar> registrars;
private final @NonNull List<UserMementoRefiner> userMementoRefiners;

@Inject
public AuthenticationManager(
final List<Authenticator> authenticators,
// needs @Lazy due to circular provisioning dependency
final @Lazy InteractionService anonymousInteractionFactory,
final RandomCodeGenerator randomCodeGenerator,
final @Lazy List<UserMementoRefiner> userMementoRefiners) {
 
I made a local copy of the service and set the priority. It was adding @Lazy to userMementoRefiners that did the trick."
ISIS-2885,Improvement,Closed,wrapMixin and collection parameter,"Possible issue with wrapMixin, perhaps to do with serialisation of view model not handling collections.
 
There’s a line in DisableForContextFacetViaMethod that includes ""InvokeUtil.invokeAutofit(method, target{color:#080808});”. {color}That was throwing an exception when called act() on a wrapMixin() target. By the time the disableAct() was called the parameter had become null.
 
 "
ISIS-2884,Bug,Closed,Passwords not matching after restart,"When I restart the web app the old passwords don’t work.
 
I think this might be the cause of that:
 
@Service
@Named(""isis.ext.secman.PasswordEncryptionServiceUsingJBcrypt"")
@javax.annotation.Priority(PriorityPrecedence.MIDPOINT)
@Qualifier(""JBCrypt"")
public class PasswordEncryptionServiceUsingJBcrypt implements PasswordEncryptionService {

private String salt;

private String getSalt() {
if (salt == null) {
salt = BCrypt.gensalt();
}
return salt;
}

@Override
public String encrypt(String password) {
return password == null ? null : BCrypt.hashpw(password, getSalt());
}

That looks like the salt is set on the service and would be different after the service is used following an app restart.
 
One solution might be a variant that picks up the salt from a property file."
ISIS-2883,Improvement,Closed,[Prototyping] Site-Map Export (AsciiDoc),"I am thinking of a new prototyping menu action, that allows one to export something like a site-map that could be turned into a pre-flight checklist.

That is a human readable checklist for the Web-App. Things for the human tester to work through with the App in order to find glitches. This should help with pre-release testing.

Could introduce an extension for that, providing a new annotation @PreFlight(value=""Doing xxx should result in yyy ..."") to formally provide instructions on what to look out for when testing.

But before implementing such a thing we should first gather more experience doing this by hand with the Demo App."
ISIS-2882,Improvement,Closed,[Wicket Viewer] Support for generic Value-Type Conversion based on ValueSemantics,"Replace uses of Wicket built-in Converters with ones based on ValueSemantics. We identified 4 categories of value-types
# Numerical
# Temporal (Date and Time)
# String based
# Composite (planned for RC1)"
ISIS-2881,Bug,Closed,Scale for BigDecimal property is not picked up in JPA version,"When using JPA the scale of BigDecimal is not being picked up.

See attachments for difference JDO 1) and JPA 2)

links:

1) https://github.com/johandoornenbal/isis-app-helloworld/blob/jdo-SNAPSHOT/src/main/java/domainapp/modules/hello/dom/hwo/HelloWorldObject.java#L75

2) https://github.com/johandoornenbal/isis-app-helloworld/blob/jpa-SNAPSHOT/src/main/java/domainapp/modules/hello/dom/hwo/HelloWorldObject.java#L76"
ISIS-2880,Improvement,Closed,Multi line textfield should have the cursor in the field after clicking in order to start typing right away,"When clicking in notes field (multi line text) an currently extra click is required to start typing.

(See ui.gif)"
ISIS-2879,Bug,Closed,"Multiline textfield can be 'edited' but data not persisted without edit mode being active (chrome, firefox)",See UI.gif attached
ISIS-2878,Task,Closed,[kroviz] Package Client into demo/domain,analogous to https://github.com/rjaros/kvision-examples/tree/master/template-fullstack-ktor
ISIS-2877,Epic,Resolved,Support for Value Type Composition,"It should be sufficient to specify a value-type say CalendarEvent to be a compound of already existing value-types (date, time, duration, title, notes) = base-types, without the need of further integration with the UI.

Given all the required information via a ValueSemanticsProvider, the framework should be smart enough to handle:
* property update dialogs (optional -  for that to work, we might just require an update action that takes all required base-types as arguments)
* action dialogs (eg. just embed the base-types)
* table columns (eg. just embed the base-types, or as an alternative use value semantics 'rendering')

"
ISIS-2876,Bug,Closed,DomainModelValidator validation fails on IsisModuleSubdomainsExcelApplib,"When assertValid is called on the class DomainModelValidator and one has included the module IsisModuleSubdomainsExcelApplib, then the following error is raised:

Collection action parameter found without supporting choices or autoComplete facet. Class: org.apache.isis.subdomains.excel.applib.dom.WorksheetSpec$Sequencer action: sequence parameter 0

 

Hence the Excel module should adhere to the (changed) validation rules."
ISIS-2875,Bug,Closed,ArchitectureJdoRules should check only root identities,every_jdo_PersistenceCapable_with_DATASTORE_identityType_must_be_annotated_as_DataStoreIdentity should only verify root entities
ISIS-2874,Improvement,Open,update the README for simpleapp and perhaps helloworld (m6 and later),"looks to be out of date... the jpa version of the README mentions enhance-all.sh; there's also mention of lockdown tests, which were removed.

 

also:

- delete SimpleObject#others.columnOrder.txt"
ISIS-2873,New Feature,Open,petclinic tutorial  (documentation),"convert over gitlab.com/danhaywood/isis-petclinic-tutorial-docs, also use isis-app-demo as the companion repo."
ISIS-2872,Dependency upgrade,Closed,[kroviz] Upgrade Kotlin/KVision Dependencies,
ISIS-2871,Improvement,Closed,Value Types need Semantics on a per Member/Param Basis,"One a per member basis we would like to support customization like eg
* ScientificNumberFormatValueSemantics: 1.2345 x 10^9
* ZonedDateTimeValueSemantics: 02/01/2018 - 13:45:30 UTC
* IconValueSemantics: eg yields images of size 48x48"
ISIS-2870,Bug,Closed,"[Regression] Various UI glitches - temporal values, ...","date picker no longer appears for temporal values;
...
"
ISIS-2869,Improvement,Closed,[Demo] Add CalenderEvent,Bring the fullcalendar extension back to live.
ISIS-2868,Improvement,Open,archtest jpa - @DiscriminatorValue and logicalTypeName,https://vladmihalcea.com/the-best-way-to-map-the-discriminatorcolumn-with-jpa-and-hibernate/
ISIS-2867,Improvement,Closed,Further archtest rules,
ISIS-2866,Improvement,Closed,Ensure @MemberSupport for all framework-provided members,
ISIS-2865,Bug,Closed,[Regression] Menu links to Swagger and RO don't honor context path (URL),"When using a context path for the web-app, some local resource links are broken."
ISIS-2864,Bug,Closed,[Demo] Unreferenced Java Sources (Adoc),"Seems non of the Java source examples can be successfully referenced.
 
 {{Unresolved directive in <stdin> - include::MixinVm.java[tags=class]}}"
ISIS-2863,Improvement,Closed,Remove DN5 suffix from maven artifact names,We migrated to DN6 already.
ISIS-2862,Improvement,Closed,Remove WizardFacet,WizardFacet is not used.
ISIS-2861,Improvement,Closed,Remove ViewModel.Cloneable,"ancient stuff, no longer required"
ISIS-2860,Bug,Closed,[NOT A BUG] Entities not Picked Up During Application Start,"Under certain - yet to be identified - circumstances, EntityBeans are not being picked up.

https://the-asf.slack.com/archives/CFC42LWBV/p1630071333010500

https://github.com/joerg-rade/domox/blob/master/domox-domain/src/main/java/domox/dom/nlp/Relation.java
https://github.com/joerg-rade/domox/blob/master/domox-domain/src/main/java/domox/SimpleModule.java "
ISIS-2859,Task,Closed,2.0.0-M7 release activities,
ISIS-2858,Improvement,Open,AbstractUserAndRoleScript and similar should inject into suppliers.,"Or alternatively, rather than pass into the constructor, could provide hook methods to return the values?"
ISIS-2857,Improvement,Closed,Bump Datanucleus from 5.x to 6.x,In support of Java 16+.
ISIS-2856,Improvement,Closed,Remove Deprecations marked as such till 2.0.0-M6,Eg. there are several in applib's annotations.
ISIS-2855,Bug,Closed,Wicket Viewer fails to render singleton (scalar) Values like Strings,"Eg. seen when rendering an action result like List.of(""Sample String"")."
ISIS-2854,Bug,Closed,Secman's UserMementoRefinerForApplicationUser introduces circular dependency,"|isis.runtimeservices.RepositoryServiceDefault|
|+|
|isis.runtimeservices.FactoryServiceDefault (field org.apache.isis.applib.services.iactnlayer.InteractionService org.apache.isis.core.runtimeservices.factory.FactoryServiceDefault.interactionServi
 ce)|
|+ |
|isis.runtimeservices.InteractionServiceDefault (field org.apache.isis.core.security.authentication.manager.AuthenticationManager org.apache.isis.core.runtimeservices.session.InteractionServiceDef
 ault.authenticationManager)|
|+ |
|isis.security.AuthenticationManager|
|+ |
|org.apache.isis.extensions.secman.integration.usermementorefiner.UserMementoRefinerFromApplicationUser|
|+ |
|isis.ext.secman.ApplicationUserRepository (field private org.apache.isis.applib.services.repository.RepositoryService org.apache.isis.extensions.secman.applib.user.dom.ApplicationUserRepositoryAb
 stract.repository)|

 "
ISIS-2853,Improvement,Closed,Cover all RO Viewer Endpoints with Debug Logging,All @Path resources should allow to log what the request was and what response is being produced.
ISIS-2852,Improvement,Closed,AuthorizorSecman: Permission Caching per Interaction ,Speed up permission lookup.
ISIS-2851,Sub-task,Open,Basic Types / Bytes,
ISIS-2850,Improvement,Closed,Remove uses of deprectated SecMan config beans,Also provide more detailed deprecated java-doc info.
ISIS-2849,Improvement,Closed,Bump Spring Boot from 2.5.3 to 2.5.4,Also fix dependency convergence issues.
ISIS-2848,Wish,Open,"[Wish] Allow local mixins to be wrapped more ""intuitively""","(This is a nice-to-have, but could avoid confusion etc).

If we use the local class mixin idiom:
{code:java}
public class Customer {
    @Action
    public class placeOrder {
        public Order act(...) { ... }
    }
}{code}
then to invoke using `WrapperFactory` in an integ test we have to use:
{code:java}
 wrapMixin(Customer.placeOrder.class, customer).act(...){code}
but it would be more intuitive to use:
{code:java}
wrap(customer).new placeOrder().act(...) {code}"
ISIS-2847,Improvement,Closed,Improve secman's AbstractUsersAndRole so that it is an upsert rather than a simple insert-if-not-present.,This makes it easier for the secman-provided security superuser to then be refined as the application-level superuser also.
ISIS-2846,Bug,Closed,Layout Information Missing in RO Viewer,"Found in 2.0.0-M6 RC1

I suspect some of the commits for https://issues.apache.org/jira/browse/ISIS-2787 have a side effect on the RO viewer, that 'break' kroviz.
The first version showing the defect is apacheisis/demo-wicket-jdo:2.0.0-M5.20210707-0226-46cb701c - the version from the day before works as expected.
Some layout information is missing, that is required at least for rendering columns in parented collections.

"
ISIS-2845,Bug,Closed,Reinstate automatic injection into entities when resolved.,"see attached class.

One issue is that we no longer provide access to the current `InteractionLayer` from a static context ... `InteractionService` holds this and normally can just be injected.  As DN is instantiating the class, we don't get the chance to inject into it.  We'll therefore need to expose `InteractionService` as a singleton (yuk, but there's no other way).

We then need to change `LocalPersistenceManagerFactory` to always set the DN property:

!image-2021-08-18-17-29-54-495.png|width=962,height=95!

somewhere about here:

!image-2021-08-18-17-28-16-816.png|width=685,height=515!"
ISIS-2844,Improvement,Open,"With Secman, SudoService behaves differently from impersonation - should be consistent.","I think that permissions should always be taken from the usermemento.  For the three use cases:
 * impersonation (as already is case): we use the roles specified on the usermemento
 * sudo service (new code): we instead use the roles  specified on the usermemento
 * no sudoservice, no impersonation : we obtain the roles from the usermemento, which would have been copied from the ApplicationUser on login.

In terms of code, I think we just remove the check for userService.isImpersonating() below and always run the first branch, ie query `byUserMemento(...)`.  The `byUser(...)` method is probably therefore redundant and could be removed.  See code snippet below.

In terms of change to the user experience, because a `UserMemento` is immutable and is only populated on login from the `ApplicationUser`, and that it contains the roles, then the user will need to logout and login if they are added to any new roles while logged in.  I think this is acceptable.

!image-2021-08-18-16-24-04-978.png|width=879,height=376!"
ISIS-2843,Improvement,Closed,Remove mavendeps 'integtests' and 'unittests'.,follow up on https://issues.apache.org/jira/browse/ISIS-2836
ISIS-2842,Wish,Open,[Wish] Improve Swagger UI to allow credentials to be specified,
ISIS-2841,Improvement,Closed,Fix module path issues to allow javadoc plugin to be reinstated,"Performing the apache-release deploy in JDK16 results in the javadoc plugin failing with issues related to the module path.

For details, see this conversation: [https://the-asf.slack.com/archives/CFC42LWBV/p1629034332031200]

Hopefully the fix is to update from javaee-api 8:0 to jakarta ee 8.0 (see commit `5be630aeb2cf82d34abb0eb380b8bf49674edb8f` for a first cut on this, aborted), and then also author the module-info.java classes for each (maven) module."
ISIS-2840,Sub-task,Open,Featured / Where In The World,
ISIS-2839,Sub-task,In Progress,More Types / Blobs,
ISIS-2838,Sub-task,Closed,Basic Types / Strings,
ISIS-2837,Improvement,Open,[kroviz] Execute Integration Tests against Docker Image (Demo),"Currently kroviz integration tests simply check, if an application is available at localhost:8080.
If the app is not available, tests are skipped.

Ensure a docker image is running at this address, skip the check and always execute tests
c.f. https://info.michael-simons.eu/2016/08/25/integration-testing-with-docker-and-maven/"
ISIS-2836,Improvement,Closed,"Remove the unnecessary mavendeps, cleanup uses of JDK11+support","The mavendeps for archtests, integspecs, integtests, jdo, jpa and unittests all do very little, and the jdk11 mavendep also is pretty much redundant.

For those where there is just one dependency, simply remove.

For those which aggregate multiple dependencies, suggest make those additoinal libraries (eg fakedata, fixtures) as dependencies of the main library ... can always be excluded by the end-user if required.

 "
ISIS-2835,Bug,Closed,"JpaPropertyPublishingTest succeeds in isolation, fails when run in sequence to other tests",Either the test code is incorrect or this reveals a bug with the framework.
ISIS-2834,Bug,Closed,Pending Parameters Model is not capturing values of type LocalDateTime,"Given an Action with Parameters, one with LocalDateTime is not captured by the parameter negotiation process. That is, the framework does not keep track of the already negotiated parameter.

While LocalDateTime action parameters seems to work when submitting a form (action dialog), these don't work with parameter negotiation model (pending parameters). 

org.apache.isis.viewer.wicket.ui.components.scalars.ScalarPanelAbstract.ScalarUpdatingBehavior.onUpdate(AjaxRequestTarget) is never called.
"
ISIS-2833,Bug,Closed,@Title throws NPE.,
ISIS-2832,Improvement,Open,Add Docs for @Property(entityChangePublishing=...),as a follow up on https://issues.apache.org/jira/browse/ISIS-2490
ISIS-2831,Improvement,Closed,WicketViewer/ScalarPanelTextField: page scrolls to the top on editing a field,"https://stackoverflow.com/questions/1255726/href-dont-scroll/11746912

as of template org.apache.isis.viewer.wicket.ui.components.scalars.ScalarPanelTextFieldAbstract.html"
ISIS-2830,Bug,Closed,Wicket Viewer: ScalarPropertyModel.getManagedProperty() caching is too agressive,might cause NPE
ISIS-2829,Improvement,Closed,Cannot run WicketViewer on JVM 17,"At least not out of the box.
For stacktrace see comment."
ISIS-2828,Bug,Closed,ExecutionParametersDefault: asKeyValueMap(...) assumes newline to be '\n',"We should rather do generic line parsing, that is not sensitive to the actual newline characters used."
ISIS-2827,Improvement,Closed,Wicket Blob/Clob: filename is rendered twice in table cells,remove the cell label and also the compact component's file-name label
ISIS-2826,Improvement,Closed,Implement Lightweight Property Change Tracking for JPA,"- publish property changes on the fly during PrePersist, PreUpdate and PreRemove
- remove support for JPA Entity Changes Tracking"
ISIS-2825,Improvement,Closed,LinkAndLabelFactoryAbstract: remove 'Wicket Hack',"This is a follow up on ISIS-2253, to address the 'Wicket Hack'."
ISIS-2824,Bug,Closed,Ensure ImpersonatedUserHolder can be accessed during initial fixtures,"The ImpersonatedUserHolderForWicket implementation introduced for keycloak ticket recently is superfluous (the existing ImpersonatedUserHolderForHttpSession works fine, I believe) but in any case the UserService that iterates over all of the available should be fault-tolerant to any of the impl's throwing an exception.

This currently happens if a fixture script called during initialization uses secman which results in a call to obtain the current user... there is no Wicket session and so the fixture scripts fail to run."
ISIS-2822,Bug,Open,Wrapper: async executions must run within their own exclusive transaction,"Ideally to be enforced by running on a different (isolated) thread. 
Yet we are using the fork-join common pool, which provides no such guarantee.

Currently an async execution might eventually run on the same thread as the caller, and hence participate in the same transaction as the caller. The framework must prevent this from happening."
ISIS-2821,Wish,Open,[Wish] Arch tests to verify uniqueness constraints (and other ideas)," For JDO, the members of a @Unique or Index should match the name of a field.

For JPA, the column names of a uniqueness constaint or index should match the explicit name of a @Column or else the inferred name from the member.

 every DomainObject must be annotated editing=DISABLED

every DomainObject must be annotated either with bounded or with an autoCompleteRepository, and the autoCompleteMethod must exist in that repository.

every DomainObject that is annotated with an autoCompleteRepository, the autoCompleteMethod (explicit or implicit name) must exist in that repository, and the class must be a @Repository.

every JDO/JPA entity that is a subtype of an entity must NOT have an id declared.

every abstract JDO/JPA entity should have only protected constructors (do not need to be no-arg)

every domain services must use constructor injection only, no @Inject'd fields.  (Use Provider<X> to break cycles).

every domain service must be annotated with @RequiredArgsConstructor (as preferred way of avoiding boilerplate)

every JDO/JPA entity with a field reference to another entity should specify the column name, eg:

    @javax.jdo.annotations.Column(allowsNull = ""false"", name = ""countryId"")
    private Country country;

every jdo/jpa entity should implement comparable of itself

 "
ISIS-2820,Improvement,Closed,Additional arch tests for entities etc.,"FIXES:

every_jdo_PersistenceCapable_must_be_annotated_with_Version ... should not apply if this is a subtype of an entity.

 

 

~~~~~~~~ 

Every mixin class annotated with @Action, @Collection or @Property must have a 1-arg constructor.

Every mixin class annotated with @Action, @Collection or @Property must follow a naming convention of Xxx_yyy or Xxx$yyy where Xxx is the simple name of the constructor parameter.

Every mixin class should have primary method matching the name in its @Action or @Collection or @Property methodName attrib.

 

Finder methods in `Repository` should return either a `List<.>` or an `Optional<.>`.

For jaxb view model, any `@Inject`ed fields should be marked as `@XmlTransient`

For serializable view model, any `@Inject`ed fields should be marked as `transient` keyword.

 

JDO entity must be annotated with @Version.

JDO must have @PersistenceCapable#schema

JDO entity if datastore identity must have @DatastoreIdentity

JPA entity must have Table#schema

JPA entity enums should be annotated with EnumType.STRING.

JPA entity should have id field annotated with @Id.

JPA entity should have version field annotated with @Version.

JDO entity, any `@Inject`ed fields should be marked as `@NonPersistent`

JPA entity, any `@Inject`ed fields should be marked as `@Transient`

JDO entity should have protected no-arg constructors, to force use of factory methods.

JPA entity should have protected no-arg constructors, to force use of factory methods. 

Every class annotated with @Repository must have be named XxxRepository (and vice versa)

Every class annotated with @Controller must have be named XxxController (and vice versa) 

 

 

 

 

 

 "
ISIS-2819,Improvement,Closed,"Extend base subdomain's convenience annotations, provide JDO applib variants",
ISIS-2818,Improvement,Closed,Add overrides for XxxDomainEvent for hide/disable/invalidate to evaluate a supplier,"Rather than:
{code:java}
if (hubCurrentService.currentHub().isEmpty()) {
  ev.hide();
} {code}
I'd prefer to write:
{code:java}
ev.hideIf(hubCurrentService.currentHub().isEmpty());{code}
or more flexibly:
{code:java}
ev.hideIf(() -> hubCurrentService.currentHub().isEmpty()); {code}
 "
ISIS-2817,Improvement,Closed,Module 'Apache Isis Core - Schemas' cannot build with JDK-16 (or 17-ea),"Schema creation accesses 'sun.misc.Unsafe#defineClass', which is no longer available

java.security.PrivilegedActionException: java.lang.NoSuchMethodException: sun.misc.Unsafe.defineClass(java.lang.String,[B,int,int,java.lang.ClassLoader,java.security.ProtectionDomain)
"
ISIS-2816,Bug,Closed,Impersonation: eventually throws exception (in the background?),"RequestCycle is not available, when in the process of expiring the Session.

stacktrace see comment"
ISIS-2815,Bug,Closed,TableColumnOrderServiceUsingTxtFile: line parsing will eventually fail,"Issue surfaces when maven building on linux with JDK15, having a failing test that depends on resource loading via _Resources#load(...)

{code:java}
[ERROR]   TableColumnOrderServiceUsingTxtFile_Test$orderParented.happy_case:31
Expecting:
  []
to contain exactly (and in same order):
  [""orderNum"", ""orderDate"", ""orderStatus""]
but could not find the following elements:
  [""orderNum"", ""orderDate"", ""orderStatus""]
{code}
"
ISIS-2814,Bug,Closed,Tooltip doesn't appear for icons in collections,Fixed as part of ISIS-2813
ISIS-2813,New Feature,Closed,TableColumnOrderingService using files,"where the file is named ""Customer#orders.columnOrder.txt"" (for Customer#orders) and looks like:
{code:java}
orderNum
placedOn
shipTo
numItems{code}
in other words the properties of the referenced entity Order to show as columns in the Customer's orders collection.

and similarly for standalone collections of `Customer.columnOrder.txt`:
{code:java}
customerNum
lastName
status
addressPostcode{code}"
ISIS-2812,Bug,Closed,Regression: cssClassFa and cssClass not honored with menubars.layout.xml,It seem we don't create any facets here.
ISIS-2811,Bug,Closed,Regression: Fontawesome Icons are not showing up when based on prefix pattern.,Seeing this eg. with the SecMan ApplicationUserMenu.
ISIS-2810,Improvement,Closed,[is this required?] secman - introduce explicit permissions for type,"... by reworking HiddenTypeFacetDerivedFromAuthorization to be based on explicit type action.

*discussion:*

The current behaviour of the NavigationFacetDerivedFromHiddenType, which is derived from HiddenTypeFacetDerivedFromAuthorizaion (the only implementation of HiddenTypeFacet) is difficult to comprehend and might be considered too strict ... see for example this thread: [https://the-asf.slack.com/archives/CFC42LWBV/p1626757648322200?thread_ts=1626754801.321200&cid=CFC42LWBV.] 

An alternative design has been suggested for HiddenTypeFacetDerivedFromAuthorizaion that is based not on whether there are any members visible, but simply on whether the type has been explicitly hidden (or perhaps implicitly inherited from the namespace).  For more info, pick up the thread here: [https://the-asf.slack.com/archives/CFC42LWBV/p1626778227337200?thread_ts=1626754801.321200&cid=CFC42LWBV]

Perhaps a configuration flag should determine the behaviour of its facet factory easy to configure:
 * EXPLICIT_TYPE_PERMISSIONS  (this is the default)
 * DERIVED_FROM_MEMBER_PERMISSIONS (collections, properties and actions)
 * DERIVED_FROM_ASSOCIATION_PERMISSIONS (collections + properties but not actions)
 * DERIVED_FROM_PROPERTIES_PERMISSIONS
 * NONE ... effectively disable"
ISIS-2809,Improvement,Closed,HiddenTypeFacetDerivedFromAuthorization should take actions into account,"This facet currently marks a type as hidden if all of its properties or collections are hidden.  The rationale here is mostly to do with suppressing collections of that type (or actions returning that instance, or properties of that type) if the end-user has no access to that type.

However, it might be the case that there are actions that the user has access to; so it should take this into account."
ISIS-2808,Dependency upgrade,Closed,Java 11 to replace Java 8 compliance for the entire code base,"Goal: have all maven builds yield Java 11 byte-code
Non-Goal: convert to Java modules"
ISIS-2807,Improvement,Closed,Improve arch tests for subpackages to work across modules.,
ISIS-2806,Improvement,Closed,Add some overrides for SudoService / InteractionContext to switch the clock.,
ISIS-2805,Bug,Open,Lifecycle events do not fire for JDO (either),
ISIS-2804,Improvement,Closed,[WON'T DO] Remove hard-coding of the Wicket role in impersonation etc.,see also ISIS-2729
ISIS-2803,Improvement,Closed,Rewrite keycloak integration to use Spring security,
ISIS-2802,Improvement,Closed,"Change AsciiDoc and MarkDown types to convert on the fly, and rename 'Markup' to 'Html'","At the moment the `AsciiDoc` and `Markdown` value types actually persist HTML; their only knowledge of those markup formats is in their factory methods when they eagerly convert the respective markup formats into HTML.

Instead, we should persist the markup format and then convert to HTML only lazily whenever rendering.

To store raw HTML, we'll rename the existing 'Markup' type to 'Html'.

 "
ISIS-2801,Improvement,Closed,Add JPA support for Blob and Clob (multi-valued),
ISIS-2800,Bug,Closed,"reasonVetoed is null, causing NPE ","* java.lang.NullPointerException
 * Parameter/Field 'reasonVetoed' is required to be present (not null).
 * org.apache.isis.commons.internal.base._With#requiresNotEmpty(_With.java:239)
 * org.apache.isis.core.metamodel.consent.Veto#<init>(Veto.java:41)
 * org.apache.isis.core.metamodel.interactions.managed.ManagedMember#checkUsability(ManagedMember.java:184)
 * org.apache.isis.viewer.wicket.model.models.ScalarPropertyModel#whetherDisabled(ScalarPropertyModel.java:115)
 * org.apache.isis.viewer.wicket.model.models.ScalarModel#isEnabled(ScalarModel.java:251)
 * org.apache.isis.viewer.wicket.model.models.ScalarModel#canEnterEditMode(ScalarModel.java:246)
 * org.apache.isis.viewer.wicket.ui.components.scalars.ScalarPanelAbstract#buildGui(ScalarPanelAbstract.java:374)
 * org.apache.isis.viewer.wicket.ui.components.scalars.ScalarPanelAbstract#buildGuiAndCallHooks(ScalarPanelAbstract.java:268)
 * org.apache.isis.viewer.wicket.ui.components.scalars.ScalarPanelAbstract#onInitialize(ScalarPanelAbstract.java:260)
 * org.apache.wicket.Component#fireInitialize(Component.java:881)
 * org.apache.wicket.MarkupContainer$3#component(MarkupContainer.java:1050)
 * org.apache.wicket.MarkupContainer$3#component(MarkupContainer.java:1046)
 * org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:144)
 * org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
 * org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
 * org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
 * org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
 * org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
 * org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
 * org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
 * org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
 * org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
 * org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
 * org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
 * org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:123)
 * org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:192)
 * org.apache.wicket.MarkupContainer#visitChildren(MarkupContainer.java:982)
 * org.apache.wicket.MarkupContainer#internalInitialize(MarkupContainer.java:1045)
 * org.apache.wicket.MarkupContainer#addedComponent(MarkupContainer.java:1021)
 * org.apache.wicket.MarkupContainer#replace(MarkupContainer.java:860)
 * org.apache.wicket.MarkupContainer#addOrReplace(MarkupContainer.java:268)
 * org.apache.wicket.extensions.markup.html.tabs.TabbedPanel#setCurrentTab(TabbedPanel.java:438)
 * org.apache.wicket.extensions.markup.html.tabs.TabbedPanel#setSelectedTab(TabbedPanel.java:396)
 * org.apache.isis.viewer.wicket.ui.components.layout.bs3.tabs.TabGroupPanel#setSelectedTab(TabGroupPanel.java:103)
 * de.agilecoders.wicket.core.markup.html.bootstrap.tabs.AjaxBootstrapTabbedPanel$1#onClick(AjaxBootstrapTabbedPanel.java:43)
 * org.apache.wicket.ajax.markup.html.AjaxFallbackLink$1#onEvent(AjaxFallbackLink.java:93)
 * org.apache.wicket.ajax.AjaxEventBehavior#respond(AjaxEventBehavior.java:127)
 * org.apache.wicket.ajax.AbstractDefaultAjaxBehavior#onRequest(AbstractDefaultAjaxBehavior.java:631)
 * org.apache.wicket.core.request.handler.ListenerRequestHandler#internalInvoke(ListenerRequestHandler.java:306)
 * org.apache.wicket.core.request.handler.ListenerRequestHandler#invoke(ListenerRequestHandler.java:280)
 * org.apache.wicket.core.request.handler.ListenerRequestHandler#invokeListener(ListenerRequestHandler.java:222)
 * org.apache.wicket.core.request.handler.ListenerRequestHandler#respond(ListenerRequestHandler.java:208)
 * org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:907)
 * org.apache.wicket.request.RequestHandlerExecutor#execute(RequestHandlerExecutor.java:65)
 * org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:293)
 * org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:254)
 * org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:276)
 * org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:207)
 * org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:306)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:189)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:162)
 * org.apache.isis.core.webapp.modules.logonlog.IsisLogOnExceptionFilter#doFilter(IsisLogOnExceptionFilter.java:60)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:189)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:162)
 * org.apache.isis.extensions.secman.shiro.RunAuthenticatedFilter#doFilter(RunAuthenticatedFilter.java:62)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:189)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:162)
 * org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:450)
 * org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
 * org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
 * org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
 * org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:387)
 * org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
 * org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:189)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:162)
 * org.springframework.web.filter.RequestContextFilter#doFilterInternal(RequestContextFilter.java:100)
 * org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:189)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:162)
 * org.springframework.web.filter.FormContentFilter#doFilterInternal(FormContentFilter.java:93)
 * org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:189)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:162)
 * org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter#doFilterInternal(WebMvcMetricsFilter.java:93)
 * org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:189)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:162)
 * org.springframework.web.filter.CharacterEncodingFilter#doFilterInternal(CharacterEncodingFilter.java:201)
 * org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:189)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:162)
 * com.microsoft.applicationinsights.web.internal.WebRequestTrackingFilter#doFilter(WebRequestTrackingFilter.java:142)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:189)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:162)
 * org.apache.catalina.core.StandardWrapperValve#invoke(StandardWrapperValve.java:202)
 * org.apache.catalina.core.StandardContextValve#invoke(StandardContextValve.java:97)
 * org.apache.catalina.authenticator.AuthenticatorBase#invoke(AuthenticatorBase.java:542)
 * domainapp.webapp.AppManifest$1#invoke(AppManifest.java:315)
 * org.apache.catalina.core.StandardHostValve#invoke(StandardHostValve.java:143)
 * org.apache.catalina.valves.ErrorReportValve#invoke(ErrorReportValve.java:92)
 * org.apache.catalina.core.StandardEngineValve#invoke(StandardEngineValve.java:78)
 * org.apache.catalina.connector.CoyoteAdapter#service(CoyoteAdapter.java:357)
 * org.apache.coyote.http11.Http11Processor#service(Http11Processor.java:374)
 * org.apache.coyote.AbstractProcessorLight#process(AbstractProcessorLight.java:65)
 * org.apache.coyote.AbstractProtocol$ConnectionHandler#process(AbstractProtocol.java:893)
 * org.apache.tomcat.util.net.NioEndpoint$SocketProcessor#doRun(NioEndpoint.java:1707)
 * org.apache.tomcat.util.net.SocketProcessorBase#run(SocketProcessorBase.java:49)
 * java.util.concurrent.ThreadPoolExecutor#runWorker(null:-1)
 * java.util.concurrent.ThreadPoolExecutor$Worker#run(null:-1)
 * org.apache.tomcat.util.threads.TaskThread$WrappingRunnable#run(TaskThread.java:61)
 * java.lang.Thread#run(null:-1)"
ISIS-2799,Bug,Closed,JPA: Framework caches and does not re-read changed state from the database.,"to reproduce:
 * run up JPA simpleapp
 * save an object
 * using h2 console, update the name manually
 * reload the object through the UI (eg click on the title)  - the change is not picked up, ie the database is not read.

 

~~~~

It seems that we use 

the symptom seems to be that we cache EntityManager's in JpaContext, which might be ok if they are proxied thread-locals; however the underlying aren't disposed of.

We notice that EclipseLink creates a ""NoServerPlatform"", meaning that it doesn't recognise us as being in a container.

We also notice that JPA creates an LocalContainerEntityManagerFactoryBean, whereas perhaps it should create a LocalEntityManagerFactoryBean.  [https://stackoverflow.com/a/6157339/56880] 

some docs:

[https://www.eclipse.org/eclipselink/documentation/2.6/solutions/testingjpa001.htm]

[https://www.baeldung.com/jpa-hibernate-persistence-context] - we want to use ""transaction-scoped"" persistence context rather than ""extended"" ... and we are, I think.

 

 "
ISIS-2798,Bug,Closed,ObjectBulkLoader should inject dependencies into Pojos,
ISIS-2797,Wish,Open,[Wish] Reimplement login page as a view model,"copied from a TODO that was on org.apache.isis.core.security.authentication.logout.LogoutHandler:

* @since Apr 9, 2020
* TODO we are at early stages of the design, a better idea occurred:
* actually model the SignIn page as a true ViewModel similar to how we
* render the home-page; this should allow for the LogoutHandler to be called
* from the framework more directly and not from within the LogoutMenu's
* logout action, which is more complicated because, this happens within
* the context of an IsisInteraction, where we cannot simply purge the
* current session, when in the middle of an interaction"
ISIS-2796,Bug,Closed,Use base64 encoding with o.a.wicket....CookieUtils.save/load.,"Cookie values must pass RFC6265 validation, eg. whitespaces need encoding. But to be on the safe side let us use base64 encoding instead."
ISIS-2795,Documentation,Open,Update docs for namedXxx() and describedXxx feature.,"namedXxx() and describedXxx are supported now for all members (actions, properties and collections) ... but not objects nor parameters

Also update the cheat-sheet."
ISIS-2794,Bug,Closed,JPA Lifecycle events do not fire,see docs on Lifecycle Events here https://isis.apache.org/refguide/2.0.0-M5/applib-classes/events/lifecycleevent.html#section-top
ISIS-2793,Bug,Closed,Impersonation with roles doesn't work with keycloak (next interaction logs out),"as reported via slack : [https://the-asf.slack.com/archives/CFC42LWBV/p1625642789207500?thread_ts=1625548590.181200&cid=CFC42LWBV]

 "
ISIS-2792,Improvement,Closed,JPA ElSettings probably shouldn't hard code eclipselink.weaving=false,
ISIS-2791,Bug,Closed,TitleFacetViaMethodsFactory needs to unconditionally remove toString method from action candidates,otherwise toString might get interpreted as action
ISIS-2790,Improvement,Closed,Allow the Wicket viewer's Password reset feature email to support xxx+yyy@  format for emails.,"as per [https://the-asf.slack.com/archives/CFC42LWBV/p1625408544170000]

 

Could the regex in EmailAddressValidator be changed to {{^[_A-Za-z0-9-][_A-Za-z0-9-+]+(\.[_A-Za-z0-9-+]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9-]+)*((\.[A-Za-z]\{2,})\{1}$)}} to allow a ‘+’ in the middle of the part before the ‘@’ ? This would allow the Google email alias convenience of {{martin+}}{{[zedify.co.uk|http://zedify.co.uk/]}} for example.

 "
ISIS-2789,New Feature,Closed,Implement EntityChangePublisher for JPA,
ISIS-2788,Bug,Closed,"XRay interferes with auditing, as it causes the pending changes to be drained/discarded.","see stack trace:

!image-2021-07-02-15-16-34-035.png|width=749,height=565!"
ISIS-2787,Bug,Closed,Names cannot be overridden in menubars.layout.xml,"for example:
{code:java}
<mb3:serviceAction objectType=""simple.SimpleMenu"" id=""createSimpleObject"">
    <mb3:named>Create</mb3:named>
</mb3:serviceAction>{code}
is rendered as ""Create Simple Object"" rather than just ""Create"""
ISIS-2786,Bug,Closed,[NOT A PROBLEM] A tabgroup with tab that contains multiple fieldsets does not surround them correctly (UI cosmetics only),"This makes for an odd experience when tabbing; the second fieldset on the tab (that doesn't look like it is part of the tab) disappears.

I wonder if this is just a mistake in the BS4 migration, or whether the change made quite recently to remove the ""col"" CSS style caused this issue?"
ISIS-2785,Bug,Closed,"Title tooltip shows the base class, rather than concrete","UPDATE (9th July):

after Andi's first set of changes, Client at least works:

!image-2021-07-09-06-12-11-547.png|width=115,height=138!

However other entities  still show ""Base Entity"":

!image-2021-07-09-06-13-12-043.png|width=161,height=137!

for the Instruction class which would seem to have the same inheritance hierarchy as Client.  Very odd ! 
{code:java}
public class Instruction extends BaseEntityAudit implements Comparable<Instruction> { {code}
 

In addition (this might be a different issue), we don't seem to have a tooltip for the icon to navigate to an object in a table:

!image-2021-07-09-06-17-19-558.png|width=132,height=139!

__________________________________________________________________________

 

for example:

!image-2021-07-02-12-48-02-412.png|width=138,height=149!

The ""Base Entity"" should instead say ""Client.

where 
{code:java}
@MappedSuperclass
public abstract class BaseEntity  { ... } {code}
and:
{code:java}
@MappedSuperclass
public abstract class BaseEntityAudit extends BaseEntity { .. } {code}
and:
{code:java}
@javax.persistence.Entity
@DomainObject(...)
...
public class Client extends BaseEntityAudit implements Comparable<Client> { ... } {code}
 

 "
ISIS-2784,Bug,Closed,fix implementation of FixtureScript#wrapMixin ,not correct to use wrap(mixin(...)) any more.
ISIS-2783,Dependency upgrade,Closed,Bump resteasy-spring-boot-starter from 4.8.0.Final to 4.8.1.Final,"Some subtlety with header parsing, which breaks RepresentationType parsing when upgrading. "
ISIS-2782,New Feature,Closed,"[Duplicate] Add config properties to require explicit @Property, @Collection and @MemberSupport.  (isis.applib.annotation.property.explicit etc)","TO UPDATE: we are now thinking to simplify this to two uptions (As per [https://the-asf.slack.com/archives/CFC42LWBV/p1625209487155700?thread_ts=1624911448.097500&cid=CFC42LWBV):]
 # annotations all explicit: the rigorous and strict recommended way, with the benefit of supporting non-public members and member supporters
 # annotations all optional: only supporting public members and member supporters, and also less rigorous MM validation

 

We already have this for actions ([https://apache-isis-committers.github.io/isis-nightly/refguide/latest/config/sections/isis.applib.html#isis.applib.annotation.action.explicit] ). 

This is for symmetry, but also to work with ISIS-2774 or two which is to be able to read direct from fields and support non-public supporting mehods; all of this would allow us to reduce boilerplate still further, and remove the use for @Programmatic if explicit=true for all of actions, properties and collections and supporting methods.
 * isis.applib.annotation.action.explicit=true|false
 * isis.applib.annotation.property.explicit=true|false
 * isis.applib.annotation.collection.explicit=true|false
 * isis.applib.annotation.memberSupport.explicit=true|false

and also one for all, with the ability go ignore selected packages (eg if 3rd party)
 * isis.applib.annotation.all.explicit=true|false
 * isis.applib.annotation.all.explicitExceptions=com.foo,com.bar

 

See also discussion: [https://the-asf.slack.com/archives/CFC42LWBV/p1625205578149000?thread_ts=1624911448.097500&cid=CFC42LWBV]"
ISIS-2781,New Feature,Closed,Add library of architecture tests.,
ISIS-2780,Bug,Closed,Regression: IllegalArgumentException with Wrapper using Mixin,"wrapMixin(mixinClass, client).act(""xx"", ""17:00"");

at org.apache.isis.commons.internal.exceptions._Exceptions.illegalState(_Exceptions.java:87)
	at org.apache.isis.core.runtimeservices.wrapper.handlers.DomainObjectInvocationHandler.invoke(DomainObjectInvocationHandler.java:245)"
ISIS-2779,New Feature,Closed,Support JVM serialization as a way to mementos of view models that implement java.io.Serializable.,"This is building blocks for being able to display UserMemento , which is immutable but we want as a recreatable view model.  As it happens to implement Serializable, we can let the JVM do the heavy lifting."
ISIS-2778,Bug,Closed,Action returning an unchanged view model does not re-inject domain services into local mixins...,"... which then results in NPEs.

The workaround is to annotate the action with `@ActionLayout(redirectPolicy=EVEN_IF_SAME)`"
ISIS-2777,Improvement,Closed,Extend AbstractUserAndRoleFixtureScript to allow username and roles to be supplied lazily.,"The rationale here is that the subclass is obligated to provide the username and rolenames in the constructor, ie prior to dependency injection.

In particular, this means that the SecmanConfiguration bean cannot be queried to find the configured name of the super user username / rolename."
ISIS-2776,Bug,Closed,@Parameter(regex=...) does not allow for parameter to also be optional.,"In other words, if null is provided then the regex fails.  It should just ignore.

This shows up as a problem for the simple case, eg:

`@Parameter(regex=..., optionality=OPTIONAL)`

it also shows up in the case of a chained meta-annotation:
{code:java}
@Parameter(regex=..., optionality=MANDATORY)
public @interface Reference {}{code}
and
{code:java}
@Parameter(optionality=OPTIONAL)
@Reference
public @interface VatCode {} {code}
where we want parameters annotated with `@VatCode` to be optional, overriding the inherited mandatory from `@Reference`.

 "
ISIS-2775,Improvement,Closed,Allow mixin actions to be declared on domain services.,"The main use case is to enable local mixin classes, ie grouping the supporting methods in a nested non-static inner class."
ISIS-2774,Improvement,Closed,"Allow members (and their supporting methods) to have non-public visibility.  Allow properties/collections to have no getters & setters, or non-public getters and setters.","See also ISIS-2782, which is closely related.  And discussion at https://the-asf.slack.com/archives/CFC42LWBV/p1625205578149000?thread_ts=1624911448.097500&cid=CFC42LWBV

 

~~~~~~

Rationale here is: encapsulation, ""tell not ask"".

Thus:
 * Our definition of a property or collection should be _either_ with a publicly available getter or setter, or a field annotated with @Property or @Collection.
 * Our definition of an action should be _either_ a publicly available method (if explicit actions config property not set), _or_ a method with any visibility and annotated with @Action.
 * Our definition of a supporting method is either one with public visibility or with some other visibility but annotated with @MemberSupport.

See this blog [https://thorben-janssen.com/access-strategies-in-jpa-and-hibernate/] for reasons as to why field-level annotations are also recommended for ORMs (JPA in this case)."
ISIS-2773,Improvement,Closed,Extend FixtureScript API to allow checking of optional params,"refactor this hack:
{code:java}
public class FixtureScript {
  ...
  protected <T> void optionalParam(
    final String parameterName, final ExecutionContext ec, final Class<T> cls) {
    try {
        checkParam(parameterName, ec, cls);
    } catch (IllegalArgumentException e) {
        // Do nothing
    }
  }
}
 {code}"
ISIS-2772,Improvement,Closed,Extend ApplicationFeatureId's API to create from LogicalType,
ISIS-2771,Improvement,Closed,Remove Object_stopImpersonating mixin,"as it is difficult to know how to grant permissions to this action such that once impersonating, the user will have access to it.

compare to the stopImpersonating action on the ImpersonateStopMenu, which is well-defined and easy to grant access to."
ISIS-2770,Improvement,Closed,Tabbing onto a date field doesn't show the date picker.  ,"Current tabbing behavior: Temporal text input field is focused. Hitting ENTER closes the dialog with OK, which seems convenient for me. So we need some key binding maybe other than ENTER to show the date-picker."
ISIS-2769,Improvement,Closed,Remove execPrereq and addPrereq from BuilderScriptAbstract,"The genericisation that we have is broken (I think it got simplified a little too much) but working without it (passing personas through to personas rather than domain objects) is no more difficult and is more obvious code to understand.

So I think we should just lose this part of the API."
ISIS-2768,New Feature,Closed,[RO] Make Application Logo Available via REST,"Currently the application logo / icon is not available via REST.

The RO spec is silent on this matter, so an Isis extension would be required.  

C.F. https://the-asf.slack.com/archives/CFC42LWBV/p1624630090071000"
ISIS-2767,Improvement,Closed,secman m:n link table for ApplicationUser/ApplicationRole is in default schema,"for JPA...

should be in same schema as ApplicationUser table etc; and is picking up default name also (called ApplicationRole_AppicationUser, so perhaps detail on the wrong side?)"
ISIS-2766,Improvement,Closed,Make ObjectIcon(s) available via ManagedObject(s) directly.,Consequently move the ObjectIconService to the MM. Which becomes an internal service.
ISIS-2765,Bug,Closed,[CANNOT REPRODUCE] Method ModuleWithFixtures.getTeardownFixture not executed after failed test ,"When an integration test fails the method ModuleWithFixtures.getTeardownFixture is not executed. As a result added entities to the H2 DB are not deleted. This can and has caused errors in other integration tests that are run later in the flow and depend on overlapping data.

IMHO the teardown should always run to make sure the other tests can continue in a consistent state."
ISIS-2764,Improvement,Closed,stopImpersonating should always be available (under isis.applib),"We obviously want to restrict access to impersonation, but once impersonating we should be able to stopImpersonating without any special permissions."
ISIS-2763,Bug,Closed,JPA ApplicationUser / ApplicationRole should not use CascadeType.ALL,"This can result in cascading the deletion of other ApplicationUsers.  

[https://vladmihalcea.com/the-best-way-to-use-the-manytomany-annotation-with-jpa-and-hibernate/] 

[https://thorben-janssen.com/avoid-cascadetype-delete-many-assocations/]

 "
ISIS-2762,Improvement,Closed,Allow HomePageResolverService to be substituted out.,
ISIS-2761,Bug,Closed,Invoking link for rel object-icon results in HTTP 404,"Invoking: 
{code}
http://localhost:8080/restful/objects/demo.WhereInTheWorldMenu/1/actions/whereInTheWorld/invoke?address=Malvern,%20UK&zoom=14
{code}

gives:  [^WhereInTheWorldMenu_1_actions.json] 

This contains at link #4:
{code}
{
    ""rel"" : ""urn:org.apache.isis.restfulobjects:rels/object-icon"",
    ""href"" : ""http://localhost:8080/restful/objects/demo.CustomUiVm/PADw_eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04IiBzdGFuZGFsb25lPSJ5ZXMiPz4KPGRlbW8uQ3VzdG9tVWlWbT4KICAgIDxhZGRyZXNzPk1hbHZlcm4sIFVLPC9hZGRyZXNzPgogICAgPGxhdGl0dWRlPjUyLjE5ODk0NDwvbGF0aXR1ZGU-CiAgICA8bG9uZ2l0dWRlPi0yLjI0MjY1NzEwNzkxMzA4ODY8L2xvbmdpdHVkZT4KICAgIDx6b29tPjE0PC96b29tPgo8L2RlbW8uQ3VzdG9tVWlWbT4K/image"",
    ""method"" : ""GET"",
    ""type"" : ""image/png""
  }
{code}

Invoking the href results in:

{code}
No webpage was found for the web address: 

http://localhost:8080/restful/objects/demo.CustomUiVm/PADw_eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04IiBzdGFuZGFsb25lPSJ5ZXMiPz4KPGRlbW8uQ3VzdG9tVWlWbT4KICAgIDxhZGRyZXNzPk1hbHZlcm4sIFVLPC9hZGRyZXNzPgogICAgPGxhdGl0dWRlPjUyLjE5ODk0NDwvbGF0aXR1ZGU-CiAgICA8bG9uZ2l0dWRlPi0yLjI0MjY1NzEwNzkxMzA4ODY8L2xvbmdpdHVkZT4KICAgIDx6b29tPjE0PC96b29tPgo8L2RlbW8uQ3VzdG9tVWlWbT4K/image

HTTP ERROR 404
{code}"
ISIS-2760,Improvement,Closed,"Wicket/BS-Grid: remove css class ""col"" from container div","Martin Willitts:
[org.apache.isis.viewer.wicket.ui.components.layout.bs3.col.Col]
I think ‘col’ is spuriously added to the css for col div. It adds more spacing (which I’m trying to reduce for mobile use). The Bootstrap documentation suggests that the col-xx-x is sufficient without an additional ‘col’.

"
ISIS-2759,Improvement,Open,"[JUnit] Either validate or ignore public helper methods in mixin superclass ... (was resulting in mixin not rendering, even though was in metamodel)","was resulting in mixin not rendering, even though was in metamodel

for example:
{code:java}
 @RequiredArgsConstructor
public abstract class UpdateTimeWindow {
  private final BaseEntity baseEntity;

  public abstract TimeWindow getTimeWindow();  // <<<<<<<<<<< PROBLEMATIC...
  public abstract void initTimeWindow();       // <<<<<<<<<<<

  public BaseEntity act(String startTime, String endTime) {
    if (getTimeWindow() == null) {
      initTimeWindow();
    }
    getTimeWindow().setValue(startTime, endTime);
    return baseEntity;
  }
{code}
and then:
{code:java}
public class UpdateAdvanceDeliveryTimeWindow extends UpdateTimeWindow {
    public UpdateAdvanceDeliveryTimeWindow() {
        super(Client.this);
    }
    public BaseEntity act(String startTime, String endTime) { return super.act(startTime, endTime); }
    public TimeWindow getTimeWindow() {
        return Client.this.getAdvanceDeliveryTimeWindow();
    }
    public void initTimeWindow() {
        advanceDeliveryTimeWindow = new TimeWindow();
    }
}
 {code}
where `TimeWindow` is an embedded entity.

UPDATE:

Even making these supporting methods protected didn't seem to do the job...

 "
ISIS-2758,Bug,Closed,Initial fixture scripts can fail to load due to JSF not present exception.,"stack trace due to: ExceptionInInitializerError 

""java.util.MissingResourceException: Can't find javax.faces.LogStrings bundle from""

where call to currentUserName() brings in ImpersonatedUserHolder and ultimately its proxy results in going down a code path to attempt to bring in JSF:
{code:java}
public abstract class RequestContextHolder {
   private static final boolean jsfPresent =    
       ClassUtils.isPresent(""javax.faces.context.FacesContext"",
                            RequestContextHolder.class.getClassLoader());
  {code}
this class is part of 
{code:java}
<dependency>
    <groupId>javax</groupId>
    <artifactId>javaee-api</artifactId>
</dependency>
  {code}
referenced by both isis-commons and isis-applib.

*UPDATE:*

first attempt to solve this was to exclude the JSF classes.  However, as they are part of the overall javaee-api jar file (for JavaEE v8), this is suprisingly difficult to do ... that is not a simple aggregator of the respective specs in the JavaEE.  And that approach increases the maintenance effort.

And in any case, it just moved the exception but didn't completely resolve it ... the exception was being thrown in a static initializer of a proxy for `ImpersonatedUserHolderWithSession`, as this latter class is annotated as `@RequestScoped` but was called outside of an http request.

The fix I've used is to remove that annotation and instead to use RequestContextHolder that can check if there's a thread-local that contains an HttpRequest.  This allows us to keep the dependency on javaee-api."
ISIS-2757,New Feature,Closed,ServiceRegistry.lookupService should honour @Primary as earlier than any @Priority,"refinement of ISIS-2750

InstanceByPriorityComparator"
ISIS-2756,New Feature,Closed,Unit test support fixes (docs and impl),"* SoapEndpointPublishingRule *is* a junit4 rule, factor out the useful logic
 * AbstractBeanPropertiesTest depends on junit4 mock rule
 * reorganize packages
 * docs"
ISIS-2755,Improvement,Closed,add @Priority to alll menu @DomainService's,
ISIS-2754,New Feature,Closed,Use @AliasFor to declare Spring's @Named from @DomainService(logicalTypeName),"attempted this, using:
{code:java}
public @interface DomainService {

    // ...
    @AliasFor(annotation = Named.class, attribute = ""value"")
    String logicalTypeName() default """";

} {code}
however it results in:
{code:java}
Caused by: org.springframework.core.annotation.AnnotationConfigurationException: @AliasFor declaration on attribute 'logicalTypeName' in annotation [org.apache.isis.applib.annotation.DomainService] declares an alias for attribute 'value' in annotation [javax.inject.Named] which is not meta-present. 
at org.springframework.core.annotation.AnnotationTypeMapping.validateAllAliasesClaimed(AnnotationTypeMapping.java:372) 
at org.springframework.core.annotation.AnnotationTypeMapping.afterAllMappingsSet(AnnotationTypeMapping.java:359) 
at java.base/java.util.ArrayList.forEach(ArrayList.java:1541) 
at org.springframework.core.annotation.AnnotationTypeMappings.<init>(AnnotationTypeMappings.java:69) 
at org.springframework.core.annotation.AnnotationTypeMappings.<init>(AnnotationTypeMappings.java:46) 
at org.springframework.core.annotation.AnnotationTypeMappings$Cache.createMappings(AnnotationTypeMappings.java:245) 
at java.base/java.util.concurrent.ConcurrentMap.computeIfAbsent(ConcurrentMap.java:330) {code}
that means we need to add @Named to @DomainService

 "
ISIS-2753,Improvement,Closed,"to avoid explicit casting, make AbstractDomainEvent#getSubject() return <T> T","... rather than Object.

This will save the application having to perform an explicit case; the java compiler will put in the cast for us."
ISIS-2752,New Feature,Open,Extend MetaModelService to lookup custom annotations from an Identifier,
ISIS-2751,Bug,Closed,"ModuleFixtureService#modules() needs to be well-defined, to walk the graph correctly ...",... when setting up/tearing down fixtures.
ISIS-2750,Bug,Closed,"To allow beans to be overridden, use `@Priority` instead of `@Order` and remove any `@Primary` annotations.",
ISIS-2749,Improvement,Closed,[Duplicate] Convert IsisConverterLocator into a domain service and allow Wicket Converters to be substituted in.,"For example, if enter 'abc' into a BigDecimal' then the error message returned is effectively hardcoded because in IsisWicketApplication we just use Wicket's default ConverterLocator (fine tuned with a couple of extra types to convert).  That means we get:

!image-2021-06-17-12-50-57-240.png|width=582,height=120!

We also have a bit of technical debt, because there is an IsisConverterLocator that _doesn't_ implement Wicket's IConvertLocator, and is just called from one place, statically, to render an object as a string.

So we should perhaps:
 * provide our own impl of IConveterLocator, probably subclassed from Wicket's
 * make it a Spring Bean
 * get rid of IsisConverterLocator (roll it into aforementioned IConverterLocator)
 * decide on a way to allow new/replacement converters to be registered.

We might also want to look at the ValueTypeRegistry we have, just in case there's overlap.

 

 "
ISIS-2748,Improvement,Closed,"Presence of ""mustSatisfy"" Specifications causes integ tests to fail .... UNKNOWN bean sort","domainapp.modules.base.types.Name$Specification: is a (concrete) but UNKNOWN sort, yet has 3 actions: \{domainapp.modules.base.types.Name.Specification#satisfies(java.lang.Object), domainapp.modules.base.types.Name.Specification#satisfiesTranslatable(java.lang.Object), domainapp.modules.base.types.Name.Specification#satisfiesTranslatableSafely(java.lang.String)}

Moreover, this is when

isis.applib.annotation.action.explicit=true

To add insult to injury, AbstractSpecification2 does not declare @Programmatic and also declares final methods that cannot be overrridden."
ISIS-2747,Improvement,Closed,[OBSOLETE] Document the fact that secman requires SudoService to specify a user with appropriate roles," 

And not just any old user with a set of roles.

While it would be nicer to do the latter, we have to resolve potentially conflicting sets of roles' permissions, and this is done at the user level (ApplicationUser#getPermissionSet).

 "
ISIS-2746,Bug,Closed,"Fix the order of listeners for metamodel event (security seeding should be early, fixture installation should be late)",use @Order annotation on the event listener method
ISIS-2745,New Feature,Closed,[DUPLICATE] Allow actions to be contributed to domain services also.,"Now that we no longer have contributing domain services, hopefully this becomes easier to reason about"
ISIS-2744,Wish,Open,"[Wish] Add new ""optionalX"" supporting method for parameters so that its optionality can be toggled","We can of course validate using validateNXxx(), but the idea here is to toggle off or on the optionality constraint for N>0 parameters based on earlier parameters,

eg:
{code:java}
public void act(SomeType type, String someParam) {
}
public boolean optional1Act(SomeType type) {
    if (type == SomeType.FOO || type == SomeType.BAR) return true;
    return false;
} {code}"
ISIS-2743,New Feature,Closed,"For embedded entity types, contribute their actions to the referencing type.","For example, suppose we have an embedded type that itself defines an action:
{code:java}
@javax.persistence.Embeddable                                                             @Value(semanticsProviderClass = ComplexNumberJpaValueSemantics.class)
public class ComplexNumber { 

    private double re;
    private double im;

    @Action
    public ComplexNumber update(double re, double im) {
        return new ComplexNumber(re, im);
    }
}
 {code}
and then we have an entity that uses that type:
{code:java}
@Entity 
public class SomePhysicsConcept {
    ComplexNumber upper;
    ComplexNumber lower;
}{code}
then we should synthesise these mixins on the referencing type:
{code:java}
@ActionLayout(associateWith=""upper"")
public class SomePhysicsConcept_updateUpper {
    public SomePhysicsConcept act(double re, double im) {
        somePhysicsConcept.upper = somePhysicsConcept.upper.act(re, im);
    }
}
 {code}
and similarly:
{code:java}
@ActionLayout(associateWith=""lower"")
public class SomePhysicsConcept_updateLower {
    public SomePhysicsConcept act(double re, double im) {
        somePhysicsConcept.lower = somePhysicsConcept.lower.act(re, im);
    }
}{code}
 

 

 

 

 "
ISIS-2742,Improvement,Closed,Allow meta-annotations to be declared for entities.,"for example, would like to be able to declare:
{code:java}
@Target(TYPE)
@Retention(RUNTIME)
@PersistenceCapable( identityType = IdentityType.DATASTORE)
@DatastoreIdentity( strategy = IdGeneratorStrategy.NATIVE)
@Version( strategy = VersionStrategy.VERSION_NUMBER)
public @interface EntityWithIdAndVersion {

    @AliasFor( annotation = PersistenceCapable.class, attribute = ""schema"")
    String schema() default """";

    @AliasFor( annotation = DatastoreIdentity.class, attribute = ""column"")
    String idColumn() default ""id"";

    @AliasFor( annotation = Version.class, attribute = ""column"")
    String versionColumn() default ""version"";

} {code}
and then:
{code:java}
 @EntityWithIdAndVersion( schema = ""ORGANISATION"")
public class Party {}{code}
however, this results in:

""ObjectSpecification is missing an EntityFacet"" exception."
ISIS-2741,Improvement,Closed,Show a more appropriate message when invalid BigDecimal shown; ideally allow it to be customised using @Digits.message,"When we have a BigDecimal property with @Digits(10,3) we get a generic message.  This should be more suitable, and ideally could be customised.

For example:
{code:java}
@Digits(integer = 10, fraction = 3) // <<<<<<<<<<<< allow the message thrown by this
@Property()
@Parameter()
@Target({ ElementType.METHOD, ElementType.FIELD, ElementType.PARAMETER, ElementType.ANNOTATION_TYPE })
@Retention(RetentionPolicy.RUNTIME)
public @interface Hours { }{code}"
ISIS-2740,Improvement,Closed,Wicket Viewer:  menu dropdowns should have higher z-index than toast messages,Otherwise (if not clicking them away) one has to wait for messages to disappear in order to be able to navigate eg. the Prototyping Menu.
ISIS-2739,Improvement,Closed,"Download menubars XML is broken, due to @DomainObject annotation on enum","!image-2021-06-13-17-03-54-085.png|width=689,height=375!"
ISIS-2738,Improvement,Closed,Metamodel: add diff report (along the various MM downloads),"For each facet-type (known to the MM) it shall report semantic differences between 2 domain models (xml) so that one has a better overview on a per facet-type basis.

UI menu is same as the xml MM download, but with an additional param for uploading a reference MM (zipped xml)."
ISIS-2737,Improvement,Closed,Metamodel: accept Can<T> as vector type (along java.util.Collection),eg. UserMemento#getRoles() : Can<RoleMemento> fails with see comment ...
ISIS-2736,Improvement,Closed,Metamodel: add (diff friendly) download format ASCII (as a variant to XML),
ISIS-2735,Improvement,In Progress,"[Command Replay] Reinstate UI and REST for JDO, also implement for JPA","Currently _Command Replay_ domain-objects/mixins and meta-annotations only exist for the JDO universe.

We should refactor those into a common model to be shared between JDO and JPA.

(_Secman Extension_ can be used as a blueprint on how to do this.)
 "
ISIS-2734,New Feature,Closed,Extend the API of VirtualClock to make it a little easier to work with.,
ISIS-2733,New Feature,Closed,Surface UserMemento on the UI,Now that it has more info....
ISIS-2732,Improvement,Closed,Rationalize fixture applib's Clock singleton vs VirtualClock (hopefully remove the former),(Some earlier rationalization/simplficiation was done in ISIS-2726)
ISIS-2731,Improvement,Closed,"Allow injected services to have getters on them.  This would allow entities to be annotated with @lombok.Data, removing some boilerplate.","we had an entity:
{code:java}
@Data
public class Organisation {
    ...

    @Inject CLockService clockService;
}{code}
Attempting to render this in Wicket results in a stack trace, because we have made the getClockService() into a property:
{code:java}
java.lang.IllegalArgumentExceptionDon't know how to create an ObjectMemento for a type with ObjectSpecification ObjectSpecificationDefault@3d53e732[class=org.apache.isis.core.runtimeservices.clock.ClockServiceDefault,type=MANAGED_BEAN_NOT_CONTRIBUTING,superclass=java.lang.Object]. All other strategies failed. Type is neither identifiable (isManagedBean() || isViewModel() || isEntity()), nor is a 'parented' Collection, nor has 'encodable' semantics, nor is (Serializable || Externalizable)org.apache.isis.commons.internal.exceptions._Exceptions#illegalArgument(_Exceptions.java:80)org.apache.isis.viewer.wicket.viewer.services.mementos.ObjectMementoWkt#init(ObjectMementoWkt.java:475)org.apache.isis.viewer.wicket.viewer.services.mementos.ObjectMementoWkt#<init>(ObjectMementoWkt.java:435)org.apache.isis.viewer.wicket.viewer.services.mementos.ObjectMementoWkt#createOrNull(ObjectMementoWkt.java:67)org.apache.isis.viewer.wicket.viewer.services.mementos.ObjectMementoServiceWicket#mementoForObject(ObjectMementoServiceWicket.java:80)org.apache.isis.viewer.wicket.model.models.ManagedObjectModel#setObject(ManagedObjectModel.java:91)org.apache.isis.viewer.wicket.model.models.ScalarPropertyModel#reset(ScalarPropertyModel.java:129)org.apache.isis.viewer.wicket.model.models.ScalarPropertyModel#<init>(ScalarPropertyModel.java:56)org.apache.isis.viewer.wicket.model.models.EntityModel#getPropertyModel(EntityModel.java:237)org.apache.isis.viewer.wicket.ui.components.entity.fieldset.PropertyGroup#addPropertyToForm(PropertyGroup.java:204)org.apache.isis.viewer.wicket.ui.components.entity.fieldset.PropertyGroup#buildGui(PropertyGroup.java:117)org.apache.isis.viewer.wicket.ui.components.entity.fieldset.PropertyGroup#<init>(PropertyGroup.java:80) {code}"
ISIS-2730,Improvement,Closed,"If home page fails to render (eg due to insufficient permissions), then just suppress.","The issue here is that if the SecMan super user - that has admin perms for the SecMan module but not for anything else - attempts to login to an app that has a @HomePage, then currently this will render an error page (""not authorised"") and it's not possible to continue (trapped in a loop)."
ISIS-2729,Improvement,Closed,[Wicket] use generic RoleName 'org.apache.isis.security.AUTHORIZED_USER_ROLE',"At the moment there is code in both the filters for keycloak and shiro to add in the role required by Wicket viewer.  This should be removed (implicit coupling) and instead Wicket viewer should provide its own WebModule that adds in a filter to do this work somehow.

 "
ISIS-2728,New Feature,Closed,"Extend UserMemento to contain application tenancy path, and callback to allow secman etc to populate.","The rationale for this is to allow a higher level of abstraction for domain apps, so that any domain code would be able to simply use the framework's generic _UserService_ rather than have to map across to the secman-specific _ApplicationUserRepository_.

We can either store this directly as a field or within a (serializable) set of attributes.

Storing as a field may be reasonable: this is a piece of info that could reasonable be known for any securiyt implementation.  One objection to using attributes is that nominally UserMemento is an immutable value.

 

 "
ISIS-2727,New Feature,Closed,"Expose minimal InteractionFactory in the applib, to create new InteractionLayers.  Perhaps this is an extension of SudoService ?","[https://the-asf.slack.com/archives/CFC42LWBV/p1623056272236700]

A fixture script that mocks the clock ""just"" needs to push an {{AuthenticationLayer}} with the desired {{VirtualClock}}.

We also need to be able (within the test) to ""sudo"".  This is where we need the ability to create an AuthenticationLayer (we'll rename it to InteractionLayer) on the fly.

Discussion:
 some thoughts on how to do this:
 * {{ExecutionContext}} is already in the applib, though its name is confusing as it suggests it is related to the {{Interaction.Execution}} class (it isn't, really) and also the fixtures applib provide {{FixtureScript.ExecutionContext}}.  Really it acts more like a context for creating an {{InteractionLayer}}, so I think it should be called {{InteractionContext}}. [DONE]
 * That then means that the _current_ {{InteractionContext}} - which exposes the Isis applib {{Interaction}} to domain apps - then needs to be renamed.  I suggest this is called {{InteractionProvider}} instead  *[DONE]*
 * We promote some small super-interface of {{InteractionFactory}} up into the applib.  This might allow us to remove the {{AnonymousInteractionFactory}} interface that was recently introduced into security. 
 * Rather than {{InteractionFactory#openInteraction(...)}} taking an {{Authentication}}, I think it could instead take the (now renamed) {{InteractionContext}} which is wrapped by an {{Authentication}}.  My reasoning is that {{Authentication}} is not much more than a wrapper around {{InteractionContext}}, so I doubt there is any code that has a hard dependency on {{Authentication}} that couldn't be refactored to work with {{InteractionContext}} instead. [DONE]
 * The responsibilities of {{Authentication}} are then to do with ensuring that it is valid (the validation code) and the type (delegated or not etc).  Those responsibilities hopefully won't need to leak outside of security, ie {{Authentication}} is not used elsewhere, ie other modules just use {{InteractionContext}} as mentioned..

Also:
 * Rename {{AuthenticationContext}} to  {{AuthenticationProvider}} , as this follows a similar pattern *[DONE]*"
ISIS-2726,Improvement,Closed,Simplify SudoService and others to be based on InteractionService,Building on the work of ISIS-2727
ISIS-2725,Improvement,Closed,Support logical type names with value types,"Add @Value(logicalTypeName=...) and an MM validator to ensure either @Value or @DomainObject.

Also maybe extend ValueTypeProvider(s) to register value types with also providing a logicalTypeName."
ISIS-2724,Bug,Closed,[Regression] Some mixed-in actions don't show up,"Seeing this with isis.applib.mixins.metamodel.Object_inspectMetamodel#act. Even though user has change permissions for the above feature, the action does not show up on any entity pages."
ISIS-2723,Bug,Closed,"[Regression] JDO: @Column(allowsNull=""true"") is not interpreted as Optionality.OPTIONAL",
ISIS-2722,Bug,Closed,[Regression] Markup value types are hidden,Seeing this with the builtin markup value types. Value types should never be hidden based on access permissions!
ISIS-2721,Bug,Closed,[Regression] Blob/Clob properties are not rendered with table columns,"We expect to see download links placed at the associated table column. However the table cells are just empty.

In addition Blob/Clob properties do not show up on EntityPages. (No download button, and also no label rendered.)"
ISIS-2720,Bug,Closed,[Regression] FormExecutorDefault#executeAndProcessResults throws IllegalArgumentException,Demo/JDO: Dependent Args Action -> Dialog Parity Default -> try select an enum
ISIS-2719,Improvement,Closed,"with secman, Impersonation does not correctly figure out permissions of switched user","Two separate (perhaps completely separate?) issues here:
 * for shiro.ini, we don't support ""impersonateWithRoles"", so my guess is that we keep the same roles as the original.

 * for secman, we ignore the roles specified using ""impersonateWithRoles"", because ApplicationUser#getPermissionSet joins across to the roles in the database, rather than the set of roles that are in the UserMemento.

 "
ISIS-2718,Improvement,Closed,Demo webapp - fix permissions and ensure all isis roles are seeded,"none of the asciidoc stuff seems to be visible.    Also the list of roles seem to be missing some of secman's standard ones:

!image-2021-06-03-08-40-05-204.png|width=1556,height=393!"
ISIS-2717,Improvement,Closed,Replace FixtureScriptsSpecificationProvider with configuration properties.,
ISIS-2716,Bug,Closed,Can't Login to demo wicket nightly 20210602,
ISIS-2715,Improvement,Closed,Shiro permissions should use namespace rather than package; fix,Aligning with SecMan
ISIS-2714,Bug,Closed,Update helloworld and simpleapp with permissions to allow users to logout (!),"helloworld jpa SNAPSHOT, 'bob' login cannot log out

I guess this might be a permissions problem?
{code:java}
sven = pass, admin_role
dick = pass, user_role, self-install_role
bob  = pass, user_role, self-install_role, conf_role, sudo_role, features_role, metamodel_role, jdo_role, h2_role, swagger_role
joe  = pass, user_role, self-install_role
guest = guest, user_role



# -----------------------------------------------------------------------------
# Roles with assigned permissions
#
# Each line conforms to the format defined in the
# org.apache.shiro.realm.text.TextConfigurationRealm#setRoleDefinitions JavaDoc
# -----------------------------------------------------------------------------

[roles]
# role = perm1, perm2, perm3, ...
# perm in format: packageName:className:memberName:r,w

user_role =   organisation:*:*:*,\
              currency:*:*:*,\
              isis.applib:*:*:*,\
              isis.security:*:*:*
conf_role =   isis.conf:*:*:*
sudo_role =   isis.sudo:*:*:*
features_role =   isis.feat:*:*:*
metamodel_role =   isis.metamodel:*:*:*
h2_role =   isis.ext.h2Console:*:*:*
jdo_role =   isis.persistence.jdo:*:*:*
swagger_role =   isis.viewer.restfulobjects:*:*:*
self-install_role = *:FixtureScripts:*:*
admin_role = *

 {code}"
ISIS-2713,Improvement,Closed,All framework-contributed metamodel features should be in isis.<something> namespace,there are a couple of omissions - use metamodel download CSV to find them 
ISIS-2712,Improvement,Closed,"MetaModelServiceMenu downloadMetamodelXml should filter on logical type namespaces, not on packages",
ISIS-2711,Bug,Closed,TreeNode should be a value in the metamodel,Currently is ABSTRACT - with Secman this can result in it being invisible.
ISIS-2710,Bug,Closed,"Provide a mechanism so that view models wrapping ""just deleted"" entity objects don't attempt to reset their state after execution (resulting in runtime error).",as per https://the-asf.slack.com/archives/CFC42LWBV/p1622194487173800
ISIS-2709,Bug,Closed,"Fix permission seed data for h2console, make available to secman admin; other minor simplifications",
ISIS-2708,Bug,Closed,Add bottom margin spacing after tab groups in Wicket viewer,
ISIS-2707,Improvement,Closed,Extend MetaModelServiceMenu downloadMetaModelCsv to include the logicalTypeName as a column.,
ISIS-2706,Bug,Closed,JPA does not persist entities with application-defined primary keys,"For example, secman's ApplicationTenancy cannot be persisted as currently implemented.

Reason (perhaps): there is logic in ManagedObjects.EntityUtil.getState() to infer the entity state of the object, and for such entities it returns the state as PERSISTABLE_DESTROYED rather than DETACHED, meaning that flush transaction is never called. 

To reproduce, simply attempt to create a new ApplicationTenancy. 

 

HERE'S THE CODE THAT SHOWS the entity is not reported as detached,so the transaction never flushed:

!image-2021-05-28-06-20-20-489.png|width=783,height=627!

 

THE FIX MIGHT BE TO SIMPLY REMOVE THE HIGHLIGHTED, WHICH PERHAPS IS A PERFORMANCE OPTIMISATION?  (or,  it is only safe to do if the @Id also has @GeneratedValue, which application-defined primary keys do not, of course.

 

!image-2021-05-28-06-31-55-731.png|width=645,height=374!

 

 "
ISIS-2705,New Feature,Closed,Allow positioning of Wicket viewer's popups to be configured,
ISIS-2704,Bug,Closed,"If there is an select2 drop-down param, this takes focus even if not first field","I made a fix in isis.viewer.wicket.js for this recently so that select2 would get focus at all, but obvs the implementation isn't perfect..."
ISIS-2703,Bug,Closed,ApplicationTenancy's autocomplete doesn't seem to work (not available for secman-admin),"At the moment, if attempt to create a new tenancy, the parent param cannot be set.

Notes:

* I think this is to do with the matching of abstract ApplicationTenancy to the target type.

* Attempting to use Bounded instead on the abstract ApplicatoinTenancy resulted in runtime exception."
ISIS-2702,Improvement,Closed,Unnecessary warning is logged whenever return an standalone collection from an action,"For example, return ""all hello world instances"", will hit this breakpoint:

  !image-2021-05-27-06-30-24-300.png|width=817,height=294!"
ISIS-2701,Improvement,Closed,SecMan: rename ApplicationUser_permissions to ApplicationUser_effectiveMemberPermissions,
ISIS-2700,Improvement,Closed,"If no members visible for type, then veto viewing of _instances_ of that type.","To summarise what's to be done here:
 * we already have a HiddenObjectFacet (currently derived from a ""hidden()"" method on the object itself) that can be installed on the ObjectSpecification.  Make it a viewer responsibility that if this exists, hide any collections for that ObjectSpecification.
 * create a further implementation for this facet that is derived from the set of permissions : if all props are invisible, infer that the object as a whole is.
 * as belt-n-braces, implement a general tenancy evaluator that hides an object if its ObjectSpecification has this facet.
 * similar to the work done in ISIS-2701, we'll should also introduce an `ApplicationUser_effectiveTypePermissions` mixin to surface this computed set.   Only secman admins should be able to see this collection.

 

some of the discussion leading to this outcome below (and for the original discussion, see [https://the-asf.slack.com/archives/CFC42LWBV/p1621939985113300] )

~~~~~~~~~~~~~~~

A permission that vetoes the viewing of a type (such as in the example below) is not fully honored. In this concrete case a user that is being assigned a role with this permission (and no other roles with any permission that would contradict this permission) could still navigate to an entity page of a ApplicationUser and would see the title and the the icon and perhaps an empty metadata tab.

The desired behavior would be the display of an error message saying ""Not authorized or no such object"".

 

!image-2021-05-26-15-18-02-115.png!

 

This is a screenshot of how the vetoed entity page presents to the user:

!image-2021-05-26-15-20-31-139.png!

 "
ISIS-2699,Improvement,Closed,Replace SecmanConfiguration with configuration properties.  ,
ISIS-2698,Improvement,Closed,Rename secman's 'api' and 'model' submodules to 'applib' and 'integration' respectively,"To reflect their responsibliities/consistency elsewhere.

Also:
 * move the Authorizor from secman's applib module to integration
 * conversely.move the seed scripts up from integration to applib
 * move PasswordEncryptionService to be an spi of o.a.i.extensions.secman.applib.user

."
ISIS-2697,Improvement,Closed,Simplify secman's support for user-registration.,"Rather than require the dev to have to subclass an abstract service class in order to provide an implementation of UserRegistrationService, instead have secman provide a concrete implementation and then have the list of initial roles be set up as a config parameter.

This then makes the 'secman.model' module clearer ... it is almost all spiimpl integrations rather than representing an API of its own."
ISIS-2696,Bug,Closed,[Regression] MM validation fails on abtract mixin member support method,"
Martin Hesse:
I have an abstract mixin class with a concrete method act() and an abstract method disableAct().
After upgrading to 0525 I get the following metamodel validation error:
AbstractMixin#disableAct: is assumed to support a property, collection or action. Unmet constraint(s): unsupported method signature or orphaned (not associated with a member)"
ISIS-2695,Improvement,Closed,[Duplicate] Add Java Bean Validation support,"[~danhaywood]

In v2 we support meta-annotations, which can then have both Isis and also JDO annotations against them. That will make for better modularity.

What's not clear right now is whether it's worth the boilerplate without an actual use case to benefit from that boilerplate. The only use case in practice in many cases is for a string property, eg name, where we want to tell both Isis and JDO that the max length is 50, say.

Another use case could be for regex's, eg for a reference. That is the beginning of some business logic, and could use @Property(regexPattern=...) and [@parameter|https://issues.apache.org/parameter](regexPattern=...).

More generally, we can do @Property(mustSatisfy=...) and [@parameter|https://issues.apache.org/parameter](mustSatisfy=...) for arbitrary business logic.

Another consideration is if the property appears as a parameter in lots of actions; in which case this allows having to specify @Parametr and @ParameterLayout everywhere.

For this particular use case, suggest just inline and get rid of NameType (""yagni"" - ""you ain't gonna need it"", in other words).

Perhaps the tipping point is if we could see there being a value type in the future... in which case a meta-annotation as being fairly close to that. Whether a value type / meta-annotation is worth the overhead depends on a couple of factors: one might be whether the concept itself is helpful to have as part of the ubiquitous language, another more practical reason is whether the entities that have properties of that value type are mutable (for that value type): eg does a Fixed Asset's name ever change? If so, a value type for 'Name' might start to make sense.

 

[~ppjdeenen]

I prefer using standards first and foremost, e.g. i would recommend switching to java bean validation which has default annotations for this. It has strong spring boot support, see [https://reflectoring.io/bean-validation-with-spring-boot/] Hence for String length validation use annotation [@size|https://issues.apache.org/size](max=50) for regex use annotation @pattern(regexp = ""^[0-9]\{1,3}\.[0-9]\{1,3}\.[0-9]\{1,3}\.[0-9]\{1,3}$"") for business logic in the entity use @AssertTrue or @AssertFalse and of course one can define custom (generic) annotations.

 

[~danhaywood]

We could certainly do this, though would require a contribution to Apache Isis itself to 'teach' it about the meanings of this. I think this would be a good and discrete thing to look into.

Indeed, we do still have (very old) tickets for this:
 * https://issues.apache.org/jira/browse/ISIS-491
 * https://issues.apache.org/jira/browse/ISIS-517

fyi, as a matter of style, we did use to have lots of fine-grained annotations similar to [@size|https://issues.apache.org/size] and @pattern. The difficulty we found was remembering them all, which is why we switched to using two annotations (one domain, one layout) for each member type ... ie @Property/@PropertyLayout, [@action|https://issues.apache.org/action]/@ActionLayout etc.

 

[~ppjdeenen]

Ok, to summarize my take on this:
 * Use java bean validation for validation of business logic (the java standard for validations) in combination with Spring for additional ease of use.
 * Refactor Apache Isis to support Java Bean Validation (so both Ises and ORM understand the same annotations)
 * Add @Property(Layout) and [@action|https://issues.apache.org/action](Layout) as custom Java Bean validation annotations"
ISIS-2694,Improvement,Closed,Can we simplify secman and get rid of SecurityRealm / SecurityRealmCharacteristics ?,"There's quite a few types here (SecurityRealmService, SecurityRealm, SecurityRealmCharacteristics) along with a requirement for the end-developer to instantiate a SecurityRealmService bean... but all we do is use the value to hide/not hide an action.   

 

!image-2021-05-24-22-41-32-839.png|width=526,height=135!

Seems to be over-engineered?  Can this be simplified, or perhaps even just removed?"
ISIS-2693,Improvement,Closed,Not sure how filterPermissions is meant to work exactly - slightly confusing output,"Using filterPermissions, I selected a member (ApplicationUser#permissions, in fact), but what I saw was all the permissions relating to the type (ApplicationUser).  What is the intended behaviour here?

Also, with the ""sort:X"" prefix, a couple of points:

a) the ""sort:"" is a lot to type.

b) there's no space after those first 6 chars, which is tricky to read.

 

Perhaps it could be simplified to:

n:<xxxx>

t:<xxxx>

m:<xxxx>

which is less to type, and the "":"" acts as a natural separator?"
ISIS-2692,Improvement,Closed,Rename ApplicationUserStatus from ENABLED/DISABLED to LOCKED/UNLOCKED,Note that this changes what is persisted in the database...
ISIS-2691,Improvement,Closed,Add @MemberSupport for all framework-provided mixins.,To fail fast in case we made a mistake.
ISIS-2690,Improvement,Closed,ApplicationUser is unable to modify their own user detais.,
ISIS-2689,Improvement,Closed,"Allow multiple Authorizors to be registered, with mechanism to decide which to use.",
ISIS-2688,Bug,Closed,Impersonation doesn't actually work ... AuthorizorShiro still delegates to ApplicationUser as originally logged in.,
ISIS-2687,Improvement,Closed,"To reduce learning curve, remove archunit, lockdown and BDD specs from simpleapp.","as this is for the simpleapps, being backported to current website for 2.0.0-M5"
ISIS-2686,Bug,Closed,"cannot 'identify' the value type org.apache.isis.applib.value.LocalResourcePath, as values have no identifier","Reproduce via: 
kroviz (running against apacheisis/demo-wicket-jdo of 2021-05-18) -> Demo -> Prototyping -> Open H 2 Console

Url: 
http://localhost:8080/restful/objects/isis.ext.h2Console.H2ManagerMenu/1/actions/openH2Console/invoke

Stacktrace:
org.apache.isis.commons.internal.exceptions._Exceptions.illegalArgument(_Exceptions.java:80)
org.apache.isis.core.metamodel.objectmanager.identify.ObjectBookmarker_builtinHandlers$BookmarkForValues.handle(ObjectBookmarker_builtinHandlers.java:106)
org.apache.isis.core.metamodel.objectmanager.identify.ObjectBookmarker_builtinHandlers$BookmarkForValues.handle(ObjectBookmarker_builtinHandlers.java:97)
org.apache.isis.commons.handler.ChainOfResponsibility.lambda$of$1(ChainOfResponsibility.java:74)
java.base/java.util.Optional.map(Optional.java:258)
org.apache.isis.commons.handler.ChainOfResponsibility.lambda$of$2(ChainOfResponsibility.java:74)
org.apache.isis.core.metamodel.objectmanager.identify.ObjectBookmarker.lambda$createDefault$1(ObjectBookmarker.java:56)
org.apache.isis.core.metamodel.objectmanager.ObjectManager.bookmarkObject(ObjectManager.java:88)
org.apache.isis.core.metamodel.spec.ManagedObjectInternalUtil.lambda$identify$0(ManagedObjectInternalUtil.java:76)
java.base/java.util.Optional.map(Optional.java:258)
org.apache.isis.core.metamodel.spec.ManagedObjectInternalUtil.identify(ManagedObjectInternalUtil.java:76)
org.apache.isis.core.metamodel.spec.ManagedObject$LazyManagedObject.lambda$new$0(ManagedObject.java:238)
org.apache.isis.commons.internal.base._Lazy_ThreadSafe.get(_Lazy_ThreadSafe.java:65)
org.apache.isis.core.metamodel.spec.ManagedObject$LazyManagedObject.getBookmark(ManagedObject.java:233)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer.render(DomainObjectReprRenderer.java:173)
org.apache.isis.viewer.restfulobjects.rendering.Responses.ofOk(Responses.java:67)
org.apache.isis.viewer.restfulobjects.rendering.service.conneg.ContentNegotiationServiceForRestfulObjectsV1_0.buildResponseTo(ContentNegotiationServiceForRestfulObjectsV1_0.java:119)
org.apache.isis.viewer.restfulobjects.rendering.service.conneg.ContentNegotiationServiceForRestfulObjectsV1_0.buildResponse(ContentNegotiationServiceForRestfulObjectsV1_0.java:100)
org.apache.isis.viewer.restfulobjects.rendering.service.conneg.ContentNegotiationServiceForRestfulObjectsV1_0.buildResponse(ContentNegotiationServiceForRestfulObjectsV1_0.java:229)
org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationService.lambda$actionResult$4(RepresentationService.java:189)
org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationService.buildResponse(RepresentationService.java:222)
org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationService.actionResult(RepresentationService.java:188)
org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.invokeAction(DomainResourceHelper.java:298)
org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.invokeActionQueryOnly(DomainResourceHelper.java:164)
org.apache.isis.viewer.restfulobjects.viewer.resources.DomainObjectResourceServerside.invokeActionQueryOnly(DomainObjectResourceServerside.java:641)
java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)
java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
java.base/java.lang.reflect.Method.invoke(Method.java:564)
org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:170)
org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:130)
org.jboss.resteasy.core.ResourceMethodInvoker.internalInvokeOnTarget(ResourceMethodInvoker.java:646)
org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTargetAfterFilter(ResourceMethodInvoker.java:510)
org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invokeOnTarget$2(ResourceMethodInvoker.java:460)
org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:364)
org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:462)
org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:420)
org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:394)
org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:69)
org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:492)
org.jboss.resteasy.core.SynchronousDispatcher.lambda$invoke$4(SynchronousDispatcher.java:261)
org.jboss.resteasy.core.SynchronousDispatcher.lambda$preprocess$0(SynchronousDispatcher.java:161)
org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:364)
org.jboss.resteasy.core.SynchronousDispatcher.preprocess(SynchronousDispatcher.java:164)
org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:247)
org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:249)
org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:60)
org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55)
javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsInteractionFilter.lambda$doFilter$1(IsisRestfulObjectsInteractionFilter.java:387)
org.apache.isis.commons.functional.ThrowingRunnable.lambda$toCallable$0(ThrowingRunnable.java:36)
org.apache.isis.commons.functional.Result.of(Result.java:58)
org.apache.isis.core.runtimeservices.transaction.TransactionServiceSpring.callTransactional(TransactionServiceSpring.java:106)
org.apache.isis.applib.services.xactn.TransactionalProcessor.callWithinCurrentTransactionElseCreateNew(TransactionalProcessor.java:100)
org.apache.isis.applib.services.xactn.TransactionalProcessor.runWithinCurrentTransactionElseCreateNew(TransactionalProcessor.java:110)
org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsInteractionFilter.lambda$doFilter$3(IsisRestfulObjectsInteractionFilter.java:386)
org.apache.isis.core.runtimeservices.session.InteractionFactoryDefault.runAuthenticated(InteractionFactoryDefault.java:268)
org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsInteractionFilter.doFilter(IsisRestfulObjectsInteractionFilter.java:382)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.apache.isis.core.webapp.modules.logonlog.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:60)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:450)
org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)
org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:93)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1707)
org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
java.base/java.lang.Thread.run(Thread.java:832)

"
ISIS-2685,Improvement,Closed,Bump spring-boot from 2.4.5 to 2.5.0,"There are some significant changes around data-source configuration:
https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.5-Release-Notes"
ISIS-2684,Bug,Closed,RO domain-types/<xxx> representation of `members` returns a list instead of a map,see https://the-asf.slack.com/archives/CFC42LWBV/p1621426919014700
ISIS-2683,Bug,Open,BS3 Menu layout cssClassFa not honored,The cssClassFa attribute of the menu XML element in the menubar layout xml is not pickep up and the specified icon not rendered in the menu wicket component.
ISIS-2682,Bug,Closed,"Cannot read field ""mutatorFacetType"" because ""mutatorSpec"" is null","Reproduce via: 
kroviz (running against nightly Docker Image) -> Demo -> Basic Types -> Strings

Url: 
http://localhost:8080/restful/objects/demo.JavaLangStrings/PADw_eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04IiBzdGFuZGFsb25lPSJ5ZXMiPz4KPERlbW8vPgo=/collections/entities

Stacktrace:
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.AbstractObjectMemberReprRenderer.addLinkFor(AbstractObjectMemberReprRenderer.java:226)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.ObjectCollectionReprRenderer.addMutatorLink(ObjectCollectionReprRenderer.java:169)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.ObjectCollectionReprRenderer.addMutatorLinksIfEnabled(ObjectCollectionReprRenderer.java:160)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.AbstractObjectMemberReprRenderer.renderMemberContent(AbstractObjectMemberReprRenderer.java:194)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.ObjectCollectionReprRenderer.render(ObjectCollectionReprRenderer.java:67)
org.apache.isis.viewer.restfulobjects.rendering.Responses.ofOk(Responses.java:67)
org.apache.isis.viewer.restfulobjects.rendering.service.conneg.ContentNegotiationServiceForRestfulObjectsV1_0.buildResponseTo(ContentNegotiationServiceForRestfulObjectsV1_0.java:183)
org.apache.isis.viewer.restfulobjects.rendering.service.conneg.ContentNegotiationServiceForRestfulObjectsV1_0.buildResponse(ContentNegotiationServiceForRestfulObjectsV1_0.java:161)
org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationService.lambda$collectionDetails$2(RepresentationService.java:151)
org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationService.buildResponse(RepresentationService.java:222)
org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationService.collectionDetails(RepresentationService.java:150)
org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.collectionDetails(DomainResourceHelper.java:133)
org.apache.isis.viewer.restfulobjects.viewer.resources.DomainObjectResourceServerside.accessCollection(DomainObjectResourceServerside.java:526)
java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)
java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
java.base/java.lang.reflect.Method.invoke(Method.java:564)
org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:170)
org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:130)
org.jboss.resteasy.core.ResourceMethodInvoker.internalInvokeOnTarget(ResourceMethodInvoker.java:646)
org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTargetAfterFilter(ResourceMethodInvoker.java:510)
org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invokeOnTarget$2(ResourceMethodInvoker.java:460)
org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:364)
org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:462)
org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:420)
org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:394)
org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:69)
org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:492)
org.jboss.resteasy.core.SynchronousDispatcher.lambda$invoke$4(SynchronousDispatcher.java:261)
org.jboss.resteasy.core.SynchronousDispatcher.lambda$preprocess$0(SynchronousDispatcher.java:161)
org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:364)
org.jboss.resteasy.core.SynchronousDispatcher.preprocess(SynchronousDispatcher.java:164)
org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:247)
org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:249)
org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:60)
org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55)
javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsInteractionFilter.lambda$doFilter$1(IsisRestfulObjectsInteractionFilter.java:387)
org.apache.isis.commons.functional.ThrowingRunnable.lambda$toCallable$0(ThrowingRunnable.java:36)
org.apache.isis.commons.functional.Result.of(Result.java:58)
org.apache.isis.core.runtimeservices.transaction.TransactionServiceSpring.callTransactional(TransactionServiceSpring.java:106)
org.apache.isis.applib.services.xactn.TransactionalProcessor.callWithinCurrentTransactionElseCreateNew(TransactionalProcessor.java:100)
org.apache.isis.applib.services.xactn.TransactionalProcessor.runWithinCurrentTransactionElseCreateNew(TransactionalProcessor.java:110)
org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsInteractionFilter.lambda$doFilter$3(IsisRestfulObjectsInteractionFilter.java:386)
org.apache.isis.core.runtimeservices.session.InteractionFactoryDefault.runAuthenticated(InteractionFactoryDefault.java:268)
org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsInteractionFilter.doFilter(IsisRestfulObjectsInteractionFilter.java:382)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.apache.isis.core.webapp.modules.logonlog.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:60)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:450)
org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)
org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:93)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1707)
org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
java.base/java.lang.Thread.run(Thread.java:832)
"
ISIS-2681,Improvement,Closed,Allow members of a type hierarchy including interfaces to share the same objectType=...,"Eg. having an ApplicationUser interface and a concrete ApplicationUser (JDO) that have the same @DomainObject(objectType=...) should be allowed.

The only constraint that applies, is that there cannot be multiple bookmark-able types that share the same @DomainObject(objectType=...). This must be guaranteed by MM validation."
ISIS-2680,Bug,Closed,[Regression] SecMan cannot open ME menu entry: no such object,
ISIS-2679,Bug,Closed,[Regression] SecMan cannot list Roles,"1. there is a bug in LayoutFacetUtil which causes SortedByFacetForCollectionXml to fail
2. object-mementos from ApplicationPermission (JDO) cannot be recreated, because their bookmark isis.ext.secman.ApplicationRole:n maps to the abstract type org.apache.isis.extensions.secman.api.role.dom.ApplicationRole, which has no EntityFacet
"
ISIS-2678,Documentation,Open,Add missing documentation to explain the Parameters syntax for dependent (mixin) action args.,"as per slack: [https://the-asf.slack.com/archives/CFC42LWBV/p1620978920239500?thread_ts=1620833729.210100&cid=CFC42LWBV]

We should backport this to the current website."
ISIS-2677,New Feature,Closed,Locating the layout.xml should search up the (class) inheritance hierarchy,"For a start, we'll only consider classes, not interfaces. Walking the hierarchy from current to super to super-super, ... first found wins."
ISIS-2676,Wish,Open,[Wish] Better approach to ordering columns in tables (properties + actions),"re: [https://the-asf.slack.com/archives/CFC42LWBV/p1620925090232000?thread_ts=1620883840.222800&cid=CFC42LWBV]

what we have already, of course, is TableColumnOrderService, which is a terrible but rather handy kludge.... it works surprisingly well.

In olden days, before we had layout.xml, the (recently deceased) {{@MemberOrder}} sufficed both for the order of fields on an object form, and for the order of columns in a table.  But we are well beyond that now.  So I think that the table column order should be specified through a completely different mechanism.

Suggestions:

1. One is to extend {{@PropertyLayout}} with a new element just for column order, eg {{@PropertyLayout(columnOrder=""1.0""). }}We would use dewey decimal to allow subtypes to ""slot"" any columns in as nec.

2. Another annotation-based idea is something like:
@DomainObjectLayout(columnOrderBy=CustomerColumnComparator.class)
public interface Customer {
}
3. A different idea is to specify this in a separate file, eg ""ApplicationUser.columnOrder.txt"".  That could then be changed at runtime, same as layout files, and could support commenting out as well in order to hide columns.

A separate ongoing spike is to allow actions also being in the table.  So whatever option, it would be nice to anticipate this.  

~~~

Riffing on (3), each row could represent either a property or an actionId.  We would provide a service to download it (same as Object_downloadLayout currently).

eg:
{code:java}
# properties (this row starts with a '#' so is a comment and is ignored)
firstName
lastName
emailAddress

# actions.  These would be shown in a separate column as a drop-down.
resetPassword    # allow comments here also.  
updateEmail      
updateFamilyName
updateGivenName
updateKnownAs

{code}

 

 

 "
ISIS-2675,New Feature,Closed,[WON'T FIX] Object_ mixins should only be contributed to entities and view models.,At the moment we contribute these mixins to simply java.lang.Object.  But we could cut down the size of the metamodel substantially by only contributing to objects that can be accessed through the UI.
ISIS-2674,New Feature,Closed,Collections of Interfaces do not show columns (eg ApplicationUser#getRoles()),"as per [https://the-asf.slack.com/archives/CFC42LWBV/p1620884365223300?thread_ts=1620883840.222800&cid=CFC42LWBV]

 "
ISIS-2673,New Feature,Closed,"Rationalize secman fixture scripts.  In  particular, all regular users of secman should be granted isis.security.LogoutMenu",done as part of ISIS-2619
ISIS-2672,New Feature,Closed,Consider promoting the feature dom out of secman and up into core.,It's pretty cool to be able to navigate around the metamodel as entities.  Suggest we promote it.
ISIS-2671,New Feature,Closed,[WON'T FIX] Extend ApplicationRole to show the inferred permissions (similar to ApplicationUser),"I'm trying to understand what the SecmanConfiguration#getFixtureRoleName() represents.  Its javadoc says: 

Role to run in the prototype fixture scripts for the example webapp for the security module.

However it is granted namespace allow/change to ""isis.ext.secman"", which I suspect implies a lot more access than that.

ApplicationUser shows which features are accessible for the user, along with why.  I'm thinking something similar (but probably a bit simpler) would be helpful here for ApplicationRoles also."
ISIS-2670,Bug,Closed,Bootstrap tooltips do not disappear,"For example, with secman enabled and open up 'sven' (admin user),then the tooltip to prevent access to the 'delete' action on ApplicationUser never disappears."
ISIS-2669,Bug,Closed,"When both Wicket- and RO-Viewer are provisioned, REST requests fail due to HttpSession creation not allowed",
ISIS-2668,Improvement,Closed,Suppress Object_objectType and Object_objectIdentifier unless for entities.,"I've noticed that these are appearing on view models, but they only really have value for entities.  Therefore propose we simply hide them unless for a view model."
ISIS-2667,Improvement,Open,[JUnit] Parameters syntax for dependent params seems to trip MM validation for non-mixins of a domain service.,"attempting to workaround issue in ISIS-2666, but got no further. Less far, in fact,

as per [https://cwiki.apache.org/confluence/display/ISIS/ActionParameters]

This code fails on bootstrapping.  Note that a mixin example in the demo ([https://github.com/apache/isis/blob/master/examples/demo/domain/src/main/java/demoapp/dom/domain/actions/progmodel/depargs/DependentArgsActionDemo_useDefault.java#L52)] does work fine.

 

!image-2021-05-12-17-11-17-896.png|width=971,height=764!"
ISIS-2666,Improvement,Closed,Defaults callback for dependent vector param is never called when change preceding param arg.,"[|https://cwiki.apache.org/confluence/display/ISIS/ActionParameters]in ISIS-2619, attempted to use in ImpersonateMenu#impersonateWithRoles.

 

!image-2021-05-12-17-07-28-628.png|width=875,height=568!"
ISIS-2665,Improvement,Closed,@Action(associateWith=) requires separation of layout and behavioral concerns,"* we rename @Action(associateWith=) -> @Action(choicesFrom=) ... this is an action concern not a parameter concern, as there can only be one selection provider per action
* we introduce @ActionLayout(associateWith=) so that we have the layout concern separated from the behavioral concern
* @Action(choicesFrom=) implies @ActionLayout(associateWith=) but not the other way around

As a follow up the demo needs to be updated."
ISIS-2664,Bug,Closed,"[Regression] Collection Panel: associated actions are not showing up, if the assoc. is specified in the layout.xml only","Seeing this with a mixed in action, that is also referenced in the layout.xml where it is associated to a collection, but does not have the associatedWith attribute with the @Action annotation."
ISIS-2663,Bug,Open,Presence of a member support method interferes with 'named' attribute from layout.xml,"
Martin Willitts May 10th at 21:14
I’m using layout.xml and setting a field label in there. When I include disableXX in the corresponding class then the field label from layout.xml is ignored."
ISIS-2662,Improvement,Closed,Get ready for Maven 3.8.x,"Its maybe worth reading through https://maven.apache.org/docs/3.8.1/release-notes.html before upgrading from maven 3.6.x, as there is one significant change:

QUOTE:
This is not just a bugfix as it contains three features that cause a change of default behavior (external HTTP insecure URLs are now blocked by default): your builds may fail when using this new Maven release, if you use now blocked repositories. Please check and eventually fix before upgrading."
ISIS-2661,Bug,Closed,[Regression] Parented Collections: some associated actions are not showing up,"eg. Demo Action#associateWith ... Children should show 3 actions, but only shows 1"
ISIS-2660,Improvement,Closed,"For starter apps, remove persistence.xml (we can get by without it).","its presence seemed to mask out an issue with h2 and prototyping, where DN failed to create the tables due to no schema.

In the entity, we had:
{code:java}
@PersistenceCapable(schema=""organisation"") {code}
and in application.properties, we declared :
{code:java}
isis.persistence.schema.auto-create-schemas=organisation {code}
 However, lower-case schema seemingly aren't supported by h2; these are created upper case, at least.

So, the above doesn't work, we see this error when try to interact with table:
{code:java}
An exception was thrown while adding/validating class(es) : Schema ""organisation"" not found; SQL statement:
CREATE TABLE ""organisation"".""Currency""
(
    ""id"" BIGINT NOT NULL IDENTITY,
    ""name"" VARCHAR(50) NOT NULL,
    ""reference"" VARCHAR(24) NOT NULL,
    ""version"" BIGINT NOT NULL,
    CONSTRAINT ""Currency_PK"" PRIMARY KEY (""id"")
) [90079-200]
org.h2.jdbc.JdbcSQLSyntaxErrorException: Schema ""organisation"" not found; SQL statement:
CREATE TABLE ""organisation"".""Currency""
(
    ""id"" BIGINT NOT NULL IDENTITY,
    ""name"" VARCHAR(50) NOT NULL,
    ""reference"" VARCHAR(24) NOT NULL,
    ""version"" BIGINT NOT NULL,
    CONSTRAINT ""Currency_PK"" PRIMARY KEY (""id"")
) [90079-200]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:576)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:429)
	at or {code}
 

The fix is to make everything upper case.  
{code:java}
@PersistenceCapable(schema=""ORGANISATION"") {code}
 

 Now, for a while it looked like the persistence-unit name mattered, but it was a red herring; everything works with or without this file.
{code:java}
<?xml version=""1.0"" encoding=""UTF-8"" ?>
<persistence xmlns=""http://java.sun.com/xml/ns/persistence""
 xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""
 xsi:schemaLocation=""http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd"" version=""1.0"">
<persistence-unit name=""organisation"">
 </persistence-unit>
</persistence>
  {code}
 

So, to avoid chasing phantoms, let's just delete this file.

 

 "
ISIS-2659,Improvement,Closed,@DomainObject(autoCompleteAction=) should be renamed to autoCompleteMethod,"That's because the method referenced doesn't need to be an action.  Indeed, typically it will be just another method on a repository.

 "
ISIS-2658,New Feature,Closed,Factor out BDD specs as a separate surefire execution so can turn on or off via system properties.,
ISIS-2657,Bug,Closed,"If action parameter first field is an auto-complete drop-down, then it doesn't get focus.","This might have been an issue for a while, or perhaps due to the bootstrap upgrade.  

Looking at jquery.isis.wicket.viewer.js, I see:
{code:java}
Wicket.Event.subscribe(Isis.Topic.FOCUS_FIRST_PARAMETER, function(jqEvent, elementId) {
    setTimeout(function() {
        $('#'+elementId).find('.inputFormTable.parameters').find('input,textarea,select,div.cbx').filter(':visible:first').focus();
    }, 0);
});
 {code}
while inspection of what has focus suggests that instead of <select> that it should be <span class='select2'>

!image-2021-05-11-17-44-13-862.png!"
ISIS-2656,Bug,Open,@DomainServiceLayout(name=...) seems to have no effect. Should either...,"It's original intent was to define the menu to slot into.  And there was some hokey stuff to do with the action (@MemberOrder) sequence from which we inferred the order of the menus themselves.

We need to rationalise this.  I suggest:
 * we use menubars.layout.xml to define the order of the top-level menus, with no annotation equivalent.  This is analogous to how rows, cols, fieldSets and tabs are only ever specified in object layouts with no annotation equivalent (ie the ""higher level structure"").
 * we use @DomainServiceLayout(name=""..."" to identify the name of the menu to slot into.  Within this, sequence is used to order across all other menu services that might be contributing actions to that menu.  these would go into an un-named section of the service.
 * We add a new element @DomainServiceLayout(sectionName=...)  If specified, then the items would go into that section, if it exists in the menubars.layout.xml, with the sequence then  being the order of actions in that section.  Again, this is the higher-level structure thing. 
 * We would provide NO annotation for defining the order of the sections, these would only be in the menubars.layout.xml.

to summarise:
 * menubars.layout.xml defines the order of menus, and the order of the sections within the menus
 * @DomainServiceLayout(name=...) - identifies the menu
 * @DomainServiceLayout(secitonName=...) - identifies the section within that menu
 * @ActionLayout(sequence=...) defines the order of the actions within the section of the menu.  This is either the unnamed-section (if sectionName=... is not defined) or in the explicitly named section (otherwise).

 "
ISIS-2655,Improvement,Closed,"""You have been redirected"" message gets in the way of prototypine menu.",perhaps allow the position of the message to be configured so that it doesn't obstruct the prototyping menu etc.
ISIS-2654,Bug,Open,ImpersonateMenu's items does not automatically slot onto tertiary menu bar.,
ISIS-2653,Bug,Closed,"Meta-annotation with JDO @Column(allowNulls=""true"") not picked up.",We see this in simpleapp snapshot ([https://simpleapp.jdo-snapshot.isis.incode.work)|https://simpleapp.jdo-snapshot.isis.incode.work%29/] where SimpleObject's notes property is now mandatory.
ISIS-2652,Bug,Closed,"simpleapp's SimpleObject.layout.xml throws metamodel errors unless fieldSetId=""..."" is defined also.","Observed with latest nightly, but probably introduced a while back after M5.

2.0.0-M5.20210511-0427-5af25b07

To reproduce, run up simpleapp from IDE against this nightly.

 "
ISIS-2651,Improvement,Resolved,"JDO bootstrapping for h2 seems to only lazily create tables.  For reliability, create all up-front.","Our updated JDO integration no longer seems to eagerly create tables on bootstrap, instead creates them when first accessed.

With our previous integration, this proved to be an issue with superclass tables when DN didn't have the full meta-model to hand.  It would be safer to create all up-front."
ISIS-2650,Bug,Closed,[DUPLICATE] Support domain events for property and collection mixins,"duplicate of ISIS-2235

At the moment we have to use a workaround of emitting action domain events

 

In particular, need to address for two framework-provided mixins:
 * Object_logicalTypeName
 * Object_objectIdentifier"
ISIS-2649,Bug,Closed,[WON'T FIX] Regression: ObjectSpecification Predicates isEntity() and isViewModel() are always false when abstract,"the {{ObjectBulkLoader_builtinHandlers.BulkLoadEntity}} could just handle the abstract types as well

the {{isHandling(ObjectBulkLoader.Request objectQuery)}} method should probably just ask if the spec has an EntityFacet, independently of the BeanSort"
ISIS-2648,Improvement,Closed,Wicket: simplify collection models and member mementos,I have some refactoring in mind. Ultimately the Wicket Viewer should not bake its own memento logic. I see this responsibility rather moved to the framework's core.
ISIS-2647,Improvement,Closed,DB connection leak with DataSourceIntrospectionService,"Properly close all connections, once we have the meta-data."
ISIS-2646,Wish,Open,[Project Rename] Update layout namespace (bs3->bs),"Dan: For BS3 Grid, I suggest perhaps we rename it to BSGrid or BootstrapGrid, just remove the version from the name.  Because even if in each version of Bootstrap there are changes and improvements, I think at our level of abstraction we don't care about that detail."
ISIS-2645,Bug,Closed,Unreferenced Action not showing up,"The Object_inspectMetamodel mixin action should show up on every entity page when PROTOTYPING, yet it does not on the ApplicationNamespace view model."
ISIS-2644,Improvement,Closed,Remove Persistable_datanucleusIdLong ... duplicated by Object_objectIdentifier,
ISIS-2643,Bug,Closed,Dependent default parameters don't refresh,"For example, secman's impersonateWithRoles - if select a user in param 0, then its roles are defaulted in param 1.  But if select a different user, the roles are no longer defaulted."
ISIS-2642,Bug,Closed,"Wildcard Generic Type Args are not properly detected, always using Object instead","ParameterizedType detection generally misses Wildcard bounds. Always falls back to Object.

eg. List<? extends Customer> has TypeOfFacet with element type Object.class while it should be Customer"
ISIS-2641,Bug,Closed,SecMan: abstract ApplicationFeatureViewModel.getPermissions() renders with missing columns,"Regarding the interface ApplicationPermission in SecMan, it seems that the pure interface doesn't get picked up as domain object during introspection, which is why all the columns are missing from the Permissions table when viewed from within an ApplicationFeatureViewModel, as compared to when viewed from a JDO entity such as ApplicationRole, then all columns in the Permissions table do show up."
ISIS-2640,Improvement,Closed,Spring @Profile support,"We have support for @Vetoed and @Programmatic at type level. In addition we should also support Spring's @Profile annotation, to allow for the framework to decide at runtime, which types must not contribute to the meta-model.

A valid use-case is the demo-app, that we want to either showcase JDO or JPA features.
2 profiles 'demo-jdo' and 'demo-jpa' are used, to decide what persistence stack to provision and what is effectively shown/hidden with the demo."
ISIS-2639,Improvement,Open,[kroviz] Incoming Events Update Object as well as Lists (containing the Object),"The state of the model-user interaction is kept in the EventStore. The ES logs all request/response pairs (LogEntry) and for each holds 1:n relations to Aggregtators.
An Aggegator may be related to many LogEntries (resulting in m:n in total) and acts as a facade to the DisplayModel. DM's are rendered by views (RoDisplay). Incoming updates refresh the views.
For kroviz the scenario you described boils down to: an updated entity may be part of an additional object list as well (and it's Aggregator/RoDisplay pair).

There needs to be an (additional) relation between certain LogEntries and/or their Aggregators to handle this .

See: https://the-asf.slack.com/archives/CFC42LWBV/p1619869133072400?thread_ts=1619867697.070300&cid=CFC42LWBV "
ISIS-2638,Bug,Closed,"Dependent defaults seems to be broken, eg impersonateWithRoles","as per helloworld's impersonateWithRoles

when select a user from param 0, then the current defaults for that user should be provided automatically."
ISIS-2637,Improvement,Closed,TitlesAndTranslationsValidator should possibly be implemented as a PostProcessor instead,
ISIS-2636,Bug,Closed,TableColumnOrderForCollectionTypeAbstract should return null for non-recognised collection types,
ISIS-2635,Improvement,Closed,Add TableColumnVisibilityService so that implementations can be used for filtering only.,"... so that we can have an implementation that filters out columns due to security but otherwise leaves stuff unchanged.

 "
ISIS-2634,Wish,Open,[Wish] Wicket UI should not show a tab if no members visible,"By members, we mean either properties or collections.

I could replicate this with a new mixin property for HelloWorld that was not bound to any of the fieldsets (set ended up in ""Other""), but where I had security that hid that property - as in testing ISIS-2619."
ISIS-2633,Improvement,Closed,Quieten DN warnings if 1:N mismatch in ApplicationTenancy hierarchy,"2021-04-30 07:19:26.695 INFO 47300 --- [ main] D.Persistence : Object ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy@53d94a6b"" has field ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy.parent"" with an N-1 bidirectional relation set to relate to ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy@4707d60a"" but the collection at ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy.children"" doesnt contain this object.
2021-04-30 07:19:26.709 INFO 47300 --- [ main] D.Persistence : Object ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy@608448e7"" has field ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy.parent"" with an N-1 bidirectional relation set to relate to ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy@4707d60a"" but the collection at ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy.children"" doesnt contain this object.
2021-04-30 07:19:26.717 INFO 47300 --- [ main] D.Persistence : Object ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy@76dc9569"" has field ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy.parent"" with an N-1 bidirectional relation set to relate to ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy@4707d60a"" but the collection at ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy.children"" doesnt contain this object.
2021-04-30 07:19:26.725 INFO 47300 --- [ main] D.Persistence : Object ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy@41413c5a"" has field ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy.parent"" with an N-1 bidirectional relation set to relate to ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy@4707d60a"" but the collection at ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy.children"" doesnt contain this object.
2021-04-30 07:19:26.725 INFO 47300 --- [ main] D.Persistence : Object ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy@3e2a8fc"" has field ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy.parent"" with an N-1 bidirectional relation set to relate to ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy@4707d60a"" but the collection at ""org.apache.isis.extensions.secman.jdo.dom.tenancy.ApplicationTenancy.children"" doesnt contain this object."
ISIS-2632,Improvement,Closed,"An error in security seed scripts results in none being installed, but no warning or stacktrace to diagnose from.","For example, if I forget to run the fixture script to set up a role, and then attempt to create a user that has that role, I get no error but none of the fixture scripts are installed)."
ISIS-2631,Improvement,Closed,"Make terminology consistent in applib (@DomainObject(objectType=...), TableColumnOrderService, ApplicationFeatureId, BookmarkService)","we have logicalTypeName and objectType, that are the same thing.  The latter has been around longer so think we should use that

in ApplicationFeatureId, we have memberName, but in TableColumnOrderService we have propertyId.  ""Id"" is the correct nomenclature, a ""name"" is usually a friendly name as appears in the UI."
ISIS-2630,Bug,Closed,Regression: SecMan User's Permission Tab is gone,"On the ApplicationUser Detail Page also most Associated Action Buttons are gone. 

I suspect the issue is somehow related to permission handling with mixins. The demo from 21th of April is still working. "
ISIS-2629,Improvement,Closed,Wicket BS4 Regression: Disabled Action buttons should have mouse cursor disabled style,
ISIS-2628,Bug,Closed,Wicket BS4 Regression: Property edit button tooltips don't dissapear on inline edit,"See eg. demo Action#command: click on an update action with tooltip, at that moment tooltip should disappear, but it does not.
"
ISIS-2627,Bug,Closed,"SecMan: UserPermissionViewModel, IllegalArgumentException when username contains a colon (:)",The encoding used should account for colons as valid username characters.
ISIS-2626,Improvement,Closed,Do not serve HTTP requests until the Application is fully initialized.,"That's currently a denial of service vector, as HTTP requests that happen too early during bootstrapping have the side effect of triggering meta-model validation too early, which leaves the application in an unusable state. As meta-model validation, while yet only partly inspected, will most likely lead to a validation failure that renders the application permanently broken until restarted."
ISIS-2625,Bug,Closed,Removing access to a property nevertheless shows as column in table for user.,"the user is not allowed to see the data, so it is not critical, but they shouldn't even be aware that the field/column exists."
ISIS-2624,Improvement,Closed,[WON'T FIX] Changing the seeding password for an existing admin user should update the password,"Can you explain this a little more, [~mwhesse] ?"
ISIS-2623,Bug,Closed,Regression: DomainObject's property setter may never be interpreted as an action,
ISIS-2622,Improvement,Closed,CommandLog: split impl into JDO and JPA variants,"We are supporting 2 persistence stacks, so need to split the implementation in support of JPA."
ISIS-2621,Improvement,Closed,Allow for usernames with more than 30 characters in SecMan,Some (delegate) users may have usernames (i.e. email addresses) longer than 30 characters
ISIS-2620,Improvement,Closed,Demo: create a JPA stack based variant,"Not strictly a requirement, to make progress with value type support for the JPA stack, but would be very convenient."
ISIS-2619,Bug,Closed,TenantedAuthorizationFacetFactory should not use Mixin Class to filter evaluators,"{{InteractionUtils.isUsableResult(FacetHolder, UsabilityContext)}} is being called for facetHolders of type {{ObjectActionMixedIn}}, but these are missing a facet of type {{TenantedAuthorizationFacetDefault}}

{{In the }}{{TenantedAuthorizationFacetFactory t}}{{he }}{{applicationTenancyEvaluator.handles}}{{ method is being called with the Mixin Class and returns false. Instead it should be called with the type towards which the Mixin is contributing}}

{{[https://github.com/apache/isis/blob/53e535fd08e9dae4580fb8de7179b10620c14a69/extensions/security/secman/model/src/main/java/org/apache/isis/extensions/secman/model/facets/TenantedAuthorizationFacetFactory.java#L96]}}

{{}}"
ISIS-2618,Improvement,Closed,ConcurrentModificationException with MethodFinderUtils.findAnnotatedMethod,Seen in the context of the MM ObjectLoader during VM recreation.
ISIS-2617,Improvement,Closed,Upgrade Bootstrap 3 to 4 (WicketStuff),
ISIS-2616,Improvement,Closed,Auto-select fixture script in drop-down if only one,
ISIS-2615,Improvement,Closed,Clean up configuration view model a tiny bit,"!image-2021-04-15-08-45-11-847.png|width=434,height=286!

^^^ this metadata panel is distracting and doesn't inform.

 "
ISIS-2614,Improvement,Closed,productionise secman a bit more (finish off ImpersonsateUserAdvisor),"DONE: use abstract superclasses, single layout

FIXED: don't allow user to see their permissions.

FIXED: veto viewing only disables (eg ApplicationUser#addRole or #lock actions for a regular user).

FIXED:
 * accidentally created two roles with the same identifier.  This resulted in no fixtures being seeded.  My guess is there was an unlogged SQL exception.

 
{code:java}
public class RoleAndPerms__UserRw extends AbstractRoleAndPermissionsFixtureScript {

  public RoleAndPerms__UserRw() {
    super(""user-rw"", 
          ""Read-write access to entire application"");   
  }
  // ... 
} {code}
and (by mistake)...
{code:java}
public class RoleAndPerms__UserRo extends AbstractRoleAndPermissionsFixtureScript {

  public RoleAndPerms__UserRo() {
    super(""user-rw"",                                    <<<<< my mistake was here
          ""Read-only access to entire application"");   
  }
  // ...
}{code}
 

 

 

DONE - update the @Configuration's, make sure they declare the correct services

DONE (enough) - update the docs (pre- and post- hooks etc).

 

specifically:
 * DONE - clean-up @Configuration imports and service definitions (so there is less config needed for framework user)
 * DONE - clean-up layouts.
 ** [https://github.com/apache/isis/pull/490]  (Martin Hesse's change to dialog modal)  ... already merged to master
 ** implement as "".fallback"" layouts.
 * DONE - write missing documentation on how to configure

 

 "
ISIS-2613,Improvement,Closed,"To reduce CI build time, split out regression tests into multiple modules, so that they can run in parallel","using [https://github.com/mvndaemon/mvnd] :

mvnd clean install -Dmodule-all -o

 "
ISIS-2612,Improvement,Closed,Promote @Model annotation to Applib (maybe find a better name also),Its use is optional anyway. In turn allows us to get rid of one maven module.
ISIS-2611,Bug,Closed,"for simpleapp, the Smoke_IntegTests seem to be run twice (by two different surefire executions).",This is probably an error in our to-level isis starter app.
ISIS-2610,Improvement,Closed,Add Permission (to role) action in SecMan should use modal dialogue,"The Feature FQNs tend to become quite long, using a modal action panel could improve readability/usabilty"
ISIS-2609,Improvement,Closed,PrincipalForApplicationUser should use the ApplicationUser username,"Currently the PrincipalForApplicationUser uses the ApplicationUser FQ name from ""getName()"" as username, making the principals toString() method return the built-up qualified named of the user (""Firstname Lastname (email)"") if firstname and lastname are defined, otherwise just the email address or the username."
ISIS-2608,New Feature,Closed,Extend Wicket viewer to show avatarUrl and realName on header (if available),
ISIS-2607,New Feature,Closed,Decouple SecMan from the authenticator API that is in use.,
ISIS-2606,New Feature,Closed,Extend UserMemento to include gravatar URL,
ISIS-2605,New Feature,Closed,Allow spring security to handle arbitrary authenticated principals (SPI),
ISIS-2604,Improvement,Closed,Metamodel: don't allow annotations to occur more than once for mixins,"Fail validation if @Property @Action @Collection and their layout counterparts appear on both type and method level. It must be either one or the other (old or new programming style). 

However, mixing these styles should be allowed, as there is no ambiguity in interpreting the meta-model."
ISIS-2603,Improvement,Closed,[WON'T FIX] Simplify layout styles (that are available for download when prototyping),"Reduce currently 4 to just 2:
# COMPLETE ... which in effect adds all the layout metadata into the XML.  This would allow the @XxxLayout annotations to be removed from the code.
# MINIMAL ... with the intent of providing only the fieldsets and tabs with the @XxxLayout annotations being used to bind the object members into the correct place"
ISIS-2602,Improvement,Closed,"Programming Model: add @ActionLayout/@PropertyLayout(fieldSetId=..., fieldSetName=...)","1. In the XML, every fieldset has an `id`, though it may be inferred from a non-empty `name`.  (If the name is empty """" or missing, then the id is mandatory).
2. We place a property in a fieldset either by locating within the XML, or by using `@PropertyLayout(fieldSet=...)`.  If the latter then `@PropertyLayout(sequence=...)` is then the relative position within that fieldset.
3. We can associate an action with a property or collection using `@Action(associateWith=...)`.  This will be positioned close to the property/collection, either under it or on the header panel depending on other layout facets.
4. We can override (3) using `@ActionLayout(fieldSet=...)`.  In such a case, the action is placed on the panel.
5. We take the fieldset name and pass it to the TranslationService along with a context.  As with all translations, if none is available then the name is returned unchanged.  For this reason it is the fieldset name (not its id) that is passed in to translations.
6. For the context of a fieldset name translation, we use a construct `com.mycompany.Customer~fieldSets`.  We DON'T indicate the id of the fieldset, the human translator doesn't need that detail.
7. Similar, we take the tab name and pass it through to be translated.
8. For the context of a tab, we use a construct `com.mycompany.Customer~tabs`.  Again, no more detail than that is needed by the human translator."
ISIS-2601,Improvement,Closed,Remove ActionPrompt page from Wicket viewer (unused),
ISIS-2600,Improvement,Closed,Remove microprofile from incubator,
ISIS-2599,Task,Closed,Purge Legacy Modules,also remove microprofile (incubator)
ISIS-2598,Wish,Open,"[Wish] field set name is not being translated, perhaps labels also","per[https://the-asf.slack.com/archives/CFC42LWBV/p1617681577197100?thread_ts=1617614189.183900&cid=CFC42LWBV]
  
 I still struggle to understand why the ""{{name}}"" of a {{MemberOrderFacet}} should ever need to be translated. It even seems like when the memberOrderName is in fact translated then it won't match the name or the ID of an object association anymore, potentially breaking some functionality.
  
 Also in terms of classifying/filtering what needs to be translated and what not, the context of a member order should have some qualifying suffix, such as ""~memberOrderName"" 

 

*Label captions*

I'm also looking at why the label captions for scalars are not translated anymore when rendered (edited) 

*Panel Headers:*

and it seems the panel headers are also not being translated when rendered

Seems the GridSystemService is replacing the NamedFacetTranslated installed by the TranslationFacetFactory when visiting a grid

or at least they get somehow lost in the ""action"" "
ISIS-2597,Bug,Closed,Prevent duplicate info messages being rendered,
ISIS-2596,Improvement,Closed,Use Identifier#getTranslationContext() consistently,"from [https://the-asf.slack.com/archives/CFC42LWBV/p1617614428185000?thread_ts=1617614189.183900&cid=CFC42LWBV]

 

Provide more context to TranslationService for collections.

 
 The VisitorAdapter that handles the translations does not implement visit for FieldSets, rather the translations for FieldSets are picked up during the traversing of properties, but then all the context goes missing for some reason
  
 it would be nice to have more than the class name as context I guess
  
 maybe the {{MemberOrderFacetXml}} facet that does the ordering of the members shouldn't also handle translations? There seems to be quite a few cases where it makes more sense to use the ID for ordering, but then the ID is not the text that should be translated I guess

 

It seems that the context that the MemberOrderFacet is passing to the translation service is a different one than the context passed to the translation service during the metamodel introspection for the same piece of text ... `MemberOrderFacetAbstract` line 72.

 
Just passing the className is a mismatch with the context that is used by the TranslationFacetFactory 


        final String context = holder.getIdentifier().getTranslationContext();
 
Question is why the context is computed differently
 
Andi introduced that method quite recently, I think this is one area which probably always had a bug lurking and we didn't refactor it to the new style ... *So,  we should just change it I think.*
 
Consistently using the translation context of the IdentifiedHolder should fix a good number of misaligned cases between the translation facet factory and the member order facet.
 

 "
ISIS-2595,Improvement,Closed,Translation context should be provided consistently for collections/properties/services ...,"... as to whether an id or a name is used.

 

from [https://the-asf.slack.com/archives/CFC42LWBV/p1617614189183900]

 

Regarding translations, it seems that currently the ID of a collection is used as the reference text, not the name from the layout data

 
 Line 317 in the GridSystemServiceAbstract class:
 final String groupName = collectionLayoutData.getId();
 final String sequence = """" + collectionSequence++;
 addOrReplaceFacet(
 new MemberOrderFacetXml(groupName, sequence, translationService, oneToManyAssociation));
 groupName is then passed to the translation service as reference text
  
  
 This is different from how properties work; (not looked at actions)
  
 This is in the visitor for CollectionLayoutData.
  

~~~
To distill this: *why are the IDs of layouts used as reference texts for translations ?*
 
 
 

  
  "
ISIS-2594,Improvement,Closed,Add EclipseLink configuration property support,"To improve the development experience with drop-downs , also autogenerate the documentation."
ISIS-2593,Improvement,Closed,Recognize eclipselink.* configuration options and pass them over to the EclipseLink integration.,
ISIS-2592,Improvement,Closed,Fix schemas for secman (JDO and JPA) to be in line with the owning module.,
ISIS-2591,Bug,Closed,source release seems to zip up node_modules & datanucleus.log,"For datanucleus.log, this just needs to be zapped beforehand.

For the short term (while we aren't yet releasing kroviz and vaadin), perhaps just need to ensure that these modules are not built as part of the pre-release steps, and to run ""git clean -dfx"" before hand.

For the longer term (when either of these are released), we may need to locate node_modules outside of the repo's directory (akin to ~/.m2/repository for maven dependencies)"
ISIS-2590,Bug,Closed,MessageService informUser messages not presented in the UI,"Any message passed to the MessageService service is not presented in the user interface (Wicket Viewer).

I observed this first in my own app that I migrated to use a locally built version of M5-rc2 (compiled on JDK8) when using the informUser (or warnUser) method on MessageService.

I verified the behaviour on the standard HelloWorld app. The delete() method on HelloWorldObject does not trigger a message when invoked via the UI even though it has the code:
{code:java}
messageService.informUser(String.format(""'%s' deleted"", title){code}"
ISIS-2589,Improvement,Closed,Remove usage of deprecated Wicket API ClientProperties.isBrowserInternetExplorer(),"Used here to detect whether to add bootlint to the response

https://github.com/apache/isis/blob/master/viewers/wicket/ui/src/main/java/org/apache/isis/viewer/wicket/ui/pages/PageAbstract.java#L320"
ISIS-2588,Bug,Closed,Icon size in breadcrumb misaligned with font size,"The icons in the breadcrumb menu are misaligned with the font size. Solution would be to implement this CSS instruction:
.whereAmI .fa-2x {
    font-size: unset;
}"
ISIS-2587,Bug,Closed,[WON'T FIX]Navigable parent not updated in breadcrumb panel,"the navigable parent in the breadcrumb menu doesn't update when changed, i.e. an action that changes the parent (moves an object), the action returns the object with the changed parent --> the navigation item in the breadcrumb menu still shows the old parent"
ISIS-2586,Bug,Closed,ServiceInjector cannot handle null argument,"For ServiceInjector#injectServicesInto(T domainObject) make domainObject nullable.

Otherwise potentially results in Illegal arg. ex."
ISIS-2585,Bug,Closed,"""(none)"" label not hidden after entity-type property set ",Null (=empty) object references are displayed in the UI with the literal '(none)'.
ISIS-2584,Improvement,Closed,Disable CORS for SimpleApp,"See [https://the-asf.slack.com/archives/CFC42LWBV/p1616416095067200]

 

Also update docs (simpleapp.adoc) to explain what's been configured, and why (and how to change it)."
ISIS-2583,Bug,Closed,NPE from ConfigurationViewServiceDefault if there are NO datanucleus.* properties defined.,"as is the case for JPA variants.

 

Workaround is to define a single unused datanucleus.* property.

 

I imagine this would also NPE if no resteasy.* properties defined, similarly."
ISIS-2582,Bug,Closed,Wicket: NPE when ComponentHintKey#hintStore not restored on deserialization,
ISIS-2581,Improvement,Closed,Clean up configuration properties for DN and RestEasy,"* an isis-specific config property for resteasy should be moved from resteasy.* to isis.viewer.restfulobjects.*
 * move implementation of RestfulPathProvider
 * remove ""as-map"" appearing in the XxxConfiguration and therefore remove from the generated docs.

 "
ISIS-2580,Bug,Closed,Duplicated UI notification on DataAccessExceptions.,"To reproduce with simpleapp and sqlserver on both JPA and JDO.

Attempt to create two objects with the same name. An unnecessary toast message appears.

"
ISIS-2579,Bug,Closed,Wicket/JPA: entity deletion does not redirect to homepage,"Dan Haywood:
which is, if I create an object in simpleapp, and then delete it, the viewer stays on the page of the just-deleted object (instead of redirecting to the home page).
(In jdo this seems to work fine.)


"
ISIS-2578,Task,In Progress,Address known Issues/Limitations for JDO/JPA,"JDO Stack:
* DN enhancer supports up to Java 15; Java 16 not supported yet
* No injection points resolved on entity collections as fetched by JDO.
* Entity Change Tracking not working.

JPA Stack:
* No special value type support (Blob, Clob, Markdown, ...).
* No Entity Change Tracking (Application Layer Integration).
* No injection points resolved on entity collections as fetched by JPA.

SecMan Extension:
* Cannot set permissions on mixins, only on their mixees. (eg. 'Clear Hints') -> NOT AN ISSUE"
ISIS-2577,Bug,Closed,Potential NPE when clearing a scalar property.,"Martin Hesse:
I think there is a ""bug"" in the MemberExecutorServiceDefault, in the method setOrClearProperty the parameter final @NonNull ManagedObject newValueAdapter is called with a null argument from the PropertySetterOrClearFacetForDomainEventAbstract:
return setOrClearProperty(EditingVariant.CLEAR,
   owningProperty, targetAdapter, /*newValueAdapter*/ null, interactionInitiatedBy);
I don't think it needs the @NonNull annotation, as far as I can see the unwrapping can handle null"
ISIS-2576,Bug,Closed,favicon missing from signin page,
ISIS-2575,Improvement,Closed,PanelAbstract found to be suspectious generic by the IDE because of erasure clash.,"Due to the generic handling of Wicket and Isis, there is an annoying error message in IDE (IntelliJ (IntelliJ IDEA 2020.3.2 (Ultimate Edition) Build #IU-203.7148.57) and Eclipse as well):

{{'setDefaultModel(IModel model)' in 'org.apache.wicket.MarkupContainer' clashes with 'setDefaultModel(IModel model)' in 'org.apache.wicket.IGenericComponent'; both methods have same erasure yet neither overrides the other}}

It is displayed on every class which is PanelAbstract descendant. The root cause is the generic-raw-generic inheritance tree branch: PanelAbstract is a generic parametrized by IModel, and its ancestor, PanelBase is originally  a generic parametrized by the content of the IModel.  Basically PanelAbstract should be declared as 
{code:java}
class PanelAbstract<U, T extends IModel<U>> extends PanelBase<U>  ...
{code}
Of course, this is inconvenient and repetitive, but Java can't infer U from T. 

 

So it is fair cause to use raw type in-the-middle to change, ""unbox"" the parameter. But this cause a huge mess in the IDE. Two ancestors of PanelAbstract  has the same method: setDefaultModel in IGenericComponent<T, GenericPanel<T>> (which is generic, and the method is default) and MarkupContainer (which is NOT a generic) won't match any more, although their erasure won't be different: the compiler complains.

There is a comment in PanelAbstract about this solution describing it suspectious.



My suggestion to solve this problem:



Simply make the PanelBase to be raw, using Panel instead of GenericPanel<T>:


{code:java}
public class PanelBase extends Panel implements HasCommonContext {
{code}
 

 

This simply solves the problem, and removes the generic-raw-generic ancestor tree mess (Panel and its ancestors are raw types), makes the inheritance cleaner.

There are some places where PanelBase is used directly, but these can be solve easily as most of them are PanelBase<Void>.

 

Other solution is to keep the generic:


{code:java}
public abstract class PanelAbstract<T extends IModel<?>> 
extends PanelBase<Object>
{code}

but getModel will return IModel<Object> which is not compatible to T of course, so we need another method, for example getPanelModel() which returns T. This need more refactoring, so I suggest the first.

 

 

It is a minor problem, but very annoying to develop new PanelAbstract descendant, so I would be happy to see a solution.

 

Some links, in connection with this problem:
https://issues.apache.org/jira/browse/WICKET-6804
https://stackoverflow.com/questions/51931500/wicket-8-wicket-setdefaultmodel-clashes-with-setdefaultmodel

 

 "
ISIS-2574,Improvement,Closed,[WON'T FIX] Swagger: Harmonize dependencies of metamodel and vaadin viewer,"maven artifacts 
io.swagger.core:swagger-core moved to 
io.swagger.core.v3:swagger-core"
ISIS-2573,Bug,Closed,Regression-Testing: add entity change publishing tests,Entity Change Publishing (JDO) is currently not triggered.
ISIS-2572,Bug,Closed,RO/Swagger: Generated schema offers outdated urn:org.apache.isis/v1,Generator class should instead offer urn:org.apache.isis/v2
ISIS-2571,Improvement,Closed,Enforce logical-type-names to have non empty namespaces.,"With logical type name support for permissions (SecMan) we now need the namespace part of the logical-type-name not to be empty. Which previously was always true, when we used java package names  (as package names are never empty, guaranteed by the Java language)

Add a meta-model validator."
ISIS-2570,Improvement,Closed,Disable JdoDiscriminatorAnnotationFacetFactory, Breaks the idea of logical-type-names having namespaces
ISIS-2569,Improvement,Closed,Further rationalize value types representing the metamodel.,"Follow up on https://issues.apache.org/jira/browse/ISIS-2553.

Look into RootOid/Oid/Bookmark.

Also remove uses of SpecificationLoader.loadSpecification(Class<?>) outside the scope of metamodel initialization (it does not init members for performance optimization reasons)."
ISIS-2568,Wish,Open,[Wish] Make sidebar resizable,"possible implementation:

[https://codepen.io/Zodiase/pen/qmjyKL]

HTML:
{code:java}
<div class=""container"">
  <aside>
    Aside
    <hr />
  </aside>
  <div class=""resize-handle--x"" data-target=""aside""></div>
  <main>
    Main
    <hr />
  </main>
</div> {code}
CSS:
{code:java}
 html {
  height: 100%;
}
body {
  box-sizing: border-box;
  height: 100%;
  margin: 0;
  padding: 30px;
  background-color: black;
}.container {
  height: 100%;
  overflow: hidden;
  background-color: white;
}// Flexbox setup.
.container {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  -webkit-flex-wrap: nowrap;
  -ms-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -webkit-justify-content: flex-start;
  -ms-flex-pack: start;
  justify-content: flex-start;
  -webkit-align-content: stretch;
  -ms-flex-line-pack: stretch;
  align-content: stretch;
  -webkit-align-items: stretch;
  -ms-flex-align: stretch;
  align-items: stretch;
  
  & > aside {
    -webkit-order: 0;
    -ms-flex-order: 0;
    order: 0;
    -webkit-flex: 0 0 auto;
    -ms-flex: 0 0 auto;
    flex: 0 0 auto;
    -webkit-align-self: auto;
    -ms-flex-item-align: auto;
    align-self: auto;
  }
  
  & > main {
    -webkit-order: 0;
    -ms-flex-order: 0;
    order: 0;
    -webkit-flex: 1 1 auto;
    -ms-flex: 1 1 auto;
    flex: 1 1 auto;
    -webkit-align-self: auto;
    -ms-flex-item-align: auto;
    align-self: auto;
  }
}.container > aside,
.container > main {
  padding: 10px;
  overflow: auto;
}.resize-handle--x {
  -webkit-flex: 0 0 auto;
  -ms-flex: 0 0 auto;
  flex: 0 0 auto;
  
  position: relative;
  box-sizing: border-box;
  width: 3px;
  height: 100%;
  border-left-width: 1px;
  border-left-style: solid;
  border-left-color: black;
  border-right-width: 1px;
  border-right-style: solid;
  border-right-color: black;
  cursor: ew-resize;
  
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  
  @handleSize: 18px;
  @handleThickness: 1px;
  @handleDistance: 2px;
  
  &:before {
    content: """";
    position: absolute;
    z-index: 1;
    top: 50%;
    right: 100%;
    height: @handleSize;
    width: @handleDistance;
    margin-top: -@handleSize/2;
    border-left-color: black;
    border-left-width: @handleThickness;
    border-left-style: solid;
  }
  &:after {
    content: """";
    position: absolute;
    z-index: 1;
    top: 50%;
    left: 100%;
    height: @handleSize;
    width: @handleDistance;
    margin-top: -@handleSize/2;
    border-right-color: black;
    border-right-width: @handleThickness;
    border-right-style: solid;
  }
}
{code}
JS:
{code:java}
 const selectTarget = (fromElement, selector) => {
  if (!(fromElement instanceof HTMLElement)) {
    return null;
  }  return fromElement.querySelector(selector);
};const resizeData = {
  tracking: false,
  startWidth: null,
  startCursorScreenX: null,
  handleWidth: 10,
  resizeTarget: null,
  parentElement: null,
  maxWidth: null,
};$(document.body).on('mousedown', '.resize-handle--x', null, (event) => {
  if (event.button !== 0) {
    return;
  }  event.preventDefault();
  event.stopPropagation();  const handleElement = event.currentTarget;
  
  if (!handleElement.parentElement) {
    console.error(new Error(""Parent element not found.""));
    return;
  }
  
  // Use the target selector on the handle to get the resize target.
  const targetSelector = handleElement.getAttribute('data-target');
  const targetElement = selectTarget(handleElement.parentElement, targetSelector);  if (!targetElement) {
    console.error(new Error(""Resize target element not found.""));
    return;
  }
  
  resizeData.startWidth = $(targetElement).outerWidth();
  resizeData.startCursorScreenX = event.screenX;
  resizeData.resizeTarget = targetElement;
  resizeData.parentElement = handleElement.parentElement;
  resizeData.maxWidth = $(handleElement.parentElement).innerWidth() - resizeData.handleWidth;
  resizeData.tracking = true;  console.log('tracking started');
});$(window).on('mousemove', null, null, _.debounce((event) => {
  if (resizeData.tracking) {
    const cursorScreenXDelta = event.screenX - resizeData.startCursorScreenX;
    const newWidth = Math.min(resizeData.startWidth + cursorScreenXDelta, resizeData.maxWidth);
    
    $(resizeData.resizeTarget).outerWidth(newWidth);
  }
}, 1));$(window).on('mouseup', null, null, (event) => {
  if (resizeData.tracking) {
    resizeData.tracking = false;    console.log('tracking stopped');
  }
});{code}
 "
ISIS-2567,Bug,Closed,Regression: commands are not published,
ISIS-2566,Improvement,Resolved,"Rename CommandDto#transactionId to #interactionId, similarly for ixn and chg schemas.  Also for Command and CommandJdo",
ISIS-2565,Improvement,Closed,"SecMan: fix outdated semantics PACKAGE, CLASS and TYPE","rename SecMan UI: TYPE -> SORT
rename SecMan UI: PACKAGE -> NAMESPACE
rename SecMan UI: CLASS -> TYPE
mig. notes M5 (database entry updates?)"
ISIS-2564,Improvement,Resolved,Rationalize mixee interfaces; fix derivation of sequence for EntityChanges,"A number of HasXxx had been moved to the commons module, but these are intended for domain objects to implement in order that they can participate as mixees for framework-provided mixins.

Also, make more explicit the roles around interactions and transactions:
 * HasUniqueId to HasInteractionId
 * rename RepresentsInteractionMemberExecution to HasTransactionId (because the sequence here was for transactions, not nested executions).

In course of this, discovered that the derivation of getSequence for EntityChanges was wrong, and should use SequenceType of TRANSACTION.  Fix, and renames the Sequence enum to SequenceType and change the internal Interaction#next to use SequenceType rather than an untyped string.  "
ISIS-2563,Bug,Closed,Autocomplete MinLength not always handled correctly,"Also MinLength is not picked up by the facet.

 

Seeing this with mixin (autocomplete not available in UI)
{code:java}
@Action
@ActionLayout(promptStyle = PromptStyle.DIALOG_MODAL)
public class ApplicationRole_addPermission {

    @Value @Accessors(fluent = true)           
    public static class Parameters {
        ApplicationPermissionRule rule; // ALLOW/VETO
        ApplicationPermissionMode mode; // r/w
        String feature;
    }

    public ApplicationRole act(
            
            @Parameter(optionality = Optionality.MANDATORY)
            @ParameterLayout(named=""Rule"")
            final ApplicationPermissionRule rule,
            
            @Parameter(optionality = Optionality.MANDATORY)
            @ParameterLayout(named=""Mode"")
            final ApplicationPermissionMode mode,
            
            @Parameter(optionality = Optionality.MANDATORY)
            @ParameterLayout(named=""Feature"")
            final String feature) {
        //...    
    }

    @Model
    public java.util.Collection<String> autoCompleteFeature(
            Parameters params,
            @MinLength(3) String search) {
    }

}
{code}"
ISIS-2562,Bug,Closed,SecMan: New User modal dialog ... selected inital role has no label only icon,"At least the icon has a tooltip, so one can figure out what object it is. 

Not sure yet, whether a SecMan or Wicket issue."
ISIS-2561,Improvement,Closed,Metamodel: Resurrect orphaned supporting method validator,"For the various supporting method prefixes (hide, disable, ...), detect any orphaned methods. 

Do this by still allowing actions to use these prefixes, where when they do, an @Action annotation becomes mandatory."
ISIS-2560,Improvement,Closed,SecMan: ApplicationRole ... make adding Permissions more convenient,A single button to add permissions (utilizing a smart autocomplete) shall do.
ISIS-2559,Improvement,Closed,SecMan: ApplicationUser_delete has no are_u_sure semantics,
ISIS-2558,Improvement,Closed,Configuration Page: make config item visibility a configuration option,"Configuration page: is there a way to completely disable them (not just hide)?

The balancing act is between the usefulness of it vs the potential insecurity of it.  I'm not keen on adding it into @Import as an extension, unless we formally move it out and make it into an extension.  But I would much rather that there's a config property for this menu service, more discoverable, perhaps an enum which is ALWAYS_SHOW, NEVER_SHOW, SHOW_ONLY_IN_PROTOTYPE mode ... with the last being the default."
ISIS-2557,Improvement,Closed,Provide a more general purpose Authenticator as an alternative to having to route through Shiro.,"HMM... one caveat. to the stuff below - AuthentiationManager applies an OR logic to all Authenticators, so only one needs to recognise the request, whereas we probably want an AND logic for the secman Authenticator (in addition to whatever the primary authenticator is).  I suppose the workaround is to write a custom Authenticator that would be configured first and apply AND semantics, but that is hacky.

 ~~~~~~~~~

Shiro can have multiple realms that contribute to the principal/subject representing the end user
  
 So the secman realm is (a) authenticating that the user exists in the database and (b) gathering up the permissions of that user in some form so that shiro's authorizor can determine if the user has access to a feature.
  
 We can break out these two responsibilities, though
  
 First, for authentication - making sure that a user exists in the secman database - we could provide an implementation of Isis' own Authenticator (eg AuthenticatorSecMan) that just queries the ApplicationUserRepository.  (That's because the AuthenticationManager class asks all known Authenticators if an authentication request is valid.)
  
 Second, for authorisation - well, Andi wrote that already, I think.
  
  "
ISIS-2556,New Feature,Open,Provide an EntityPropertyChangesSubscriber to receive all property changes for an entity in a single callback.,"At the moment EntityPropertyChangesPublisher gets all of the property changes and notifies any enlisted EntityPropertyChangeSubscriber's of each and every property change for each and every entity (M x N)

It would be nice to support more coarse-grained subscribers too (still to be invoked by EntityPropertyChangesPublisher).
 # to obtain all EntityPropertyChange's for a given entity (so called N times, one for each entity
 # to obtain all EntityPropertChange's in the interaction (so called just 1 time, for everything thta's changed).

That would then allow auditing implemetnations that, for example, construct a JSON document and store in MongoDB, say."
ISIS-2555,Improvement,Closed,"[WON'T FIX] EntityChanges (as consumed by EntityChangesSubscriber) should associate with transaction, not interaction?","The docs say that EntityChanges releates to a transaction, but it only has a uniqueId which identifies the parent interaction (there can be many transactions per interaction).  So, we're missing a sequence.

EntityChanges also has a reference to ChangesDto, which contains a sequence, so I think the information is there.

There is also a TransactionId which is the tuple of uniqueId (for interaction) and sequence, so in fact EntityChanges should probably have a field of type TranscationId rather than UUID uniqueId.

 

~~~

Similarly, EntityPropertyChange has both a uniqueId and a sequence, so they should be replaced by a field of type TransactionId instead."
ISIS-2554,Improvement,Closed,Make TypeIdentifier Serializable,"TypeIdentifier lazily evaluates the logical name, because instances of TypeIdentifier get created as early as the meta-model is in its phase of being built up. So the logical name only gets evaluated and memoized when first needed by any caller.
"
ISIS-2553,Improvement,Closed,"Rationalize value types representing the metamodel, promote to applib if possible.","We have some duplication between classes that describe elements of our metamodel.  We also have a legacy of names that relate to physical aspects (eg PACKAGE) whereas internally we are now using logical names (derived from @DomainObject(objectType=), in other words ObjectSpecIdFacet) throughout.  And it would probably be safe to promote all of this to the applib once clean - we currently only expose strings.

Andi's summary of what we have:
 # {{Identifier }}(AppLib): identifies an application feature, that is a type (class) or a type's member (action, property or collection)
 # TypeIdentifier  (AppLib): introduced this weekend, to effectively amend the \{{Identifier }}with an additional field, that provides the logical name of the type (aka *object-type*); immutable as much as possible, but allows for lazy evaluation of the logical name, as it requires the meta-model to be populated
 # {{ObjectSpecId}}: (internal) class that wraps the logical name (String) of the corresponding type (aka *object-type*)
 # {{ApplicationFeatureId}}: (internal) Similar to Identifier, but splits the logical type name or member name into its parts: PACKAGE, CLASS, MEMBER which with logical name support now need to be interpreted as NAMESPACE, LOGICAL-TYPE-SIMPLE-NAME and MEMBER, where the member part for actions also includes its parameter list.

 

Further discussion:
 * Dan - To me, it looks like TypeIdentifier and ObjectSpecId both describe a type (aka ObjectSpecification)
 * Andi - correct
 * Dan -  Meanwhile Identifier is kind of a superclass that represents either types or `ApplicationFeatureId`s
  
 * Dan - And we perhaps should rename from PACKAGE to NAMESPACE, etc, if that's what these now are.
 * Andi - Was my first thought today when I woke up, renaming those fields within ApplicationFeatureId.
  

also note why the distinction between ObjectSpecId and TypeIdentifier: 
 # ObjectSpecId: immutable, serializable
 # TypeIdentifier: thread-safe lazy initialization, hence not serializable

Further thoughts from Andi:

TypeIdentifier lazily evaluates the logical name, because instances of TypeIdentifier get created as early as the meta-model is in its phase of being built up. So the logical name only gets evaluated and memoized when first needed by any caller. So once memoized, the TypeIdentifier can be made serializable easily. I might just do that, so we are on the safe side here."
ISIS-2552,Improvement,Closed,"Remove IsisConverterLocator if possible, seems it is pretty limited and hopefully unnecessary","is IsisConverterLocator even used?

if (java.util.Date.class == correspondingClass) {
 return _Casts.uncheckedCast(new DateConverterForJavaUtilDate(wicketViewerSettings, adjustBy));
 }
 if (java.sql.Date.class == correspondingClass) {
 return _Casts.uncheckedCast(new DateConverterForJavaSqlDate(wicketViewerSettings, adjustBy));
 }
 if (org.joda.time.LocalDate.class == correspondingClass) {
 return _Casts.uncheckedCast(new DateConverterForJodaLocalDate(wicketViewerSettings, adjustBy));
 }
 if (org.joda.time.LocalDateTime.class == correspondingClass) {
 return _Casts.uncheckedCast(new DateConverterForJodaLocalDateTime(wicketViewerSettings, adjustBy));
 }
 if (org.joda.time.DateTime.class == correspondingClass) {
 return _Casts.uncheckedCast(new DateConverterForJodaDateTime(wicketViewerSettings, adjustBy));
 }
 if (java.sql.Timestamp.class == correspondingClass) {
 return _Casts.uncheckedCast(new DateConverterForJavaSqlTimestamp(wicketViewerSettings, adjustBy));
 }

and compare to subclasses of ScalarPanelTextFieldDatePickerAbstract and calls to #getAdjustBy()"
ISIS-2551,New Feature,Open,Provide a mixin to download security permissions for an object (for diagnostics),
ISIS-2550,Improvement,Closed,Add support for impersonation (RunAs menu action),"Impersonation works at the very bottom level of the authentication stack, that is, we would want the very first authentication layer that is pushed onto the stack to be impersonated; maybe we can account for that by extending the API and not changing the design."
ISIS-2549,Improvement,Closed,Configuration (Menu Action): show additional runtime information,"Add information on the data source that is in use.
Add information on the http filter chains that are in use. (cors, csrf, shiro, ...)
Add application startup timestamp.
Get framework version from config rather than hard-coded string.
Add OS and JVM versions."
ISIS-2548,Improvement,Open,[JUnit] Order of columns in table undefined if entity has LayoutFacetMethod and no default layout xml,"If an entity has a LayoutFacetMethod then a table displaying a collection of this type is reverting to the default system layout xml if no default layout xml is provided for this type.

The idea would be to enhance the validator to warn (or enforce?) when there is no defined default view for entities that have a LayoutFacet.

Related to https://issues.apache.org/jira/browse/ISIS-2547

 "
ISIS-2547,Bug,Closed,layout() method does not reload grid in production mode,
ISIS-2546,Improvement,Open,[JUnit] CollectionLayout#sortedBy should be effective based on actual runtime type ,"Double check whether for an entity that holds a relation of type Set<?> annotated with @CollectionLayout, the framework actually applies the specified comparator. (default is natural order).

My suspicion is that it only does this for compile time type SortedSet<?>. We might need to do a runtime type inspection, rather than rely on the meta-model, which does compile time inspection.

"
ISIS-2545,Improvement,Closed,Replace @MemberOrder#name() with @PropertyLayout#fieldSetId() (and fieldSetName),We already have @ActionLayout#associateWith() as an alternative to one of the two uses of @MemberOrder; this ticket is to address the other one.
ISIS-2544,Improvement,Closed,SecMan: ApplicationRole#Permissions ... hide role column (references parent),
ISIS-2543,Bug,Closed,SecMan/JPA: user-role (many-to-many) management is not working,adding a user to a role has no effect (does not get persisted)
ISIS-2542,Bug,Closed,SecMan/JPA: cannot add user to role (autocomplete search issue) ,You have attempted to set a parameter value using a name of regex that does not exist in the query string SELECT u FROM org.apache.isis.extensions.secman.jpa.dom.user.ApplicationUser u WHERE u.username LIKE '%:regex%'  OR u.familyName LIKE '%:regex%'  OR u.givenName LIKE '%:regex%'  OR u.knownAs LIKE '%:regex%'  OR u.emailAddress LIKE '%:regex%'.
ISIS-2541,Improvement,Closed,SecMan: existing admin user is not attached to the new secman-admin role,"Either the seeding logic needs fixing, or maybe we just need to better document how to migrate SecMan M4->M5 (mignotes)."
ISIS-2540,Bug,Closed,Regression: bulk select from mixin actions is broken,"Removing a Permission from an ApplicationRole results in a wicket exception:

Stack trace:

{noformat}
org.apache.wicket.markup.MarkupException
Unable to find component with id 'scalarIfRegular' in [WebMarkupContainer [Component id = scalarTypeContainer]] Expected: 'theme:actionPromptSidebar:actionPrompt:parameters:inputForm:parameters:1:scalarNameAndValue:scalarTypeContainer:scalarIfRegular'. Found with similar names: 'theme:entityPageContainer:entity:rows:2:rowContents:1:col:fieldSets:1:memberGroup:properties:1:property:scalarTypeContainer:scalarIfRegular',
{noformat}
"
ISIS-2539,Bug,Closed,JDO Integration: table/schema auto-creation might fail when not done eagerly,"We know seeding (w/ JDO) works for H2 in memory db, but it was not yet tested against other DB scenarios.

Quick setup for testing against a postgres docker image:
{noformat}
docker run --name postgresql-container -p 5432:5432 -e POSTGRES_PASSWORD=postgres -d postgres:12
{noformat}
{noformat}
spring.datasource.url=jdbc:postgresql://localhost:5432/db-name
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.username=postgres
spring.datasource.password=postgres
{noformat}
pgAdmin 4 via docker
{noformat}
docker run --rm -p 5050:5050 thajeztah/pgadmin4
{noformat}
 

 

 "
ISIS-2538,Improvement,Closed,Action results of type LocalResourcePath should be able to replace the current page.,"Currently these open in a new browser tab, but we need more fine grained control, that is for eg. the Logout Menu Action, we want to redirect the current page.

Once implemented we can use that for the existing Logout Menu Action.

Action results of type URL are interpreted as redirect requests as well. But I'm assuming that for these opening in a new browser tab seems the desired behavior always."
ISIS-2537,Improvement,Resolved,JPA: support object type naming from @Table(schema=...) annotation,"Needs both, a new ObjectSpecIdFacet and some logic with the Bean Type Classification."
ISIS-2536,Improvement,Resolved,attach sources in nightly build,
ISIS-2535,Bug,Closed,Regression: @PersistenceCapable(schema= ) does not get picked up as ObjectType,There is an {color:#1d1c1d}ObjectSpecIdFacet{color} which should be created for the @PersistenceCapable(schema= ) annotation. And also the initial class Spring generated class scan should properly pick that up.
ISIS-2534,New Feature,Closed,Spring Security Integration,"Similar to the keycloak integration, provide a new security module that delegates authorization to Spring Security.

This affects the Viewers: Wicket, Vaadin and RO (JavaFx only optional).

- I've only looked at Wicket.  Vaadin is still vapourware, RO we can go round the loop on.

(see ISIS-2607) It also affects the SecMan extension, where either we need to add a new supporting module as well or alternatively simplify matters in the process, and decouple SecMan from the actual security stack in use."
ISIS-2533,Wish,Open,[Wish] Hitting a non-existent end point renders a page that looks like an exception page rather than a 404 page.,"By accident, I tried [https://demo-wicket.isis.incode.work/custom/simpleObjects/]

and the page shown looks like an error page instead of a 404 page.

(what I meant to call was [https://simpleapp.isis.incode.work/custom/simpleObjects] , which works fine)"
ISIS-2532,Bug,Closed,Wicket/JPA: entity object memento cannot reattach on AJAX requests,"rendering glitch after confirming a recognized ex. in the UI when using Wicket+JPA:
object detail components on the originating page go hiding

"
ISIS-2531,Wish,Open,[Wish] Wicket: render standalone collections as modal dialogs,"For action results, that return a scalar (value) or collection, it would make sense to render the result in a modal window, such that the current semantic context is preserved when the modal window gets closed.

In principle this idea could even be extend to menu actions, that return a scalar (value) or collection, such that the current page that is open in the UI gets preserved.
"
ISIS-2530,Improvement,Closed,Wicket: switch session timeout policy to not recreate expired pages,"Martin Hesse: I came across this wicket error message I get when I click on a link or a menu entry after a being ""away from the keyboard"" for a while, saying ""Unable to find component with id 'welcome' in [WebMarkupContainer [Component id = theme]] Expected: 'theme:welcome'. Found with similar names: ''"""
ISIS-2529,Improvement,Closed,Crop Logo Images,"Some logos (*png) have a white background which makes them stick out in the UI.
 Using cropped images (with transparent background) looks nicer."
ISIS-2528,Improvement,Open,add docs to describe how to style the Wicket UI,"By adding styles to {{application.css}} the UI can be styled and values override any Theme settings, example:

{code:java}
header.navbar-fixed-top {
    background-color: #002852;
}

.navbar-inverse {
    background-color: #56b7e9;
    border-color: transparent;
}

.navbar-default .navbar-collapse, .navbar-default .navbar-form {
    background-color: #002852;
}
{code}

The interaction between 'Theme' and css (application, page) needs some explanation"
ISIS-2526,Improvement,Resolved,"Tooling: suppress header, use filename in caption","The generated index includes a header, but that makes it tricky to include.  

For example, this source:

!image-2021-02-04-06-59-48-038.png|width=533,height=113!

 

Renders as folows:

!image-2021-02-04-06-59-18-608.png|width=327,height=165!

 

I think that the ""AcceptHeaderService : interface"" is unnecessary (there would normally be a paragraph here anyway if there was some javadoc for the class).

It would be nice though to use the class as a caption:
{code:java}
[source,java]
.AcceptHeaderService.java
----
public interface  AcceptHeaderService {
   ...
}
----{code}
 

*Extending the idea...* 

I think it might be useful to include ""API"" as a section, but *after* the top-level paragraph.

In other words, the generated file would be:
{code:java}
The paragraph(s) taken from the javadoc of the class interface.

There might be quite a lot of text here.

= API

[source,java]
.AcceptHeaderService.java
----
public interface AcceptHeaderService {
  ...
}
----

{code}
 

These generated files will then be included quite nicely into the refguide pages.

 "
ISIS-2525,Improvement,Resolved,Tooling: make callouts link to sections; remove blank lines in listing.,"the screenshot below shows we are missing sections (""on this page"", to the right), and I think the blank lines don't improve readability.

!image-2021-02-04-06-48-56-673.png|width=792,height=462!"
ISIS-2524,Wish,Open,[Wish] Tooling: Ideas to enhance 'projdoc' support,"in adopting the 'projdoc' global index, I've commented out some existing material.  It'd be nice to have that material in the source code and projdoc generate pages the way I'd like them.

Several ideas:

*Auto-detect examples*

As per the ISIS-2524 branch that sketches this out, automatically detect (from src/test/java) any Xxx_example.java classes and copy over to examples/, post-process and include using include::example$Xxx_example.adoc[]

*Xrefs to page anchors*

for example, in javadoc this: \{@link ActionLayout#cssClassFa}   should correspond to this: xref:Actionlayout#cssClassfa[].

*Implementations section*

**(This is demo'd in the origin/ISIS-2524 branch)... automatically generate an ""implementations"" section, identifying the domain service and also providing example code indicating the module to @Import and the pom to reference in <dependencies> of the pom.xml

*Copy to clipboard***

The default antora template now has a widget to copy text to clipboard (see [https://gitlab.com/antora/antora-ui-default/-/issues/70)]  ... it would be nice to have the same.

*Asciidoclet*

to allow richer text, to allow comments to be written in Asciidoc.  This would leverage the existing asciidoclet doclet in our CI ([https://github.com/asciidoctor/asciidoclet#example),] while users of IntelliJ could also benefit from asciidoclet plugin support ([https://intellij-asciidoc-plugin.ahus1.de/docs/users-guide/features/advanced/asciidoclet.html).|https://intellij-asciidoc-plugin.ahus1.de/docs/users-guide/features/advanced/asciidoclet.html)]

If that is unwieldy, then perhaps simply allow .adoc comments to be stored alongside the .java files (similar to our layout files) and have projdoc stitch it all together.

For example, the extended material for @Action#semanticsOf element would reside in Action#semanticsOf.adoc, right alongside Action.java.

 "
ISIS-2523,Improvement,Closed,Combine @MemberOrder into @PropertyLayout etc.,"replace @MemberOrder#name() with @PropertyLayout#group()

replace @MemberOrder#sequence() with @PropertyLayout#sequence()."
ISIS-2522,Improvement,Resolved,Tooling: for system-overview diagrams use SVG rather than PNG,"SVG is the only one that supports embedding of links (not used currently but could with future extensions)
 also involves less traffic over the wire
 looks better when rendered (unlimited scaling)

However, at the moment we use PNG.  That's because the lightbox support that is currently enabled only works for PNG files.  (You can see this if you navigate on [https://apache-isis-committers.github.io/isis-nightly/system/latest/generated/system-overview.html] and then click on the diagram).

Also, there is CSS styling to limit the width of diagrams, see for example the ""Core"" diagram (at [https://apache-isis-committers.github.io/isis-nightly/system/latest/generated/system-overview.html#core] ).  Again, if SVG is used then the CSS doesn't apply and the width of the diagram overflows into the margins.

So, basically we need to:
 * revert the tooling so that it generates SVG rather than PNG diagrams (a one liner), but also
 * fix up the current lightbox integration so that clicking on an SVG diagram shows in a popup, and
 * fix up the CSS so that SVG diagrams do not overflow into the margins.

 "
ISIS-2521,Wish,Open,[Wish] Tooling: index gen. should log less verbose,"currently almost every J2AdocUnit search is logged if result is empty or ambiguous, maybe we can improve on that and be less verbose

eg. do not try to find J2AdocUnit(s) in the global index if the namespace is other than 'org.apache.isis' ... also make a config option (or at least don't log this as an issue)

"
ISIS-2520,Improvement,Closed,Tooling: index gen. should not suppress generic type params,java to adoc: the emitted top level class/interface should not suppress generic type params
ISIS-2519,Improvement,Closed,Tooling: system-overview should use collapsible content,"system-overview adoc should use [%collapsible] for the various lists in the artifact description column: so the artifact description is more prominent

requires [%collapsible] to be introduced as a new feature for AsciiDocFactory"
ISIS-2518,Improvement,Closed,Java-Doc: link tag contents that reference types should have corresponding import statements,"Should be a task the IDE could do for us.

Maybe this is a validation/error/warning setting somewhere."
ISIS-2516,New Feature,Closed,Tooling Global Document Index: add support for namespaces,"Should lift current limitations, that we cannot add classes with same simple name to the index.

Challenges:
- java-doc link tags now need to be interpreted fqn, which involves scanning of import statements
- fixing orphaned index references could still work, if unambiguous, otherwise just output a log message containing the various ambiguous options, so can be fixed by hand then"
ISIS-2515,Task,Resolved,Translate original Spring ORM JDO ref doc for forked 'persistence.jdo.spring' Module.,"From the original reference doc at https://docs.spring.io/spring-framework/docs/3.0.0.RC2/reference/html/ch13s04.html
- Translate the XML Beans configuration examples into Java/Spring configuration examples.
- Also back up the configuration examples by actual JUnit tests.
- Fix external http references.

follow up tasks:
- once the README.adoc is done can be integrated with the site (antora)"
ISIS-2514,Improvement,Closed,[DUPLICATE] add JPA support command-log extension,of ISIS-2735
ISIS-2513,Improvement,Closed,"Add JPA support Isis Blob, Clob, AsciiDoc, Markdown, SSE and other value types.","For the full list, find the implementations of DataNucleus' TypeConverter, JavaTypeMapping, SingleFieldMultiMapping, and BlobColumnMapping."
ISIS-2512,Improvement,Closed,Migrate example JDO datasource configurations to Spring way,"For any occurrences in property sources:
replace isis.persistence.jdo-datanucleus.impl.javax.jdo.* -> javax.jdo.*
replace isis.persistence.jdo-datanucleus.impl.datanucleus.* -> datanucleus.*

or leave unconfigured if appropriate (Spring auto-configuration)
also affects helloworld and simpleapp"
ISIS-2511,Improvement,Closed,"Rationalize all @Named(""..."") @DomainXxx(objectType=""..."") namespaces.","Using uniform namespaces of form 
- isis.applib.*
- isis.metamodel.*
- isis.persistence.*
- isis.security.*
- isis.runtime.*
- isis.runtimeservices.*
- isis.ext.*
- isis.sub.*
- isis.tooling.*
... etc

These do not have to reflect exact Java package names nor module names, but should rather capture coarse grained structure along with easy readable semantics.

Namespaces are allowed to span multiple modules.

Namespaces should also rather be lowercase to avoid ambiguity.


Why is this relevant? Because SecMan was reworked to now base its permission model on namespaces. Which also includes wildcard support.
"
ISIS-2510,Bug,Closed,Regression: interfaces when registered with the metamodel never expose their members,"Collection of same typeOf (element type) render differently depending on whether originating from an action result or from a viewmodel field.

For an example see comment."
ISIS-2509,Improvement,Resolved,SecMan: add multi select action to relocate orphaned CLASSes to new namespace,
ISIS-2508,Improvement,Closed,Tooling CLI: add documentation (README.adoc),
ISIS-2507,Bug,Closed,JaxbServiceDefault: potential infinite loop when processing DomainObjectList,"How to reproduce, see examples in comments ...

Demo is running locally in docker with image pulled yesterday.

'Parent' link is http://localhost:8080/restful/objects/isis.applib.ConfigurationMenu/1/actions/configuration/invoke"
ISIS-2506,Improvement,Open,[kroviz] Clipboard,"* Add Copy function and map to Ctrl-C
* Add Paste function (Ctrl-V) for Dialogs with input fields"
ISIS-2505,Task,In Progress,[kroviz] Catch Up With Demo Examples,"* Parented Lists
* Where In The World
* Icons"
ISIS-2504,Improvement,Closed,JDO Integration: configure datasources the Spring way,"Convert JDO integration to use Spring managed DataSource configuration.

also relocate 

isis.persistence.jdo-datanucleus.impl.* 

to

datanucleus.*
javax.jdo.*


"
ISIS-2503,Bug,Closed,[NOT AN ISSUE] RO Viewer does not emit object members of type 'property',"https://demo-wicket.isis.incode.work/restful/objects/demo.JavaLangTypesMenu/1/actions/strings/invoke sometimes has 13 members, sometimes 9, ie. missing 4 members of type property.
"
ISIS-2502,Improvement,Closed,Convert existing Exception Recognizers from JDO to Spring Data,"{color:#1d1c1d}just testing helloworld on latest - slight regression; we seem to have lost some of our ExceptionRecognizers.  If I create a helloworld object, and then another one with the same name, then the exception isnt' recognised and I get an error page{color}"
ISIS-2501,Improvement,Closed,WebModuleShiro to also cover DispatcherType.ASYNC,"This is Servlet 3.0 mapping concern. See
{code:java}
org.apache.isis.security.shiro.webmodule.WebModuleShiro#init{code}"
ISIS-2500,Improvement,Closed,SecMan: Regular User is missing Permision for LogoutMenu#logout,
ISIS-2499,Improvement,Open,[JUnit] Add Metamodel Tests to cover all potential Cases of type Hierarchies,"Setup different type hierarchy scenarios, including mixins and interfaces, then test whether their effective ObjectSpecifications are populated correctly. This also requiers to look into the details of object member overriding. 

Ideally we should be able to reason about a list of all possible scenarios such that we cover all corner cases."
ISIS-2498,Improvement,Closed,Remove requirement for Mixins to actually store their mixee.,"Keep our programming model with mixins as it is (contract by constructor), but don't strictly require mixins to actually store the holder that they are associated with. We only require this now, because of implementation details of the framework.

Currently we do a reflective field search in the mixins to get hold of the holder instance which is not guaranteed to work due to potential ambiguity."
ISIS-2497,Bug,Closed,Regression: Mixin's holder instance cannot be found if stored in non-public field.,Fix is to search the type hierarchy for any field (including non-public) and return the first match.
ISIS-2496,Improvement,Closed,"Suppress misleading ""helpful"" exception message if exception caused for reasons other than a mismatch of parameter count or type.",
ISIS-2495,Improvement,Closed,Promote SimpleTicket from core.runtimeservices to applib; move EmailTicket into the demo app only.,
ISIS-2494,Wish,Closed,Metamodel contributing members are not inheritable from interfaces.,Since Java 8 interfaces are potential sources of object members (@Action/@Property/@Collection).
ISIS-2493,Bug,Closed,Actions with same name but different signature potentially share the same metamodel member id.,"When we allow this, then the metamodel needs to be fixed. Not sure about consequences for the layout model, as actions are referenced by id, which is just their name.

Otherwise metatmodel validation must fail on action id clashes."
ISIS-2492,Bug,Closed,Metamodel contributing members are not inheritable from abstract super class.,actions/properties/collections are not propagated when sub-classed
ISIS-2491,Bug,Closed,WebModuleH2Console is never enabled when using JPA,WebModuleH2Console should enable itself when the (primary) data-source is driven by h2 and also is in memory.
ISIS-2490,Improvement,Closed,@Property(entityChangePublishing=DISABLED)  ,"We have removed @NotPersistable a while back, which had morphed into @Property(mementoSerialization=...) and become confused with/reused with the notion of being included in a snapshot.  And it seems explicit support to include/exclude a property from the audit logs has either got lost or was never implemented in the first place.

To tease things apart, @Property(mementoSerialization=...) has in another ticket been renamed to @Property(snapshot=...)

This ticket, then, is to properly introduce the notion that a property can be excluded from audit logs.  That will require the introduction of an AuditableFacet.  We can then also add support to exclude some types by default, specifically blobs/clobs (ISIS-1488)."
ISIS-2489,Bug,Closed,"TranslationsResolverWicket uses outdated config, also might fail to read translation sources",
ISIS-2488,Bug,Closed,Add metamodel validation:  detect object-type (logical-type) name clashes,"v1 had this validation, we removed it in v2, because Spring does that for us, except it does not for types it is not aware of, eg. entities and view-models"
ISIS-2487,Bug,Closed,[NOT AN ISSUE] DomainService(nature=View) recreate from memento has empty result,"Reason: memento recreation gets initiated with wrong targeted result ObjectSpecifiaction

seeing this with Simple App when creating a SimpleObject: the framework fails to recreate the ViewModel SimpleObjects"
ISIS-2486,Improvement,Closed,Rationalize JDO and JPA modules so that they are more symmetrical,"At the moment:

    JPA Eclipse Link --depends on--> JPA Integration

however

    JDO Integration --depends on--> JDO DataNucleus

The dependency should be switched, or if that's not feasible, then different names used for these two ORMs so that there is no suggestion of any sort of symmetry. "
ISIS-2485,Task,Open,Flesh out demo app with further examples,
ISIS-2484,Task,Closed,Ongoing improvements to the Apache Isis website,
ISIS-2483,Task,Closed,Isis 2.0.0-M6 Release activities,
ISIS-2482,New Feature,Closed,Enabling HTTP/2,"Although HTTP/2 is supported (test eg. via https://tools.keycdn.com/http2-test & https://demo-wicket.isis.incode.work), it needs to be enabled on the Spring Boot level, see https://byte27.com/2020/02/03/using-http-2-in-your-spring-boot-application/"
ISIS-2481,Improvement,Closed,"Consolidate BeanSort ENTITY_JDO, ENTITY_JPA -> ENTITY","This affects the programming model!

The framework should be smart enough to autodetect, what sort of entity a class/type is. Lets not require devs to be specific about this.

"
ISIS-2480,New Feature,Closed,SecMan to support JPA,
ISIS-2479,Bug,Closed,Resurrect support for TransactionId,"TransactionIds are currently empty. Java-doc of TransactionId states, that the UUID it holds, equals that of the current Interaction, and that the sequence counter keeps track of the transactions closed within the current Interaction.

Also TransactionId needs a new field, that holds the name of the persistence-context the current transaction belongs to, which should account for (not yet supported) cases, when multiple persistence layers coexist within Spring's application context."
ISIS-2478,Bug,Closed,CommonDtoUtils#newParamDto fails to handle non-scalar values.,
ISIS-2477,New Feature,Open,[kroviz] Persist Response Data,"Response Data should/could be stored on the client side in cases where data doesn't change often, ie. master data. 

State of the art seems to be using Key-Value stores provided by browsers (IDB, cf https://github.com/jakearchibald/idb)"
ISIS-2476,Improvement,Closed,"Remove EntityLinksSelectorPanel, as is dead code, and allow other implementations of ComponentType.ENTITY to be picked up.","EntityLinksSelectorPanelFactory can actually return either a Bs3GridPanel, or an EntityLinksSelectorPanel.  Except it always does the former, and the latter is dead code.

That means in turn that EntityLinksSelectorPanelFactory is (a) misnamed and (b) should not be given special priority in ComponentFactoryRegisterDefault as a selector ... it should be just another built-in.  

That would then allow other implementations of the ComponentType.ENTITY to be picked up."
ISIS-2475,Bug,Closed,RESTEASY003210: Could not find resource for full path: https://demo-wicket.isis.incode.work/restful/domain-types/org.apache.wicket.markup.MarkupStream/properties/,"Reproduce via: 
* Chrome + YARC extension, enter URL and credentials, execute GET (see screenshot) or
* curl --user sven:pass -v -H ""Access-Control-Request-Method: GET"" -H ""Origin: http://localhost:3000""   -X OPTIONS https://demo-wicket.isis.incode.work/restful/domain-types/org.apache.wicket.markup.MarkupStream/properties/
"
ISIS-2474,Bug,Closed,Fix Named annotation in WebModuleShiro ,"Named annotation in WebModuleShiro should probably be ""isisSecurityShiro.WebModuleShiro""
{noformat}
@Service
@Named(""isisSecurityKeycloak.WebModuleKeycloak"")
@Order(OrderPrecedence.FIRST + 200)
@Qualifier(""Shiro"")
public class WebModuleShiro extends WebModuleAbstract {{noformat}"
ISIS-2473,Improvement,Closed,Automate Refguide Example Generation from Java-Doc,"I'm aware we have a groovy script in place that already does parts of it, but maybe we can fully automate this."
ISIS-2472,Improvement,Closed,[WON'T FIX] Move Tooling to isis-lab project (github).,As its unlikely that these will ever be part of a release.
ISIS-2471,Improvement,Closed,Remove support for validate() at Domain Object Level,"1) This one is wrongly placed under deprecated, validate(...) is a supporting method for Property, Parameter and Action:
 [https://isis.apache.org/refguide/2.0.0-M4/applib-methods/prefixes/deprecated/validate.html#properties]

2) And also this one should include validate(...)
 [https://isis.apache.org/refguide/2.0.0-M4/applib-methods/prefixes.html]

3) Update the programming model cheat sheet (docs).

4) Update the supporting test matrix and implement missing supporting methods in
{code:java}
org.apache.isis.testdomain.model.good.ProperMemberSupport{code}
5) Add a variant of (4) that tests, whether supporting methods are also picked up from abstract methods and interfaces.

6) remove validate(...) at domain object level, as it was deprecated"
ISIS-2470,Improvement,Resolved,Unify Maven dependency declarations for jdk-supplemental (JDK11+),"Such that JDK11+ supplemental dependencies can now be imported from a single source rather than declaring the complex imports and exceptions
all over the place within the framework."
ISIS-2469,Improvement,Closed,"Remove Annotations ViewModel, ViewModelLayout and Mixin","ViewModel, ViewModelLayout and Mixin are aliases already covered by DomainObject and DomainObjectLayout.

And for @DomainObject(nature=...), as we are now more precise on the term ""entity"", we should remove EXTERNAL_ENTITY and INMEMORY_ENTITY.

With support for meta annotations, users should be able to create their own drop in replacements. eg.
{code:java}
@Inherited
@Target({ ElementType.TYPE })
@Retention(RetentionPolicy.RUNTIME)
@DomainObject(nature=MIXIN, mixinMethod=""act"")
public @interface Mixin {
}
{code}"
ISIS-2468,Improvement,Closed,Remove @Collection(mementoSerialization=...),"This installs the NotPersistedFacet for OTMA.  However, seems to be pretty much dead code (will be entirely once remove concept of mutable collections)."
ISIS-2467,Improvement,Closed,Bump Wicket to latest Version (8.11.0),"at org.apache.wicket.serialize.java.JavaSerializer$SerializationCheckerObjectOutputStream.writeObjectOverride(JavaSerializer.java:402) ~[wicket-core-8.9.0.jar:8.9.0]

[ageSavingThread] o.a.w.s.j.JavaSerializer                 : Error serializing object class org.apache.isis.viewer.wicket.ui.pages.standalonecollection.StandaloneCollectionPage [object=[Page class = org.apache.isis.viewer.wicket.ui.pages.standalonecollection.StandaloneCollectionPage, id = 16, render count = 1]]"
ISIS-2466,Improvement,Resolved,Avoid duplicate metamodel validations when objectType is reused,
ISIS-2465,Bug,Closed,Kroviz - Demo Menu Actions Show No Output,
ISIS-2464,Improvement,Closed,Application Layer Overhaul for v2,"In preparation of integrating Spring Data JPA, simplify if possible, aspects of
* Command/Auditing/Publishing Infrastructure ... separation of concerns via well documented interfaces, yielding internal dispatcher service implementations
* WrapperFactory Interaction nesting in coexistence with the SudoService
* Async Wrapping to spawn its own InteractionSession (must not share its InteractionSession with the calling thread: potential ThreadLocal collision when run with common ForkJoinPool?)

Also provide new tests, to verify correct implementation of these aspects.
Also overhaul corresponding ref-doc chapters and add sequence diagrams for these aspects.
"
ISIS-2463,Wish,Open,[Wish] Move the nightly-built website into a different repo to isis-nightly,"At the moment, every night the website is rebuilt by https://github.com/apache-isis-committers/isis-nightly and pushes back to the same repo.

This means that this repo that defines the build takes longer to clone, and also any changes to it need to be rebased.

It would be better, I think, to split out these responsibilities - build vs build website,"
ISIS-2462,Bug,Resolved,"Reinstate version in footer, and link to about page.",Noticed that this was accidentally removed in an earlier refactoring.  Want it back for traceability and for the demo apps deployed nightly.
ISIS-2461,Bug,Resolved,Potential NPE when menu-contributing ViewModel not explicitly listed in menubar.layout.xml,"NPE in
https://github.com/apache/isis/blob/7ec5986b6d39dd423e9c5c59e733bf412b37ef91/viewers/wicket/ui/src/main/java/org/apache/isis/viewer/wicket/ui/components/actionmenu/serviceactions/ServiceActionsPanel.java#L103"
ISIS-2460,Bug,Resolved,Kroviz - Demo Menu Missing,
ISIS-2459,Bug,Closed,Async Execution might throw 'no current IsisPersistenceSessionJdoBase available',"WrapperFactory async execution might run into this issue when running the execution task on the ForkJoinPool, seen with PublisherServiceTest.publisherService_shouldBeAwareOfInventoryChanges_whenUsingAsyncExecution

{code}
Caused by: org.apache.isis.commons.exceptions.IsisException: unrecoverable error: 'no current IsisPersistenceSessionJdoBase available'
	at org.apache.isis.commons.internal.exceptions._Exceptions.unrecoverable(_Exceptions.java:126)
	at org.apache.isis.persistence.jdo.datanucleus5.persistence.IsisPlatformTransactionManagerForJdo.lambda$5(IsisPlatformTransactionManagerForJdo.java:172)
{code}
"
ISIS-2458,Bug,Resolved,"Deploying demo-wicket app to k8s causes a logging issue, won't start","Kinda odd, because I don't see the issue when using Docker on my PC.  But fails on a k8s deployment (k3d).  I guess it might be the order in which the JARs are discovered at runtime.
{code:java}
SLF4J: Class path contains multiple SLF4J bindings.02/11/2020 08:26:59 SLF4J: Found binding in [jar:file:/app/libs/log4j-slf4j-impl-2.13.3.jar!/org/slf4j/impl/StaticLoggerBinder.class]02/11/2020 08:26:59 SLF4J: Found binding in [jar:file:/app/libs/logback-classic-1.2.3.jar!/org/slf4j/impl/StaticLoggerBinder.class]02/11/2020 08:26:59 SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.02/11/2020 08:26:59 SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]02/11/2020 08:26:59 Exception in thread ""main"" java.lang.ExceptionInInitializerError02/11/2020 08:26:59 	at demoapp.webapp.wicket.DemoAppWicket.main(DemoAppWicket.java:75)02/11/2020 08:26:59 Caused by: org.apache.logging.log4j.LoggingException: log4j-slf4j-impl cannot be present with log4j-to-slf4j02/11/2020 08:26:59 	at org.apache.logging.slf4j.Log4jLoggerFactory.validateContext(Log4jLoggerFactory.java:49)02/11/2020 08:26:59 	at org.apache.logging.slf4j.Log4jLoggerFactory.newLogger(Log4jLoggerFactory.java:39)02/11/2020 08:26:59 	at org.apache.logging.slf4j.Log4jLoggerFactory.newLogger(Log4jLoggerFactory.java:30)02/11/2020 08:26:59 	at org.apache.logging.log4j.spi.AbstractLoggerAdapter.getLogger(AbstractLoggerAdapter.java:54)02/11/2020 08:26:59 	at org.apache.logging.slf4j.Log4jLoggerFactory.getLogger(Log4jLoggerFactory.java:30)02/11/2020 08:26:59 	at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:363)02/11/2020 08:26:59 	at org.apache.commons.logging.LogAdapter$Slf4jAdapter.createLocationAwareLog(LogAdapter.java:130)02/11/2020 08:26:59 	at org.apache.commons.logging.LogAdapter.createLog(LogAdapter.java:91)02/11/2020 08:26:59 	at org.apache.commons.logging.LogFactory.getLog(LogFactory.java:67)02/11/2020 08:26:59 	at org.apache.commons.logging.LogFactory.getLog(LogFactory.java:59)02/11/2020 08:26:59 	at org.springframework.boot.SpringApplication.<clinit>(SpringApplication.java:196)02/11/2020 08:26:59 	... 1 more

{code}
 

The fix would seem to be: https://stackoverflow.com/a/61873064/56880"
ISIS-2457,Task,Resolved,Switch nightly builds to upload to nexus.incode.work (instead of repo.incode.work),
ISIS-2456,Bug,Closed,Regression: Object of type Nature.BEAN may have no Spec from SpecLoader,
ISIS-2455,Improvement,Closed,Build 'essential' Artefacts From Root with Maven,"{{When *mvn* *clean install* is executed in the root dir, all artifacts should be created:}}
 * {{api/applib}}
 * {{api/schema}}
 * {{examples/demo}}
 * ...

cf.  https://the-asf.slack.com/archives/CFC42LWBV/p1603772509313400"
ISIS-2454,Bug,Resolved,CORS Filter not in FilterChain?,"*Given:* demo-wicket started from IntelliJ with Spring Boot Configuration, JDK11, Maven Goal 'Demo- Wicket: clean install'

*When:*  curl --user sven:pass -v -H ""Access-Control-Request-Method: GET"" -H ""Origin: [http://localhost:3000|http://localhost:3000/]""   -X OPTIONS [http://localhost:8080/restful/user]

*Actual:* 

*   Trying 127.0.0.1...
* TCP_NODELAY set
* Connected to localhost (127.0.0.1) port 8080 (#0)
* Server auth using Basic with user 'sven'
> OPTIONS /restful/user HTTP/1.1
> Host: localhost:8080
> Authorization: Basic c3ZlbjpwYXNz
> User-Agent: curl/7.55.1
> Accept: */*
> Access-Control-Request-Method: GET
> Origin: [http://localhost:3000|http://localhost:3000/]
>
< HTTP/1.1 500
< Set-Cookie: rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Sun, 25-Oct-2020 10:13:42 GMT
< Vary: Origin
< Vary: Access-Control-Request-Method
< Vary: Access-Control-Request-Headers
< Access-Control-Allow-Origin: [http://localhost:3000|http://localhost:3000/]
< Access-Control-Allow-Methods: GET
< Access-Control-Allow-Credentials: true
< Allow: GET, HEAD, POST, PUT, DELETE, TRACE, OPTIONS, PATCH
< Content-Length: 0
< Date: Mon, 26 Oct 2020 10:13:42 GMT
< Connection: close
<
* Closing connection 0

*Expected:* 

HTTP 200, Content-Length > 0"
ISIS-2453,Task,Closed,Remove TypeManagerImpl Monkey Patch once DN-core 5.2.5 is available,
ISIS-2452,Bug,Closed,NPE within WicketViewerSettingsDefault when deserialized (IsisConfig is null),
ISIS-2451,Improvement,Closed,Remove Dependencies on Google Guava,"Why is this in issue?

Potential version clash with target infrastructure and runtime environment.

eg. JEE containers"
ISIS-2450,Task,Closed,Isis 2.0.0 M5 Release activities,
ISIS-2449,Bug,Closed,RO-Viewer: NPE when action invocation result is null,
ISIS-2448,Bug,Closed,ChicagoFLF.ttf in kroviz hinders bumping maven-resources-plugin to 3.2.0,"Setting an exception breakpoint in java.nio.charset.MalformInputException and debugging mvn clean install shows that an unhandled (EOL?) char is likely the culprit:

haveLeftOverChar= false
 leftOverChar = '\u0000' 0
 cs=""UTF-8""
 in.ch.path=~\incubator\clients\kroviz\src\main\resources\fonts\ChicagoFLF.ttf

Inclusion of the font was just for demo purposes and is not essential - therefore removed. "
ISIS-2447,Improvement,Closed,Add Regression Tests for Isis' Cucubmber Integration,
ISIS-2446,Improvement,Closed,Move JaxbService implementation applib -> runtimeservices,
ISIS-2445,Improvement,In Progress,[Ongoing] CI Maintenance,Ongoing task across releases.
ISIS-2444,Improvement,Closed,Ongoing improvements to the Apache Isis website,
ISIS-2443,New Feature,Closed,Flesh out demo app with further examples,
ISIS-2442,New Feature,Closed,"Bring/document in base, docx from incode-platform.",
ISIS-2441,Bug,Closed,Auditing/Publishing: dispatch calls happen before enlist calls,"At the end of each transaction (before commit), auditing and publishing queries any enlisted objects from the ChangedObjectsService for processing. However enlisting of changed objects happens too late."
ISIS-2440,Bug,Closed,AsciiDoc: value facets not registered properly,"ValueFacetAnnotation (A) overrules ValueFacetUsingSemanticsProvider (B), while A is provided by the core framework whenever processing a @Value annotation, B is provided by the AsciiDoc extension.

{noformat}
(A) ValueFacetAnnotation
	 child org.apache.isis.core.metamodel.facets.object.value.ImmutableFacetViaValueSemantics
	 child org.apache.isis.core.metamodel.facets.object.value.EqualByContentFacetViaValueSemantics
(B) ValueFacetUsingSemanticsProvider
	 child org.apache.isis.core.metamodel.facets.object.value.ImmutableFacetViaValueSemantics
	 child org.apache.isis.core.metamodel.facets.object.defaults.DefaultedFacetUsingDefaultsProvider
	 child org.apache.isis.core.metamodel.facets.object.value.EqualByContentFacetViaValueSemantics
	 child org.apache.isis.core.metamodel.facets.object.encodeable.encoder.EncodableFacetUsingEncoderDecoder
{noformat}

(child means contributed facet)
That's the reason for the EncodableFacet not showing up when the metamodel is fully populated. (edited) "
ISIS-2439,Bug,Closed,JDO Create Schema fails on MariaDB/MySql: SQL Syntax Error,"
{noformat}

java.sql.SQLSyntaxErrorException: (conn=80) You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '""isisExtensionsSecman""' at line 1
	at org.mariadb.jdbc.internal.util.exceptions.ExceptionFactory.createException(ExceptionFactory.java:62) ~[mariadb-java-client-2.7.0.jar:?]
	at org.mariadb.jdbc.internal.util.exceptions.ExceptionFactory.create(ExceptionFactory.java:153) ~[mariadb-java-client-2.7.0.jar:?]
	at org.mariadb.jdbc.MariaDbStatement.executeExceptionEpilogue(MariaDbStatement.java:274) ~[mariadb-java-client-2.7.0.jar:?]
	at org.mariadb.jdbc.MariaDbStatement.executeInternal(MariaDbStatement.java:363) ~[mariadb-java-client-2.7.0.jar:?]
	at org.mariadb.jdbc.MariaDbStatement.execute(MariaDbStatement.java:501) ~[mariadb-java-client-2.7.0.jar:?]
	at org.apache.isis.persistence.jdo.datanucleus5.datanucleus.CreateSchemaObjectFromClassMetadata.exec(CreateSchemaObjectFromClassMetadata.java:120) ~[classes/:?]
	at org.apache.isis.persistence.jdo.datanucleus5.datanucleus.CreateSchemaObjectFromClassMetadata.loaded(CreateSchemaObjectFromClassMetadata.java:77) ~[classes/:?]

{noformat}
"
ISIS-2438,Improvement,Closed,SecMan: rename entity schema 'isissecurity' -> 'isisExtensionsSecman',"Simply let those SecMan entities coexist within the same schema/database alongside the other developer provided entities.

Did not work for MySQL and MariaDB anyway. (Latest JDO drivers: invalid SQL syntax)"
ISIS-2437,Improvement,Closed,[WON'T FIX] Tooling: Sync Gradle files from Maven POMs,"Todo:
- generate tree model of a Maven multi-module project
- generate tree model of a Gradle multi-module project
- diff those 2 models into a deficiency model
- let a deficiency handler correct issues by directly modifying the local filesystem

Issues are:
- differences in *settings.gradle* as generated from Maven model vs Gradle model
-- auto generated from Maven model, can always override any existing in file system
- differences in *dependencies.gradle* as generated from Maven model vs Gradle model
-- optionally needs additional information for shortcut names on external dependencies (but we might just auto-generate these shortcut names aka library references)
-- auto generated from Maven model, can always override any existing in file system
- differences in *build.gradle* as generated from Maven model vs Gradle model
-- handle missing build.gradle file
-- there are open questions: clearly we don't want to support full build.gradle syntax, but just a minimal required subset


"
ISIS-2436,Bug,Closed,[NOT AN ISSUE] Secman: Update name(s) for ApplicationUser causes error,"This is for a SimpleApp based application with the Secman extension installed

*Steps to reproduce*  
 1. Log in as user with administrator (role: isis-module-security-admin)
 2. Go to the user view (for admin user or any other user)
 3. Select ""updateName"" button
 4. Enter text in ""Family Name"" field; tab off
 5. Stacktrace shown

This can also be repeated by doing the same with the ""Given Name"" field
  
*FYI*
 An update can be successfully made by entering the three name fields in this order (before clicking OK):
 1. Known As
 2. Given Name
 3. Family Name
  
 *Screenshot - About to enter Family name and tab off*
 !updatename.png|width=800!
  
 *Screenshot - Tab off Family Name field*
 !error.png|width=800!
  
 *Stack trace:*
{quote} * java.lang.NullPointerException
 * 
 * java.util.Objects#requireNonNull(Objects.java:203)
 * java.util.Optional#<init>(Optional.java:96)
 * java.util.Optional#of(Optional.java:108)
 * java.util.stream.FindOps$FindSink$OfRef#get(FindOps.java:193)
 * java.util.stream.FindOps$FindSink$OfRef#get(FindOps.java:190)
 * java.util.stream.FindOps$FindOp#evaluateSequential(FindOps.java:152)
 * java.util.stream.AbstractPipeline#evaluate(AbstractPipeline.java:234)
 * java.util.stream.ReferencePipeline#findFirst(ReferencePipeline.java:531)
 * org.apache.isis.core.metamodel.facets.param.defaults.methodnum.ActionParameterDefaultsFacetViaMethod#getDefault(ActionParameterDefaultsFacetViaMethod.java:101)
 * org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionParameterAbstract#findDefault(ObjectActionParameterAbstract.java:298)
 * org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionParameterAbstract#getDefault(ObjectActionParameterAbstract.java:288)
 * org.apache.isis.viewer.wicket.model.models.ScalarModel$Kind$2#getDefault(ScalarModel.java:430)
 * org.apache.isis.viewer.wicket.ui.components.scalars.ScalarPanelAbstract2#updateIfNecessary(ScalarPanelAbstract2.java:169)
 * org.apache.isis.viewer.wicket.ui.components.actions.ActionParametersForm#onUpdate(ActionParametersForm.java:178)
 * org.apache.isis.viewer.wicket.ui.components.scalars.ScalarPanelAbstract2$ScalarUpdatingBehavior#onUpdate(ScalarPanelAbstract2.java:561)
 * org.apache.wicket.ajax.form.AjaxFormComponentUpdatingBehavior#onEvent(AjaxFormComponentUpdatingBehavior.java:158)
 * org.apache.wicket.ajax.AjaxEventBehavior#respond(AjaxEventBehavior.java:127)
 * org.apache.wicket.ajax.AbstractDefaultAjaxBehavior#onRequest(AbstractDefaultAjaxBehavior.java:598)
 * org.apache.wicket.core.request.handler.ListenerRequestHandler#internalInvoke(ListenerRequestHandler.java:306)
 * org.apache.wicket.core.request.handler.ListenerRequestHandler#invoke(ListenerRequestHandler.java:280)
 * org.apache.wicket.core.request.handler.ListenerRequestHandler#invokeListener(ListenerRequestHandler.java:222)
 * org.apache.wicket.core.request.handler.ListenerRequestHandler#respond(ListenerRequestHandler.java:208)
 * org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:914)
 * org.apache.wicket.request.RequestHandlerExecutor#execute(RequestHandlerExecutor.java:65)
 * org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:282)
 * org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:253)
 * org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:221)
 * org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:275)
 * org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:206)
 * org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:299)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.apache.isis.core.webapp.modules.logonlog.IsisLogOnExceptionFilter#doFilter(IsisLogOnExceptionFilter.java:60)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.apache.tomcat.websocket.server.WsFilter#doFilter(WsFilter.java:53)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.springframework.web.filter.RequestContextFilter#doFilterInternal(RequestContextFilter.java:100)
 * org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.springframework.web.filter.FormContentFilter#doFilterInternal(FormContentFilter.java:93)
 * org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.springframework.boot.web.servlet.support.ErrorPageFilter#doFilter(ErrorPageFilter.java:128)
 * org.springframework.boot.web.servlet.support.ErrorPageFilter#access$000(ErrorPageFilter.java:66)
 * org.springframework.boot.web.servlet.support.ErrorPageFilter$1#doFilterInternal(ErrorPageFilter.java:103)
 * org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)
 * org.springframework.boot.web.servlet.support.ErrorPageFilter#doFilter(ErrorPageFilter.java:121)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.springframework.web.filter.CharacterEncodingFilter#doFilterInternal(CharacterEncodingFilter.java:201)
 * org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
 * org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
 * org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
 * org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
 * org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:387)
 * org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
 * org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.apache.catalina.core.StandardWrapperValve#invoke(StandardWrapperValve.java:202)
 * org.apache.catalina.core.StandardContextValve#invoke(StandardContextValve.java:96)
 * org.apache.catalina.authenticator.AuthenticatorBase#invoke(AuthenticatorBase.java:541)
 * org.apache.catalina.core.StandardHostValve#invoke(StandardHostValve.java:139)
 * org.apache.catalina.valves.ErrorReportValve#invoke(ErrorReportValve.java:92)
 * org.apache.catalina.valves.AbstractAccessLogValve#invoke(AbstractAccessLogValve.java:690)
 * org.apache.catalina.core.StandardEngineValve#invoke(StandardEngineValve.java:74)
 * org.apache.catalina.connector.CoyoteAdapter#service(CoyoteAdapter.java:343)
 * org.apache.coyote.http11.Http11Processor#service(Http11Processor.java:373)
 * org.apache.coyote.AbstractProcessorLight#process(AbstractProcessorLight.java:65)
 * org.apache.coyote.AbstractProtocol$ConnectionHandler#process(AbstractProtocol.java:868)
 * org.apache.tomcat.util.net.NioEndpoint$SocketProcessor#doRun(NioEndpoint.java:1589)
 * org.apache.tomcat.util.net.SocketProcessorBase#run(SocketProcessorBase.java:49)
 * java.util.concurrent.ThreadPoolExecutor#runWorker(ThreadPoolExecutor.java:1149)
 * java.util.concurrent.ThreadPoolExecutor$Worker#run(ThreadPoolExecutor.java:624)
 * org.apache.tomcat.util.threads.TaskThread$WrappingRunnable#run(TaskThread.java:61)
 * java.lang.Thread#run(Thread.java:748){quote}
 
  
  "
ISIS-2435,Improvement,Closed,Commons: Polishing,"* remove CDI specific code
 * ensure internal classes have underscore prefix
 * write an about.adoc"
ISIS-2434,Improvement,Closed,Bump Spring Boot 2.3.2.RELEASE to 2.3.4.RELEASE,Maintenance releases.
ISIS-2433,Improvement,Closed,Gradle Build: automate 'folder' to 'build artifact name' mapping (settings.gradle),"Particularly use maven artifact keys for this mapping:
{code:java}
:<groupId>:<artifactId>{code}
 "
ISIS-2432,Bug,Closed,SecMan Entities don't render a meaningful Title (eg. User: name not shown),"Actually found, that this is only happening with the Demo, because for demonstration purposes we do have a _DefaultTitleProvider_ there. Probably not implemented correctly."
ISIS-2431,Improvement,Closed,SecMan support for ObjectType (canonical object names),"So called Application Features are currently referenced by fully qualified class names, which breaks persistent authorization data as soon as Application Features are refactored to new class names.

The idea is to collate the objectTypes and use the ""dirname"" part as the package.  Normally this will be a single value, representing a name of the module (though I think there's no restriction; logical subpackages probably would work).

For example, we could have ""customer.Customer"" and ""customer.EmailAddress"" as two object types.  These would both be in the logical package (aka module) of ""customer"".

Or we might have ""customer.Customer"" but also ""customer.contact.EmailAddress"" and ""customer.contact.PhoneNumber"" and ""customer.contact.PostalAddress"".  In this case we would have the module ""customer"" and another inferred module ""customer.contact"".

ASIDE: I could imagine there being some metamodel validation whereby the owning module (Spring `@Configuration`) could specify a module name, and then we check that all domain classes within that module declare an objectType that is equal or a submodule of that owning module.  But that's probably another ticket, for another day."
ISIS-2430,Bug,Closed,"Cannot assume Action Param Spec to be correct when eagerly loaded, eg. SecMan Menu Action (create user) causes Exception","java.lang.IllegalArgumentException: Don't know how to create an ObjectMemento for a type with ObjectSpecification ObjectSpecificationDefault@53129328[class=org.apache.isis.extensions.secman.api.role.ApplicationRole,type=UNKNOWN,superclass=Object]. All other strategies failed. Type is neither identifiable (isManagedBean() || isViewModel() || isEntity()), nor is a 'parented' Collection, nor has 'encodable' semantics, nor is (Serializable || Externalizable)
 at org.apache.isis.core.commons.internal.exceptions._Exceptions.illegalArgument(_Exceptions.java:80) ~[isis-core-commons-2.0.0-M2.20200912-0501-842cc88f.jar:2.0.0-M2.20200912-0501-842cc88f]
 at org.apache.isis.viewer.wicket.viewer.services.mementos.ObjectMementoWkt.init(ObjectMementoWkt.java:471) ~[isis-viewer-wicket-viewer-2.0.0-M2.20200912-0501-842cc88f.jar:2.0.0-M2.20200912-0501-842cc88f]
 at org.apache.isis.viewer.wicket.viewer.services.mementos.ObjectMementoWkt.<init>(ObjectMementoWkt.java:429) ~[isis-viewer-wicket-viewer-2.0.0-M2.20200912-0501-842cc88f.jar:2.0.0-M2.20200912-0501-842cc88f]
 at org.apache.isis.viewer.wicket.viewer.services.mementos.ObjectMementoWkt.createOrNull(ObjectMementoWkt.java:66) ~[isis-viewer-wicket-viewer-2.0.0-M2.20200912-0501-842cc88f.jar:2.0.0-M2.20200912-0501-842cc88f]
 at org.apache.isis.viewer.wicket.viewer.services.mementos.ObjectMementoServiceWicket.mementoForObject(ObjectMementoServiceWicket.java:81) ~[isis-viewer-wicket-viewer-2.0.0-M2.20200912-0501-842cc88f.jar:2.0.0-M2.20200912-0501-842cc88f]
 at org.apache.isis.viewer.wicket.model.models.ManagedObjectModel.setObject(ManagedObjectModel.java:90) ~[isis-viewer-wicket-model-2.0.0-M2.20200912-0501-842cc88f.jar:2.0.0-M2.20200912-0501-842cc88f]
 at org.apache.isis.viewer.wicket.model.models.ScalarParameterModel.setValue(ScalarParameterModel.java:150) ~[isis-viewer-wicket-model-2.0.0-M2.20200912-0501-842cc88f.jar:2.0.0-M2.20200912-0501-842cc88f]
 at org.apache.isis.viewer.wicket.model.models.ActionArgumentCache.lambda$resetTo$1(ActionArgumentCache.java:86) ~[isis-viewer-wicket-model-2.0.0-M2.20200912-0501-842cc88f.jar:2.0.0-M2.20200912-0501-842cc88f]"
ISIS-2429,Bug,Closed,Demo: ThereCanBeOnlyOne shutdown is hardwired to port 8080,Use Spring configured port instead.
ISIS-2428,Improvement,Closed,Cleanup inconsistent Artifact Names,"* _Commons_ to be common to the entire Apache Isis ecosystem.
{code:java}
org.apache.isis.core:isis-core-commons -> org.apache.isis.commons:isis-commons{code}

 * _Isis-Parent_ to be parent to the entire Apache Isis ecosystem.
{code:java}
org.apache.isis.core:isis-parent -> org.apache.isis:isis-parent{code}

 * Rename _Core_ artifact
{code:java}
org.apache.isis.core:isis -> org.apache.isis.core:isis-core{code}

 * Rename/relocate smoketests to regression-tests (regtests)"
ISIS-2427,Improvement,Closed,Create a Docker Image showcasing the Vaadin Demo.,"[x] rename demo-springboot -> demo-wicket
[x] create docker image via CI
[ ] switch vaadin packaging build to 'production'
[ ] is there a way for the vaadin viewer to keep npn stuff local to the viewer's module such that consuming application modules don't require to fetch all the npn modules again, (ideally: don't require devs to have node.js installed locally)

 "
ISIS-2426,Improvement,Closed,"Add Tooling Infrastructure (Project Introspection, Code Mining/Analysis, Reporting)","Gather those building blocks under /tooling, targeted for JVM 11+. These are expected to not depend on any of the Core modules.

 

Future extension:

Add PlantUML diagrams with c4 macros. Generate SVG type images with Antora, that also can contain HTTP links, such that when viewed in a browser these SVG type diagram images allow interactive detail discovery to the interested reader."
ISIS-2425,Sub-task,Closed,Gradle Build (CI) does not fail when Metamodel Tests fail,"There might be other modules too. We need to make sure, all the modules are tested during run of the CI pipeline."
ISIS-2424,Improvement,Closed,Separation of Concerns for Spec-Loader-Cache and IsisBeanTypeRegistry,"It would be great to get rid of the quick classification stuff in IsisBeanTypeRegistry, because determining the BeanSort is ultimately a meta-model concern (responsibility of the ObjectSpecificationLoader).

IsisBeanTypeRegistry can only operate before Spring's Context is available, hence does not have access to provisioned services, while the ObjectSpecificationLoader does.

IsisBeanTypeRegistry's responsibility should be trimmed down to just
 * provide alternative bean naming to override Spring's defaults (objectType=""..."")
 * determine which types to introspect (inbox for spec-loader)

BeanSort classification should happen then at a later stage, when Spring's context is available.

 

 

 

 "
ISIS-2423,Bug,Closed,"Persisted callback and PublisherService#changedObjects are not called, instead appear as updates.","Due to use of EntityUtil.isAttached(...) in the PersistenceSession5#enlistCreated... method, rather than checking our own Oid.  In this particular case they were not equivalent.

Fix:

- was able to simplify and remove some redundant code, using instead

persistable.dnGetStateManager().isNew(persistable)

as the mechanism to determine in preStore/postStore whether we are dealing within an insert or an update."
ISIS-2422,Improvement,Closed,"Treat schema DTOs (InteractionDto, ChangesDto, CommandDto) as value types.","And as a nice-to-have, extend the Asciidoc component to be able to render these as nicely formatted XML."
ISIS-2421,Bug,Closed,Demo fat jar fails to launch - could not find asciidoctor jruby file,"context:  [https://the-asf.slack.com/archives/CFC42LWBV/p1596851537015600]

 

running the generated demo wicket jar with java -jar fails on startup.

Need to add the requiresUnpack configuration to the spring boot repackage process. 

 

<configuration>
     <requiresUnpack>
        <dependency>
           <groupId>org.asciidoctor</groupId>
           <artifactId>asciidoctorj</artifactId>
        </dependency>
     </requiresUnpack>
 </configuration>

 "
ISIS-2420,Bug,Closed,Testing fails when certain beans are injected,"see [https://github.com/bkalbfus/isis-app-simpleapp]

Spring cannot find a bean to inject when running integration or BDD tests.  Skipping test allows SimpleModule to build and then WebApp module can run with spring-boot:run.  Wicket app works perfectly.

 

Cases documented in referenced repo:
 # Spring Event listener does not get domain service injected for BDD tests.  Launching in Wicket viewer is functioning as expected.  This is shown in NewUserService in WebApp module.
 # SimpleObjects injects ApplicationUserRepository.  Tests fail the same way.  Spring cannot find a bean to inject.

 "
ISIS-2419,Improvement,Closed,"Less verbose Action Dialog Validation Feedback, if its (just) a Constraint Violation (suppress Category)","If I have an action ""update"" that is validated in it's entirety by a validation method ""validateUpdate"" then the error message in the wicket viewer shows unwanted boiler plate wording (""_[violation of some declarative constraint]:_"") together with the desired error message.

*Screenshot of unwanted text:*

!image-2020-08-05-22-26-25-207.png|width=516,height=332!

*Code that produces the message*
{code:java}
	@Action(semantics = SemanticsOf.NON_IDEMPOTENT)
	public Task update(
			TaskStatus status,
			@Parameter(optionality = Optionality.OPTIONAL) String comment) {
		
		this.status = status;

		if (comment != null) {
			this.comments = """".concat(this.comments).concat(comment).concat(""\n"");
		}

		return repositoryService.persist(this);
	}
	
	public String validateUpdate(TaskStatus status, String comment) {
		if (this.status != status) {
			if (this.status == TaskStatus.Complete || this.status == TaskStatus.Cancelled) {
				return ""Can't change status of a task that is Complete or Cancelled"";
			}
		}
		return null;
	}
{code}
This problem does not manifest if I do validation on only one of the action parameters, as follows:

*Screenshot:*

*!image-2020-08-05-22-29-10-621.png|width=627,height=358!*

*Code of validation message:*

 
{code:java}
	public String validate0Update(TaskStatus status) {
		if (this.status != status) {
			if (this.status == TaskStatus.Complete || this.status == TaskStatus.Cancelled) {
				return ""Can't change status of a task that is Complete or Cancelled"";
			}
		}
		return null;
	}
{code}


 "
ISIS-2418,Bug,Closed,deselecting checkboxes for collection per @Action(associateWith) doesn't work.,
ISIS-2417,Wish,Closed,[Wish] Support @javax.inject.Named annotation for Domain Objects,"These must be unique, and Spring will use the simple class name as a fallback, so has very similar semantics to our own objectType.

Probably need a validator to ensure that @Named and objectType=... are not both specified (or, if they are, that the value is one and the same)."
ISIS-2416,Improvement,Closed,Allow action domain event handlers to change argument in the executing phase.,
ISIS-2415,Bug,Open,"""mustSatisfy"" cannot be used in a meta-annotation","@Property(mustSatisfy=..) and @Parameter(mustSatisfy=...)

To reproduce, unhide properties and mixins in demo app for @Property(mustSatisfy=....)"
ISIS-2414,Improvement,Closed,"Infer maxLength semantic for primitives, eg short should be 6 characters max.",
ISIS-2413,Improvement,Closed,Improve UI for Isis' Blob type in the Wicket viewer.,"It all seems to work, but it's a bit ugly.

In the demo app, More Types > Blobs.

Also, in the table, shows additoinal buttons.

!image-2020-07-18-16-06-34-927.png!"
ISIS-2412,Bug,Closed,java.awt.Image does not render (simply blank) not persist (ditto),"for demo, unhide JavaAwtTypesMenu#images()"
ISIS-2411,Bug,Closed,Remove Isis Image (use AWT's BufferedImage instead),Java AWT's BufferImage is supported as value type by the framework.
ISIS-2410,Bug,Closed,ZonedDateTime does not render/parse correctly.,"Only renders first part of the date.

To recreate, re-enable in JavaTimeTypesMenu#zonedDateTimes()."
ISIS-2409,Bug,Closed,Offset Time does not render in the demo app.,"to reproduce: uncomment JavaTimeTypesMenu#offsetTimes()
{code:java}
 {code}
 * org.apache.wicket.WicketRuntimeException
 * Error attaching this container for rendering: [WebMarkupContainer [Component id = body]]
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1766)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.markup.repeater.AbstractRepeater#onBeforeRender(AbstractRepeater.java:143)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.markup.repeater.AbstractRepeater#onBeforeRender(AbstractRepeater.java:143)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.markup.repeater.AbstractRepeater#onBeforeRender(AbstractRepeater.java:143)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.markup.repeater.AbstractRepeater#onBeforeRender(AbstractRepeater.java:143)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.markup.repeater.AbstractRepeater#onBeforeRender(AbstractRepeater.java:143)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Page#onBeforeRender(Page.java:789)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.Page#renderPage(Page.java:991)
 * org.apache.wicket.request.handler.render.WebPageRenderer#renderPage(WebPageRenderer.java:124)
 * org.apache.wicket.request.handler.render.WebPageRenderer#respond(WebPageRenderer.java:195)
 * org.apache.wicket.core.request.handler.RenderPageRequestHandler#respond(RenderPageRequestHandler.java:202)
 * org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:914)
 * org.apache.wicket.request.RequestHandlerExecutor#execute(RequestHandlerExecutor.java:65)
 * org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:282)
 * org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:253)
 * org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:221)
 * org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:275)
 * org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:206)
 * org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:299)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.apache.isis.core.webapp.modules.logonlog.IsisLogOnExceptionFilter#doFilter(IsisLogOnExceptionFilter.java:60)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.springframework.web.filter.RequestContextFilter#doFilterInternal(RequestContextFilter.java:100)
 * org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.springframework.web.filter.FormContentFilter#doFilterInternal(FormContentFilter.java:93)
 * org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.springframework.web.filter.CharacterEncodingFilter#doFilterInternal(CharacterEncodingFilter.java:201)
 * org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
 * org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
 * org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
 * org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
 * org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:387)
 * org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
 * org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.apache.catalina.core.StandardWrapperValve#invoke(StandardWrapperValve.java:202)
 * org.apache.catalina.core.StandardContextValve#invoke(StandardContextValve.java:96)
 * org.apache.catalina.authenticator.AuthenticatorBase#invoke(AuthenticatorBase.java:541)
 * org.apache.catalina.core.StandardHostValve#invoke(StandardHostValve.java:139)
 * org.apache.catalina.valves.ErrorReportValve#invoke(ErrorReportValve.java:92)
 * org.apache.catalina.core.StandardEngineValve#invoke(StandardEngineValve.java:74)
 * org.apache.catalina.connector.CoyoteAdapter#service(CoyoteAdapter.java:343)
 * org.apache.coyote.http11.Http11Processor#service(Http11Processor.java:373)
 * org.apache.coyote.AbstractProcessorLight#process(AbstractProcessorLight.java:65)
 * org.apache.coyote.AbstractProtocol$ConnectionHandler#process(AbstractProtocol.java:868)
 * org.apache.tomcat.util.net.NioEndpoint$SocketProcessor#doRun(NioEndpoint.java:1590)
 * org.apache.tomcat.util.net.SocketProcessorBase#run(SocketProcessorBase.java:49)
 * java.util.concurrent.ThreadPoolExecutor#runWorker(ThreadPoolExecutor.java:1128)
 * java.util.concurrent.ThreadPoolExecutor$Worker#run(ThreadPoolExecutor.java:628)
 * org.apache.tomcat.util.threads.TaskThread$WrappingRunnable#run(TaskThread.java:61)
 * java.lang.Thread#run(Thread.java:834)
 * 
 * Caused by:
 * 
 * java.lang.NullPointerException
 * offset
 * java.util.Objects#requireNonNull(Objects.java:246)
 * java.time.OffsetTime#<init>(OffsetTime.java:339)
 * java.time.OffsetTime#of(OffsetTime.java:236)
 * org.datanucleus.store.types.converters.OffsetTimeSqlTimeConverter#toMemberType(OffsetTimeSqlTimeConverter.java:42)
 * org.datanucleus.store.types.converters.OffsetTimeSqlTimeConverter#toMemberType(OffsetTimeSqlTimeConverter.java:29)
 * org.datanucleus.store.rdbms.mapping.java.TypeConverterMapping#getMemberValueFromDatastore(TypeConverterMapping.java:256)
 * org.datanucleus.store.rdbms.mapping.java.TypeConverterMapping#getObject(TypeConverterMapping.java:536)
 * org.datanucleus.store.rdbms.fieldmanager.ResultSetGetter#fetchObjectField(ResultSetGetter.java:181)
 * org.datanucleus.state.StateManagerImpl#replacingObjectField(StateManagerImpl.java:1995)
 * demoapp.dom.types.javatime.javatimeoffsettime.jdo.JavaTimeOffsetTimeJdo#dnReplaceField(JavaTimeOffsetTimeJdo.java:-1)
 * demoapp.dom.types.javatime.javatimeoffsettime.jdo.JavaTimeOffsetTimeJdo#dnReplaceFields(JavaTimeOffsetTimeJdo.java:-1)
 * org.datanucleus.state.StateManagerImpl#replaceFields(StateManagerImpl.java:4320)
 * org.datanucleus.store.rdbms.query.PersistentClassROF$1#fetchFields(PersistentClassROF.java:482)
 * org.datanucleus.state.StateManagerImpl#loadFieldValues(StateManagerImpl.java:3737)
 * org.datanucleus.state.StateManagerImpl#initialiseForHollow(StateManagerImpl.java:383)
 * org.datanucleus.state.ObjectProviderFactoryImpl#newForHollow(ObjectProviderFactoryImpl.java:99)
 * org.datanucleus.ExecutionContextImpl#findObject(ExecutionContextImpl.java:3199)
 * org.datanucleus.store.rdbms.query.PersistentClassROF#findObjectWithIdAndLoadFields(PersistentClassROF.java:477)
 * org.datanucleus.store.rdbms.query.PersistentClassROF#getObject(PersistentClassROF.java:412)
 * org.datanucleus.store.rdbms.query.ForwardQueryResult#nextResultSetElement(ForwardQueryResult.java:181)
 * org.datanucleus.store.rdbms.query.ForwardQueryResult$QueryResultIterator#next(ForwardQueryResult.java:409)
 * org.datanucleus.store.rdbms.query.ForwardQueryResult#processNumberOfResults(ForwardQueryResult.java:137)
 * org.datanucleus.store.rdbms.query.ForwardQueryResult#advanceToEndOfResultSet(ForwardQueryResult.java:165)
 * org.datanucleus.store.rdbms.query.ForwardQueryResult#toArray(ForwardQueryResult.java:532)
 * java.util.ArrayList#<init>(ArrayList.java:179)
 * org.apache.isis.core.commons.internal.collections._Lists#newArrayList(_Lists.java:125)
 * org.apache.isis.persistence.jdo.datanucleus5.jdosupport.IsisJdoSupportDN5#executeListAndClose(IsisJdoSupportDN5.java:200)
 * org.apache.isis.persistence.jdo.datanucleus5.jdosupport.IsisJdoSupportDN5#executeQuery(IsisJdoSupportDN5.java:178)
 * org.apache.isis.persistence.jdo.applib.services.IsisJdoSupport_v3_2#executeQuery(IsisJdoSupport_v3_2.java:60)
 * org.apache.isis.persistence.jdo.datanucleus5.datanucleus.persistence.queries.PersistenceQueryFindAllInstancesProcessor#process(PersistenceQueryFindAllInstancesProcessor.java:52)
 * org.apache.isis.persistence.jdo.datanucleus5.datanucleus.persistence.queries.PersistenceQueryFindAllInstancesProcessor#process(PersistenceQueryFindAllInstancesProcessor.java:29)
 * org.apache.isis.persistence.jdo.datanucleus5.persistence.PersistenceSession5#processPersistenceQuery(PersistenceSession5.java:381)
 * org.apache.isis.persistence.jdo.datanucleus5.persistence.PersistenceSession5#lambda$findInstancesInTransaction$0(PersistenceSession5.java:340)
 * org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring#executeWithinTransaction(TransactionServiceSpring.java:163)
 * org.apache.isis.persistence.jdo.datanucleus5.persistence.PersistenceSession5#findInstancesInTransaction(PersistenceSession5.java:339)
 * org.apache.isis.persistence.jdo.datanucleus5.persistence.PersistenceSession5#allMatchingQuery(PersistenceSession5.java:303)
 * org.apache.isis.persistence.jdo.datanucleus5.metamodel.facets.object.persistencecapable.JdoPersistenceCapableFacetImpl#fetchByQuery(JdoPersistenceCapableFacetImpl.java:72)
 * org.apache.isis.core.metamodel.objectmanager.query.ObjectBulkLoader_builtinHandlers$BulkLoadEntity#handle(ObjectBulkLoader_builtinHandlers.java:93)
 * org.apache.isis.core.metamodel.objectmanager.query.ObjectBulkLoader_builtinHandlers$BulkLoadEntity#handle(ObjectBulkLoader_builtinHandlers.java:71)
 * org.apache.isis.core.commons.handler.ChainOfResponsibility#lambda$of$1(ChainOfResponsibility.java:75)
 * java.util.Optional#map(Optional.java:265)
 * org.apache.isis.core.commons.handler.ChainOfResponsibility#lambda$of$2(ChainOfResponsibility.java:75)
 * org.apache.isis.core.metamodel.objectmanager.query.ObjectBulkLoader#lambda$createDefault$2(ObjectBulkLoader.java:72)
 * org.apache.isis.core.metamodel.objectmanager.ObjectManager#queryObjects(ObjectManager.java:78)
 * org.apache.isis.core.runtimeservices.repository.RepositoryServiceDefault#submitQuery(RepositoryServiceDefault.java:173)
 * org.apache.isis.core.runtimeservices.repository.RepositoryServiceDefault#allMatches(RepositoryServiceDefault.java:164)
 * org.apache.isis.core.runtimeservices.repository.RepositoryServiceDefault#allInstances(RepositoryServiceDefault.java:137)
 * org.apache.isis.core.runtimeservices.repository.RepositoryServiceDefault$$FastClassBySpringCGLIB$$70885c77#invoke(<generated>:-1)
 * org.springframework.cglib.proxy.MethodProxy#invoke(MethodProxy.java:218)
 * org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation#invokeJoinpoint(CglibAopProxy.java:771)
 * org.springframework.aop.framework.ReflectiveMethodInvocation#proceed(ReflectiveMethodInvocation.java:163)
 * org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation#proceed(CglibAopProxy.java:749)
 * org.springframework.dao.support.PersistenceExceptionTranslationInterceptor#invoke(PersistenceExceptionTranslationInterceptor.java:139)
 * org.springframework.aop.framework.ReflectiveMethodInvocation#proceed(ReflectiveMethodInvocation.java:186)
 * org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation#proceed(CglibAopProxy.java:749)
 * org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor#intercept(CglibAopProxy.java:691)
 * org.apache.isis.core.runtimeservices.repository.RepositoryServiceDefault$$EnhancerBySpringCGLIB$$f72026cd#allInstances(<generated>:-1)
 * demoapp.dom.types.javatime.javatimeoffsettime.jdo.JavaTimeOffsetTimeJdoEntities#all(JavaTimeOffsetTimeJdoEntities.java:20)
 * demoapp.dom.types.javatime.javatimeoffsettime.JavaTimeOffsetTimes#getEntities(JavaTimeOffsetTimes.java:69)
 * jdk.internal.reflect.NativeMethodAccessorImpl#invoke0(NativeMethodAccessorImpl.java:-2)
 * jdk.internal.reflect.NativeMethodAccessorImpl#invoke(NativeMethodAccessorImpl.java:62)
 * jdk.internal.reflect.DelegatingMethodAccessorImpl#invoke(DelegatingMethodAccessorImpl.java:43)
 * java.lang.reflect.Method#invoke(Method.java:566)
 * org.apache.isis.core.metamodel.commons.CanonicalParameterUtil#invoke(CanonicalParameterUtil.java:72)
 * org.apache.isis.core.metamodel.commons.MethodExtensions#invoke(MethodExtensions.java:61)
 * org.apache.isis.core.metamodel.commons.MethodExtensions#invoke(MethodExtensions.java:55)
 * org.apache.isis.core.metamodel.spec.ManagedObjects$InvokeUtil#invoke(ManagedObjects.java:615)
 * org.apache.isis.core.metamodel.facets.collections.accessor.CollectionAccessorFacetViaAccessor#getProperty(CollectionAccessorFacetViaAccessor.java:69)
 * org.apache.isis.core.metamodel.specloader.specimpl.OneToManyAssociationDefault#get(OneToManyAssociationDefault.java:167)
 * org.apache.isis.viewer.wicket.model.models.EntityCollectionModel$Variant$2#load(EntityCollectionModel.java:212)
 * org.apache.isis.viewer.wicket.model.models.EntityCollectionModel#load(EntityCollectionModel.java:421)
 * org.apache.isis.viewer.wicket.model.models.EntityCollectionModel#load(EntityCollectionModel.java:72)
 * org.apache.wicket.model.LoadableDetachableModel#getObject(LoadableDetachableModel.java:128)
 * org.apache.isis.viewer.wicket.ui.components.collectioncontents.ajaxtable.CollectionContentsSortableDataProvider#size(CollectionContentsSortableDataProvider.java:67)
 * org.apache.wicket.markup.repeater.data.DataViewBase#internalGetItemCount(DataViewBase.java:142)
 * org.apache.wicket.markup.repeater.AbstractPageableView#getItemCount(AbstractPageableView.java:214)
 * org.apache.wicket.markup.repeater.AbstractPageableView#getRowCount(AbstractPageableView.java:195)
 * org.apache.wicket.markup.repeater.AbstractPageableView#getViewSize(AbstractPageableView.java:293)
 * org.apache.wicket.markup.repeater.AbstractPageableView#getItemModels(AbstractPageableView.java:97)
 * org.apache.wicket.markup.repeater.RefreshingView#onPopulate(RefreshingView.java:93)
 * org.apache.wicket.markup.repeater.AbstractRepeater#onBeforeRender(AbstractRepeater.java:124)
 * org.apache.wicket.markup.repeater.AbstractPageableView#onBeforeRender(AbstractPageableView.java:113)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.markup.repeater.AbstractRepeater#onBeforeRender(AbstractRepeater.java:143)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.markup.repeater.AbstractRepeater#onBeforeRender(AbstractRepeater.java:143)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.markup.repeater.AbstractRepeater#onBeforeRender(AbstractRepeater.java:143)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.markup.repeater.AbstractRepeater#onBeforeRender(AbstractRepeater.java:143)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.markup.repeater.AbstractRepeater#onBeforeRender(AbstractRepeater.java:143)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1754)
 * org.apache.wicket.Component#onBeforeRender(Component.java:3801)
 * org.apache.wicket.Page#onBeforeRender(Page.java:789)
 * org.apache.wicket.Component#beforeRender(Component.java:939)
 * org.apache.wicket.Page#renderPage(Page.java:991)
 * org.apache.wicket.request.handler.render.WebPageRenderer#renderPage(WebPageRenderer.java:124)
 * org.apache.wicket.request.handler.render.WebPageRenderer#respond(WebPageRenderer.java:195)
 * org.apache.wicket.core.request.handler.RenderPageRequestHandler#respond(RenderPageRequestHandler.java:202)
 * org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:914)
 * org.apache.wicket.request.RequestHandlerExecutor#execute(RequestHandlerExecutor.java:65)
 * org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:282)
 * org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:253)
 * org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:221)
 * org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:275)
 * org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:206)
 * org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:299)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.apache.isis.core.webapp.modules.logonlog.IsisLogOnExceptionFilter#doFilter(IsisLogOnExceptionFilter.java:60)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.springframework.web.filter.RequestContextFilter#doFilterInternal(RequestContextFilter.java:100)
 * org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.springframework.web.filter.FormContentFilter#doFilterInternal(FormContentFilter.java:93)
 * org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.springframework.web.filter.CharacterEncodingFilter#doFilterInternal(CharacterEncodingFilter.java:201)
 * org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
 * org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
 * org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
 * org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
 * org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:387)
 * org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
 * org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
 * org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)
 * org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)
 * org.apache.catalina.core.StandardWrapperValve#invoke(StandardWrapperValve.java:202)
 * org.apache.catalina.core.StandardContextValve#invoke(StandardContextValve.java:96)
 * org.apache.catalina.authenticator.AuthenticatorBase#invoke(AuthenticatorBase.java:541)
 * org.apache.catalina.core.StandardHostValve#invoke(StandardHostValve.java:139)
 * org.apache.catalina.valves.ErrorReportValve#invoke(ErrorReportValve.java:92)
 * org.apache.catalina.core.StandardEngineValve#invoke(StandardEngineValve.java:74)
 * org.apache.catalina.connector.CoyoteAdapter#service(CoyoteAdapter.java:343)
 * org.apache.coyote.http11.Http11Processor#service(Http11Processor.java:373)
 * org.apache.coyote.AbstractProcessorLight#process(AbstractProcessorLight.java:65)
 * org.apache.coyote.AbstractProtocol$ConnectionHandler#process(AbstractProtocol.java:868)
 * org.apache.tomcat.util.net.NioEndpoint$SocketProcessor#doRun(NioEndpoint.java:1590)
 * org.apache.tomcat.util.net.SocketProcessorBase#run(SocketProcessorBase.java:49)
 * java.util.concurrent.ThreadPoolExecutor#runWorker(ThreadPoolExecutor.java:1128)
 * java.util.concurrent.ThreadPoolExecutor$Worker#run(ThreadPoolExecutor.java:628)
 * org.apache.tomcat.util.threads.TaskThread$WrappingRunnable#run(TaskThread.java:61)
 * java.lang.Thread#run(Thread.java:834)

 "
ISIS-2408,Improvement,Closed,Support for RenderedAdjusted facet for datetimes should be pluggable.,"Currently the list of types is hard-coded in IsisConverterLocator

It is also inconsistent with the subclasses of ScalarPanelTextFieldDatePickerAbstract and calls to #getAdjustBy().

 
{code:java}
if (java.util.Date.class == correspondingClass) {
 return _Casts.uncheckedCast(new DateConverterForJavaUtilDate(wicketViewerSettings, adjustBy));
}
if (java.sql.Date.class == correspondingClass) {
 ...
}
if (org.joda.time.LocalDate.class == correspondingClass) {
 ...
}
if (org.joda.time.LocalDateTime.class == correspondingClass) {
 ...
}
if (org.joda.time.DateTime.class == correspondingClass) {
 ...
}
if (java.sql.Timestamp.class == correspondingClass) {
 ...
} {code}
 "
ISIS-2407,Bug,Closed,CORS Extension breaks Wicket Viewer (bulk select issues),"as discovered with https://issues.apache.org/jira/browse/ISIS-2311

A newer CORS implementation might work."
ISIS-2406,Bug,Closed,Header should be sticky (but currently scrolls up),
ISIS-2405,Bug,Closed,"@Property mixin on a view model cannot be defined, fails to render with ClassCastException","To reproduce, uncomment // @Property for PropertyLayoutCssClassVm_annotatedMixin in the demo app."
ISIS-2404,Bug,Closed,Param Negotiation clears already filled out Param when non-scalar,At least seeing this with enum choices.
ISIS-2403,Bug,Closed,"'Rebuild metamodel' seems to deadlock, at least in the demo app.","This seems to be quite recently introduced (in the last week...).

Clicking on 'rebuild metamodel' generates this in the log:
{code:java}
2020-07-13 13:38:11.680  INFO 5636 --- [nio-8080-exec-4] o.a.w.u.c.ClassCryptFactory              : using encryption/decryption object org.apache.wicket.util.crypt.SunJceCrypt@219be65c
...
2020-07-13 13:40:41.297  WARN 5636 --- [nio-8080-exec-8] o.a.i.c.m.s.SpecificationLoaderDefault   : Missed class 'demoapp.dom.annotations.PropertyLayout.cssClass.PropertyLayoutCssClassVm' when the metamodel was fully introspected.
2020-07-13 13:40:41.297 ERROR 5636 --- [nio-8080-exec-8] o.a.i.c.m.s.SpecificationLoaderDefault   : Introspecting class 'demoapp.dom.annotations.PropertyLayout.cssClass.PropertyLayoutCssClassVm' of sort VIEW_MODEL, after the metamodel had been fully introspected and is now locked. One reason this can happen is if you are attempting to invoke an action through the WrapperFactory on a service class incorrectly annotated with Spring's @Service annotation instead of @DomainService.
2020-07-13 13:40:41.299  WARN 5636 --- [nio-8080-exec-8] o.a.i.c.m.s.SpecificationLoaderDefault   : Missed class 'java.lang.Object' when the metamodel was fully introspected.
 {code}
and a thread dump shows these two threads:
{code:java}
""http-nio-8080-exec-8@13871"" daemon prio=5 tid=0x1bb nid=NA waiting""http-nio-8080-exec-8@13871"" daemon prio=5 tid=0x1bb nid=NA waiting  java.lang.Thread.State: WAITING  blocks ForkJoinPool.commonPool-worker-27@17638   at java.lang.Object.wait(Object.java:-1)   at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:330)   at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:412)   at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:736)   at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)   at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)   at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)   at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497)   at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:661)   at org.apache.isis.core.commons.internal.collections.snapshot._VersionedList$Snapshot.forEachParallel(_VersionedList.java:79)   at org.apache.isis.core.commons.internal.collections.snapshot._VersionedList.forEachParallel(_VersionedList.java:176)   at org.apache.isis.core.metamodel.specloader.SpecificationLoaderDefault.forEach(SpecificationLoaderDefault.java:417)   at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorVisiting.validateAll(MetaModelValidatorVisiting.java:96)   at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorVisiting.collectFailuresInto(MetaModelValidatorVisiting.java:87)   at org.apache.isis.core.metamodel.specloader.SpecificationLoaderDefault.lambda$collectFailuresFromMetaModel$2(SpecificationLoaderDefault.java:299)   at org.apache.isis.core.metamodel.specloader.SpecificationLoaderDefault$$Lambda$1676.1195616447.accept(Unknown Source:-1)   at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)   at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195)   at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1654)   at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)   at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474)   at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)   at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)   at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)   at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497)   at org.apache.isis.core.metamodel.specloader.SpecificationLoaderDefault.collectFailuresFromMetaModel(SpecificationLoaderDefault.java:296)   at org.apache.isis.core.metamodel.specloader.SpecificationLoaderDefault$$Lambda$670.1483799557.get(Unknown Source:-1)   at org.apache.isis.core.commons.internal.base._Lazy_ThreadSafe.get(_Lazy_ThreadSafe.java:64)   - locked <0x5c56> (a org.apache.isis.core.commons.internal.base._Lazy_ThreadSafe)   at org.apache.isis.core.metamodel.specloader.SpecificationLoaderDefault.getValidationResult(SpecificationLoaderDefault.java:286)   at org.apache.isis.core.metamodel.specloader.SpecificationLoaderDefault.revalidateIfNecessary(SpecificationLoaderDefault.java:397)   at org.apache.isis.core.metamodel.specloader.specimpl.ObjectSpecificationAbstract.introspectUpTo(ObjectSpecificationAbstract.java:321)   at org.apache.isis.core.metamodel.specloader.SpecificationLoaderDefault.loadSpecification(SpecificationLoaderDefault.java:382)   at org.apache.isis.core.metamodel.specloader.SpecificationLoaderDefault.reloadSpecification(SpecificationLoaderDefault.java:340)   at org.apache.isis.core.metamodel.services.metamodel.MetaModelServiceDefault.rebuild(MetaModelServiceDefault.java:101)   at org.apache.isis.applib.mixins.layout.Object_rebuildMetamodel.act(Object_rebuildMetamodel.java:58)   at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(NativeMethodAccessorImpl.java:-1)   at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)   at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:566)   at org.apache.isis.core.metamodel.commons.CanonicalParameterUtil.invoke(CanonicalParameterUtil.java:72)   at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.invokeMethodElseFromCache(ActionInvocationFacetForDomainEventAbstract.java:277)   at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.access$400(ActionInvocationFacetForDomainEventAbstract.java:75)   at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$DomainEventMemberExecutor.execute(ActionInvocationFacetForDomainEventAbstract.java:455)   at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$DomainEventMemberExecutor.execute(ActionInvocationFacetForDomainEventAbstract.java:408)   at org.apache.isis.applib.services.iactn.Interaction.executeInternal(Interaction.java:204)   at org.apache.isis.applib.services.iactn.Interaction.execute(Interaction.java:171)   at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.doInvoke(ActionInvocationFacetForDomainEventAbstract.java:207)   at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.lambda$invoke$0(ActionInvocationFacetForDomainEventAbstract.java:128)   at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$$Lambda$2310.207403167.get(Unknown Source:-1)   at org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinTransaction(TransactionServiceSpring.java:163)   at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.invoke(ActionInvocationFacetForDomainEventAbstract.java:127)   at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeInternal(ObjectActionDefault.java:451)   at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionMixedIn.execute(ObjectActionMixedIn.java:167)   at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeWithRuleChecking(ObjectActionDefault.java:418)   at org.apache.isis.viewer.wicket.model.models.ActionModel.executeAction(ActionModel.java:198)   at org.apache.isis.viewer.wicket.model.models.ActionModel.load(ActionModel.java:177)   at org.apache.isis.viewer.wicket.model.models.ActionModel.load(ActionModel.java:67)   at org.apache.wicket.model.LoadableDetachableModel.getObject(LoadableDetachableModel.java:128)   at org.apache.isis.viewer.wicket.model.models.ActionModel.execute(ActionModel.java:262)   at org.apache.isis.viewer.wicket.ui.components.actions.ActionFormExecutorStrategy.obtainResultAdapter(ActionFormExecutorStrategy.java:73)   at org.apache.isis.viewer.wicket.ui.panels.FormExecutorDefault.obtainResultAdapter(FormExecutorDefault.java:518)   at org.apache.isis.viewer.wicket.ui.panels.FormExecutorDefault.executeAndProcessResults(FormExecutorDefault.java:147)   at org.apache.isis.viewer.wicket.ui.components.widgets.linkandlabel.LinkAndLabelFactoryAbstract.onClick(LinkAndLabelFactoryAbstract.java:237)   at org.apache.isis.viewer.wicket.ui.components.widgets.linkandlabel.LinkAndLabelFactoryAbstract.access$000(LinkAndLabelFactoryAbstract.java:70)   at org.apache.isis.viewer.wicket.ui.components.widgets.linkandlabel.LinkAndLabelFactoryAbstract$1.performOnClick(LinkAndLabelFactoryAbstract.java:140)   at org.apache.isis.viewer.wicket.ui.components.widgets.linkandlabel.LinkAndLabelFactoryAbstract$1.doOnClick(LinkAndLabelFactoryAbstract.java:135)   at org.apache.isis.viewer.wicket.ui.components.widgets.linkandlabel.ActionLink.onClick(ActionLink.java:104)   at org.apache.wicket.ajax.markup.html.AjaxLink$1.onEvent(AjaxLink.java:85)   at org.apache.wicket.ajax.AjaxEventBehavior.respond(AjaxEventBehavior.java:127)   at org.apache.wicket.ajax.AbstractDefaultAjaxBehavior.onRequest(AbstractDefaultAjaxBehavior.java:598)   at org.apache.wicket.core.request.handler.ListenerRequestHandler.internalInvoke(ListenerRequestHandler.java:306)   at org.apache.wicket.core.request.handler.ListenerRequestHandler.invoke(ListenerRequestHandler.java:280)   at org.apache.wicket.core.request.handler.ListenerRequestHandler.invokeListener(ListenerRequestHandler.java:222)   at org.apache.wicket.core.request.handler.ListenerRequestHandler.respond(ListenerRequestHandler.java:208)   at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:914)   at org.apache.wicket.request.RequestHandlerExecutor.execute(RequestHandlerExecutor.java:65)   at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:282)   at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:253)   at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:221)   at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:275)   at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:206)   at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:299)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)   at org.apache.isis.core.webapp.modules.logonlog.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:60)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)   at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)   at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)   at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)   at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)   at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)   at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)   at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)   at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)   at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)   at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)   at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)   at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)   at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)   at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)   at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)   at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541)   at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)   at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)   at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)   at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)   at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:373)   at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)   at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)   at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)   at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)   - locked <0x5c57> (a org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper)   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)   at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)   at java.lang.Thread.run(Thread.java:834) {code}
and 
{code:java}
 ""ForkJoinPool.commonPool-worker-27@17638"" daemon prio=5 tid=0x1cb nid=NA waiting for monitor entry""ForkJoinPool.commonPool-worker-27@17638"" daemon prio=5 tid=0x1cb nid=NA waiting for monitor entry  java.lang.Thread.State: BLOCKED  waiting for http-nio-8080-exec-8@13871 to release lock on <0x5c56> (a org.apache.isis.core.commons.internal.base._Lazy_ThreadSafe)   at org.apache.isis.core.commons.internal.base._Lazy_ThreadSafe.isMemoized(_Lazy_ThreadSafe.java:45)   at org.apache.isis.core.metamodel.specloader.SpecificationLoaderDefault.revalidateIfNecessary(SpecificationLoaderDefault.java:395)   at org.apache.isis.core.metamodel.specloader.specimpl.ObjectSpecificationAbstract.introspectUpTo(ObjectSpecificationAbstract.java:321)   at org.apache.isis.core.metamodel.specloader.specimpl.ObjectSpecificationAbstract.streamObjectActions(ObjectSpecificationAbstract.java:738)   at org.apache.isis.core.metamodel.spec.feature.ObjectActionContainer.lambda$streamObjectActions$2(ObjectActionContainer.java:89)   at org.apache.isis.core.metamodel.spec.feature.ObjectActionContainer$$Lambda$1388.92566262.apply(Unknown Source:-1)   at java.util.stream.ReferencePipeline$7$1.accept(ReferencePipeline.java:271)   at java.util.Iterator.forEachRemaining(Iterator.java:133)   at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)   at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)   at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474)   at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:913)   at java.util.stream.ReduceOps$5.evaluateSequential(ReduceOps.java:257)   at java.util.stream.ReduceOps$5.evaluateSequential(ReduceOps.java:248)   at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)   at java.util.stream.ReferencePipeline.count(ReferencePipeline.java:605)   at org.apache.isis.core.metamodel.progmodels.dflt.ProgrammingModelFacetsJava8.lambda$new$0(ProgrammingModelFacetsJava8.java:374)   at org.apache.isis.core.metamodel.progmodels.dflt.ProgrammingModelFacetsJava8$$Lambda$656.1587485260.visit(Unknown Source:-1)   at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorVisiting.lambda$validateAll$1(MetaModelValidatorVisiting.java:107)   at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorVisiting$$Lambda$1689.1794699629.accept(Unknown Source:-1)   at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)   at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1654)   at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)   at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)   at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:746)   at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)   at java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1020)   at java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:1656)   at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1594)   at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:177){code}"
ISIS-2402,Improvement,Closed,[WON'T FIX] Demo Launch takes >25s until Spring Boot Banner even appears (investigate),"... while on same workstation, smoketests take typically only ~3s to bring up the Spring Context even fully initialized.

This is not an issue regarding production use, but slows down development process."
ISIS-2401,Bug,Closed,Memento creation/recreation roundtrip might get confused when processing Value Types,"Seeing this when running vaadin and wkt viewer simultaneous. Wkt throws ...
{noformat}
Caused by: java.lang.IllegalArgumentException: need an id to lookup an object specId=org.apache.isis.valuetypes.asciidoc.applib.value.AsciiDoc
 at org.apache.isis.core.commons.internal.exceptions._Exceptions.illegalArgument(_Exceptions.java:80) ~[classes/:?]
 at org.apache.isis.viewer.wicket.viewer.services.mementos.ObjectMementoLegacy$RecreateStrategy$2.recreateObject(ObjectMementoLegacy.java:221) ~[classes/:?]
 at org.apache.isis.viewer.wicket.viewer.services.mementos.ObjectMementoLegacy$Cardinality$1.asAdapter(ObjectMementoLegacy.java:85) ~[classes/:?]
 at org.apache.isis.viewer.wicket.viewer.services.mementos.ObjectMementoLegacy.reconstructObject(ObjectMementoLegacy.java:449) ~[classes/:?]{noformat}"
ISIS-2400,Improvement,Closed,Allow sections within menubars.layout.xml to have a name ... then appear in the menu,"If you run the demo app you can see that some of the menus (eg for types) are quite large, split into multiple sections.

It would be nice to provide a name/title for each of the sections; eg:
{code:java}
<mb3:primary>
    <mb3:menu>
        <mb3:named>Data Types</mb3:named>
        <mb3:section>
            <mb3:named>Primitives</mb3:named>  <--- THIS IS NEW
            <mb3:serviceAction objectType=""demo.PrimitiveTypesMenu"" id=""bytes""/>
            <mb3:serviceAction objectType=""demo.PrimitiveTypesMenu"" id=""shorts""/>
 {code}
 "
ISIS-2399,Bug,Closed,Spring bean resolution issues when configuring TenantedAuthorizationFacet,"It seems that attempting to access QueryResultsCache (which is @InteractionScoped) from within a facet (TenantedAuthorizationFacet) causes issues.

To reproduce, in the demo app:

just add this silly implementation:
{code:java}
@Service
public class ApplicationTenancyEvaluatorImpl implements ApplicationTenancyEvaluator {

    @Override
    public boolean handles(Class<?> cls) {
        return PrimitiveByteHolder.class.isAssignableFrom(cls);
    }

    @Override
    public String hides(Object domainObject, ApplicationUser applicationUser) {
        PrimitiveByteHolder byteHolder = (PrimitiveByteHolder) domainObject;
        return byteHolder.getReadOnlyProperty() == 3 ? ""hidden"" : null;
    }

    @Override
    public String disables(Object domainObject, ApplicationUser applicationUser) {
        return null;
    }
}
 {code}
which for me generated this stack trace:
{code:java}
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'isisRuntime.QueryResultsCacheDefault': Scope 'isis-interaction' is not active for the current thread; consider defining a scoped proxy for this bean if you intend to refer to it from a singleton; nested exception is java.lang.IllegalStateException: Creation of bean isisRuntime.QueryResultsCacheDefault with @IsisInteractionScope requires the calling Thread[ForkJoinPool.commonPool-worker-5 (453)]) to have an open IsisInteraction on the thread-local stack. Running into this issue might be caused by use of ... @Inject MyScopedBean bean ..., instead of ... @Inject Provider<MyScopedBean> provider ...org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'isisRuntime.QueryResultsCacheDefault': Scope 'isis-interaction' is not active for the current thread; consider defining a scoped proxy for this bean if you intend to refer to it from a singleton; nested exception is java.lang.IllegalStateException: Creation of bean isisRuntime.QueryResultsCacheDefault with @IsisInteractionScope requires the calling Thread[ForkJoinPool.commonPool-worker-5 (453)]) to have an open IsisInteraction on the thread-local stack. Running into this issue might be caused by use of ... @Inject MyScopedBean bean ..., instead of ... @Inject Provider<MyScopedBean> provider ... at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:368) ~[spring-beans-5.2.7.RELEASE.jar:5.2.7.RELEASE] at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202) ~[spring-beans-5.2.7.RELEASE.jar:5.2.7.RELEASE] at org.springframework.beans.factory.support.DefaultListableBeanFactory$1.orderedStream(DefaultListableBeanFactory.java:407) ~[spring-beans-5.2.7.RELEASE.jar:5.2.7.RELEASE] at org.apache.isis.core.commons.internal.ioc.spring.IocContainerSpring.select(IocContainerSpring.java:115) ~[isis-core-commons-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.core.metamodel.services.registry.ServiceRegistryDefault.select(ServiceRegistryDefault.java:77) ~[isis-core-metamodel-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.applib.services.registry.ServiceRegistry.select(ServiceRegistry.java:68) ~[isis-applib-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.applib.services.registry.ServiceRegistry.lookupService(ServiceRegistry.java:131) ~[isis-applib-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.extensions.secman.model.facets.TenantedAuthorizationFacetFactory.createFacet(TenantedAuthorizationFacetFactory.java:102) ~[isis-extensions-secman-model-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.extensions.secman.model.facets.TenantedAuthorizationFacetFactory.process(TenantedAuthorizationFacetFactory.java:62) ~[isis-extensions-secman-model-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.core.metamodel.specloader.facetprocessor.FacetProcessor.lambda$process$1(FacetProcessor.java:307) ~[isis-core-metamodel-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at java.util.ArrayList.forEach(ArrayList.java:1540) ~[?:?] at org.apache.isis.core.metamodel.specloader.facetprocessor.FacetProcessor.process(FacetProcessor.java:307) ~[isis-core-metamodel-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.core.metamodel.specloader.specimpl.FacetedMethodsBuilder.introspectClass(FacetedMethodsBuilder.java:174) ~[isis-core-metamodel-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.core.metamodel.specloader.specimpl.dflt.ObjectSpecificationDefault.introspectTypeHierarchy(ObjectSpecificationDefault.java:124) ~[isis-core-metamodel-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.core.metamodel.specloader.specimpl.ObjectSpecificationAbstract.introspectUpTo(ObjectSpecificationAbstract.java:286) ~[isis-core-metamodel-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.core.metamodel.specloader.SpecificationLoaderDefault.introspect(SpecificationLoaderDefault.java:508) ~[isis-core-metamodel-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.core.metamodel.specloader.SpecificationLoaderDefault.createMetaModel(SpecificationLoaderDefault.java:252) ~[isis-core-metamodel-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.core.commons.internal.concurrent._ConcurrentTask$3.innerCall(_ConcurrentTask.java:157) ~[isis-core-commons-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.core.commons.internal.concurrent._ConcurrentTask$3.innerCall(_ConcurrentTask.java:153) ~[isis-core-commons-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.core.commons.internal.concurrent._ConcurrentTask$1.innerCall(_ConcurrentTask.java:112) ~[isis-core-commons-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.core.commons.internal.concurrent._ConcurrentTask.run(_ConcurrentTask.java:87) ~[isis-core-commons-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at java.util.concurrent.ForkJoinTask$AdaptedRunnableAction.exec(ForkJoinTask.java:1407) ~[?:?] at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290) ~[?:?] at java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1020) ~[?:?] at java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:1656) ~[?:?] at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1594) ~[?:?] at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:177) ~[?:?]Caused by: java.lang.IllegalStateException: Creation of bean isisRuntime.QueryResultsCacheDefault with @IsisInteractionScope requires the calling Thread[ForkJoinPool.commonPool-worker-5 (453)]) to have an open IsisInteraction on the thread-local stack. Running into this issue might be caused by use of ... @Inject MyScopedBean bean ..., instead of ... @Inject Provider<MyScopedBean> provider ... at org.apache.isis.core.commons.internal.exceptions._Exceptions.illegalState(_Exceptions.java:87) ~[isis-core-commons-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.apache.isis.core.runtime.iactn.scope.IsisInteractionScope.get(IsisInteractionScope.java:69) ~[isis-core-runtime-2.0.0-SNAPSHOT.jar:2.0.0-SNAPSHOT] at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:356) ~[spring-beans-5.2.7.RELEASE.jar:5.2.7.RELEASE] ... 26 more {code}"
ISIS-2398,Bug,Closed,Rendering a StandaloneCollectionPage in Wicket throws Optional not serializable exception,"For demo app, this occurs when Prototyping > Run Fixture Script.  See stacktrace

This seems to be just noise in the logs, but even so....
{code:java}
2020-07-09 06:36:13.588 ERROR 3524 --- [ageSavingThread] o.a.w.s.j.JavaSerializer                 : Error serializing object class org.apache.isis.viewer.wicket.ui.pages.standalonecollection.StandaloneCollectionPage [object=[Page class = org.apache.isis.viewer.wicket.ui.pages.standalonecollection.StandaloneCollectionPage, id = 4, render count = 1]]org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream$ObjectCheckException: The object type is not Serializable!
A problem occurred while checking object with type: java.util.Optional
Field hierarchy is:
  4 [class=org.apache.isis.viewer.wicket.ui.pages.standalonecollection.StandaloneCollectionPage, path=4]
    private java.lang.Object org.apache.wicket.MarkupContainer.children [class=java.util.ArrayList]
      private java.lang.String org.apache.isis.viewer.wicket.ui.components.widgets.favicon.Favicon.contentType[write:6][write:7][write:8] [class=org.apache.wicket.markup.html.WebMarkupContainer, path=4:theme]
        private java.lang.Object org.apache.wicket.MarkupContainer.children [class=java.util.ArrayList]
          private org.apache.isis.viewer.wicket.ui.ComponentType org.apache.isis.viewer.wicket.ui.panels.PanelAbstract.componentType[write:12][write:13][write:20] [class=org.apache.isis.viewer.wicket.ui.components.actionprompt.ActionPromptModalWindow, path=4:theme:actionPromptModalWindow]
            private java.lang.Object org.apache.wicket.MarkupContainer.children [class=java.util.ArrayList]
              private java.lang.Object org.apache.wicket.MarkupContainer.children[write:3][write:5][write:8] [class=org.apache.isis.viewer.wicket.ui.components.actions.ActionParametersPanel, path=4:theme:actionPromptModalWindow:content]
                private java.lang.Object org.apache.wicket.MarkupContainer.children [class=java.util.ArrayList]
                  java.lang.Object org.apache.wicket.Component.data[write:8][write:4][write:7] [class=org.apache.isis.viewer.wicket.ui.components.actions.ActionParametersFormPanel, path=4:theme:actionPromptModalWindow:content:parameters]
                    private java.lang.Object org.apache.wicket.MarkupContainer.children [class=org.apache.isis.viewer.wicket.ui.components.actions.ActionParametersForm, path=4:theme:actionPromptModalWindow:content:parameters:inputForm]
                      private java.lang.Object org.apache.wicket.MarkupContainer.children [class=java.util.ArrayList]
                        private java.lang.Object org.apache.wicket.MarkupContainer.children[write:1] [class=org.apache.wicket.markup.repeater.RepeatingView, path=4:theme:actionPromptModalWindow:content:parameters:inputForm:parameters]
                          private java.lang.Object org.apache.wicket.MarkupContainer.children [class=java.util.ArrayList]
                            private java.lang.Object org.apache.wicket.MarkupContainer.children[write:1] [class=org.apache.wicket.markup.html.WebMarkupContainer, path=4:theme:actionPromptModalWindow:content:parameters:inputForm:parameters:1]
                              private java.lang.Object org.apache.wicket.MarkupContainer.children [class=org.apache.isis.viewer.wicket.ui.components.scalars.valuechoices.ValueChoicesSelect2Panel, path=4:theme:actionPromptModalWindow:content:parameters:inputForm:parameters:1:scalarNameAndValue]
                                java.lang.Object org.apache.wicket.Component.data [class=[Ljava.lang.Object;]
                                  java.lang.Object org.apache.wicket.Component.data[0] [class=org.apache.isis.viewer.wicket.model.models.ScalarParameterModel]
                                    private org.apache.isis.viewer.wicket.model.models.InlinePromptContext org.apache.isis.viewer.wicket.model.models.ScalarModel.inlinePromptContext [class=org.apache.isis.viewer.wicket.model.models.InlinePromptContext]
                                      private final org.apache.wicket.Component org.apache.isis.viewer.wicket.model.models.InlinePromptContext.scalarIfRegular [class=org.apache.isis.viewer.wicket.ui.components.widgets.bootstrap.FormGroup, path=4:theme:actionPromptModalWindow:content:parameters:inputForm:parameters:1:scalarNameAndValue:scalarTypeContainer:scalarIfRegular]
                                        private java.lang.Object org.apache.wicket.MarkupContainer.children [class=java.util.ArrayList]
                                          private java.lang.Object org.apache.wicket.MarkupContainer.children[write:1] [class=org.apache.isis.viewer.wicket.ui.components.widgets.select2.Select2ChoiceExt, path=4:theme:actionPromptModalWindow:content:parameters:inputForm:parameters:1:scalarNameAndValue:scalarTypeContainer:scalarIfRegular:scalarValue]
                                            private org.wicketstuff.select2.ChoiceProvider org.wicketstuff.select2.AbstractSelect2Choice.provider [class=org.apache.isis.viewer.wicket.ui.components.widgets.select2.providers.ObjectAdapterMementoProviderForValueChoices]
                                              private final org.apache.isis.core.commons.collections.Can org.apache.isis.viewer.wicket.ui.components.widgets.select2.providers.ObjectAdapterMementoProviderForValueChoices.choiceMementos [class=org.apache.isis.core.commons.collections.Can_Singleton]
                                                private final java.util.concurrent.atomic.AtomicReference org.apache.isis.core.commons.collections.Can_Singleton.singleton [class=java.util.concurrent.atomic.AtomicReference]
                                                  private volatile java.lang.Object java.util.concurrent.atomic.AtomicReference.value [class=java.util.Optional] <----- field that is causing the problem
 {code}
 "
ISIS-2397,Improvement,Closed,Add removeAll to RepositoryService API,"useful for testing.  Considering calls this truncate, but it wouldn't be as fast since deletes each instance one by one."
ISIS-2396,Improvement,Closed,"Make Markup final, remove ListeningMarkup (can just use Markup)",
ISIS-2395,Bug,Closed,"JDO mapping required for AsciiDoc and Markdown.  (Also, Markup should be abstract)","In addition:
 * rename asString() to asHtml()
 * introduce HasHtml interface common to Markup, Markdown and AsciiDoc types.
 * reorg SSE maven modules for consistency, with ""-sse-ui"" becoming ""-sse-ui-wkt""
 * introduce ""metamodel"" module for Markdown and AsciiDoc types."
ISIS-2394,Improvement,Closed,TenantedFacetFactory should be automatically registered into the programming model,It should be enough just to reference the IsisModuleExtSecmanModel in the appmanifest.
ISIS-2393,Bug,Closed,Editing a property on a view model does not stick,"(This has probably always been the case).

 

The value appears to update in the UI, but refreshing the page (eg clicking on the title) shows that this ain't so.

 

Workaround: use an action with a promptStyle of INLINE_AS_IF_EDIT,"
ISIS-2392,Improvement,Closed,Add CSS classes and identifiers for cypress regression test suite.,
ISIS-2391,Improvement,Closed,Upgrade DataNucleus 5.2.2->5.2.3,
ISIS-2390,Bug,Closed,Not possible to navigate to date/time drop-down using keyboard.,
ISIS-2389,Improvement,Open,[Validation] Metamodel exception if default supporting method type doesn't match.,"eg in the demo app, I had this error:

 

@Action(semantics = SemanticsOf.SAFE)
@ActionLayout(promptStyle = PromptStyle.DIALOG_MODAL)
public WrapperBooleanVm openViewModel(Boolean initialValue) {
 return new WrapperBooleanVm(initialValue);
}
public char default0OpenViewModel() {
 return 'a';
}"
ISIS-2388,Bug,Closed,Regression: value choice mementos are broken,"eg. this one does not work
{code:java}
public List<Boolean> choices0Act() {
 return Stream.of(true, false)
 .collect(Collectors.toList());
}{code}"
ISIS-2387,Bug,Closed,Regression: boolean parameters not handled properly,"Seen with primitive boolean action parameters:

It seems the internal model representation is 3-state, while the rendered representation is 2-state.

There seem multiple issues: 

1) An initially checked checkbox leading to a validation failure, that clears the checkbox, then after checking the checkbox via user interaction, validation passes.

2) Validation fails on a parameter (complaining that it is mandatory), while the domain logic states that any of the 2 possible states (false/true) are valid.

 

 

 "
ISIS-2386,Bug,Closed,Regression: null parameters not handled properly (invalid method signatures),
ISIS-2385,Bug,Closed,Jaxb PersistentEntityAdapter fails when asked to marshal detached entities,"Reason: BookmarkService cannot create bookmark for detached entity.

is related to https://issues.apache.org/jira/browse/ISIS-2383

Issue is, that the object graph that gets serialized must not contain detached entities. But instead of re-attaching all detached entities just to get their IDs for marshalling them later is inefficient. There should be a better way to do this."
ISIS-2384,Bug,Closed,Action that takes a List of view models fails to gather them when object has been viewed already,"From demo in master, apply this patch:
{code:java}
diff --git a/examples/demo/domain/src/main/java/demoapp/dom/viewmodels/jaxbrefentity/StatefulViewModelJaxbRefsEntity.java b/examples/demo/domain/src/main/java/demoapp/dom/viewmodels/jaxbrefentity/StatefulViewModelJaxbRefsEntity.java
index 92a26bc..476ca60 100644
--- a/examples/demo/domain/src/main/java/demoapp/dom/viewmodels/jaxbrefentity/StatefulViewModelJaxbRefsEntity.java
+++ b/examples/demo/domain/src/main/java/demoapp/dom/viewmodels/jaxbrefentity/StatefulViewModelJaxbRefsEntity.java
@@ -37,11 +37,10 @@
 import org.apache.isis.applib.annotation.Property;
 import org.apache.isis.applib.annotation.SemanticsOf;
 
+import demoapp.dom._infra.asciidocdesc.HasAsciiDocDescription;
 import lombok.Getter;
 import lombok.Setter;
 
-import demoapp.dom._infra.asciidocdesc.HasAsciiDocDescription;
-
 //tag::class[]
 @XmlRootElement(name = ""demo.StatefulViewModelJaxbRefsEntity"")
 @XmlType(
@@ -103,6 +102,14 @@
     @XmlElement(name = ""child"")
     private List<ChildJdoEntity> children = new ArrayList<>();
 
+    @Action(associateWith = ""children"")
+    public StatefulViewModelJaxbRefsEntity suffixChildren(List<ChildJdoEntity> children) {
+    	for(ChildJdoEntity child : children) {
+    		child.setName(child.getName() + "", Jr"");
+    	}
+    	return this;
+    }
+    
     @Action(associateWith = ""children"", associateWithSequence = ""1"", semantics = SemanticsOf.NON_IDEMPOTENT)
     public StatefulViewModelJaxbRefsEntity addChild(final ChildJdoEntity child) {
         children.add(child);

{code}
Then, on the demo wicket page, go to the view models refs entity.  Add all children.  Then view all children individually (I used ctrl-click). 

 

Then, select all the children and run the ""Suffix Children"" action.  Before being prompted to affirm the selected children, an NPE occurs:
{noformat}
                                    
                                        java.lang.NullPointerException
                                    
                                        
                                    
                                            java.util.Objects#requireNonNull(Objects.java:222)

                                    
                                            
org.apache.isis.viewer.wicket.ui.components.widgets.linkandlabel.LinkAndLabelFactoryAbstract$1#doOnClick(LinkAndLabelFactoryAbstract.java:112)

                                    
                                            org.apache.isis.viewer.wicket.ui.components.widgets.linkandlabel.ActionLink#onClick(ActionLink.java:100)

                                    
                                            org.apache.wicket.ajax.markup.html.AjaxLink$1#onEvent(AjaxLink.java:85)

                                    
                                            org.apache.wicket.ajax.AjaxEventBehavior#respond(AjaxEventBehavior.java:127)

                                    
                                            org.apache.wicket.ajax.AbstractDefaultAjaxBehavior#onRequest(AbstractDefaultAjaxBehavior.java:598)

                                    
                                            org.apache.wicket.core.request.handler.ListenerRequestHandler#internalInvoke(ListenerRequestHandler.java:306)

                                    
                                            org.apache.wicket.core.request.handler.ListenerRequestHandler#invoke(ListenerRequestHandler.java:280)

                                    
                                            org.apache.wicket.core.request.handler.ListenerRequestHandler#invokeListener(ListenerRequestHandler.java:222)

                                    
                                            org.apache.wicket.core.request.handler.ListenerRequestHandler#respond(ListenerRequestHandler.java:208)

                                    
                                            org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:914)

                                    
                                            org.apache.wicket.request.RequestHandlerExecutor#execute(RequestHandlerExecutor.java:65)

                                    
                                            org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:282)

                                    
                                            org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:253)

                                    
                                            org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:221)

                                    
                                            org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:275)

                                    
                                            org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:206)

                                    
                                            org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:299)

                                    
                                            org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)

                                    
                                            org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)

                                    
                                            org.apache.isis.core.webapp.modules.logonlog.IsisLogOnExceptionFilter#doFilter(IsisLogOnExceptionFilter.java:60)

                                    
                                            org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)

                                    
                                            org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)

                                    
                                            org.springframework.web.filter.RequestContextFilter#doFilterInternal(RequestContextFilter.java:100)

                                    
                                            org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)

                                    
                                            org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)

                                    
                                            org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)

                                    
                                            org.springframework.web.filter.FormContentFilter#doFilterInternal(FormContentFilter.java:93)

                                    
                                            org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)

                                    
                                            org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)

                                    
                                            org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)

                                    
                                            org.springframework.web.filter.CharacterEncodingFilter#doFilterInternal(CharacterEncodingFilter.java:201)

                                    
                                            org.springframework.web.filter.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:119)

                                    
                                            org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)

                                    
                                            org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)

                                    
                                            org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)

                                    
                                            org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)

                                    
                                            org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)

                                    
                                            org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)

                                    
                                            org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:387)

                                    
                                            org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)

                                    
                                            org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)

                                    
                                            org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:193)

                                    
                                            org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:166)

                                    
                                            org.apache.catalina.core.StandardWrapperValve#invoke(StandardWrapperValve.java:202)

                                    
                                            org.apache.catalina.core.StandardContextValve#invoke(StandardContextValve.java:96)

                                    
                                            org.apache.catalina.authenticator.AuthenticatorBase#invoke(AuthenticatorBase.java:541)

                                    
                                            org.apache.catalina.core.StandardHostValve#invoke(StandardHostValve.java:139)

                                    
                                            org.apache.catalina.valves.ErrorReportValve#invoke(ErrorReportValve.java:92)

                                    
                                            org.apache.catalina.core.StandardEngineValve#invoke(StandardEngineValve.java:74)

                                    
                                            org.apache.catalina.connector.CoyoteAdapter#service(CoyoteAdapter.java:343)

                                    
                                            org.apache.coyote.http11.Http11Processor#service(Http11Processor.java:373)

                                    
                                            org.apache.coyote.AbstractProcessorLight#process(AbstractProcessorLight.java:65)

                                    
                                            org.apache.coyote.AbstractProtocol$ConnectionHandler#process(AbstractProtocol.java:868)

                                    
                                            org.apache.tomcat.util.net.NioEndpoint$SocketProcessor#doRun(NioEndpoint.java:1590)

                                    
                                            org.apache.tomcat.util.net.SocketProcessorBase#run(SocketProcessorBase.java:49)

                                    
                                            java.util.concurrent.ThreadPoolExecutor#runWorker(ThreadPoolExecutor.java:1128)

                                    
                                            java.util.concurrent.ThreadPoolExecutor$Worker#run(ThreadPoolExecutor.java:628)

                                    
                                            org.apache.tomcat.util.threads.TaskThread$WrappingRunnable#run(TaskThread.java:61)

                                    
                                            java.lang.Thread#run(Thread.java:830)

                                    
                                {noformat}
 

Note, this action succeeds if I do not view the children beforehand.

 

 "
ISIS-2383,Bug,Closed,Regression: cannot create mementos from detached choice pojos,"For supporting methods that provide choices of entity objects, those might get detached before the framework gets a chance to create mementos for these."
ISIS-2382,Bug,Resolved,Concurrent Spec Loading is broken (possible race condition),"Seen this both in production and prototyping mode. Prototyping mode allows to refresh the meta model, which fixes any missing action buttons. With production mode, one needs to restart the App. Though seen very rarely, this is mission critical.

My assumption is, that we have a race condition when introspecting the domain classes."
ISIS-2381,Improvement,Open,[Validation] Metamodel exception if @PropertyLayout(navigable=...) with a value type,
ISIS-2380,Bug,Closed,"Regression ""Inline as if edit"" prompt style is broken in Wicket viewer","Run up the demo app, Wicket viewer

* Featured Types > Primitive Char

* Open up an entity

Now change to ""inline as if edit"":

[https://github.com/apache/isis/blob/74a5b33f587ccf260b9df251a30ccaabc8e11300/examples/demo/domain/src/main/java/demoapp/dom/types/primitive/chars/holder/PrimitiveCharHolder_updateReadOnlyProperty2InlineAsIfEdit.java#L34]

Repeat, will fail to render.

 

 

 "
ISIS-2379,Improvement,Closed,Fire UserCreatedEvent when a new User Entity gets persisted,
ISIS-2378,Bug,Closed,Internal _Strings.readAllLines does not honor selected Charset,
ISIS-2377,Bug,Open,[JUnit] Regression: download Layout.xml 'normalized' seems to behave like 'full',"And we produce invalid XML when outputting ... attribute=NOT_SPECIFIED

 

Ultimately would be nice to have some tests and more docs on this topic as well.

 

 "
ISIS-2376,Bug,Closed,Regression: switching Translation Mode fails (Prototyping Menu),Throws ClassCastException
ISIS-2375,Improvement,Closed,IsisIntegrationTestAbstractWithFixtures should also run module fixtures automatically.,
ISIS-2374,Task,Closed,Support Gradle Builds,As first step: alongside Maven builds
ISIS-2373,Bug,Open,Upload attachment: Preview vulnerable to XSS for html-attachments,"First of all: I am not sure if the topic is placed here correctly as it might only affect the wicket-Dependency that isis is using. But: As the current wicket-version (7.9.0) that is used by isis is vulnerable to it, I should be relevant to you.

 

I created the following HTML-document named xss_box.html:
{code:java}
<html>
<script language=""JavaScript""> 
    window.alert(""Sometext"");
</script>
<head>
    <meta http-equiv=""Content-Type"" content=""text/html;charset=utf-8"">
</head>
<body>...</body>
</html>
{code}
When selecting this document for an upload, usually a preview of the content will be shown. In this case the client uploading the file executes the javascript code and gets a modified preview content, as you can see in my attached images.

 

I do not know if later wicket-versions (currently the newest version is 7.16.0) are protected against this threat.

 "
ISIS-2372,Improvement,Closed,Wicket No-arg Confirm Dialog: render below instead of right of button,Should be less likely to render out of screen/window.
ISIS-2371,Bug,Closed,Regression: inline editing of entities fails (entity not attached),
ISIS-2370,Bug,Closed,Regression: collection result may display negative time amounts (timing info when prototyping),
ISIS-2369,Bug,Closed,Regression: object references within parented tables render just as text,
ISIS-2368,Improvement,Closed,Add lightbox support (=enlarge image on click) for Antora template ,"The Antora based documentation allows a user to click on an image. The code for this looks like this: 

 

{{image::value-types/markup.png[width=""400px"",link=""\{imagesdir}/value-types/markup.png""]}}

 

An alternative would be to add ""lightbox"" support  (=enlarge image on click) for the Antora template. This would reduce the markup to

 

{{image::value-types/markup.png[width=""400px""]}}

 

An example can be found here: [https://intellij-asciidoc-plugin.ahus1.de/docs/users-guide/quick-start.html]

I've also started a discussion to make it part of the standard Antora UI: [https://gitlab.com/antora/antora-ui-default/-/issues/140.|https://gitlab.com/antora/antora-ui-default/-/issues/140]

Please let me know if you'd like to see a pull request for this for Isis including a clean-up of the AsciiDoc code (even before it is part of the standard Antora UI)."
ISIS-2367,Improvement,Closed,Promote @Model support from 'incubator' to 'extension',
ISIS-2366,Improvement,Closed,Bump to latest Spring Releases,
ISIS-2365,Bug,Closed,Action Dialog: Incompatible Parameter Memento if non-scalar,
ISIS-2364,Bug,Closed,Bulk selection (first param in action dialog) is also propagated to other params if of same type.,
ISIS-2363,Bug,Closed,Recently removed ServiceRegistry.injectServicesInto() is still recommended in docs,"The docs [1] have this text:

Alternatively the object can be instantiated simply using {{new}}, then services injected using [{{ServiceRegistry}}|https://isis.apache.org/refguide/2.0.0-M3/applib-svc/ServiceRegistry.html]'s {{injectServicesInto(…​)}} method.

 

This method is missing in 2.0.0-M3.  I found from Slack[2] that a replacement might be serviceInjector.injectServicesInto()

 

[1]: [https://isis.apache.org/refguide/2.0.0-M3/applib-svc/about.html#using-the-services]

[2]: [https://the-asf.slack.com/archives/CFC42LWBV/p1579553230202600?thread_ts=1579553230.202600&cid=CFC42LWBV]"
ISIS-2362,Improvement,Closed,New Programming Model for Action Parameters,"New programming model as discussed in

[https://cwiki.apache.org/confluence/display/ISIS/ActionParameters]

 

 "
ISIS-2361,Bug,Closed,Bulk selection (first param in action dialog) gets cleared when validation fails.,
ISIS-2360,Documentation,Open,document how to specify the timezone,"Defaults.setTimeZone(DateTimeZone.forTimeZone(TimeZone.getTimeZone(""Europe/Amsterdam"")));"
ISIS-2359,Improvement,Closed,Doc: List of Maven Artifacts,As a rolemodel ... https://ktor.io/quickstart/artifacts.html
ISIS-2358,Bug,Closed,A background command referencing a parent command can cause DN exception,"When persisting a background command referencing a parent command where the action on the parent is marked not to persist commands (commandPersistence = CommandPersistence.NOT_PERSISTED), then, as an undesired side-effect, the parent command is persisted as well.

In the case of a serialised viewmodel that can cause JDO Exception in target column."
ISIS-2357,Improvement,Closed,Upgrade FontAwesome 4 -> 5,
ISIS-2356,Bug,Closed,Broken cross references and links in AsciiDoc,There are some broken links in the AsciiDoc documentation for the Isis project. 
ISIS-2355,New Feature,Resolved,Visualize JSON via Plantuml,"When inspecting responses it can be helpful to have a visual representation of JSON.

Check if
 * json-to-plantuml can be used to generate plantuml and then
 * pass on that code to kroki. 

See: [https://www.npmjs.com/package/json-to-plantuml] and [https://github.com/rjaros/kvision/issues/134]"
ISIS-2354,New Feature,Open,[kroviz] Extend Tabulator Usage ,"tabulator.js offers two more features of interest:
 * Tree [http://tabulator.info/docs/4.1/tree] and
 * Download [http://tabulator.info/docs/4.1/download] 
 * Row Selection [http://tabulator.info/docs/4.1/select]"
ISIS-2353,New Feature,Closed,Open New Browser Tab for External Links,
ISIS-2352,New Feature,Open,Search/Filter Dropdown Example,"Fill Search/Filter Dropdown's with cached values.

Cf. [https://www.w3schools.com/howto/howto_js_filter_dropdown.asp] "
ISIS-2351,New Feature,Resolved,Chart Example,"Render Event History (start, end, duration, response size, frequency, etc.) as chart"
ISIS-2350,New Feature,Closed,Drag&Drop Example,See: [https://kvision.gitbook.io/kvision-guide/part-2-advanced-features/drag-and-drop]
ISIS-2349,New Feature,Open,[kroviz] Process Change Events Pushed from Server,"Use ServerSentEvents for objects rendered on individual kroviz clients.
 * implement an Apache Isis module keeping track of clients and objects displayed/edited
 * implement a clientside listener that eventually reloads resources changed on the server 
 * use REST resources as object id's "
ISIS-2348,New Feature,Closed,[kroviz] Replay User Events,Filter events elicited by user actions (dialog input) and save them for later replay.
ISIS-2347,New Feature,Open,[kroviz] Support Bulk Actions,"* implement selection / checkbox in tabulator
 * filter actions applicable for selected objects"
ISIS-2346,Bug,Reopened,[kroviz] Tab Layout isn't using 100% Width,
ISIS-2345,Task,Closed,Invoke gradle build from mvn,
ISIS-2344,Bug,Closed,Executing listAll a second time leads to duplicated entries in table,Use ObservableSet instead of ObservableList -> [https://github.com/rjaros/kvision/issues/148]
ISIS-2343,Bug,Closed,Integration tests w/ Datanucleus might fail when run in a batch,eg. https://github.com/johandoornenbal/proplannio/blob/master/module-simple/src/test/java/domainapp/modules/project/integtests/tests/Products_IntegTest.java#L77
ISIS-2342,Task,Closed,Client Kroviz: UI Polishing,"* align Buttons in Dialogs with parent bottom (/)
 * make multiline text boxes size with parent (/)
 * avoid multiple scrollbars (/)
 * add notifications to StatusBar (/)
 * turn user icon into Button (/)
 * add actions to StatusBar Buttons (/)
 * in DiagramPanel:
 ** use buttons to scale image (/)
 ** make Dialogs transparent on move (/)
 ** use available space after resize (enlarge/shrink) (/)"
ISIS-2341,Task,Closed,Ongoing: CI Maintenance,
ISIS-2340,New Feature,Closed,New common UI Model Module,Consolidate code that is common to all viewers into a new module.
ISIS-2339,Bug,Closed,Dropdownlist requires 2 clicks in order to show (dialog not initialized properly),"I tested both a dropdown in a modal as well as sidebar dialog. (see 1)

 

 

1)

[https://github.com/johandoornenbal/proplannio/blob/master/module-simple/src/main/java/domainapp/modules/project/actions/Project_addProduct.java#L28]

 "
ISIS-2338,Bug,Closed,Regression: all Confirmation Dialogs are broken,Cannot execute the Action via the UI. Buttons are not rendered.
ISIS-2337,Improvement,Closed,[WON'T FIX] FacetFactories to be managed by Spring,And facet processing order needs to follow Spring's precedence of managed beans.
ISIS-2336,Improvement,Closed,Ongoing improvements for Antora website,Continued by ISIS-2444
ISIS-2335,Bug,Closed,Mixins declared using type-level @Action should not contribute as Association,
ISIS-2334,Improvement,Closed,Schema Update: document field Facet#id ,facetType ... The framework looks for Facets of certain well-known facet types...
ISIS-2333,Improvement,Closed,Add Object Mixin for graphical Metamodel Inspection,
ISIS-2332,Improvement,Closed,Add new JPA module to provide a JpaEntityFacet,
ISIS-2331,Improvement,Closed,Decouple from PersistenceSession (move to persistence module),
ISIS-2330,Improvement,Closed,Extend ObjectManager with ObjectBulkLoader (handle Queries),Further decouple core from PersistenceSession.
ISIS-2329,Improvement,Closed,"Support nested non-static mixins, with domain event class declared within.","To support this, need to allow action domain events to have 1-arg constructor, being the mixee. 

eg, at the moment, in simpleapp, I can refactor updateName into a mixin:
{code:java}
public static class UpdateNameActionDomainEvent 
  extends SimpleModule.ActionDomainEvent<SimpleObject.updateName> { }

@Action(semantics = IDEMPOTENT,
        command = CommandReification.ENABLED, publishing = Publishing.DISABLED,
        associateWith = ""name"", domainEvent = UpdateNotesActionDomainEvent.class)
public class updateName {

    public SimpleObject act(@Name final String name) {
        setName(name);
        return SimpleObject.this;
    }

    public String default0Act() {
        return getName();
    }
}
 {code}
but the  UpdateNameActionDomainEvent has to remain outside for now.  Instead, I'd like to write:
{code:java}
@Action(semantics = IDEMPOTENT,
        command = CommandReification.ENABLED, publishing = Publishing.DISABLED,
        associateWith = ""name"", domainEvent = UpdateNotesActionDomainEvent.class)
public class updateName {

   public class UpdateNameActionDomainEvent 
     extends SimpleModule.ActionDomainEvent<SimpleObject.updateName> { } 

    public SimpleObject act(@Name final String name) {
        setName(name);
        return SimpleObject.this;
    }

    public String default0Act() {
        return getName();
    }
}
 {code}
The fix should be quite simple: improve the instantiation logic in DomainEventHelper to handle events with 1 arg as well as 0 args and 3 args."
ISIS-2328,Bug,Closed,Missing publisher facet for @Action declared on mixin.,"At least this facet is not picked up, as in @Action(publishing=ENABLED); perhaps others too?

Seems to be an issue irrespective of whether we use

* @Action(publishing=ENABLED) on the mixin type, or

* the older style of @Mixin(method=""act"") on the mixin type and then @Action(published=ENABLED)"
ISIS-2327,Improvement,Closed,Use new Popover Label for Object Reference Tooltips,
ISIS-2326,Bug,Closed,No-arg Action w/ Confirmation suppresses Tooltips.,"No-arg Action button don't show their tooltips, when a confirmation dialog is associated.

Also Wicket's ConfirmationConfig allows for tooltips to be configured. These don't show up neither."
ISIS-2325,Wish,Open,[Wish] Allow Mixins to render additional Properties/Collections (but not Actions),"In support of providing additional context to the user when filling out an action's parameter(s) within a modal or sidebar dialog.

There are possibly other solutions to explore here. Eg. Is there a more general purpose way of rendering this kind of context specific support information?"
ISIS-2324,Task,Closed,Merge kroviz,
ISIS-2323,Improvement,Closed,Allow for IsisInteractions to store User Data (InteractionScoped),
ISIS-2322,Task,Closed,Isis 2.0.0-M4 release activities,
ISIS-2321,Improvement,Closed,Demo: Showcase advanced Mixin (rendering as ViewModel),
ISIS-2320,Improvement,Closed,Rename IsisSessionScope -> IsisInteractionScope,and also rename IsisSessionFactory -> IsisInteractionFactory 
ISIS-2319,Bug,Closed,defaults/disable/hide not honored when pending args are preset with defaults,"Action parameter 
+ visibility (hide) 
+ usability (disable) 
+ priming (defaults) 
do not work when pending arguments are preset with a defaultNXxx() supporting method. "
ISIS-2318,Bug,Closed,[CANNOT REPRODUCE] Regression on Mixins: @Action at method level no longer honor association,"seen with contributed collections

there is some wrong use of the NotContributingFacet during MM processing here"
ISIS-2317,Bug,Closed,ManagedObject instances need a side-effect free toString() method,"otherwise logging may produce side-effects
(this revisits an earlier hotfix that was too rushed for 2.0.0-M3)"
ISIS-2316,Bug,Closed,New type level @Property (Mixins) get picked up as both association and action ,"should only be picked up as association

might also affect @Collection when used at type level"
ISIS-2315,Bug,Closed,Bad PageParameter: oidString=images (as seen with SimpleApp),
ISIS-2314,Bug,Closed,ComponentHintKey fails to restore field 'hintStore' on de-serialization,"To fix this, just follow same idiom as in WebPageBase."
ISIS-2313,Bug,Closed,Do not depend on 2 versions of javax.jdo simultaneously,"Remove all references to API version 3.1,
otherwise DN enhancer will see versions 3.1 and 3.2-m? on the class path.

"
ISIS-2312,New Feature,Closed,Add Jdo Metamodel Download Menu (Zip),
ISIS-2311,Bug,Closed,Bulk Toggle (Multiselect): UI can get out of sync with underlying model,"It seems when hitting the Bulk Toggle the first time, an AJAX request gets triggered, that updates the DOM tree, but during this update clears some behavior such that the Bulk Toggle second hit has no longer any effect."
ISIS-2310,Bug,Closed,Values of @EmbeddedOnly type should not render logo or title if absent,
ISIS-2309,Bug,Closed,@EmbeddedOnly types are broken,"Persistence-capable types declared with @EmbeddedOnly are not identifiable, hence need a different bean-sort than ENTITY."
ISIS-2308,Bug,Closed,Regression: Markup rendering is broken,"Renders as r/w text filed, while should always be readonly."
ISIS-2307,Improvement,Closed,Vaadin Viewer: Isis Preset Debug Logging not honored,
ISIS-2306,Improvement,Closed,Vaadin Viewer: Action calls need an IsisSession,
ISIS-2305,Improvement,Closed,Demo App: add more scalar types not covered yet,"https://github.com/isisaddons/isis-app-kitchensink

especially feature missing types
* character
* password
* clob
* uuid
* joda* ... gonna be deprecated sooner or later"
ISIS-2304,Improvement,Closed,Vaadin Viewer: fix menubar rendering ,"* Secondary and tertiary top level menus need right alignment.
* The rightmost top level menu should be labeled with the current user's name."
ISIS-2303,Improvement,Closed,Vaadin Viewer: Login Page,Also fix launch issues.
ISIS-2302,Improvement,Closed,Rename WithTransactionScope interface to eg. TransactionScopeListener,Also need to investigate whether the WithTransactionScope still works when using the new @IsisSessionScope.
ISIS-2301,Documentation,Reopened,Docs for new InteractionScope,"We allow IsisInteractions to be nested. The @IsisInteractionScope is always bound to the top-level IsisInteraction of the current thread's session stack. (first stack element, aka bottom of stack) 

Isis (not Spring) is aware, when any IsisInteractionScope ends. So at the end of each IsisInteractionScope, we call the destruction runnables on the IsisInteractionScope-d beans that belong to the current thread, then clear the IsisInteraction stack (of the current thread). (edited) 

The IsisInteractionScope-d beans are managed by Spring, that is Spring creates them and registers their destruction runnables.

Requires Provider idiom: we fail early if one tries to inject an IsisInteractionScope-d bean directly. The thrown exception gives a hint, how to fix it. (Use the Provider<> idiom instead)"
ISIS-2300,Dependency upgrade,Closed,Some CVEs in dependencies are threatening your project!,"Hi, I noticed that your project are using vulnerable libraries which are related to some CVEs. To prevent potential risk it may cause, I suggest a library update. Please look into the details below.

 Vulnerable Library Version: org.springframework : spring-web : 5.2.2.RELEASE
  CVE ID: [CVE-2020-5397](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5397), [CVE-2020-5398](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5398)
  Import Path: core/webapp/pom.xml, viewers/wicket/viewer/pom.xml
  Suggested Safe Versions: 5.2.3.RELEASE
 
Vulnerable Library Version: org.apache.commons : commons-email : 1.4
  CVE ID: [CVE-2018-1294](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1294), [CVE-2017-9801](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9801)
  Import Path: core/runtime/pom.xml
  Suggested Safe Versions: 1.5"
ISIS-2299,Improvement,Closed,Convert BDD Cucumber to use JUnit5 test platform engine (rather than legacy JUnit4),This makes for a better dev experience in the IDE (can test individual features in IntelliJ IDEA Ultimate).
ISIS-2298,New Feature,Closed,Initial project structure for the Vaadin viewer,
ISIS-2297,Improvement,In Progress,[Ongoing] Mitigate Sonar Code Quality Issues,Ongoing task: Mitigate Sonar Code Quality Issues
ISIS-2296,Bug,Closed,@RequestScoped isn't honoured,"@RequestScoped isn't honoured (don't see new instance each request)

The services are:
 * AcceptHeadersService
 * CommandContext
 * InteractionContext
 * Scratchpad
 * PublisherDispatchServiceDefault

That's a big problem... I would expect them to be instantiated (and call @PostConstruct/@PreDestroy) for each request.  As it is, they seem to be singletons.

Also, these three further domain services are annotated with @RequestScoped, but also implement WithTransactionScope:
 * ChangedObjectService
 * QueryResultsCacheDefault
 * MetricsServiceDefault

This callback is being called, so they are not memory leaking over time, but they are not thread-safe for concurrent transactions.  At any rate, we should get rid of this home-grown transaction stuff and instead use Spring's @TransactionScope

~~~

Also, AcceptHeadersServiceForRest (the RO implementation) although it is annotated with @RequestScoped, seems to have its own thread-local.  This could probably be removed if it can be made to be properly request-scoped.

 

 "
ISIS-2295,Bug,Closed,ChangedObjectsService doesn't reset enlisted pojos at end of xactn -> memory leak.,
ISIS-2294,New Feature,Closed,Create JPA variant of JDO Book/Product/Inventory (regressiontests),
ISIS-2293,Bug,Resolved,Fix the ability to inject into Specifications,
ISIS-2292,Bug,Closed,HTTP 400 when rendering Object w/ ObjectId containing slashes,eg. ApplicationTenancy
ISIS-2291,Improvement,Closed,SecMan: convert any actions in 'jdo' to mixins and move to 'model',"In preparation, for SecMan to also run with JPA as persistence layer."
ISIS-2290,Bug,Closed,Formatting and typos in documentation,"I'll create a PR with some minor fixes from around the docs that I noticed.

Update: PR is now available [https://github.com/apache/isis/pull/174]"
ISIS-2289,Improvement,Closed,detect incompatible choices return types ,"Metamodel validator: validate eagerly (when full introspect)

 

This one [1] hits at runtime, should be covered by full introspection/validation instead.

 

[1] [https://github.com/apache/isis/blob/f380b389fa80f98b3667383f1d8b76d39b8e84a9/core/metamodel/src/main/java/org/apache/isis/core/metamodel/specloader/specimpl/ObjectActionParameterAbstract.java#L351]"
ISIS-2288,Bug,Closed,"(possible regression): if sidebar is activated, then cannot access menu items (z-order)",
ISIS-2287,Bug,Closed,"Regression: parameters get reset if a predecessor is modified, even if there are no dependent defaults",as raised by [~johandoornenbal] (offline)
ISIS-2286,Bug,Closed,SecMan listAll Classes: types of @DomainService(nature=NatureOfService.VIEW) are missing,
ISIS-2285,Improvement,Closed,Reinstate mechanism to run a specified fixture class on startup.,
ISIS-2284,Improvement,Resolved,RO viewer incorrectly throws 500 instead of 404 for ObjectNotFound.,
ISIS-2283,Bug,Closed,Demo/RO: restful/menuBars Contains Unexpected Element,"The response of [http://localhost:8080/restful/menuBars]  contains an unexpected menu element:
{code:java}
 {
    ""named"": null,
    ""cssClassFa"": null,
    ""unreferencedActions"": null
},{code}

see attached screenshot / sample.json.

Is it by purpose and should be interpreted as a kind of separator?"
ISIS-2282,Bug,Closed,Demo: action 'runFixtureScript' either does not exist or is not visible,"The reponse for [http://localhost:8080/restful/menuBars] contains:
{code:java}
...
  ""secondary"": {
    ""menu"": [
      {
        ""named"": ""Prototyping"",
        ""cssClassFa"": null,
        ""section"": [
          {
            ""serviceAction"": [
              {
                ""objectType"": ""isisExtFixtures.FixtureScripts"",
                ""id"": ""runFixtureScript"",
                ""named"": ""Run Fixture Script"",
                ""namedEscaped"": null,
                ""bookmarking"": null,
                ""cssClass"": null,
                ""cssClassFa"": null,
                ""describedAs"": null,
                ""metadataError"": null,
                ""link"": {
                  ""rel"": ""urn:org.restfulobjects:rels/action"",
                  ""method"": ""GET"",
                  ""href"": ""http://localhost:8080/restful/objects/isisExtFixtures.FixtureScripts/1/actions/runFixtureScript"",
                  ""type"": ""application/json;profile=\""urn:org.restfulobjects:repr-types/object-action\""""
                }
              }
...
{code}
But invoking [http://localhost:8080/restful/objects/isisExtFixtures.FixtureScripts/1/actions/runFixtureScript]

results in: {{action 'runFixtureScript' either does not exist or is not visible}}"
ISIS-2281,Bug,Closed,objectSpec expected to have EncodableFacet,"URL: http://localhost:8080/restful/objects/demo.AsyncActionMenu/1/actions/asyncActions/invoke

{code}
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.JsonValueEncoder.appendValueAndFormat(JsonValueEncoder.java:150)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.ObjectPropertyReprRenderer.addValue(ObjectPropertyReprRenderer.java:117)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.ObjectPropertyReprRenderer.render(ObjectPropertyReprRenderer.java:70)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer.addProperties(DomainObjectReprRenderer.java:341)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer.withMembers(DomainObjectReprRenderer.java:294)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer.render(DomainObjectReprRenderer.java:193)
org.apache.isis.viewer.restfulobjects.rendering.Responses.ofOk(Responses.java:63)
org.apache.isis.viewer.restfulobjects.rendering.service.conneg.ContentNegotiationServiceForRestfulObjectsV1_0.buildResponseTo(ContentNegotiationServiceForRestfulObjectsV1_0.java:108)
org.apache.isis.viewer.restfulobjects.rendering.service.conneg.ContentNegotiationServiceForRestfulObjectsV1_0.buildResponse(ContentNegotiationServiceForRestfulObjectsV1_0.java:89)
org.apache.isis.viewer.restfulobjects.rendering.service.conneg.ContentNegotiationServiceForRestfulObjectsV1_0.buildResponse(ContentNegotiationServiceForRestfulObjectsV1_0.java:222)
org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationServiceContentNegotiator.lambda$actionResult$4(RepresentationServiceContentNegotiator.java:119)
org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationServiceContentNegotiator.buildResponse(RepresentationServiceContentNegotiator.java:146)
org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationServiceContentNegotiator.actionResult(RepresentationServiceContentNegotiator.java:118)
org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.invokeActionUsingAdapters(DomainResourceHelper.java:239)
org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.invokeAction(DomainResourceHelper.java:209)
org.apache.isis.viewer.restfulobjects.viewer.resources.DomainObjectResourceServerside.invokeAction(DomainObjectResourceServerside.java:732)
sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
java.lang.reflect.Method.invoke(Method.java:498)
org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:151)
org.jboss.resteasy.core.MethodInjectorImpl.lambda$invoke$3(MethodInjectorImpl.java:122)
java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:602)
java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:614)
java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1983)
java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:110)
org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:122)
org.jboss.resteasy.core.ResourceMethodInvoker.internalInvokeOnTarget(ResourceMethodInvoker.java:594)
org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTargetAfterFilter(ResourceMethodInvoker.java:468)
org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invokeOnTarget$2(ResourceMethodInvoker.java:421)
org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:363)
org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:423)
org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:391)
org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invoke$1(ResourceMethodInvoker.java:365)
java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981)
java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124)
java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:110)
org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:365)
org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:477)
org.jboss.resteasy.core.SynchronousDispatcher.lambda$invoke$4(SynchronousDispatcher.java:252)
org.jboss.resteasy.core.SynchronousDispatcher.lambda$preprocess$0(SynchronousDispatcher.java:153)
org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:363)
org.jboss.resteasy.core.SynchronousDispatcher.preprocess(SynchronousDispatcher.java:156)
org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:238)
org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:249)
org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:60)
org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55)
javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisTransactionFilterForRestfulObjects.lambda$doFilter$0(IsisTransactionFilterForRestfulObjects.java:48)
org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring$1.doInTransactionWithoutResult(TransactionServiceSpring.java:113)
org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:36)
org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinNewTransaction(TransactionServiceSpring.java:109)
org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinTransaction(TransactionServiceSpring.java:140)
org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisTransactionFilterForRestfulObjects.doFilter(IsisTransactionFilterForRestfulObjects.java:45)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsSessionFilter.doFilter(IsisRestfulObjectsSessionFilter.java:379)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:59)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
org.ebaysf.web.cors.CORSFilter.handleSimpleCORS(CORSFilter.java:302)
org.ebaysf.web.cors.CORSFilter.doFilter(CORSFilter.java:164)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)
org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)
org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:367)
org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:860)
org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1591)
org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
java.lang.Thread.run(Thread.java:748)

{code}"
ISIS-2280,Bug,Closed,"[NOT-AN-ISSUE] demoapp.dom.types.blob.BlobDemo: menuBars suggest GET, implementation requires POST? ","URL: http://localhost:8080/restful/objects/demo.FeaturedTypesMenu/1/actions/blobs/invoke
{code:json}
{
  ""httpStatusCode"": 500,
  ""message"": ""Error marshalling domain object to XML; domain object class is 'demoapp.dom.types.blob.BlobDemo'"",
  ""detail"": {
    ""className"": ""org.apache.isis.applib.NonRecoverableException"",
    ""message"": ""Error marshalling domain object to XML; domain object class is 'demoapp.dom.types.blob.BlobDemo'"",
    ""element"": [
      ""org.apache.isis.applib.services.jaxb.JaxbService$Simple.toXml(JaxbService.java:212)"",
      ""org.apache.isis.applib.services.jaxb.JaxbService$Simple.toXml(JaxbService.java:157)"",
      ""org.apache.isis.core.metamodel.facets.object.recreatable.RecreatableObjectFacetForXmlRootElementAnnotation.clone(RecreatableObjectFacetForXmlRootElementAnnotation.java:67)"",
      ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.cloneIfViewModelElse(ActionInvocationFacetForDomainEventAbstract.java:300)"",
      ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.cloneIfViewModelCloneable(ActionInvocationFacetForDomainEventAbstract.java:286)"",
      ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.access$500(ActionInvocationFacetForDomainEventAbstract.java:74)"",
      ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$DomainEventMemberExecutor.execute(ActionInvocationFacetForDomainEventAbstract.java:461)"",
      ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$DomainEventMemberExecutor.execute(ActionInvocationFacetForDomainEventAbstract.java:413)"",
      ""org.apache.isis.applib.services.iactn.Interaction.executeInternal(Interaction.java:175)"",
      ""org.apache.isis.applib.services.iactn.Interaction.execute(Interaction.java:141)"",
      ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.doInvoke(ActionInvocationFacetForDomainEventAbstract.java:204)"",
      ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.lambda$invoke$0(ActionInvocationFacetForDomainEventAbstract.java:125)"",
      ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinTransaction(TransactionServiceSpring.java:149)"",
      ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.invoke(ActionInvocationFacetForDomainEventAbstract.java:124)"",
      ""org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeInternal(ObjectActionDefault.java:424)"",
      ""org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.execute(ObjectActionDefault.java:410)"",
      ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.invokeActionUsingAdapters(DomainResourceHelper.java:230)"",
      ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.invokeAction(DomainResourceHelper.java:209)"",
      ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainObjectResourceServerside.invokeAction(DomainObjectResourceServerside.java:732)"",
      ""sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)"",
      ""sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)"",
      ""sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)"",
      ""java.lang.reflect.Method.invoke(Method.java:498)"",
      ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:151)"",
      ""org.jboss.resteasy.core.MethodInjectorImpl.lambda$invoke$3(MethodInjectorImpl.java:122)"",
      ""java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:602)"",
      ""java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:614)"",
      ""java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1983)"",
      ""java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:110)"",
      ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:122)"",
      ""org.jboss.resteasy.core.ResourceMethodInvoker.internalInvokeOnTarget(ResourceMethodInvoker.java:594)"",
      ""org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTargetAfterFilter(ResourceMethodInvoker.java:468)"",
      ""org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invokeOnTarget$2(ResourceMethodInvoker.java:421)"",
      ""org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:363)"",
      ""org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:423)"",
      ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:391)"",
      ""org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invoke$1(ResourceMethodInvoker.java:365)"",
      ""java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981)"",
      ""java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124)"",
      ""java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:110)"",
      ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:365)"",
      ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:477)"",
      ""org.jboss.resteasy.core.SynchronousDispatcher.lambda$invoke$4(SynchronousDispatcher.java:252)"",
      ""org.jboss.resteasy.core.SynchronousDispatcher.lambda$preprocess$0(SynchronousDispatcher.java:153)"",
      ""org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:363)"",
      ""org.jboss.resteasy.core.SynchronousDispatcher.preprocess(SynchronousDispatcher.java:156)"",
      ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:238)"",
      ""org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:249)"",
      ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:60)"",
      ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55)"",
      ""javax.servlet.http.HttpServlet.service(HttpServlet.java:741)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
      ""org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
      ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisTransactionFilterForRestfulObjects.lambda$doFilter$0(IsisTransactionFilterForRestfulObjects.java:48)"",
      ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring$1.doInTransactionWithoutResult(TransactionServiceSpring.java:113)"",
      ""org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:36)"",
      ""org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)"",
      ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinNewTransaction(TransactionServiceSpring.java:109)"",
      ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinTransaction(TransactionServiceSpring.java:140)"",
      ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisTransactionFilterForRestfulObjects.doFilter(IsisTransactionFilterForRestfulObjects.java:45)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
      ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsSessionFilter.doFilter(IsisRestfulObjectsSessionFilter.java:379)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
      ""org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:59)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
      ""org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)"",
      ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
      ""org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)"",
      ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
      ""org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)"",
      ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
      ""org.ebaysf.web.cors.CORSFilter.handleSimpleCORS(CORSFilter.java:302)"",
      ""org.ebaysf.web.cors.CORSFilter.doFilter(CORSFilter.java:164)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
      ""org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)"",
      ""org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)"",
      ""org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)"",
      ""org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)"",
      ""org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)"",
      ""org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)"",
      ""org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)"",
      ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
      ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
      ""org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)"",
      ""org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)"",
      ""org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)"",
      ""org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)"",
      ""org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)"",
      ""org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)"",
      ""org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)"",
      ""org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:367)"",
      ""org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)"",
      ""org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:860)"",
      ""org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1591)"",
      ""org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)"",
      ""java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)"",
      ""java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)"",
      ""org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)"",
      ""java.lang.Thread.run(Thread.java:748)""
    ],
    ""causedBy"": {
      ""className"": ""javax.xml.bind.MarshalException"",
      ""message"": null,
      ""element"": [
        ""com.sun.xml.bind.v2.runtime.MarshallerImpl.write(MarshallerImpl.java:301)"",
        ""com.sun.xml.bind.v2.runtime.MarshallerImpl.marshal(MarshallerImpl.java:226)"",
        ""javax.xml.bind.helpers.AbstractMarshallerImpl.marshal(AbstractMarshallerImpl.java:116)"",
        ""org.apache.isis.applib.services.jaxb.JaxbService$Simple.toXml(JaxbService.java:176)"",
        ""org.apache.isis.applib.services.jaxb.JaxbService$Simple.toXml(JaxbService.java:157)"",
        ""org.apache.isis.core.metamodel.facets.object.recreatable.RecreatableObjectFacetForXmlRootElementAnnotation.clone(RecreatableObjectFacetForXmlRootElementAnnotation.java:67)"",
        ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.cloneIfViewModelElse(ActionInvocationFacetForDomainEventAbstract.java:300)"",
        ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.cloneIfViewModelCloneable(ActionInvocationFacetForDomainEventAbstract.java:286)"",
        ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.access$500(ActionInvocationFacetForDomainEventAbstract.java:74)"",
        ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$DomainEventMemberExecutor.execute(ActionInvocationFacetForDomainEventAbstract.java:461)"",
        ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$DomainEventMemberExecutor.execute(ActionInvocationFacetForDomainEventAbstract.java:413)"",
        ""org.apache.isis.applib.services.iactn.Interaction.executeInternal(Interaction.java:175)"",
        ""org.apache.isis.applib.services.iactn.Interaction.execute(Interaction.java:141)"",
        ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.doInvoke(ActionInvocationFacetForDomainEventAbstract.java:204)"",
        ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.lambda$invoke$0(ActionInvocationFacetForDomainEventAbstract.java:125)"",
        ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinTransaction(TransactionServiceSpring.java:149)"",
        ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.invoke(ActionInvocationFacetForDomainEventAbstract.java:124)"",
        ""org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeInternal(ObjectActionDefault.java:424)"",
        ""org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.execute(ObjectActionDefault.java:410)"",
        ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.invokeActionUsingAdapters(DomainResourceHelper.java:230)"",
        ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.invokeAction(DomainResourceHelper.java:209)"",
        ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainObjectResourceServerside.invokeAction(DomainObjectResourceServerside.java:732)"",
        ""sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)"",
        ""sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)"",
        ""sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)"",
        ""java.lang.reflect.Method.invoke(Method.java:498)"",
        ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:151)"",
        ""org.jboss.resteasy.core.MethodInjectorImpl.lambda$invoke$3(MethodInjectorImpl.java:122)"",
        ""java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:602)"",
        ""java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:614)"",
        ""java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1983)"",
        ""java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:110)"",
        ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:122)"",
        ""org.jboss.resteasy.core.ResourceMethodInvoker.internalInvokeOnTarget(ResourceMethodInvoker.java:594)"",
        ""org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTargetAfterFilter(ResourceMethodInvoker.java:468)"",
        ""org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invokeOnTarget$2(ResourceMethodInvoker.java:421)"",
        ""org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:363)"",
        ""org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:423)"",
        ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:391)"",
        ""org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invoke$1(ResourceMethodInvoker.java:365)"",
        ""java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981)"",
        ""java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124)"",
        ""java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:110)"",
        ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:365)"",
        ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:477)"",
        ""org.jboss.resteasy.core.SynchronousDispatcher.lambda$invoke$4(SynchronousDispatcher.java:252)"",
        ""org.jboss.resteasy.core.SynchronousDispatcher.lambda$preprocess$0(SynchronousDispatcher.java:153)"",
        ""org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:363)"",
        ""org.jboss.resteasy.core.SynchronousDispatcher.preprocess(SynchronousDispatcher.java:156)"",
        ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:238)"",
        ""org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:249)"",
        ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:60)"",
        ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55)"",
        ""javax.servlet.http.HttpServlet.service(HttpServlet.java:741)"",
        ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)"",
        ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
        ""org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)"",
        ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
        ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
        ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisTransactionFilterForRestfulObjects.lambda$doFilter$0(IsisTransactionFilterForRestfulObjects.java:48)"",
        ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring$1.doInTransactionWithoutResult(TransactionServiceSpring.java:113)"",
        ""org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:36)"",
        ""org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)"",
        ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinNewTransaction(TransactionServiceSpring.java:109)"",
        ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinTransaction(TransactionServiceSpring.java:140)"",
        ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisTransactionFilterForRestfulObjects.doFilter(IsisTransactionFilterForRestfulObjects.java:45)"",
        ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
        ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
        ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsSessionFilter.doFilter(IsisRestfulObjectsSessionFilter.java:379)"",
        ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
        ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
        ""org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:59)"",
        ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
        ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
        ""org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)"",
        ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
        ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
        ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
        ""org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)"",
        ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
        ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
        ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
        ""org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)"",
        ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
        ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
        ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
        ""org.ebaysf.web.cors.CORSFilter.handleSimpleCORS(CORSFilter.java:302)"",
        ""org.ebaysf.web.cors.CORSFilter.doFilter(CORSFilter.java:164)"",
        ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
        ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
        ""org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)"",
        ""org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)"",
        ""org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)"",
        ""org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)"",
        ""org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)"",
        ""org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)"",
        ""org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)"",
        ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
        ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
        ""org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)"",
        ""org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)"",
        ""org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)"",
        ""org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)"",
        ""org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)"",
        ""org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)"",
        ""org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)"",
        ""org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:367)"",
        ""org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)"",
        ""org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:860)"",
        ""org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1591)"",
        ""org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)"",
        ""java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)"",
        ""java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)"",
        ""org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)"",
        ""java.lang.Thread.run(Thread.java:748)""
      ],
      ""causedBy"": {
        ""className"": ""com.sun.istack.SAXException2"",
        ""message"": ""java.lang.NullPointerException"",
        ""element"": [
          ""com.sun.xml.bind.v2.runtime.XMLSerializer.reportError(XMLSerializer.java:217)"",
          ""com.sun.xml.bind.v2.runtime.XMLSerializer.reportError(XMLSerializer.java:232)"",
          ""com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:340)"",
          ""com.sun.xml.bind.v2.runtime.XMLSerializer.childAsSoleContent(XMLSerializer.java:563)"",
          ""com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeRoot(ClassBeanInfoImpl.java:311)"",
          ""com.sun.xml.bind.v2.runtime.XMLSerializer.childAsRoot(XMLSerializer.java:464)"",
          ""com.sun.xml.bind.v2.runtime.MarshallerImpl.write(MarshallerImpl.java:298)"",
          ""com.sun.xml.bind.v2.runtime.MarshallerImpl.marshal(MarshallerImpl.java:226)"",
          ""javax.xml.bind.helpers.AbstractMarshallerImpl.marshal(AbstractMarshallerImpl.java:116)"",
          ""org.apache.isis.applib.services.jaxb.JaxbService$Simple.toXml(JaxbService.java:176)"",
          ""org.apache.isis.applib.services.jaxb.JaxbService$Simple.toXml(JaxbService.java:157)"",
          ""org.apache.isis.core.metamodel.facets.object.recreatable.RecreatableObjectFacetForXmlRootElementAnnotation.clone(RecreatableObjectFacetForXmlRootElementAnnotation.java:67)"",
          ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.cloneIfViewModelElse(ActionInvocationFacetForDomainEventAbstract.java:300)"",
          ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.cloneIfViewModelCloneable(ActionInvocationFacetForDomainEventAbstract.java:286)"",
          ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.access$500(ActionInvocationFacetForDomainEventAbstract.java:74)"",
          ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$DomainEventMemberExecutor.execute(ActionInvocationFacetForDomainEventAbstract.java:461)"",
          ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$DomainEventMemberExecutor.execute(ActionInvocationFacetForDomainEventAbstract.java:413)"",
          ""org.apache.isis.applib.services.iactn.Interaction.executeInternal(Interaction.java:175)"",
          ""org.apache.isis.applib.services.iactn.Interaction.execute(Interaction.java:141)"",
          ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.doInvoke(ActionInvocationFacetForDomainEventAbstract.java:204)"",
          ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.lambda$invoke$0(ActionInvocationFacetForDomainEventAbstract.java:125)"",
          ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinTransaction(TransactionServiceSpring.java:149)"",
          ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.invoke(ActionInvocationFacetForDomainEventAbstract.java:124)"",
          ""org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeInternal(ObjectActionDefault.java:424)"",
          ""org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.execute(ObjectActionDefault.java:410)"",
          ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.invokeActionUsingAdapters(DomainResourceHelper.java:230)"",
          ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.invokeAction(DomainResourceHelper.java:209)"",
          ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainObjectResourceServerside.invokeAction(DomainObjectResourceServerside.java:732)"",
          ""sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)"",
          ""sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)"",
          ""sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)"",
          ""java.lang.reflect.Method.invoke(Method.java:498)"",
          ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:151)"",
          ""org.jboss.resteasy.core.MethodInjectorImpl.lambda$invoke$3(MethodInjectorImpl.java:122)"",
          ""java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:602)"",
          ""java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:614)"",
          ""java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1983)"",
          ""java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:110)"",
          ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:122)"",
          ""org.jboss.resteasy.core.ResourceMethodInvoker.internalInvokeOnTarget(ResourceMethodInvoker.java:594)"",
          ""org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTargetAfterFilter(ResourceMethodInvoker.java:468)"",
          ""org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invokeOnTarget$2(ResourceMethodInvoker.java:421)"",
          ""org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:363)"",
          ""org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:423)"",
          ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:391)"",
          ""org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invoke$1(ResourceMethodInvoker.java:365)"",
          ""java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981)"",
          ""java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124)"",
          ""java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:110)"",
          ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:365)"",
          ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:477)"",
          ""org.jboss.resteasy.core.SynchronousDispatcher.lambda$invoke$4(SynchronousDispatcher.java:252)"",
          ""org.jboss.resteasy.core.SynchronousDispatcher.lambda$preprocess$0(SynchronousDispatcher.java:153)"",
          ""org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:363)"",
          ""org.jboss.resteasy.core.SynchronousDispatcher.preprocess(SynchronousDispatcher.java:156)"",
          ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:238)"",
          ""org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:249)"",
          ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:60)"",
          ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55)"",
          ""javax.servlet.http.HttpServlet.service(HttpServlet.java:741)"",
          ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)"",
          ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
          ""org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)"",
          ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
          ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
          ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisTransactionFilterForRestfulObjects.lambda$doFilter$0(IsisTransactionFilterForRestfulObjects.java:48)"",
          ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring$1.doInTransactionWithoutResult(TransactionServiceSpring.java:113)"",
          ""org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:36)"",
          ""org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)"",
          ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinNewTransaction(TransactionServiceSpring.java:109)"",
          ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinTransaction(TransactionServiceSpring.java:140)"",
          ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisTransactionFilterForRestfulObjects.doFilter(IsisTransactionFilterForRestfulObjects.java:45)"",
          ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
          ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
          ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsSessionFilter.doFilter(IsisRestfulObjectsSessionFilter.java:379)"",
          ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
          ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
          ""org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:59)"",
          ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
          ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
          ""org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)"",
          ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
          ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
          ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
          ""org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)"",
          ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
          ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
          ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
          ""org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)"",
          ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
          ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
          ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
          ""org.ebaysf.web.cors.CORSFilter.handleSimpleCORS(CORSFilter.java:302)"",
          ""org.ebaysf.web.cors.CORSFilter.doFilter(CORSFilter.java:164)"",
          ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
          ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
          ""org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)"",
          ""org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)"",
          ""org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)"",
          ""org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)"",
          ""org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)"",
          ""org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)"",
          ""org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)"",
          ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
          ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
          ""org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)"",
          ""org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)"",
          ""org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)"",
          ""org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)"",
          ""org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)"",
          ""org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)"",
          ""org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)"",
          ""org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:367)"",
          ""org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)"",
          ""org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:860)"",
          ""org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1591)"",
          ""org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)"",
          ""java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)"",
          ""java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)"",
          ""org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)"",
          ""java.lang.Thread.run(Thread.java:748)""
        ],
        ""causedBy"": {
          ""className"": ""com.sun.xml.bind.api.AccessorException"",
          ""message"": ""java.lang.NullPointerException"",
          ""element"": [
            ""com.sun.xml.bind.v2.runtime.reflect.AdaptedAccessor.get(AdaptedAccessor.java:48)"",
            ""com.sun.xml.bind.v2.runtime.reflect.TransducedAccessor$CompositeTransducedAccessorImpl.writeLeafElement(TransducedAccessor.java:218)"",
            ""com.sun.xml.bind.v2.runtime.property.SingleElementLeafProperty.serializeBody(SingleElementLeafProperty.java:100)"",
            ""com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:330)"",
            ""com.sun.xml.bind.v2.runtime.XMLSerializer.childAsSoleContent(XMLSerializer.java:563)"",
            ""com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeRoot(ClassBeanInfoImpl.java:311)"",
            ""com.sun.xml.bind.v2.runtime.XMLSerializer.childAsRoot(XMLSerializer.java:464)"",
            ""com.sun.xml.bind.v2.runtime.MarshallerImpl.write(MarshallerImpl.java:298)"",
            ""com.sun.xml.bind.v2.runtime.MarshallerImpl.marshal(MarshallerImpl.java:226)"",
            ""javax.xml.bind.helpers.AbstractMarshallerImpl.marshal(AbstractMarshallerImpl.java:116)"",
            ""org.apache.isis.applib.services.jaxb.JaxbService$Simple.toXml(JaxbService.java:176)"",
            ""org.apache.isis.applib.services.jaxb.JaxbService$Simple.toXml(JaxbService.java:157)"",
            ""org.apache.isis.core.metamodel.facets.object.recreatable.RecreatableObjectFacetForXmlRootElementAnnotation.clone(RecreatableObjectFacetForXmlRootElementAnnotation.java:67)"",
            ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.cloneIfViewModelElse(ActionInvocationFacetForDomainEventAbstract.java:300)"",
            ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.cloneIfViewModelCloneable(ActionInvocationFacetForDomainEventAbstract.java:286)"",
            ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.access$500(ActionInvocationFacetForDomainEventAbstract.java:74)"",
            ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$DomainEventMemberExecutor.execute(ActionInvocationFacetForDomainEventAbstract.java:461)"",
            ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$DomainEventMemberExecutor.execute(ActionInvocationFacetForDomainEventAbstract.java:413)"",
            ""org.apache.isis.applib.services.iactn.Interaction.executeInternal(Interaction.java:175)"",
            ""org.apache.isis.applib.services.iactn.Interaction.execute(Interaction.java:141)"",
            ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.doInvoke(ActionInvocationFacetForDomainEventAbstract.java:204)"",
            ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.lambda$invoke$0(ActionInvocationFacetForDomainEventAbstract.java:125)"",
            ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinTransaction(TransactionServiceSpring.java:149)"",
            ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.invoke(ActionInvocationFacetForDomainEventAbstract.java:124)"",
            ""org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeInternal(ObjectActionDefault.java:424)"",
            ""org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.execute(ObjectActionDefault.java:410)"",
            ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.invokeActionUsingAdapters(DomainResourceHelper.java:230)"",
            ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.invokeAction(DomainResourceHelper.java:209)"",
            ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainObjectResourceServerside.invokeAction(DomainObjectResourceServerside.java:732)"",
            ""sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)"",
            ""sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)"",
            ""sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)"",
            ""java.lang.reflect.Method.invoke(Method.java:498)"",
            ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:151)"",
            ""org.jboss.resteasy.core.MethodInjectorImpl.lambda$invoke$3(MethodInjectorImpl.java:122)"",
            ""java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:602)"",
            ""java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:614)"",
            ""java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1983)"",
            ""java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:110)"",
            ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:122)"",
            ""org.jboss.resteasy.core.ResourceMethodInvoker.internalInvokeOnTarget(ResourceMethodInvoker.java:594)"",
            ""org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTargetAfterFilter(ResourceMethodInvoker.java:468)"",
            ""org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invokeOnTarget$2(ResourceMethodInvoker.java:421)"",
            ""org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:363)"",
            ""org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:423)"",
            ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:391)"",
            ""org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invoke$1(ResourceMethodInvoker.java:365)"",
            ""java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981)"",
            ""java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124)"",
            ""java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:110)"",
            ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:365)"",
            ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:477)"",
            ""org.jboss.resteasy.core.SynchronousDispatcher.lambda$invoke$4(SynchronousDispatcher.java:252)"",
            ""org.jboss.resteasy.core.SynchronousDispatcher.lambda$preprocess$0(SynchronousDispatcher.java:153)"",
            ""org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:363)"",
            ""org.jboss.resteasy.core.SynchronousDispatcher.preprocess(SynchronousDispatcher.java:156)"",
            ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:238)"",
            ""org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:249)"",
            ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:60)"",
            ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55)"",
            ""javax.servlet.http.HttpServlet.service(HttpServlet.java:741)"",
            ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)"",
            ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
            ""org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)"",
            ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
            ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
            ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisTransactionFilterForRestfulObjects.lambda$doFilter$0(IsisTransactionFilterForRestfulObjects.java:48)"",
            ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring$1.doInTransactionWithoutResult(TransactionServiceSpring.java:113)"",
            ""org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:36)"",
            ""org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)"",
            ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinNewTransaction(TransactionServiceSpring.java:109)"",
            ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinTransaction(TransactionServiceSpring.java:140)"",
            ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisTransactionFilterForRestfulObjects.doFilter(IsisTransactionFilterForRestfulObjects.java:45)"",
            ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
            ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
            ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsSessionFilter.doFilter(IsisRestfulObjectsSessionFilter.java:379)"",
            ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
            ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
            ""org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:59)"",
            ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
            ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
            ""org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)"",
            ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
            ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
            ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
            ""org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)"",
            ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
            ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
            ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
            ""org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)"",
            ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
            ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
            ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
            ""org.ebaysf.web.cors.CORSFilter.handleSimpleCORS(CORSFilter.java:302)"",
            ""org.ebaysf.web.cors.CORSFilter.doFilter(CORSFilter.java:164)"",
            ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
            ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
            ""org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)"",
            ""org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)"",
            ""org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)"",
            ""org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)"",
            ""org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)"",
            ""org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)"",
            ""org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)"",
            ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
            ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
            ""org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)"",
            ""org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)"",
            ""org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)"",
            ""org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)"",
            ""org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)"",
            ""org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)"",
            ""org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)"",
            ""org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:367)"",
            ""org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)"",
            ""org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:860)"",
            ""org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1591)"",
            ""org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)"",
            ""java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)"",
            ""java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)"",
            ""org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)"",
            ""java.lang.Thread.run(Thread.java:748)""
          ],
          ""causedBy"": {
            ""className"": ""java.lang.NullPointerException"",
            ""message"": null,
            ""element"": [
              ""demoapp.dom.types.blob.DemoBlobStore$BlobAdapter.put(DemoBlobStore.java:62)"",
              ""demoapp.dom.types.blob.DemoBlobStore$BlobAdapter.marshal(DemoBlobStore.java:54)"",
              ""demoapp.dom.types.blob.DemoBlobStore$BlobAdapter.marshal(DemoBlobStore.java:37)"",
              ""com.sun.xml.bind.v2.runtime.reflect.AdaptedAccessor.get(AdaptedAccessor.java:46)"",
              ""com.sun.xml.bind.v2.runtime.reflect.TransducedAccessor$CompositeTransducedAccessorImpl.writeLeafElement(TransducedAccessor.java:218)"",
              ""com.sun.xml.bind.v2.runtime.property.SingleElementLeafProperty.serializeBody(SingleElementLeafProperty.java:100)"",
              ""com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:330)"",
              ""com.sun.xml.bind.v2.runtime.XMLSerializer.childAsSoleContent(XMLSerializer.java:563)"",
              ""com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeRoot(ClassBeanInfoImpl.java:311)"",
              ""com.sun.xml.bind.v2.runtime.XMLSerializer.childAsRoot(XMLSerializer.java:464)"",
              ""com.sun.xml.bind.v2.runtime.MarshallerImpl.write(MarshallerImpl.java:298)"",
              ""com.sun.xml.bind.v2.runtime.MarshallerImpl.marshal(MarshallerImpl.java:226)"",
              ""javax.xml.bind.helpers.AbstractMarshallerImpl.marshal(AbstractMarshallerImpl.java:116)"",
              ""org.apache.isis.applib.services.jaxb.JaxbService$Simple.toXml(JaxbService.java:176)"",
              ""org.apache.isis.applib.services.jaxb.JaxbService$Simple.toXml(JaxbService.java:157)"",
              ""org.apache.isis.core.metamodel.facets.object.recreatable.RecreatableObjectFacetForXmlRootElementAnnotation.clone(RecreatableObjectFacetForXmlRootElementAnnotation.java:67)"",
              ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.cloneIfViewModelElse(ActionInvocationFacetForDomainEventAbstract.java:300)"",
              ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.cloneIfViewModelCloneable(ActionInvocationFacetForDomainEventAbstract.java:286)"",
              ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.access$500(ActionInvocationFacetForDomainEventAbstract.java:74)"",
              ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$DomainEventMemberExecutor.execute(ActionInvocationFacetForDomainEventAbstract.java:461)"",
              ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$DomainEventMemberExecutor.execute(ActionInvocationFacetForDomainEventAbstract.java:413)"",
              ""org.apache.isis.applib.services.iactn.Interaction.executeInternal(Interaction.java:175)"",
              ""org.apache.isis.applib.services.iactn.Interaction.execute(Interaction.java:141)"",
              ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.doInvoke(ActionInvocationFacetForDomainEventAbstract.java:204)"",
              ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.lambda$invoke$0(ActionInvocationFacetForDomainEventAbstract.java:125)"",
              ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinTransaction(TransactionServiceSpring.java:149)"",
              ""org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.invoke(ActionInvocationFacetForDomainEventAbstract.java:124)"",
              ""org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeInternal(ObjectActionDefault.java:424)"",
              ""org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.execute(ObjectActionDefault.java:410)"",
              ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.invokeActionUsingAdapters(DomainResourceHelper.java:230)"",
              ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainResourceHelper.invokeAction(DomainResourceHelper.java:209)"",
              ""org.apache.isis.viewer.restfulobjects.viewer.resources.DomainObjectResourceServerside.invokeAction(DomainObjectResourceServerside.java:732)"",
              ""sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)"",
              ""sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)"",
              ""sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)"",
              ""java.lang.reflect.Method.invoke(Method.java:498)"",
              ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:151)"",
              ""org.jboss.resteasy.core.MethodInjectorImpl.lambda$invoke$3(MethodInjectorImpl.java:122)"",
              ""java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:602)"",
              ""java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:614)"",
              ""java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1983)"",
              ""java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:110)"",
              ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:122)"",
              ""org.jboss.resteasy.core.ResourceMethodInvoker.internalInvokeOnTarget(ResourceMethodInvoker.java:594)"",
              ""org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTargetAfterFilter(ResourceMethodInvoker.java:468)"",
              ""org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invokeOnTarget$2(ResourceMethodInvoker.java:421)"",
              ""org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:363)"",
              ""org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:423)"",
              ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:391)"",
              ""org.jboss.resteasy.core.ResourceMethodInvoker.lambda$invoke$1(ResourceMethodInvoker.java:365)"",
              ""java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981)"",
              ""java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124)"",
              ""java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:110)"",
              ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:365)"",
              ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:477)"",
              ""org.jboss.resteasy.core.SynchronousDispatcher.lambda$invoke$4(SynchronousDispatcher.java:252)"",
              ""org.jboss.resteasy.core.SynchronousDispatcher.lambda$preprocess$0(SynchronousDispatcher.java:153)"",
              ""org.jboss.resteasy.core.interception.jaxrs.PreMatchContainerRequestContext.filter(PreMatchContainerRequestContext.java:363)"",
              ""org.jboss.resteasy.core.SynchronousDispatcher.preprocess(SynchronousDispatcher.java:156)"",
              ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:238)"",
              ""org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:249)"",
              ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:60)"",
              ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55)"",
              ""javax.servlet.http.HttpServlet.service(HttpServlet.java:741)"",
              ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)"",
              ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
              ""org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)"",
              ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
              ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
              ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisTransactionFilterForRestfulObjects.lambda$doFilter$0(IsisTransactionFilterForRestfulObjects.java:48)"",
              ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring$1.doInTransactionWithoutResult(TransactionServiceSpring.java:113)"",
              ""org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:36)"",
              ""org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)"",
              ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinNewTransaction(TransactionServiceSpring.java:109)"",
              ""org.apache.isis.core.runtimeservices.xactn.TransactionServiceSpring.executeWithinTransaction(TransactionServiceSpring.java:140)"",
              ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisTransactionFilterForRestfulObjects.doFilter(IsisTransactionFilterForRestfulObjects.java:45)"",
              ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
              ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
              ""org.apache.isis.viewer.restfulobjects.viewer.webmodule.IsisRestfulObjectsSessionFilter.doFilter(IsisRestfulObjectsSessionFilter.java:379)"",
              ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
              ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
              ""org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:59)"",
              ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
              ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
              ""org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)"",
              ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
              ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
              ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
              ""org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)"",
              ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
              ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
              ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
              ""org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)"",
              ""org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)"",
              ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
              ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
              ""org.ebaysf.web.cors.CORSFilter.handleSimpleCORS(CORSFilter.java:302)"",
              ""org.ebaysf.web.cors.CORSFilter.doFilter(CORSFilter.java:164)"",
              ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
              ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
              ""org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)"",
              ""org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)"",
              ""org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)"",
              ""org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)"",
              ""org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)"",
              ""org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)"",
              ""org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)"",
              ""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)"",
              ""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)"",
              ""org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)"",
              ""org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)"",
              ""org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)"",
              ""org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)"",
              ""org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)"",
              ""org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)"",
              ""org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)"",
              ""org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:367)"",
              ""org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)"",
              ""org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:860)"",
              ""org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1591)"",
              ""org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)"",
              ""java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)"",
              ""java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)"",
              ""org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)"",
              ""java.lang.Thread.run(Thread.java:748)""
            ],
            ""causedBy"": null
          }
        }
      }
    }
  }
} {code}"
ISIS-2279,Improvement,Open,Make caching optional in InjectorMethodEvaluatorDefault to avoid large heap usage ,Observed this growing to ~400Mb in size.
ISIS-2278,Improvement,Closed,"Reinstate background commands for entities, incorporate fix ISIS-2277 from v1",
ISIS-2277,Improvement,Closed,"To avoid memory starvation, each background commands should run in its own session.","The current behaviour (at least, as exploited by the Incode Platform's command service implementation) is:
 * a bunch of commands might be queued up to run in the background say 3000 of them
 * every 10 seconds, quartz schedules to execute the RunBackgroundCommandsWithReplicationAndReplayJob.
 ** nb: this is annotated with @DisallowConcurrentExecution and 
@PersistJobDataAfterExecution ... so quartz won't run another instance until this one has completed.
 * this delegates to BackgroundCommandExecutionFromBackgroundCommandServiceJdo
 * this in turn finds the 3000 commands
 * in the superclass, BackgroundCommandExecution#doExecute(). these commands are processed one by one, each in their own transaction
 * HOWEVER, there is only one session for all of this work, meaning that the size of that session can result in memory starvation (both DataNucleus and Isis hold hashes of all objects that have been modified).

The fix is to create a new session for each command, rather than just a single session.

 "
ISIS-2276,Improvement,Closed,BackgroundCommandExecution - should use a different persistent session for each command,To avoid memory starvation if submit lots of work to be performed in the background.
ISIS-2275,Bug,Closed,"Rest Response Doesn't Contain Number With ""multiLine""","Response snapshot taken from Demo 2.0.0-M3-SNAPSHOT (f629ce2344b5ab8c67f5faeccc70569110902781)

[https://github.com/joerg-rade/kroviz/blob/3605fd9269eb0a22d1fc1ea52f4ac809649b3cdc/src/test/kotlin/org/ro/snapshots/demo2_0_0/DEMO_OBJECT_LAYOUT.kt#L197]

expected: ""multiLine"": 3

actual: ""multiLine"": null

 "
ISIS-2274,Improvement,Resolved,Properties should be disabled by default.,"This is a change in policy from v1 ...

isis.applib.annotation.domain-object.editing = false"
ISIS-2273,Improvement,Resolved,Move most of core-unittestsupport into testing.  Perhaps all of it.,
ISIS-2272,Improvement,Resolved,"Simplify @HomePage support - just use as annotation on type, not for an action.","For two reasons:
 * first, because almost always a home page will be a view model, so the only thing that this change does not support - which is to display the results of an action being arbitrary standalone collections - can be easily simulated as the parented collection of a view model
 * second, because the current implementation to support @HomePage on actions requires a dummy helper class that exposes this action into the metamodel, but it is also exposed in the REST API, which is not ideal.

 "
ISIS-2271,Improvement,Closed,Port fullcalendar over from incode-platform as an extension.,
ISIS-2270,Improvement,Closed,"Rethink, who shall manage Lifecycles of DomainObjects, ViewModels and Mixins","1) Document and annotate @DomainObject, @ViewModel and @Mixin with @Scope(SCOPE_PROTOTYPE)
2) FactoryService#instantiate needs a semantic update

We want Spring to discover these types from the classpath (so that we can build the metamodel eagerly), but we don't want it to manage them, or do we?

Using @Scope(PROTOTYPE) is the closest we can come to expressing that without (attempting to) define a custom scope for each of these three types., analogous to factoryService#instantiate for transient objects.

In practical terms, inventing a custom ""entity"" scope is probably impossible due to DN's design (the enhancer creates a dnNewInstance method and this is called upon as a factory).

Instead, then, we ""veto"" any of these domain types so that Spring is NOT allowed to instantiate any of them.

The docs should be updated to explain what we're doing here."
ISIS-2269,Bug,Closed,"Exception when calling collection on integration test ('more than one ImperativeFacet for method getReferencedObjects , with inconsistent intents')","When 'consuming' a collection of a domain class in integration tests using the wrapper factory an exception is thrown.

java.lang.IllegalArgumentException: domainapp.modules.simple.dom.impl.SimpleObject#referencedObjects: more than one ImperativeFacet for method getReferencedObjects , with inconsistent intents: [CollectionAccessorFacetViaAccessor[type=PropertyOrCollectionAccessorFacet,method=public java.util.List domainapp.modules.simple.dom.impl.SimpleObject.getReferencedObjects()], CollectionClearFacetViaAccessor[type=CollectionClearFacet,method=public java.util.List domainapp.modules.simple.dom.impl.SimpleObject.getReferencedObjects()], CollectionAddToFacetViaAccessor[type=CollectionAddToFacet,method=public java.util.List domainapp.modules.simple.dom.impl.SimpleObject.getReferencedObjects()], CollectionRemoveFromFacetViaAccessor[type=CollectionRemoveFromFacet,method=public java.util.List domainapp.modules.simple.dom.impl.SimpleObject.getReferencedObjects()]]java.lang.IllegalArgumentException: domainapp.modules.simple.dom.impl.SimpleObject#referencedObjects: more than one ImperativeFacet for method getReferencedObjects , with inconsistent intents: [CollectionAccessorFacetViaAccessor[type=PropertyOrCollectionAccessorFacet,method=public java.util.List domainapp.modules.simple.dom.impl.SimpleObject.getReferencedObjects()], CollectionClearFacetViaAccessor[type=CollectionClearFacet,method=public java.util.List domainapp.modules.simple.dom.impl.SimpleObject.getReferencedObjects()], CollectionAddToFacetViaAccessor[type=CollectionAddToFacet,method=public java.util.List domainapp.modules.simple.dom.impl.SimpleObject.getReferencedObjects()], CollectionRemoveFromFacetViaAccessor[type=CollectionRemoveFromFacet,method=public java.util.List domainapp.modules.simple.dom.impl.SimpleObject.getReferencedObjects()]]
 at org.apache.isis.core.metamodel.facets.ImperativeFacet$Util.getIntent(ImperativeFacet.java:169) at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.invoke(DomainObjectInvocationHandler.java:212) at org.apache.isis.core.wrapper.proxy.ProxyCreator$1.invoke(ProxyCreator.java:72) at domainapp.modules.simple.dom.impl.SimpleObject_$$_jvstf5f_b.getReferencedObjects(SimpleObject_$$_jvstf5f_b.java) at domainapp.modules.simple.integtests.tests.SimpleReferencedObjectCollection_IntegTest.testCollectionOfReferencedSimpleObjects(SimpleReferencedObjectCollection_IntegTest.java:27) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)"
ISIS-2268,Improvement,Resolved,Rename OrderPrecedence literals,"HIGHEST -> FIRST

HIGH -> EARLY

MID -> MID

LOW -> LATE

LOWEST -> LAST"
ISIS-2267,New Feature,Resolved,Integrate Spring Boot flyway as an extension.,
ISIS-2266,Bug,Resolved,Revert a little bit of the joda to j8 stuff.,"# FakeDataService#jodaXxx return a J8
 # ClockService#nowAsDateTime looks to have been removed? - introduce back in as nowAsJodaDateTime()
 # Clock
 # 

 

 "
ISIS-2265,Bug,Closed,on-the-fly-introspection may occur even though MM was eagerly loaded,"+steps to reproduce:+

e.g. DemoApp (production mode) -> access menu Trees > File System Tree

java.lang.IllegalStateException
Cannot introspect class 'java.util.AbstractSet' because the metamodel has been fully introspected and is now locked. One reason this can happen is if you are attempting to invoke an action through the WrapperFactory on a service class incorrectly annotated with Spring's @Service annotation instead of @DomainService. 

+solutions+
- either allow on-the-fly-introspection for certain types
- or find all types in the first place when eagerly loading"
ISIS-2264,Improvement,Resolved,"Rationalize configuration properties hierarchy, in line with groupId / artifactId",
ISIS-2263,Improvement,Resolved,Update RO spec in support of java.time,"New supported types, from java.time:
 LOCAL_DATE_TIME(""localDateTime"")
 LOCAL_DATE(""localDate"")
 LOCAL_TIME(""localTime"")
 OFFSET_DATE_TIME(""offsetDateTime"")
 OFFSET_TIME(""offsetTime"")
 ZONED_DATE_TIME(""zonedDateTime"")

also remove deprecated BookmarkObjectState
also bump all xsd versions to 2.0

 "
ISIS-2262,Improvement,Resolved,Remove ExceptionRecognizer.recognize(Throwable) in favor of recognize2(Throwable),"{color:#1d1c1d}It could also be changed into a simple chain of responsibility, there's no need for the Composite version. If we iterate over all implementations more than once, then introduce a separate manager class to do the iteration, see eg. ValueTypeRegistry and ValueTypeProvider(s){color}"
ISIS-2261,Improvement,Resolved,Allow the baseUri of the RO viewer to be overridden,"When running a webapp with a reverse proxy, where the reverse proxy does the https:// thing but the webapp itself only runs on [http://,|http://%2C/] then the baseUri that the RO viewer infers from the injected UriInfo (in ResourceAbstract) will have the incorrect baseUri.
{code:java}
public class ResourceAbstract {

    @javax.ws.rs.core.Context UriInfo uriInfo; 
    ...
}{code}
There doesn't seem to be anyway to tell JAXRS that the webapp is running behind a reverse proxy, so i think that we'll need to provide some sort of config parameter to allow the baseUri (scheme, hostname and port) to be overridden if required."
ISIS-2260,New Feature,Resolved,Port pdfjs from incode platform as an extension,
ISIS-2259,Improvement,Resolved,Reorganize extensions into several smaller groupings.,"what I have in mind are:
 * extensions : to the framework itself, to extend its capabilities
 * subdomains - to be called by Apache Isis domain logic (  approx = lib folder)
 * mappings - in other words bounded context mappings or integrations between BCs.  I've avoided the word ""integration"" because we use that for integration tests
 * testing - for non-production code."
ISIS-2258,Improvement,Closed,Documentation Typos and AsciiDoc improvements,"This issue summarizes some findings I had when reviewing he AsciiDoc documentation content of ISIS. 

I'm currently I've been trying out the AsciiDoc plugin for IntelliJ on this project. Each change is a single commit. Feel free to comment on each commit, and I will reword/remove/update them as needed.

PR is available here: [https://github.com/apache/isis/pull/170]"
ISIS-2257,Bug,Closed,Actions fail MM Validation when associated (Hotfix),"relax the validation to not fail if there is an AssociatedWith facet on the parent action

this hotfix should be reverted once ISIS-2253 gets fixed

 "
ISIS-2256,Bug,Closed,ToggledMementosList can exceed Size of underlying Collection,"to reproduce:

select first, then select all, after that the selection memento list has the first element twice"
ISIS-2255,Improvement,Resolved,"In WrapperFactory, lookup mixin properties and collections (as well as actions).","Because we are now more strict about the bookmarks that can be created (in particular, because we do not allow bookmarks to be created on transient objects such as mixins), then the previous code was failing when attempting to create an InteractionDto with a bookmark to a mixin.

Tracking this down, this was because of the invocation of a contributed collection via the WrapperFactory.  The WrapperFactory (more precisely, DomainObjectInvocationHandler) attempts to do a ""reverse-looking"" to find the contributed mixed member  from the original action on the mixin, but only searched for contributed actions, and did not consider contributed properties or collections.

This change is to fix this.  It should mean that the targetAdapter for InteractionDto's is always correct, and that memberIdentifier == logicalMemberIdentifier in all cases."
ISIS-2254,Bug,Resolved,Ensure Command executor is set to USER when running integ tests.,"The original behaviour was to call command.setExecutor(USER) when starting a new transaction for an integration test.  This would remain until the end of the session ... a command is basically session scoped.

This behaviour has been lost, and needs to be reinstated."
ISIS-2253,Bug,Closed,"Derive ChoicesFacet from ChoicesFromFacet, remove special-case logic.","In fact, this is a case of two wrongs not quite making a right. There's a nasty hack in that it is the Wicket viewer that knows how to populate the choices for the parameter, and it does this without looking for an autoComplete or choices facet ; it just picks up the checked items of the associated collection.


 The short term solution to fix DemoApp is just to update that metamodel validator to also take into account any AssociatedWithFacet.


 The long term ""correct"" solution is a new facet factory that will derive a ChoicesFacet from the AssociatedWithFacet, and then to remove the special case logic from the Wicket viewer.

That would then make the validator correct as it is now written."
ISIS-2252,New Feature,Resolved,"[DUPLICATE] Define a new natureOfService of MODULE_API, for programmatic interactions via wrapper across module trust boundaries.",See also ISIS-2010 ... duplicate?
ISIS-2251,Improvement,Closed,"Improve the parent pom.xml, see blog",[https://itnext.io/writing-a-full-featured-maven-pom-f5b874eef312]
ISIS-2250,Improvement,Resolved,Optionally prevent new ObjectSpec's once metamodel fully created; and revalidate new ObjectSpec's otherwise.,
ISIS-2249,Improvement,Resolved,Deprecate Magnitude<T> and implementing Value Types,we move these to the 'legacy' module
ISIS-2248,Improvement,Resolved,Store the MetaModelContext in DN's NucleusContext,This allows for DN components to access Isis' context without resorting to static helper fields.
ISIS-2247,Improvement,Resolved,provide an IsisPreset for specifying the log4j2-test.xml file when running integ tests.,
ISIS-2246,Bug,Resolved,CSS fix for drop down panel (eg vertical '...' on metadata tab),
ISIS-2245,Improvement,Closed,"[WON'T FIX] convert WebModuleLogOnExceptionLogger, make into an extension.",
ISIS-2244,Improvement,Closed,Remove IsisJaxrsServerPlugin,and use Spring instead for the wiring.
ISIS-2243,Improvement,Resolved,Use resteasy-spring-boot-starter to configure jaxrs-resteasy,This will allow dependencies to be injected into RO resources etc.
ISIS-2242,Improvement,Resolved,"Use IsisSystemEnvironment to store the context path, rather than _Resources static method.",more in the theme of removing static methods where we can.
ISIS-2241,Improvement,Resolved,Remove _Resources_RestfulPath,"Can remove this static map, since can inject the IsisConfiguration everywhere its required (depends on ISIS-2240)."
ISIS-2240,Improvement,Resolved,"Use WebModule infra to inject into all servlets, filters etc.","This should allow us to remove some static methods, hopefully."
ISIS-2239,Improvement,Resolved,Use @Validated for base-path config properties,"The WebModuleWicket and WebModuleRestfulObjects both require that their respective base-path config properties start and end with a '/'; they will coerce the supplied value if necessary.

Instead, we could enforce this rule using @Validated @ConfigurationProperties.  This will fail-fast and allow us to delete code."
ISIS-2238,Improvement,Resolved,Move WebModuleRestfulObjects into the resteasy plugin module.,"This should allow the code to be simplified, ie to remove the reflective classloading etc."
ISIS-2237,Improvement,Resolved,Sequence WebModules correctly.,
ISIS-2236,New Feature,Resolved,Add WebModule to support CORS,
ISIS-2235,Bug,Open,"Mixins declared using @Property, @Collection or @Action should emit domain events","More straightforwardly, Object_logicalTypeName mixin doesn't emit events of any sort (that I can find).  It ought to emit a property domain event, as declared by @Property(domainEvent=...).

That suggests executing some facets associated with the OneToOneAssociationMixedIn, perhaps could be installed using a PostProcessor (which acts after the mixin members exist).

 

~~~

Original problem as raised:

In particular, doesn't properly create domain events if abstract and invoke via the wrapper (ie during integ tests)

fix? don't use getDeclaredFields, instead getFields (I think... to test)

example in estatio - HasDocumentAbstract_categoriseAbstract subclasses.

~~~
 because of [https://github.com/apache/isis/blob/69b4859f27ce857e9af75b7d1ef0ae7b42e5cc2c/core/metamodel/src/main/java/org/apache/isis/core/metamodel/facets/object/mixin/MixinFacetAbstract.java#L97]

getDeclaredFields() rather than getFields()

~~~~

 

for example, with this mixin:
{code:java}
@Property
public class SimpleObject_self {
    private final SimpleObject simpleObject;

    public SimpleObject_self(SimpleObject simpleObject) {
        this.simpleObject = simpleObject;
    }

    @ActionLayout(contributed = Contributed.AS_ASSOCIATION)
    public SimpleObject prop() {
        return simpleObject;
    }

}
 {code}
it's necessary to specify @ActionLayout, otherwise the behaviour is contributed as both an association and an action.

The @ActionLayout should be inferred.

~~~

See the same for @Collection and @Action also ... should imply AS_ASSOCIATION and AS_ACTION respectively.

~~~

Also, (and this might be a slightly different issue), the facets defined by @Property(...) should be copied down correctly to the corresponding facets on the action, eg domain event (this might need specifying more precisely...)

 

 "
ISIS-2234,Improvement,Open,"[Performance] During the render phase, don't populate the execution call graphs with results of mixins being invoked.","This is somewhat similar to ISIS-1656, which is to flush audit/publishing etc at the end of the ACTION phase, rather than the RENDER phase.

More broadly stated: RENDERing shouldn't have any side-effects.

~~~

Looking at the code today, we can see that in OneToOneAssociationMixedIn there's a hack:
{code:java}
@Override
public ManagedObject get(
        final ManagedObject mixedInAdapter,
        final InteractionInitiatedBy interactionInitiatedBy) {

    val mixinAdapter = mixinAdapterFor(mixinType, mixedInAdapter);

    return getPublishingServiceInternal().withPublishingSuppressed(
            () -> mixinAction.executeInternal(
                    mixinAdapter, mixedInAdapter, Can.empty(), interactionInitiatedBy)
    );
}
 {code}
which prevents the action invocation in the render phase from publishing anything.  

However, inspection of the internal data structures does currently show that the Interaction executionGraph (push, pop) gets populated, there is no corresponding hack... see attached screenshot, that shows a number of executions for all of the contributed properties of a SimpleObject.  This isn't harmful per se, but it is odd that we spend all this effort to create the execution graph for it to be consumed by no-one at all.

The bottom line is that actions don't know which phase they are being executed in, and so they do all this extra work.

Perhaps the solution might be to include the phase in the InteractionContext, so we can therefore avoid this unnecessary work populating the executionGraph."
ISIS-2233,Wish,Open,[Wish] Wicket developer bar is now semi-opaque. and cannot be interacted with.,
ISIS-2232,Improvement,Closed,"Remove support for domain services contributing properties, collections or actions.  (Use mixins instead).","Hit an issue where there's an error in contributed properties (from service) throwing NPE, due to mismatch of push/pop with interactoin execution graph.

Mixins work fine.

Rather than fix the inconsistency, think it's better to now remove that functionality (as we've planned a long while now).

 

Details of the problem encountered:

in the current HEAD (2.0.0-M3-SNAPSHOT), I am getting an NPE as the result of the presence of this contributed action (nb: contributed from a service):

 
{code:java}
public class SimpleObjects {

    @Action(semantics = SemanticsOf.SAFE)
    public SimpleObject search(final SimpleObject simpleObject) {
        return simpleObject;
    }
    public List<SimpleObject> autoComplete0Search(final String search) {
        return findByName(search);
    }
    ...
}{code}
 

The NPE occurs in the stuff around Interaction's execution:
h3. Stack trace:
 * java.lang.NullPointerException
 * 
 * org.apache.isis.applib.util.schema.MemberExecutionDtoUtils#metricsFor(MemberExecutionDtoUtils.java:77)
 * org.apache.isis.applib.services.iactn.Interaction$Execution$When#metricsFor(Interaction.java:640)
 * org.apache.isis.applib.services.iactn.Interaction$Execution$When#access$200(Interaction.java:582)
 * org.apache.isis.applib.services.iactn.Interaction$Execution$When$2#syncMetrics(Interaction.java:613)
 * org.apache.isis.applib.services.iactn.Interaction$Execution#syncMetrics(Interaction.java:660)
 * org.apache.isis.applib.services.iactn.Interaction$Execution#setCompletedAt(Interaction.java:503)
 * org.apache.isis.applib.services.iactn.Interaction#pop(Interaction.java:246)
 * org.apache.isis.applib.services.iactn.Interaction#executeInternal(Interaction.java:193)
 * org.apache.isis.applib.services.iactn.Interaction#execute(Interaction.java:142)
 * org.apache.isis.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract#doInvoke(ActionInvocationFacetForDomainEventAbstract.java:208)
 * org.apache.isis.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract#lambda$invoke$0(ActionInvocationFacetForDomainEventAbstract.java:129)
 * org.apache.isis.runtime.services.xactn.TransactionServiceSpring#executeWithinTransaction(TransactionServiceSpring.java:149)
 * org.apache.isis.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract#invoke(ActionInvocationFacetForDomainEventAbstract.java:128)
 * org.apache.isis.metamodel.specloader.specimpl.ObjectActionDefault#executeInternal(ObjectActionDefault.java:423)
 * org.apache.isis.metamodel.specloader.specimpl.ObjectActionDefault#execute(ObjectActionDefault.java:409)
 * org.apache.isis.metamodel.specloader.specimpl.OneToOneAssociationContributee#get(OneToOneAssociationContributee.java:117)
 * org.apache.isis.viewer.wicket.model.models.ScalarModel#setObjectFromPropertyIfVisible(ScalarModel.java:761)
 * org.apache.isis.viewer.wicket.model.models.ScalarModel#access$200(ScalarModel.java:83)
 * org.apache.isis.viewer.wicket.model.models.ScalarModel$Kind$1#reset(ScalarModel.java:315)
 * org.apache.isis.viewer.wicket.model.models.ScalarModel$Kind$1#init(ScalarModel.java:305)
 * org.apache.isis.viewer.wicket.model.models.ScalarModel#init(ScalarModel.java:729)
 * org.apache.isis.viewer.wicket.model.models.ScalarModel#<init>(ScalarModel.java:724)
 * org.apache.isis.viewer.wicket.model.models.EntityModel#getPropertyModel(EntityModel.java:367)
 * org.apache.isis.viewer.wicket.ui.components.entity.fieldset.PropertyGroup#addPropertyToForm(PropertyGroup.java:215)
 * org.apache.isis.viewer.wicket.ui.components.entity.fieldset.PropertyGroup#buildGui(PropertyGroup.java:117)
 * org.apache.isis.viewer.wicket.ui.components.entity.fieldset.PropertyGroup#<init>(PropertyGroup.java:81)

 

we can see that 'pop' is called but there's no execution to work upon; the stack trace tells us that we're in the render phase and evaluating this contributed property (as an action) to reset the model of the rendered entity.

 

FWIW, with this mixin:
{code:java}
@Mixin(method = ""prop"")
public class SimpleObject_search {
    private final SimpleObject simpleObject;

    public SimpleObject_search(SimpleObject simpleObject) {
        this.simpleObject = simpleObject;
    }

    @Action(semantics = SemanticsOf.SAFE)
    @Property
    public SimpleObject prop() {
        return simpleObject;
    }

}
 {code}
 

then everything behaves itself.

 

That said, we do get an interaction graph being built up in the render phase, which is odd.  See ISIS-2234 for more discussion on fixing this, and also the similar ISIS-1656 which relates to auditing/publishing.

 

 

 "
ISIS-2231,Improvement,Closed,Bring in incode-platform stuff,Continued by ISIS-2442
ISIS-2230,Improvement,Closed,ERROR: Recursive call to appender Console  (showing up on MacBook),
ISIS-2229,Improvement,Closed,Let TitleService fallback to Enum.name() as the Title Provider,default TitleService fails on plain enums
ISIS-2228,Bug,Closed,"autoComplete, default, choices don't get added to the MM","given a mixin that contributes a property, supporting methods autoComplete, default and choices get ignored"
ISIS-2227,Bug,Resolved,Toggle View is hiding DOM elements which should be visible,"toggling the view selector from table -> hidden -> table, and the table doesn't re-render

what seems to happen (looking at the DOM) is that a CSS class is added to the component to hide, then not removed in order to show it again"
ISIS-2226,Bug,Closed,"Dependend Args within Dialogs do not work for AutoComplet, Disable and Hide","autocomplete, it should enable the associated parameter field for editing

hide, it should cause the associated parameter field to be hidden dynamically;

similarly with disable it should cause it to be greyed out dynamically"
ISIS-2225,Improvement,Resolved,Simplify config metadata for wicket footer credits.,
ISIS-2224,Improvement,Closed,Integrate Smoketests with the CI Build,"In order to prevent regressions.

The 'smoketests' module provides multiple tests, most are considered stable. And those that are not working well yet, can be disabled specifically for surefire, by annotating a test-class with
{code:java}
org.apache.isis.testdomain.Incubating{code}"
ISIS-2223,Improvement,Closed,Mitigate Reliability and Security Issues as detected by Code Quality Analysis,"See [1] for nightly updated status.

[1] https://sonarcloud.io/dashboard?id=apache_isis"
ISIS-2222,Improvement,Closed,Flesh out demo app with extra examples.,ISIS-2243 will continue this work.
ISIS-2221,Bug,Closed,RestClient smoketest is broken,
ISIS-2220,Bug,Closed,Selecting request header options (profiles) in swagger-ui does not work.,
ISIS-2219,Improvement,Resolved,Move LDAP Realm implementation into an extension.,
ISIS-2218,Improvement,Resolved,"Remove AuthenticationManager interface, just use AuthenticationManagerStandard as default impl.",
ISIS-2217,Improvement,Resolved,Rename ext fixture's Module interface to ModuleWithFixtures,
ISIS-2216,Improvement,Resolved,"Standardize service @Ordered, @Named, @Primary",
ISIS-2215,Improvement,Resolved,"Remove usage of @ComponentScan, instead explicitly @Import all services etc.",
ISIS-2214,Improvement,Resolved,Introduce @Module as a meta-annotation for @ComponentScan and @Configuration.,
ISIS-2213,Improvement,Resolved,"Avoid package splitting, in prep for possible JPMS support in future.",
ISIS-2212,Improvement,Resolved,"Rename runtime-web to webapp, and tidy up ",
ISIS-2211,Improvement,Resolved,"[WON'T FIX] Factor out Swagger UI as a separate ""viewer"" module","On second thoughts, the swagger-ui is part of the RO viewer, which seems reasonable."
ISIS-2210,Bug,Resolved,"When web browser is narrow, sidebar always shown.",
ISIS-2209,Bug,Resolved,Orphaned validation (when @Action is NOT mandatory) isn't working.,"Andi, 10:11

I think we have 2 scenarios as configured:

1. @Action is mandatory ... then we could allow disable/hide/... prefixes on actions (no need for the validator to discard these cases)
2. @Action is optional ... then we need to preserve the original behavior as you suggested

Dan: 10:13
Yes, agreed. 
I have reinstated that code, though something else must have changed because I couldn't reproduce scenario (2) to trigger the ""orphaned methods"" validation error.
But scenario (1) works fine.
For our own apps, I intend to make @Action mandatory, as per isis.reflector.validator.explication-annotations.action=true

Andi, 10:16
ok, we gonna need to write test cases to check this then

Dan, 10:16
I'll add a ticket"
ISIS-2208,Improvement,Resolved,Move h2console/h2managermenu and hsqldbmanager out into isis-extensions.,Slims down the runtime-web module.
ISIS-2207,Improvement,Resolved,Move schema.utils package in applib under o.a.i.applib package,To avoid split packages.
ISIS-2206,Improvement,Resolved,"Create an incubator catalog and a legacy catalog, similar to extensions.",
ISIS-2205,Improvement,Resolved,Break runtime-extensions module into separate responsibilities,"# move wrapper to runtime-services
 # move Profiler & ProfilerSystem to extensions (or maybe just delete)
 # move jee_support into its own module within incubator.
 # rename remaining to runtime-springboot"
ISIS-2204,Bug,Resolved,"Fixes algorithm for determining if a domain action is ""public"" visible (ie no entities)",
ISIS-2203,Bug,Resolved,Fix NPE when rendering a domain object with null property in RO viewer.,think this was introduced as part of an earlier refactoring
ISIS-2202,Improvement,Resolved,Exclude org.springframework from the metamodel,I don't think there's a need for any of the org.springframework classes to be part of the Apache Isis metamodel
ISIS-2201,Improvement,Resolved,Configure a Spring Boot fallback error page.,
ISIS-2200,Improvement,Resolved,Improve the ordering in the Swagger UI.,
ISIS-2199,Improvement,Resolved,Resurrect commented out metamodel validation re: supporting methods,Andi commented this code out per his spike re: the @Model annotation that is currently in the incubator.
ISIS-2198,Improvement,Resolved,Remove welcome.file config settings and welcome text,"Most major apps will have a home page, so the concept of some welcome text on the home page isn't really that useful."
ISIS-2197,Improvement,Resolved,Allow ClassSubstitutor to be managed as a Spring-managed component,"to allow us to then be more aggressive in ignoring framework classes, but have a fallback/workaround if we end up accidentally going too far."
ISIS-2196,Improvement,Resolved,Ignore static methods in the metamodel completely.,"code that can be removed, hopefully:

- uses of MethodScope.CLASS

- RemoveStaticGettersAndSettersFacetFactory

 "
ISIS-2195,Improvement,Resolved,Performance optimisation: short-circuit searching for actions if possible,"If explicit actions are configured (isis.reflector.explicit-annotions.action=true) then any method that does not have @Action annotation by definition is not an action.  We should therefore check for this early on when introspecting a domain type's method, to avoid searching more deeply than we would otherwise care.

We should also avoid looking at a method's parameters and return types until we've decided that the method is an action (either explicitly or implicitly).

The side-effect of not doing this is that we end up with types that otherwise don't need to be in the metamodel, meaning that startup takes longer.

 "
ISIS-2194,Improvement,Resolved,TranslationServicePo should always log translations on shutdown,
ISIS-2193,Bug,Resolved,BookmarkService doesn't seem to lookup correctly,
ISIS-2192,Improvement,Resolved,"Improve the mavendeps-testing, to avoid accidental junit 4 dependency","At the moment the isis-mavendeps-testing defines transitive dependencies on both unittestsupport and integtestsupport.

 

unittestsupport defines the JMock rule stuff, which depends on junit 4: don't want to change this for now.

 

for integtestsupport, though, want to force upgrade to junit 5, which also means removing any accidental dependencies on junit:junit:4.x

 

The following dependency for integ tests works, but think it might be better to define two different mavendeps, one for unit testing and one for integ testing.

 

<dependency>
 <groupId>org.apache.isis.mavendeps</groupId>
 <artifactId>isis-mavendeps-testing</artifactId>
 <type>pom</type>
 <scope>test</scope>
 <exclusions>
 <exclusion>
 <groupId>org.apache.isis.core</groupId>
 <artifactId>isis-unittestsupport</artifactId>
 </exclusion>
 <exclusion>
 <groupId>org.junit.vintage</groupId>
 <artifactId>junit-vintage-engine</artifactId>
 </exclusion>
 </exclusions>
</dependency>"
ISIS-2191,Improvement,Resolved,"Clean up RepositoryService API (resurrect firstMatch, don't use varargs for ranges)",
ISIS-2190,Improvement,Resolved,ExceptionRecognizer not working - eg attempt to create 2 Hello World objects with same name.,"To reproduce:

with hello world:

a) create ""Hello World"" object

b) attempt to create another object with the same name

What should happen:
 * toast warning that the object already exists

What actually happens:
 * stack trace"
ISIS-2189,Improvement,Resolved,HealthCheckService should integrate with Spring Boot's actuator infra.,
ISIS-2188,Improvement,Resolved,"Remove concept of ""discoverability"" for fixture scripts, sort out fixtureResult layout","because they need to be registered in the AppManifest anyway, it seems."
ISIS-2187,Improvement,Open,[Performance] Explore jandex or classindex as ways to speed up metadata bootstrapping,"see:

[https://github.com/wildfly/jandex]

[https://github.com/atteo/classindex]

 

jandex is a key technology used by Quarkus.

- [https://quarkus.io/guides/cdi-reference#how-to-generate-a-jandex-index]

- [https://quarkus.io/guides/writing-extensions]

 

but ... spring boot decided not to use jandex) ::

 [https://github.com/spring-projects/spring-boot/issues/6260]   

 "
ISIS-2186,Improvement,Resolved,"Bring incode-platform's base, excel, fakedata & unittestsupport in as extensions",
ISIS-2185,Improvement,Resolved,"Split RO viewer's applib, move the client stuff into an extension (""ro-client-v1"" or similar)",done as part of ISIS-2213
ISIS-2184,Improvement,Resolved,Rationalize @Order of our service beans to use enum constants.,"On the note of @Order, I've been meaning to mention, I think our highest priority beans should be +100, and our lowest priority beans should be (Integer.MAX_VALUE - 100). That way it gives the application developer the ability to provide overrides or fallbacks as required.

 

Andi, 11:20
we could just define order constants; Just looking, because I think I've declared these somewhere already.
not consequently used yet, but its there ...
org.apache.isis.commons.internal.ioc.PriorityConstants

 "
ISIS-2183,Improvement,Resolved,Convert all remaining plugins (ServiceLoader) into regular service beans.,"A more general question re: plugins ... what is it about them that means that they can't be implemented as regular services, with Spring finding the implementation using classpat scanning?
 Is it that we need to load them before Spring?
 ie using ServiceLoader or similar?
 Not challenging the design, just want to be able to write some sensible docs about it

Andi, 11:01
 Let me check this first ...

I think we have these, that use ServiceLoader mechanics:
 -1. IsisJdoMetamodelPlugin-
 -2. UriBuilderPlugin-
 -3. IsisJaxrsServerPlugin-
 -4. ProxyFactoryPlugin-
 -5. ValuePropertyPlugin-
 -6. DateConverterPlugin-
 -7. ComponentFactory-

Its likely we could convert 2-7 to service beans, with 1. I need to check the rational ...

11:12
 I think we should do that, then.

Andi, 11:13
 I believe with (1) its also possible now to convert it to a service. It was not possible when the ServiceLoader introspection was run during the post-construct phase, but I changed that to now run after the post-construc pahse, when all the services are discovered and initialized.

11:14
 OK, that would then be a very nice place to get to... the whole framework is just a bunch of Spring-loaded beans.

Andi, 11:14
 yep I agree

11:15
 I think it also means that there isn't really any concept of plugins ... or at least, any of these service beans could be replaced by a different implementation with a higher @Order( if required."
ISIS-2182,Improvement,Resolved,"Move bytebuddy into core, move jaxrs into RO viewer; reorg folders",
ISIS-2181,New Feature,Resolved,Rationalize pom hierarchy with respect to Spring Boot starter-parent.,"Dependency management to go into core (even for extensions)

 

Design as per antora/components/core/modules/archdesign/attachments/pom-hierarchy.pptx."
ISIS-2180,New Feature,Resolved,Resurrect mvn plugin functionality as integ test extensions.,"two of the three features now available in the integtestsupport testing library
 * DomainModelValidator
 * SwaggerExporter

The third feature of the mvn plugin (xsd), not gonna bother with - it's better, I think, to start with an XSD and code-gen the Java class from it, rather than the other way around."
ISIS-2179,Bug,Resolved,Fallback to home page (in event of action returning null) throws an IllegalArg,... as a result of the target pojo for the domain service being an Optional wrapped around the domain service rather than the pojo itself
ISIS-2178,Wish,Open,[Wish] Integrate Nexus Vulnerability Scan into github CI,"[https://github.com/marketplace/actions/nvs-github-actions]

 

 "
ISIS-2177,Improvement,Closed,Provide an ObjectManager API to decouple from JDO,"We are implementing an ObjectManager that is an API to replace ObjectAdapterProvider, PersistenceSession and others that are closely coupled with JDO.

Following a chain of responsibility pattern ObjectManager is setup with a couple of handlers for different responsibilities, these are:

1. Object creation, newing up from a given ObjectSpecification, initializing defaults and resolving injection points if required.
 2. Object re-creation from a given ObjectSpecification + Object-Identifier, resolving injection points if required.
 3. Object persisting for a given ObjectSpecification and the actual Object a pojo. Conceptually this might also include aspects of serializing ManagedObjects into in-memory mementos."
ISIS-2176,Improvement,Closed,[WONT DO] Encapsulate Command/Audit/Publishing within an Extension,"Command (reification), audit and publishing as now included with 'core' need to be refactored into an extension."
ISIS-2175,Improvement,Closed,Remove the 'Version' in OIDs,Ancient code. The responsibility of handling entity versions should instead be up to the persistence layer.
ISIS-2174,New Feature,Resolved,Resurrect Module with fixture support.,
ISIS-2173,Improvement,Resolved,"Exceptions are being swallowed on start up, making it tricky to diagnose (simply see tomcat shutting down)",Use SpringApplicationRunListener to log failures.
ISIS-2172,Improvement,Resolved,Enable actuator for helloworld and simpleapp,
ISIS-2171,Improvement,Resolved,Remove WebModuleStaticResources ... we should just use SpringBoot's support,"... which is that static resources are placed in a ""static"" package on the classpath, ie:
{code:java}
src/main/resources/
    static/** {code}
 

 "
ISIS-2170,Bug,Resolved,@PersistenceCapable(schema=...) is no longer being used to derive objectType,this breaks helloworld app.
ISIS-2169,Improvement,Resolved,Display welcome page for demo apps (helloworld and simpleapp),
ISIS-2168,Bug,Closed,Floating Point Value Types must support Scientific Notation,"given a property of type Double, when you enter 1e-9 in the editable field, this is not recognized;

even worse: entering 0.00001 ends up being rendered as 0"
ISIS-2167,Improvement,Closed,Enable github actions and package registry for interim builds.,
ISIS-2166,Improvement,Resolved,Add dependencyManagement for spring-boot into isis core.,
ISIS-2165,Improvement,Resolved,"Extend helloworld and simpleapp to have maven deps lockdown test, under a profile flag (disable by default).",
ISIS-2164,Wish,Open,[Wish] OpenTracing integration,
ISIS-2163,Improvement,Resolved,Convert IsisSystemEnvironment to a simple Spring-managed bean.,
ISIS-2162,Improvement,Closed,Provide a semantic counterpart to @Programmatic,"We might want to introduce 
{code:java}
@Model
{code}

We've started a discussion on the user-mailing list.

Additional ideas popped up, in order to optionally allow for supporting-methods to have arbitrary names:


{code:java}
@Validate(supports=""placeOrder"")
public String checkIt() 

// and similarly @Hide, @Disable, @Default, @Choices and @AutoComplete
{code}




"
ISIS-2161,Improvement,Resolved,Remove domain-object member naming restrictions (reserved prefixes),"Currently the prefixes 'hide', 'validate', 'disable', etc are reserved for supporting-methods and may not be used for Actions and Properties.

We can lift this restriction:
 * If a member is annotated Action/Property/Collection, then we allow any names for this member, even if these collide with the 'reserved' prefixes!"
ISIS-2160,Improvement,Closed,Concurrent framework Initialization is broken,"Migration to Spring brought a lot of changes under the hood. We now have deadlocks when trying to initialize eg. the Metamodel (Specloader) in parallel.

Any concurrent initialization is disabled for now."
ISIS-2159,Task,Closed,[WON'T FIX] Resurrect the Isis Maven Plugin?,"The *isis-maven-plugin* had 3 features: validate, swagger and xsd

We need to either provide alternatives or ...

... now that we know how to bootstrap a 'headless' context with Spring (like with integration tests), we should be able to easily restore the original functionality with this maven-plugin.

 "
ISIS-2158,Task,Closed,Miscellaneous tasks in preparation of Version 2,
ISIS-2157,Bug,Closed,Secman: Non-existing User gets created in DB even though not authenticated via LDAP,"When using Secman with delegated authentication to LDAP, any login attempt authenticated or not will create an (disabled) user-account in the DB.

While not a security risk, this allows attackers to 'fill' the database with arbitrary garbage.

Desired behavior for this scenario is to auto-create user accounts in the DB only if these do successfully authenticate with the delegated authentication mechanism."
ISIS-2156,Improvement,Closed,Security Manager Extension: Memory Leak w/ PrincipalForApplicationUser,"Hi,

We ran into the issue that our application keeps building up memory but never releases it. We could track it down to the class PrincipalForApplicationUser. Every time a user is authenticated, a new PrincipalForApplicationUser object is created and it is then never released. We experience this memory issue after a change of increasing the number of permissions from 20 to about 200. When comparing the behaviour of the application before and after the change we see that the retained size of the PrincipalForApplicationUser class has increased from about 15KB per instance to about 210KB per instance. For our investigation we created a test environment based on the simpleapp application to be able to isolate the issue and reproduce the issue in a minimalistic environment. So the simpleapp application was extended with 200 fields on which permissions are set. In our test we set the maximum memory size of the VM to 200MB. The test application uses about 40MB initially. We then start firing requests to the application (using jmeter), to: /restful/services/simple.SimpleObjectMenu What we observe then is that memory usage grows rather quickly and eventually it is exhausted. Can you help with a solution for this issue? The simpleapp test application we used is available on github:

[https://github.com/pocos-nl/isis-simpleapp-memoryissues]

It also includes the jmeter test script: memoryLeak-bareApp-SecurityPerformanceTestObject.jmx Thanks,   Leandro D'Agostino"
ISIS-2155,Improvement,Closed,Introduce a BlobClobFactory and a ZipWriter,To simplify common Blob/Clob/Zip idioms.
ISIS-2154,Improvement,Resolved,Remove support for persistent object concurrency checking,"Concurrency Checking:

The OID contains the version/timestamp of the object as retrieved from the DB.So there's a potential race condition if two users pull back the same object at the same time.not to view, but instead when they hit OK to invoke an action (the same action, or perhaps different, but at any rate on the same target object). Both of those users actions will pull back the object with the same version, but either one or the other will commit first, thereby bumping the version.

The race condition here is gonna be measured in milliseconds - it's the time between pulling an object back in order to interact with it, and then the transaction locking it out.

So, once the first user's transaction has completed, then the second user can interact with that object.

The concurrency check is to ensure that the object hasn't been modified since... and if it has, then to require the second unlucky user to start over.

This mechanism only protects the target object, but says nothing about the version of any other objects that might be involved in the transaction."
ISIS-2153,Bug,Closed,Internal API: _Tasks with ThreadPoolSupport must not suppress nested Exceptions,"_Tasks used with ThreadPoolSupport might suppress nested exceptions. This is misleading.

 

 "
ISIS-2152,Improvement,Resolved,"FactoryService (API): remove 'm' shortcut, add 'viewModel'","Opinionated: remove this shortcut for 'mixin', don't encourage bad code readablity, especially when the verbose variant 'mixin' is already short enough:

 
{code:java}
<T> T m(Class<T> mixinClass, Object mixedIn);
{code}
Add

 

 
{code:java}
/**
 * Creates a new ViewModel instance, and initializes according to the given {@code mementoStr}
 * @param viewModelClass
 * @param mementoStr
 * @since 2.0
 */
<T> T viewModel(Class<T> viewModelClass, @Nullable String mementoStr);
{code}
However, I'm not entirely sure whether its a good idea to expose the mementoStr with the API that way.

 

 "
ISIS-2151,Improvement,Closed,Pull in Incode's security modul as an extension,
ISIS-2150,Improvement,Closed,Drop module 'log4j',
ISIS-2149,Improvement,Resolved,"Moves static files (applib xsd, scheme xsd) into _partials so published automatically.",(this is really part of ISIS-2062)
ISIS-2148,Improvement,Resolved,"Tidy up helloworld and simpleapp and then move to their own repos, with minimal parent hierarchy.","The repos are:
 * apache/isis-app-helloworld
 * apache/isis-app-simpleapp

For now, I *haven't* created a repo for ""demo"" or ""smoketest"", I think these will probably stay where they are.

Ideally, should have no parent rather than even a minimal one.  If we do go with a minimal one, then perhaps incode-build moves into isis itself.

 

Will also use this ticket to log any issues with the apps, or minor cleanup.

 "
ISIS-2147,Improvement,Resolved,"Provide a more sophisticated ""fallback"" layout if none is available.","This is based on one that we have come to use in Estatio:

row-1: domain-object

row-2

    col-4:

        tabs: ""identity"" / ""other"" / ""metadata""

        fieldset: ""details""

    col-8:

        collections

 "
ISIS-2146,Improvement,Resolved,"New mixins to expose the objectType and objectIdentifier as properties in the ""metadata"" fieldset.","This is useful info, but it also guarantees that there will be at least two properties in the ""metadata"" fieldset.

This is useful for ISIS-2147."
ISIS-2145,Improvement,Resolved,Move the Object_downloadMetaModelXml into the applib.,"It doesn't depend on any framework internals, and all of the other mixins are in the applib also."
ISIS-2144,Bug,Resolved,Persistable mixins not showing in the demo apps.,"This is because they are not scanned.

I can put in a quick fix, but probably Andi should look at it for the ""best"" solution."
ISIS-2143,Improvement,Resolved,Introduce AsciiDoc and Markdown as new value types.,
ISIS-2142,Improvement,Closed,NatureOfService: Remove deprecated VIEW_MENU_ONLY and  VIEW_CONTRIBUTIONS_ONLY,
ISIS-2141,Improvement,Closed,Migrate to using a shared SupplementalModelArtifact,"see [maven docs|https://maven.apache.org/plugins/maven-remote-resources-plugin/supplemental-models.html]

also make the 'mavendeps' folder a top-level module, to later pull in Dan's Mixins"
ISIS-2140,Improvement,Closed,Drop 'menuOrder' in DomainService and DomainServiceLayout,Replaced by `@Order` and `@Priority`.
ISIS-2139,Bug,Resolved,WepApp's main() should just work out of the box,"The following launch scenarios should work:

1) Running WebApp's main() from within Eclipse

2) Running WebApp's main() from within IntelliJ

3) Running `mvn spring-boot:run`

4) Deployment of the project to a container from within Eclipse

 "
ISIS-2138,Improvement,Resolved,Pull in Dan's maven-mixins,
ISIS-2137,Improvement,Closed,Replace the isis-maven-plugin with (predefined) integration tests,
ISIS-2136,Improvement,Resolved,DemoApp: enable syntax highlighting for the descriptive texts,
ISIS-2135,Improvement,Closed,[WON'T FIX] Testing: Mockito to replace JMock,
ISIS-2134,Improvement,Closed,[WONT FIX] Make joda-time support an extension module,
ISIS-2133,Improvement,Closed,Make fixturescript support an extension module,
ISIS-2132,Improvement,Closed,Make specsupport/cucumber an extension module,
ISIS-2131,Improvement,Resolved,Port Incode's Excel module to 'v2' and include with Isis,Will also be added to the DemoApp.
ISIS-2130,Bug,Closed,"Mixins are broken. Don't seem to be recognized, thus ignored.",
ISIS-2129,Bug,Resolved,Blob/Clob-Panel's Download Button might reference invalid content.,"As reported by Brian, to reproduce
 
1.  start demo with `mvn -Dspring=true spring-boot:run`
 
2.  load wicket home page for the demo ([http://localhost:8080/wicket]), logging in with sven
3.  go to Blob demo
4.  download the png logo
5.  edit it, upload tif1.tif (click OK in dialog, and the thumbnail refreshes)
6.  download the blob again and open if file viewer or take note of what downloads
 
7.  stop and start the demo
8.  Follow steps #2 through #6 with tif2.tif. 
Observe that the thumbnail changes, but the ""downloaded"" file is actually tif1.tif.  You can also see from the browser developer console that the GET request is fulfilled from cache."
ISIS-2128,Bug,Closed,TimestampService is broken,"Yet disabled, because it initialized too early."
ISIS-2127,Improvement,Resolved,Simplify how to provide a Hompage for the Wicket-Viewer,"We have Spring now, might as well utilize it."
ISIS-2126,Improvement,Resolved,Align package names with their module/project names that they are contained in.,"eg. the 'config' module shall only contain packages named 'org.apache.isis.config.*'
"
ISIS-2125,Improvement,Closed,Provide a PlatformTransactionManager for Isis/Jdo,"We have a PlatformTransactionManager for Integration Testing that was introduced with the 'smoketest' module. (Maybe) this could be provided with the integration-testing module.
"
ISIS-2124,Bug,Closed,"Common actions not shown, even when explicitly listed in layout.xml","These actions are missing when rendering domain objects.

{code:xml}
<cpt:action id=""clearHints""/>
<cpt:action id=""downloadLayoutXml""/>
<cpt:action id=""openRestApi""/>
<cpt:action id=""rebuildMetamodel""/>
{code}
"
ISIS-2123,Bug,Closed,SimpleApp build/validate/test needs fixing for v2,
ISIS-2122,Wish,Open,"[Wish] adviseXxx(), a softer version of validateXxx().","more discussion at

[https://lists.apache.org/thread.html/bd8a407ceb0e07cc42c1b7eb85e266817b802a11fccf05819c9c4812@%3Cusers.isis.apache.org%3E]"
ISIS-2121,Improvement,Closed,"Change layout of datetime widget so that is fully visible in sidebar (also fixed in ""v1 maintenance"")",
ISIS-2120,Wish,Reopened,"[Wish] Add @DomainServiceLayout#menuName, to ""slot into"" menubars.layout.xml",
ISIS-2119,Bug,Closed,"Increase timeout to avoid occasional exceptions when download Blobs  (also fixed in ""v1 maintenance"")","On a slow connection, can get occasional exceptions when downloading a blob... that the behaviour cannot be found on the entity:
{code}
org.apache.wicket.behavior.InvalidBehaviorIdException
Cannot find behavior with id '2' on component 'org.apache.isis.viewer.wicket.ui.components.scalars.reference.ReferencePanel:theme:entityPageContainer:entity:rows:1:rowContents:2:col:rows:1:rowContents:1:col:tabGroups:1:panel:tabPanel:rows:1:rowContents:1:col:fieldSets:1:memberGroup:properties:1:property' in page '[Page class = org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage, id = 10, render count = 1]'. Perhaps the behavior did not properly implement getStatelessHint() and returned 'true' to indicate that it is stateless instead of returning 'false' to indicate that it is stateful.
org.apache.wicket.Behaviors#getBehaviorById(Behaviors.java:316)
org.apache.wicket.Component#getBehaviorById(Component.java:4596)
org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler#invokeListener(ListenerInterfaceRequestHandler.java:247)
org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler#respond(ListenerInterfaceRequestHandler.java:234)
org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:895)
org.apache.wicket.request.RequestHandlerStack#execute(RequestHandlerStack.java:64)
org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:265)
org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:222)
org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:293)
org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:261)
org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:203)
org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:284)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1621)
org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter#doFilter(IsisLogOnExceptionFilter.java:52)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1621)
org.togglz.servlet.TogglzFilter#doFilter(TogglzFilter.java:100)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1621)
org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1613)
org.eclipse.jetty.servlet.ServletHandler#doHandle(ServletHandler.java:541)
org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:143)
org.eclipse.jetty.security.SecurityHandler#handle(SecurityHandler.java:548)
org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:132)
org.eclipse.jetty.server.handler.ScopedHandler#nextHandle(ScopedHandler.java:190)
org.eclipse.jetty.server.session.SessionHandler#doHandle(SessionHandler.java:1593)
org.eclipse.jetty.server.handler.ScopedHandler#nextHandle(ScopedHandler.java:188)
org.eclipse.jetty.server.handler.ContextHandler#doHandle(ContextHandler.java:1239)
org.eclipse.jetty.server.handler.ScopedHandler#nextScope(ScopedHandler.java:168)
org.eclipse.jetty.servlet.ServletHandler#doScope(ServletHandler.java:481)
org.eclipse.jetty.server.session.SessionHandler#doScope(SessionHandler.java:1562)
org.eclipse.jetty.server.handler.ScopedHandler#nextScope(ScopedHandler.java:166)
org.eclipse.jetty.server.handler.ContextHandler#doScope(ContextHandler.java:1141)
org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:141)
org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:132)
org.eclipse.jetty.server.Server#handle(Server.java:564)
org.eclipse.jetty.server.HttpChannel#handle(HttpChannel.java:320)
org.eclipse.jetty.server.HttpConnection#onFillable(HttpConnection.java:251)
org.eclipse.jetty.io.AbstractConnection$ReadCallback#succeeded(AbstractConnection.java:279)
org.eclipse.jetty.io.FillInterest#fillable(FillInterest.java:110)
org.eclipse.jetty.io.ChannelEndPoint$2#run(ChannelEndPoint.java:124)
org.eclipse.jetty.util.thread.Invocable#invokePreferred(Invocable.java:122)
org.eclipse.jetty.util.thread.strategy.ExecutingExecutionStrategy#invoke(ExecutingExecutionStrategy.java:58)
org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#produceConsume(ExecuteProduceConsume.java:201)
org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#run(ExecuteProduceConsume.java:133)
org.eclipse.jetty.util.thread.QueuedThreadPool#runJob(QueuedThreadPool.java:672)
org.eclipse.jetty.util.thread.QueuedThreadPool$2#run(QueuedThreadPool.java:590)
java.lang.Thread#run(Thread.java:748)
{code}

  There's not a lot to go on.

Inspecting the returned payload though, I discovered at the end:

{code}
<evaluate><![CDATA[(function(){setTimeout(""window.location.href='./orders.Order:7975?24-1.IBehaviorListener.0-'"", 10);})();]]></evaluate>
{code}

which gave me the clue.  The relevant code is in ActionResultResponseHandlingStrategy:

{code}
    SCHEDULE_HANDLER {
        @Override
        public void handleResults(
                final ActionResultResponse resultResponse,
                final IsisSessionFactory isisSessionFactory) {
            final RequestCycle requestCycle = RequestCycle.get();
            AjaxRequestTarget target = requestCycle.find(AjaxRequestTarget.class);

            if (target == null) {
                // non-Ajax request => just stream the Lob to the browser
                // or if this is a no-arg action, there also will be no parent for the component
                requestCycle.scheduleRequestHandlerAfterCurrent(resultResponse.getHandler());
            } else {
                // otherwise,
                // Ajax request => respond with a redirect to be able to stream the Lob to the client
                ResourceStreamRequestHandler scheduledHandler = (ResourceStreamRequestHandler) resultResponse.getHandler();
                StreamAfterAjaxResponseBehavior streamingBehavior = new StreamAfterAjaxResponseBehavior(scheduledHandler);
                final Page page = target.getPage();
                page.add(streamingBehavior);
                String callbackUrl = streamingBehavior.getCallbackUrl().toString();
                target.appendJavaScript(""setTimeout(\""window.location.href='"" + callbackUrl + ""'\"", 10);"");
            }

        }
    },
{code}

What's happening here is that response from the ajax call to invoke the button is the fragments to rebuild the page ... it's not possible to also return the BLOB.  So the Ajax instead sets a timeout to download that Blob as a separate web call.

Experimenting with this code, if the behaviour is stripped off (everything after the ""?"") then the download doesn't occur; so this is needed.

Since I've seen the problem mostly with large docs and on a slow connection, my guess is that this is some sort of race condition.  Since we can wait a bit more than 10ms, my suggestion is to increase the timeout to 250ms.

~~~
If this fails, then another idea might be to strip off any of the &hint-xxx query args also.
"
ISIS-2118,Bug,Closed,"Don't redundantly add additional DisabledFacet when disabled at class-level (also fixed in ""v1 maintenance"")","
using the ISIS-2015 mixin, I see the following for kitchensink's ReferenceObject when annotated as @DomainObject(editing=DISABLED)
{code}
            <mml:prop id=""otherName"">
                <mml:facets>
                    ...
                    <mml:facet id=""org.apache.isis.core.metamodel.facets.members.disabled.DisabledFacet"" fqcn=""org.apache.isis.core.metamodel.facets.properties.disabled.fromimmutable.DisabledFacetOnPropertyDerivedFromImmutable"">
                        <mml:attr name=""disabling"">true</mml:attr>
                        <mml:attr name=""inverted"">false</mml:attr>
                        <mml:attr name=""semantics"">DISABLED</mml:attr>
                        <mml:attr name=""when"">ALWAYS</mml:attr>
                        <mml:attr name=""where"">ANYWHERE</mml:attr>
                    </mml:facet>
                    ...
                    <mml:facet id=""org.apache.isis.core.metamodel.facets.object.immutable.ImmutableFacet"" fqcn=""org.apache.isis.core.metamodel.facets.object.domainobject.editing.ImmutableFacetForDomainObjectAnnotation"">
                        <mml:attr name=""disabling"">true</mml:attr>
                        <mml:attr name=""reason"">Disabled</mml:attr>
                        <mml:attr name=""when"">ALWAYS</mml:attr>
                    </mml:facet>
{code}

The ImmutableFacet isn't required, because the DisabledFacetOnPropertyDerivedFromImmutable should suffice."
ISIS-2117,Improvement,Closed,Don't use shared instances of 'Random',"Replace Math.random with Random.nextDouble. There is a performance overhead cost when using Math.random over Random.nextDouble. Even moreso, the Random class can allow for easier random manipulation in the future if needed."
ISIS-2116,Bug,Closed,"Avoid error in downloadMetaModelXml, CommandPersistence.NOT_PERSISTED facet not decoded correctly (also fixed in ""v1 maintenance"")",
ISIS-2115,Bug,Closed,"Prevent ajax js error for inlinePromptLink on scalar panel (also fixed in ""v1 maintenance"")","Doesn't seem to effect behaviour, but creates noise in browser JS console."
ISIS-2114,Bug,Closed,[WONT-FIX] Tables: Object Columns should be sortable by displayed Object Titles,"Sorting a column of object-links, by clicking on the column header, does not appear to work."
ISIS-2113,Bug,Closed,[NOT AN ISSUE] Blob/Clob Properties throw when Inline Editing (Ajax),
ISIS-2112,Improvement,Closed,Use Spring Boot for 'Service Provisioning',
ISIS-2111,Improvement,Closed,Remove Resteasy-3 Module (Plugin),Reduce the maintenance burden. RestEasy-4 Module supersedes RestEasy-3.
ISIS-2110,Improvement,Closed,Remove DataNucleus-4 Module (Plugin),Reduce the maintenance burden. DN-5 Module supersedes DN-4.
ISIS-2109,Improvement,Closed,Move the Isis-2-Demo into the Isis Project,Move the standalone 'isis-2-demo' project into the 'v2' branch.
ISIS-2108,Improvement,Resolved,Make WebModules plugable (SPI),"We replaced the web.xml with WebModules, but these are not extensible yet. Need to provide a SPI for more flexibility."
ISIS-2107,Bug,Closed,"Allow enums to implement interfaces for choices (also fixed in ""v1 maintenance"")","The code we wanted to write was equivalent to:

{code:java}
    public Object act(
            final INflLeague nflLeague,
            final NflRegion nflRegion,
            final NflTeamEntity nflTeam) {
        nflPlayer.updateUsingEntity((NflLeague)nflLeague, nflRegion, nflTeam);
        return this.nflPlayer;
    }

    public List<? extends INflLeague> choices0Act() {
        return Arrays.asList(NflLeague.values());
    }
    ...

{code}

where NflLeague is an enum that implements INflLeague :

{code:java}
public interface INflLeague {
    String getName();
}
{code}

and

{code:java}
public enum NflLeague implements INflLeague {
    AFC,
    NFC;

    @Override
    public String getName() {
        return name();
    }
}
{code}

There are two issues:

* first, in the metamodel we don't introspect enums to recognise that a list of NflLeague enum instances can be returned in the choices method returning List<INflLeague> 

* second, in the Wicket viewer the selection of the choicesPanel is based on the type, and if an interface is used then it guesses a referencePanel rather than ValueSelect2Panel that is normally used for enums.  The marshalling logic for ReferencePanel assumes entities, and fails when handed a bunch of scalar enums.
"
ISIS-2106,Improvement,Closed,"Fix CSS for sidebar, buttons not visible if lots of params (also fixed in ""v1 maintenance"")",
ISIS-2105,Improvement,Closed,"mixin to download metamodel in XML for each class (also fixed in ""v1 maintenance"")",
ISIS-2104,Bug,Closed,AuditerService not being called,A simple implementation of AuditerService (see attached) works in v1.17 helloworld archetype but not in v2.0.0-M2 helloworld archetype.
ISIS-2103,Wish,Open,[Wish] Tabs with empty Content should be hidden,"As per the mailing list:
----
Is there any way to hide empty tabs? A tab is hidden if it doesn't contain any fields but if all fields on a tab are hidden there's still the empty tab panel. That looks strange in most cases: 
 
[https://imgur.com/a/75JNQq2] 
 
In the example all fields are hidden on tab 2.2.1, 2.2.2 and 2.2. In that case I don't want to see tab2.2 and below."
ISIS-2102,New Feature,Resolved,Support for Server Sent Events (SSE),"We allow a ViewModel to subscribe to a server-side EventStream in order to receive updates, until the EventStream gets closed.

Use-case: Allows for Background-Tasks to fire UI-Events that update a client-side progress-bar.

"
ISIS-2101,Improvement,Closed,"TreeView: when for any reason the tree-model is empty don't NPE, create empty component instead",
ISIS-2100,Improvement,Closed,Reduce call-site complexity of 'BuilderScripts',"Removing type-params, where redundant ...

{code:java}
@Accessors(chain = true)
public class SimpleObjectBuilder 
extends BuilderScriptAbstract<SimpleObject> { // <= only 1 type param

    @Getter
    private SimpleObject object;

	...
}

@AllArgsConstructor
public enum SimpleObject_persona 
implements PersonaWithBuilderScript<SimpleObjectBuilder> /* <= only 1 type param */ ... {

    FOO(""Foo""),
    BAR(""Bar""),
	
	...

    public SimpleObjectBuilder builder() {
        return new SimpleObjectBuilder().setName(name);
    }

    public static class PersistAll
    extends PersonaEnumPersistAll<SimpleObject_persona, SimpleObject> /* <= only 2 type params */ {
		...
    }
}
{code}




"
ISIS-2099,Improvement,Closed,"The framework should re-connect to the database if it is lost (eg after an overnight DB restore in a test environment)  (also fixed in ""v1 maintenance"")",
ISIS-2098,Sub-task,Closed,Buttons (action-links) with confirmation don't show their associated tooltip,"Buttons (action-links) with confirmation don't show their associated tooltip when mouse-over.

Tooltip text is however rendered after clicking on the button (on top of the opened confirmation-dialog). "
ISIS-2097,Improvement,Resolved,Move LayoutUiEvent from o.a.i.applib.eventbus to o.a.i.applib.event.ui,
ISIS-2096,New Feature,Closed,Extend ReasonBuffer in the applib.,
ISIS-2095,New Feature,Resolved,Allow event subscribers to change the returned value of an action in the EXECUTED phase.,
ISIS-2094,Task,Closed,Release tasks for 2.0.0-M3,"Consider adding credits to the web-site including ...

- Icons made by [Freepik|http://www.freepik.com/] and [Smashicons|https://www.flaticon.com/authors/smashicons] from [www.flaticon.com|https://www.flaticon.com/] which are licensed by [CC 3.0 BY|http://creativecommons.org/licenses/by/3.0/].

- We use [flexmark|https://github.com/vsch/flexmark-java] for markdown rendering."
ISIS-2093,Improvement,Closed,Dialog OK Button: when ARE_YOU_SURE semantics then render style 'DANGER',"To be consistent with other action buttons, that have an associated are-you-sure confirmation dialog."
ISIS-2092,Improvement,Closed,Darkly Theme: buttons and fieldset-headers have same background-color,"Action Buttons on top of Fieldsets are not visually recognizable as buttons.

We need to tweak at least one of these two colors in CSS.

 

 "
ISIS-2091,Improvement,Closed,"Applib Blob and Clob should implement equals and hashCode  (also fixed in ""v1 maintenance"")",
ISIS-2090,Improvement,Closed,"Extend MessageService API with additional overloads  (also fixed in ""v1 maintenance"")",
ISIS-2089,Bug,Closed,JDODataStoreException not handled properly by the framework,"As Kevin reported:

Bug (affects both example applications): Try create two Simple Objects
 with the same name (e.g. ""a"").
 The framework becomes non-responsive (but recovers with a Reload)."
ISIS-2088,Improvement,Closed,TreeView: provide a custom theme for trees - 'bootstrap style',"Also prepare for a Tree-Theme provider service, to switch the theme programmatically."
ISIS-2087,Improvement,Closed,TreeView: algorithm for finding a nodes postion among its siblings is broken,
ISIS-2086,Improvement,Resolved,"Define beans for configuration, so that (eventually) can use Spring Boot's @ConfigurationProperties infrastructure.","ie as per [https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config]



Another benefit we will get from this is that SB has an annotation processor that generates some IDE config files to provide autocomplete when editing the application.properties file

[https://docs.spring.io/spring-boot/docs/2.0.8.RELEASE/reference/html/configuration-metadata.html#configuration-metadata-annotation-processor]

 

 "
ISIS-2085,New Feature,Open,[Validation] Every entity should be annotated with @XmlJavaTypeAdapter(PersistentEntityAdapter.class),"So can be referenced in a view model.

Perhaps only enable this metamodel validation if a config property is enabled."
ISIS-2084,New Feature,Closed,"Allow upload of interim builds to repo.incode.work (also fixed in ""v1 maintenance"")",
ISIS-2083,New Feature,Closed,Allow the dialogMode default for object actions vs service actions be specified separately.,"For example, to sidebar dialogs for object actions, but modal dialogs for service actions."
ISIS-2082,Improvement,Closed,Allow for ThreadPoolSupport to simulate legacy behavior,Allow to set the ThreadPoolSupport's execution mode in a static way. Basically so we can switch off thread-pool-support (switch to legacy behavior) for debugging purposes.
ISIS-2081,New Feature,Closed,"Provide ""redirect even when same"" control on action-by-action basis  (also fixed in ""v1 maintenance"")","Often an action will return its target (ie ""return this"").  Currently there is a configuration option (isis.viewer.wicket.redirectEvenIfSameObject) which controls whether, in such a case, to simply update the existing web page (using ajax) or to re-render the page completely.  By default ajax is used for a smoother UI.

This ticket is to make this controllable via @ActionLayout.  One reason for this is to force a re-rendering of a domain object if its layout is changed, as per ISIS-2080."
ISIS-2080,New Feature,Closed,"Support multiple layouts for a domain object, switchable using layout() (similar to iconName() or cssClass())  (also fixed in ""v1 maintenance"")",
ISIS-2079,New Feature,Closed,"Improve rebuildMetaModel to return the target object rather than void (also fixed in ""v1 maintenance"")",
ISIS-2078,New Feature,Closed,"Allow sidebar vs modal to be specified on action-by-action basis using @ActionLayout or XML (also fixed in ""v1 maintenance"")",
ISIS-2077,Documentation,Closed,"Broken Links according to W3C checker (also fixed in ""v1 maintenance"")","According to [https://validator.w3.org/checklink?uri=https%3A%2F%2Fisis.apache.org%2F&summary=on&hide_type=all&recursive=on&depth=3&cookie=nochanges&check=Check] 
 there are three 404 errors in https://isis.apache.org/guides/ugfun/ugfun.html
 * Line: 1695 [http://zest.apache.org/]
 * Line: 4794 [http://www.datanucleus.org/documentation/products/plugins.html]
 * Line: 1466 http://www.datanucleus.org/documentation/extensions/store_manager.html"
ISIS-2076,Wish,Open,"[Wish] Allow action parameter label to be used as placeholder text instead of to the TOP or LEFT.  This would be a new type of ""position""","as per [https://getbootstrap.com/docs/4.0/components/forms/#readonly]

eg:
{code:java}
@ActionParameter(labelPosition=PLACEHOLDER)
...{code}
 

As a further improvement, maybe there could also be an AUTO (or RESPONSIVE) option that will dynamically figure out the best place to render the label given the space available.

eg:
{code:java}
@ActionParameter(labelPosition=AUTO)
...{code}"
ISIS-2075,New Feature,Closed,"Allow multiple layouts to be defined, and a helper method such as ""layout()"" that returns which to use, similar to iconName() and cssClass().",
ISIS-2074,Wish,Open,"[Wish] Emit UI events to allow subscribers to contribute choices, defaults, autoComplete","The idea being that most facets (perhaps all UI facets) should be able to be expressed:

a) declaratively

b) imperatively

c) via a subscriber."
ISIS-2073,Improvement,Closed,"Multiple action buttons, when line-breaking, need more vertical space",
ISIS-2072,Task,Closed,[WON'T FIX] Release tasks for 1.18.0,
ISIS-2071,Improvement,Closed,"[WON'T FIX] Backport suppression of ""client connection abort"" errors from v2","In ResourceCachingFilter.
 
{code:java}
    ...

    // try to suppress java.io.IOException of kind 'client connection abort'
    // 1) the TCP protocol (by design) does not provide a means to check, whether a
    //    connection has been closed by the client
    // 2) the exception thrown and the exception message text are specific to the
    //    servlet-engine implementation, so we can only guess here
    try {
        chain.doFilter(servletRequest, servletResponse);    
    } catch (IOException e) {
        FluentException.of(e)
        .suppressIf(this::isConnectionAbortException);
    }
}

// -- HELPER

private boolean isConnectionAbortException(IOException e) {
    // tomcat 9
    if(e.getMessage().contains(""An established connection was aborted by the software in your host machine"")) {
        return true;
    }
    // payara 4
    if(e.getMessage().contains(""Connection is closed"")) {
        return true;
    }

    return false;
}
{code}
 "
ISIS-2070,Improvement,Closed,"config properties for ""where am I"" should have ""isis.viewer.wicket"" as a prefix",
ISIS-2069,Improvement,Closed,"Remove support for guava event bus implementation, because ...","... because guava event bus doesn't allow cascading events, ie one event to trigger another event.  Instead, there seems to be some sort of batching.

In contrast, axon works the way one would hope, so this should be the default.

Also, in v2, we will probably introduce implementations for CDI and for Spring (on their respective platforms), so we don't really need so many implementations."
ISIS-2068,Improvement,Closed,Remove all of isis-core-webserver (since no longer have o.a.i.WebServer),"Note that this will take more work than the earlier ticket (ISIS-2067) which just removed the o.a.i.WebServer class, because the other responsibliity of the Maven module is to act as an aggregator of dependencies.

For example, the isis-mavendeps-webapp basically just adds a dependency onto isis-core-webserver."
ISIS-2067,Improvement,Closed,Rework o.a.i.WebServer,"Because if we're moving to Spring etc then they will have their own way of doing bootstrapping.

In the meantime, can use mvn jetty:run"
ISIS-2066,Bug,Closed,Invoking an action that returns null results in an NPE ... eg HelloWorldObject#delete().,"this stackt trace:
{code:java}
Stack trace:
java.lang.NullPointerException
java.util.Objects#requireNonNull(Objects.java:203)
java.util.Optional#<init>(Optional.java:96)
java.util.Optional#of(Optional.java:108)
java.util.stream.FindOps$FindSink$OfRef#get(FindOps.java:193)
java.util.stream.FindOps$FindSink$OfRef#get(FindOps.java:190)
java.util.stream.FindOps$FindOp#evaluateSequential(FindOps.java:152)
java.util.stream.AbstractPipeline#evaluate(AbstractPipeline.java:234)
java.util.stream.ReferencePipeline#findFirst(ReferencePipeline.java:464)
org.apache.isis.viewer.wicket.model.models.ActionModel#executeAction(ActionModel.java:474){code}
 

which results from this code:
{code:java}
return routingServices
    .filter(routingService->routingService.canRoute(result))        
    .map(routingService->{
        final Object routeTo = routingService.route(result);
        return routeTo != null? getPersistenceSession().adapterFor(routeTo): null;
    })
    .findFirst()
    .orElse(resultAdapter);
{code}
 

This isn't quite equivalent to the code in 1.16.x:
{code:java}
final Object result = resultAdapter != null ? resultAdapter.getObject() : null;
for (RoutingService routingService : routingServices) {
    final boolean canRoute = routingService.canRoute(result);
    if(canRoute) {
        final Object routeTo = routingService.route(result);
        return routeTo != null? getPersistenceSession().adapterFor(routeTo): null;
    }
}

return resultAdapter;
{code}
 

 "
ISIS-2065,Improvement,Open,Allow homePageService to specify the homePage without the workaround of setting its nature to VIEW_CONTRIBUTIONS_ONLY,"Contributed actions will be removed in 2.0, and can be disabled, however they are used as a workaround for HomePageService to advertise an action to be invoked to return the homePage but nevertheless to not  be rendered in the menu.

~~~

Improve the viewing for WickedCharts. At the moment, if you set the nature of a WickedChart object to VIEW_MENU_ONLY, it has the side effect of having an unnecessary menu item appear."
ISIS-2064,New Feature,Closed,Allow explicit vs implicit metamodel discovery to be specified with @DomainObject,"as per dev mailing list

[https://lists.apache.org/thread.html/9d766b4e43079f81d1a72c9a78be9f78f65433cb92288394b7f195df@%3Cusers.isis.apache.org%3E]

 

We currently have the configuration property ""isis.reflector.explicitAnnotations.action"" which if specified requires @Action to be added as an annotation for all public methods that don't represent properties/collections or supporting methods.  If this is enabled then there's generally no need to annotate public methods that aren't meant to be in the metamodel with the @Programmatic annotation.
  
 Andi and I have just been discussing this (off-list) and wondering if we should extend this in v2.  Our idea is maybe to allow this to be specified at the class level, and to also have three levels rather than two:
  
 - explicit : all properties, collections and actions must be annotated
 - actions : actions must be annotated, but properties and collections need not.  This is the behavior if the above configuration property is specified.
 - implicit : no annotations are required.  This is the current default
  
 So, we were thinking to add a value to @DomainObject, eg
  
 @DomainObject(metamodelDiscoveryStrategy = EXPLICIT | ACTIONS | IMPLICIT | AS_CONFIGURED)
  
 where ""AS_CONFIGURED"" would read a new configuration property that would take these three values (replacing the existing ""isis.reflector.explicitAnnotations.action"".
  
 Two questions:
  
 1. is the idea of a new level to explicitly annotate everything (properties and collections as well as actions) useful ?
 2. is there a need to configure this on a class-by-class basis, or is a global configuration property sufficient?"
ISIS-2063,Bug,Closed,"Entering a string such as ""10:45"" for a joda LocalTime causes stack trace.","stack trace:

 
 * org.apache.wicket.WicketRuntimeException
 * Method onRequest of interface org.apache.wicket.behavior.IBehaviorListener targeted at org.apache.isis.viewer.wicket.ui.components.scalars.ScalarPanelAbstract2$ScalarUpdatingBehavior@292c9c2f on component [TextField [Component id = scalarValue]] threw an exception
 * org.apache.wicket.RequestListenerInterface#internalInvoke(RequestListenerInterface.java:268)
 * org.apache.wicket.RequestListenerInterface#invoke(RequestListenerInterface.java:241)
 * org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler#invokeListener(ListenerInterfaceRequestHandler.java:248)
 * org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler#respond(ListenerInterfaceRequestHandler.java:234)
 * org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:895)
 * org.apache.wicket.request.RequestHandlerStack#execute(RequestHandlerStack.java:64)
 * org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:265)
 * org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:222)
 * org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:293)
 * org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:261)
 * org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:203)
 * org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:284)
 * org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1621)
 * org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter#doFilter(IsisLogOnExceptionFilter.java:52)
 * org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1621)
 * org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
 * org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
 * org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
 * org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
 * org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
 * org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
 * org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
 * org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1613)
 * org.eclipse.jetty.servlet.ServletHandler#doHandle(ServletHandler.java:541)
 * org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:143)
 * org.eclipse.jetty.security.SecurityHandler#handle(SecurityHandler.java:548)
 * org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:132)
 * org.eclipse.jetty.server.handler.ScopedHandler#nextHandle(ScopedHandler.java:190)
 * org.eclipse.jetty.server.session.SessionHandler#doHandle(SessionHandler.java:1593)
 * org.eclipse.jetty.server.handler.ScopedHandler#nextHandle(ScopedHandler.java:188)
 * org.eclipse.jetty.server.handler.ContextHandler#doHandle(ContextHandler.java:1239)
 * org.eclipse.jetty.server.handler.ScopedHandler#nextScope(ScopedHandler.java:168)
 * org.eclipse.jetty.servlet.ServletHandler#doScope(ServletHandler.java:481)
 * org.eclipse.jetty.server.session.SessionHandler#doScope(SessionHandler.java:1562)
 * org.eclipse.jetty.server.handler.ScopedHandler#nextScope(ScopedHandler.java:166)
 * org.eclipse.jetty.server.handler.ContextHandler#doScope(ContextHandler.java:1141)
 * org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:141)
 * org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:132)
 * org.eclipse.jetty.server.Server#handle(Server.java:564)
 * org.eclipse.jetty.server.HttpChannel#handle(HttpChannel.java:320)
 * org.eclipse.jetty.server.HttpConnection#onFillable(HttpConnection.java:251)
 * org.eclipse.jetty.io.AbstractConnection$ReadCallback#succeeded(AbstractConnection.java:279)
 * org.eclipse.jetty.io.FillInterest#fillable(FillInterest.java:110)
 * org.eclipse.jetty.io.ChannelEndPoint$2#run(ChannelEndPoint.java:124)
 * org.eclipse.jetty.util.thread.Invocable#invokePreferred(Invocable.java:122)
 * org.eclipse.jetty.util.thread.strategy.ExecutingExecutionStrategy#invoke(ExecutingExecutionStrategy.java:58)
 * org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#produceConsume(ExecuteProduceConsume.java:201)
 * org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#run(ExecuteProduceConsume.java:133)
 * org.eclipse.jetty.util.thread.QueuedThreadPool#runJob(QueuedThreadPool.java:672)
 * org.eclipse.jetty.util.thread.QueuedThreadPool$2#run(QueuedThreadPool.java:590)
 * java.lang.Thread#run(Thread.java:748)
 * 
 * Caused by:
 * 
 * java.lang.reflect.InvocationTargetException
 * 
 * sun.reflect.NativeMethodAccessorImpl#invoke0(NativeMethodAccessorImpl.java:-2)
 * sun.reflect.NativeMethodAccessorImpl#invoke(NativeMethodAccessorImpl.java:62)
 * sun.reflect.DelegatingMethodAccessorImpl#invoke(DelegatingMethodAccessorImpl.java:43)
 * java.lang.reflect.Method#invoke(Method.java:498)
 * org.apache.wicket.RequestListenerInterface#internalInvoke(RequestListenerInterface.java:258)
 * org.apache.wicket.RequestListenerInterface#invoke(RequestListenerInterface.java:241)
 * org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler#invokeListener(ListenerInterfaceRequestHandler.java:248)
 * org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler#respond(ListenerInterfaceRequestHandler.java:234)
 * org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:895)
 * org.apache.wicket.request.RequestHandlerStack#execute(RequestHandlerStack.java:64)
 * org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:265)
 * org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:222)
 * org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:293)
 * org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:261)
 * org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:203)
 * org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:284)
 * org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1621)
 * org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter#doFilter(IsisLogOnExceptionFilter.java:52)
 * org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1621)
 * org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
 * org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
 * org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
 * org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
 * org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
 * org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
 * org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
 * org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1613)
 * org.eclipse.jetty.servlet.ServletHandler#doHandle(ServletHandler.java:541)
 * org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:143)
 * org.eclipse.jetty.security.SecurityHandler#handle(SecurityHandler.java:548)
 * org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:132)
 * org.eclipse.jetty.server.handler.ScopedHandler#nextHandle(ScopedHandler.java:190)
 * org.eclipse.jetty.server.session.SessionHandler#doHandle(SessionHandler.java:1593)
 * org.eclipse.jetty.server.handler.ScopedHandler#nextHandle(ScopedHandler.java:188)
 * org.eclipse.jetty.server.handler.ContextHandler#doHandle(ContextHandler.java:1239)
 * org.eclipse.jetty.server.handler.ScopedHandler#nextScope(ScopedHandler.java:168)
 * org.eclipse.jetty.servlet.ServletHandler#doScope(ServletHandler.java:481)
 * org.eclipse.jetty.server.session.SessionHandler#doScope(SessionHandler.java:1562)
 * org.eclipse.jetty.server.handler.ScopedHandler#nextScope(ScopedHandler.java:166)
 * org.eclipse.jetty.server.handler.ContextHandler#doScope(ContextHandler.java:1141)
 * org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:141)
 * org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:132)
 * org.eclipse.jetty.server.Server#handle(Server.java:564)
 * org.eclipse.jetty.server.HttpChannel#handle(HttpChannel.java:320)
 * org.eclipse.jetty.server.HttpConnection#onFillable(HttpConnection.java:251)
 * org.eclipse.jetty.io.AbstractConnection$ReadCallback#succeeded(AbstractConnection.java:279)
 * org.eclipse.jetty.io.FillInterest#fillable(FillInterest.java:110)
 * org.eclipse.jetty.io.ChannelEndPoint$2#run(ChannelEndPoint.java:124)
 * org.eclipse.jetty.util.thread.Invocable#invokePreferred(Invocable.java:122)
 * org.eclipse.jetty.util.thread.strategy.ExecutingExecutionStrategy#invoke(ExecutingExecutionStrategy.java:58)
 * org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#produceConsume(ExecuteProduceConsume.java:201)
 * org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#run(ExecuteProduceConsume.java:133)
 * org.eclipse.jetty.util.thread.QueuedThreadPool#runJob(QueuedThreadPool.java:672)
 * org.eclipse.jetty.util.thread.QueuedThreadPool$2#run(QueuedThreadPool.java:590)
 * java.lang.Thread#run(Thread.java:748)
 * 
 * Caused by:
 * 
 * java.lang.RuntimeException
 * unable to parse string for org.joda.time.LocalTime
 * org.apache.isis.viewer.wicket.model.models.ScalarModel#setObjectAsString(ScalarModel.java:830)
 * org.apache.isis.viewer.wicket.ui.components.scalars.TextFieldStringModel#setObject(TextFieldStringModel.java:39)
 * org.apache.isis.viewer.wicket.ui.components.scalars.TextFieldStringModel#setObject(TextFieldStringModel.java:21)
 * org.apache.wicket.Component#setDefaultModelObject(Component.java:3122)
 * org.apache.wicket.markup.html.form.FormComponent#setModelObject(FormComponent.java:1579)
 * org.apache.wicket.markup.html.form.FormComponent#updateModel(FormComponent.java:1097)
 * org.apache.wicket.ajax.form.AjaxFormComponentUpdatingBehavior#onEvent(AjaxFormComponentUpdatingBehavior.java:151)
 * org.apache.wicket.ajax.AjaxEventBehavior#respond(AjaxEventBehavior.java:155)
 * org.apache.wicket.ajax.AbstractDefaultAjaxBehavior#onRequest(AbstractDefaultAjaxBehavior.java:601)
 * sun.reflect.NativeMethodAccessorImpl#invoke0(NativeMethodAccessorImpl.java:-2)
 * sun.reflect.NativeMethodAccessorImpl#invoke(NativeMethodAccessorImpl.java:62)
 * sun.reflect.DelegatingMethodAccessorImpl#invoke(DelegatingMethodAccessorImpl.java:43)
 * java.lang.reflect.Method#invoke(Method.java:498)
 * org.apache.wicket.RequestListenerInterface#internalInvoke(RequestListenerInterface.java:258)
 * org.apache.wicket.RequestListenerInterface#invoke(RequestListenerInterface.java:241)
 * org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler#invokeListener(ListenerInterfaceRequestHandler.java:248)
 * org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler#respond(ListenerInterfaceRequestHandler.java:234)
 * org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:895)
 * org.apache.wicket.request.RequestHandlerStack#execute(RequestHandlerStack.java:64)
 * org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:265)
 * org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:222)
 * org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:293)
 * org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:261)
 * org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:203)
 * org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:284)
 * org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1621)
 * org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter#doFilter(IsisLogOnExceptionFilter.java:52)
 * org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1621)
 * org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
 * org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
 * org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
 * org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
 * org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
 * org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
 * org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
 * org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1613)
 * org.eclipse.jetty.servlet.ServletHandler#doHandle(ServletHandler.java:541)
 * org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:143)
 * org.eclipse.jetty.security.SecurityHandler#handle(SecurityHandler.java:548)
 * org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:132)
 * org.eclipse.jetty.server.handler.ScopedHandler#nextHandle(ScopedHandler.java:190)
 * org.eclipse.jetty.server.session.SessionHandler#doHandle(SessionHandler.java:1593)
 * org.eclipse.jetty.server.handler.ScopedHandler#nextHandle(ScopedHandler.java:188)
 * org.eclipse.jetty.server.handler.ContextHandler#doHandle(ContextHandler.java:1239)
 * org.eclipse.jetty.server.handler.ScopedHandler#nextScope(ScopedHandler.java:168)
 * org.eclipse.jetty.servlet.ServletHandler#doScope(ServletHandler.java:481)
 * org.eclipse.jetty.server.session.SessionHandler#doScope(SessionHandler.java:1562)
 * org.eclipse.jetty.server.handler.ScopedHandler#nextScope(ScopedHandler.java:166)
 * org.eclipse.jetty.server.handler.ContextHandler#doScope(ContextHandler.java:1141)
 * org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:141)
 * org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:132)
 * org.eclipse.jetty.server.Server#handle(Server.java:564)
 * org.eclipse.jetty.server.HttpChannel#handle(HttpChannel.java:320)
 * org.eclipse.jetty.server.HttpConnection#onFillable(HttpConnection.java:251)
 * org.eclipse.jetty.io.AbstractConnection$ReadCallback#succeeded(AbstractConnection.java:279)
 * org.eclipse.jetty.io.FillInterest#fillable(FillInterest.java:110)
 * org.eclipse.jetty.io.ChannelEndPoint$2#run(ChannelEndPoint.java:124)
 * org.eclipse.jetty.util.thread.Invocable#invokePreferred(Invocable.java:122)
 * org.eclipse.jetty.util.thread.strategy.ExecutingExecutionStrategy#invoke(ExecutingExecutionStrategy.java:58)
 * org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#produceConsume(ExecuteProduceConsume.java:201)
 * org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#run(ExecuteProduceConsume.java:133)
 * org.eclipse.jetty.util.thread.QueuedThreadPool#runJob(QueuedThreadPool.java:672)
 * org.eclipse.jetty.util.thread.QueuedThreadPool$2#run(QueuedThreadPool.java:590)
 * java.lang.Thread#run(Thread.java:748)"
ISIS-2062,Improvement,Closed,Convert website to use Antora,
ISIS-2061,Bug,Closed,Fix rendering of date/time in sidebar dialog,
ISIS-2060,Improvement,Closed,[Duplicate] Allow safe actions to be invoked if only have read-only access.,Use a config property to enable this feature.
ISIS-2059,Improvement,Closed,Allow Wicket viewer caching strategy (timestamp or digest) to be selected via config property.,"There is already some commented-out code in IsisWicketApplication.

// getResourceSettings().setCachingStrategy(
// new FilenameWithVersionResourceCachingStrategy(
// new CachingResourceVersion(
// new MessageDigestResourceVersion())));"
ISIS-2058,Improvement,Closed,Pre-render home page to avoid wait when first hit webapp after bootstrapping,"You can try by rendering the home page in a separate thread during the bootstraping

You need to use ComponentRenderer#renderPage(app.getHomePage())

you can do this for any of Isis' pages. You just need to provide their input if they require such

 

It is a static method and it creates an artificial RequestCycle for its needs (so it doesn't need an HTTP thread)


[this is an cool idea for a small WicketStuff project that uses Wicket IInitializer to render the home page in the background as soon as the app is started]"
ISIS-2057,Improvement,Closed,JaxbServiceDefault should handle entity if isn't annotated with XmlJavaTypeAdapter,
ISIS-2056,Improvement,Closed,"Fix Sonar Findings (also fixed in ""v1 maintenance"")",
ISIS-2055,Improvement,Closed,Amend CI Builds by Sonarqube Analysis,"As discussed in [1], amends the CI build to submit build artefacts to sonar analysis on [2].
Default sonar rule set may need to be customized in order to avoid false positives.

[1] https://lists.apache.org/thread.html/30ae8fb467fd76cbb2fc0404198ec369c4d87c14e6cc5df18efe28a6@%3Cdev.isis.apache.org%3E
[2] https://builds.apache.org/analysis/"
ISIS-2054,Improvement,Closed,Reduce memory pressure when reducing calls on getMethod(byName) when looking up annotations.,"Comment by Andi ...

think this relates to just noticed we can improve performance of specloader initialization by tweaking ... org.apache.isis.core.metamodel.facets.Annotations such that annotation lookup does no longer call getMethod(byName, ...) 

this produces a huge amount of stack-trace objects that pollute the heap

This has already been parallelized, but I think the bottleneck could be memory related :)"
ISIS-2053,Improvement,Closed,Improve tabbing behaviour,
ISIS-2052,Improvement,Closed,Remove unused private constructors,
ISIS-2051,Documentation,Closed,Amend ugrov ,"Attachment contains adoc formatted example, in short:

Exception:

'com.sun.xml.bind.v2.runtime.IllegalAnnotationsException: 1 counts of IllegalAnnotationExceptions'

Solution: 

Add @XmlAccessorType(XmlAccessType.FIELD) to your domain entity"
ISIS-2050,Improvement,Closed,Install ObjectSpecIdFacet immediately on creation of ObjectSpecification so can be cached.,
ISIS-2049,Improvement,Closed,Remove guava from core,Guava is still used in RO-Viewer.
ISIS-2048,Improvement,Closed,Update Wicket 8.1.0 -> 8.2.0,"{noformat}
Release Notes - Wicket - Version 8.2.0

** Bug

    * [WICKET-4423] - Modal Window dragging failes with iframe
    * [WICKET-5552] - Events to close pop-up on Modal Window are not propagated
    * [WICKET-6586] - Broken JavaScript due to fix charsetName in JavaScriptPackageResource
    * [WICKET-6588] - Under Tomcat (ver. >= 8.5) BaseWebSocketBehavior can't find session id cookie 
    * [WICKET-6589] - ClientInfo fails with NumberFormatException for unusual browser versions
    * [WICKET-6599] - ResponseIOException should never escape from WicketFilter
    * [WICKET-6602] - AuthenticatedWebApplication login Workflow broken with replaceSession
    * [WICKET-6603] - WicketTester.destroy sometimes hangs
    * [WICKET-6604] - Ajax repaint is not correctly handled when component being repainted has an enclosure associated with it and is not a child of the enclosure
    * [WICKET-6606] - data-wicket-placeholder is invalid XHTML
    * [WICKET-6607] - NoSuchMethodError when using Spring-Beans with constructor injection in an AjaxLink#onClick
    * [WICKET-6608] - Stateless page, mix of queue and add can cause unforseen consequences
    * [WICKET-6610] - Incorrect Javadoc: Refering to specific page in Application properties file is not possible

** Improvement

    * [WICKET-6435] - WicketTester should provide assertExists and assertNotExists methods
    * [WICKET-6600] - Error logging in AjaxRequestHandler is too strict
    * [WICKET-6601] - Events to close pop-up on Modal Window are not propagated from caption bar
    * [WICKET-6605] - Allow AjaxFallbackButton to be stateless 

** Task

    * [WICKET-6594] - JavaDoc of redirectToInterceptPage in Component urges to use redirectTo method when in a constructor
    * [WICKET-6609] - Update Guice from 4.1.0 to 4.2.2
{noformat}
"
ISIS-2047,Improvement,Closed,ThemeChooser: support for custom ThemeProviders,"Further removing the need for sub-classing IsisWicketApplication:

Provide your own implementiation of IsisWicketThemeSupport via

isis.viewer.wicket.themes.provider=org.my.IsisWicketThemeSupport 


"
ISIS-2046,Bug,Closed,RO viewer should honour x-ro-validate-only,"It claims it does (on the version resource), and yet not."
ISIS-2045,Bug,Closed,RO viewer does not render body correctly when action validation fails.,
ISIS-2044,Wish,Open,[Wish] IsisConfiguration download for offline editing (like layouts),"When PROTOTYPING, allow for download of then IsisConfiguration in serialized form (text-file), which can be edited offline and reused, same as we do with layouts."
ISIS-2043,New Feature,Closed,"Allow domain events to be specified at @DomainObject, and make mixins aware of this.","Thus:
{code:java}
@DomainObject(
    ...,
    actionDomainEvent=IncomingInvoice.ActionDomainEvent.class, 
    propertyDomainEvent=IncomingInvoice.PropertyDomainEvent.class,
    collectionDomainEVent=IncomingInvoice.CollectionDomainEvent.class
)
public class IncomingInvoice {
  public static class ActionDomainEvent 
      extends o.a.i.applib.services.eventbus.ActionDomainEvent {}
  // etc
}{code}
then, for this domain event would be used as the default for any actions etc.

Two refinements to this:

a) for mixins, the event type emitted by a mixin action should be that of its mixee if possible.  This does mean that the domain event must use <Object> as its generic type, because the source could either be the regular domain object or a mixin.  This seems reasonable, the subscriber can just call ev.getMixee() to determine the original source.

b) as a metamodel validation, if there are members that already define their own event types, then these event types should inherit from the types defined in @DomainObject.  However, not sure exactly how well this plays with requirement from (a) that the generic type is <Object>.

 

 

 "
ISIS-2042,Improvement,Closed,When PROTOTYPING warn when menubars.layout.xml is missing,"Just for convenience:

When PROTOTYPING show warning once per app life-cycle, when 'menubars.layout.xml' is missing, also giving a hint, where in the class-path to put this layout resource."
ISIS-2041,Improvement,Closed,"LogonFixture is deprecated, replace by FixtureScript (see also ISIS-2133)",
ISIS-2040,New Feature,Closed,[WON'T FIX] Authentication/Shiro: Add OpenID support,"Extend the shiro core plugin with buji-pac4j [1]

[1] [https://github.com/bujiio/buji-pac4j]

 

 

 "
ISIS-2039,Improvement,Closed,Redesign of Configuration,"Goals:

1) the framework shall provide a singleton instance of IsisConfiguration, which is an interface that provides immutable/readonly access to the config key/value pairs
 2) the framework provides IsisConfigurationBuilder once during the early-bootstrap phase for r/w access to the config key/value pairs
 3) first time any module requests access to IsisConfiguration, a singleton instance IsisConfiguration is built using the builder and the builder itself is no longer valid, meaning the framework denies any caller access to the builder

A benefit of this design is, that it is no longer required to pass around or hold instances of IsisConfiguration, because the framework provides a static means to get the current life-cycle's singletons for configuration.

Side-effects ...

1) cleanup and simplify bootstrapping code
 2) no more configuration mocking for JUnit tests, instead use new internal Config API
 3) removal of @PostConstruct methods that take arguments
 4) removal of apache commons dependencies (really only required by the WebServer tool)"
ISIS-2038,Bug,Closed,Darkly Theme: tooltips render white text on almost white background,
ISIS-2037,Bug,Closed,"UI: Footer Credits, links to local resources are not context path aware",
ISIS-2036,Bug,Closed,When PROTOTYPING prototyping toplevel menu is (sometimes?) hidden,"when running simple-app with 

set PROTOTYPING=true; mvn jetty:run

UI does not show the toplevel 'Prototyping' menu

"
ISIS-2035,Bug,Closed,Examples: about page ... swagger link broken,static html about page needs fixing
ISIS-2034,Bug,Closed,[NOT A PROBLEM] REST operations return empty response,"to reproduce:
 # checkout HEAD of v2 branch
 # mvn clean install
 # cd to isis/example/application/simpleapp/webapp
 # set PROTOTYPING=true
 # mvn jetty:run
 # open web browser to localhost:8080/wicket, sign in as sven/pass
 # from prototyping menu, open swagger-ui
 # reload private spec
 # select simple - /service/simple.SimpleObjectMenu/actions/listAll/invoke
 # click ""Try it out""

expected:  Response body should have some output - some json with metadata or something

actual: Reponse body says ""no content"""
ISIS-2033,Task,Closed,Spring Data Integration,Re-platforming Apache Isis on Spring Boot + Spring Data
ISIS-2032,Improvement,Closed,Tables (non-paged): display total number of entites shown,"We do have this feature in paged tables, but not when utilizing 'Show all'."
ISIS-2031,Improvement,Closed,Using 'show all' on tables does take longer than expected,"When fetching and displaying 25 objects (rendering a table) takes 1s, then the same with 100 objects should take about 4s, but it takes way longer. 

This is strange. I also noticed, that after having fetched all objects from the DB, the viewer is still occupied with rendering, showing the long-running indicator.

This needs some investigation."
ISIS-2030,Improvement,Closed,Table Column Order: use order of occurrence in layout grid as the default,"Instead of ordering by column name (more precisely: propertyId), use the grid layout facet:

1) if propertyId is mentioned within grid, put into first 'half' ordered by occurrence within grid.
2) if propertyId is not mentioned within grid, put into second 'half' ordered by propertyId (String) in natural order"
ISIS-2029,Bug,Closed,Using Application Identity (e.g. settings module) with .orm file leads to Webui exception,"h2.Problem description

I want to use settings module (incode or previous isis-addons) so that the tables are persisted in custom database schema (different than isissettings).

In order to achieve this I have created a custom .orm file e.g.

 

package-custom.orm 
{code:java}
<?xml version=""1.0"" encoding=""UTF-8"" ?>
<orm xmlns=""http://xmlns.jcp.org/xml/ns/jdo/orm""
     xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""
     xsi:schemaLocation=""http://xmlns.jcp.org/xml/ns/jdo/orm http://xmlns.jcp.org/xml/ns/jdo/orm_3_0.xsd"">

<package name=""org.isisaddons.module.settings.dom.jdo"">
    <class name=""ApplicationSettingJdo"" schema=""myschema"" table=""IsisAppSetting""/>
    <class name=""UserSettingJdo"" schema=""myschema"" table=""IsisUserSetting""/>
</package>

</orm>
{code}
and refer the file in persistor_datanucleus.properties
{code:java}
# schema name override
isis.persistor.datanucleus.impl.datanucleus.Mapping=custom{code}
 

I can create single ApplicationSetting thru WebUI but if I have more than one persisted, here the WebUI exception I get in WebUI
{code:java}
Caused by:
org.datanucleus.exceptions.NucleusUserException
Identity ""interface.MQTT.activated[OID]org.incode.example.settings.dom.jdo.ApplicationSettingJdo"" is assigned to class ""org.incode.example.settings.dom.jdo.ApplicationSettingJdo"", but its not the correct object-id type for this class.
org.datanucleus.store.AbstractStoreManager#manageClassForIdentity(AbstractStoreManager.java:937)
org.datanucleus.ExecutionContextImpl#getClassDetailsForId(ExecutionContextImpl.java:3385)
org.datanucleus.ExecutionContextImpl#findObjects(ExecutionContextImpl.java:3251){code}
 

I believe the root cause is that Datanucleus thinks somehow that the ApplicationSetting has not Application Identity which it has since field key is primary key - but only in the case when retreiving more then one entity from database.

 

All works fine when creating new instance ApplicationSetting or reading it from database by key. The command ""Settings --> listAll"" fails.

 

I tried also to adapt the .orm file e.g. but it didn't helped.
{code:java}
<package name=""org.incode.example.settings.dom.jdo"">
    <class name=""ApplicationSettingJdo"" identity-type=""application"" schema=""myschema"" table=""IsisAppSetting"">
        <field name=""key"" primary-key=""true""/>
    </class>
    <class name=""UserSettingJdo"" identityType=""application"" schema=""myschema"" table=""IsisUserSetting""/>
</package>{code}"
ISIS-2028,Bug,Closed,Bundled Jetty cannot launch with new Byte-Buddy 1.9.2 in place,"Jetty fails to launch due to discovery of a module-info.class in the byte-buddy jar.

Updating the Jetty version [1] to 9.4.12 might do the trick.

[1] https://www.eclipse.org/lists/jetty-announce/msg00124.html"
ISIS-2027,New Feature,Closed,Provide a health endpoint (eg for Docker orchestrators to monitor).,
ISIS-2026,Bug,Closed,IllegalAccessExceptions with Byte-Buddy 1.9.2,"With update of byte-buddy 1.8.0 -> 1.9.2, we intent to make Apache Isis ready for JDK 11+.

We are utilizing byte-buddy for unit-test-support (mockery) and also for creating proxies for domain objects.

It seems the newer version either no longer supports mockery of non public methods or requires some additional setup. Also we do see IllegalAccessExceptions when creating proxies, where byte-buddy 1.8.0 just worked fine.

Problem background and possible solutions can be found here [1].

[1] https://github.com/raphw/byte-buddy/issues/447

 

 

 

 "
ISIS-2025,Improvement,Closed,"Extend WrapperFactory with new execution mode to ""try"" to execute.","same as execute, but swallow any validation errors."
ISIS-2024,Improvement,Closed,Centre image or text on sign-in page.,backported from 2.0.0-M2
ISIS-2023,Improvement,Closed,Add additional config properties so there is little need to subclass IsisWicketApplication,Backported from 2.0.0-M2
ISIS-2022,Improvement,Closed,Show application version in footer if available as config property.,"initially implemented in 2.0.0-M2, backported.

Expected use is for CI system to generate an application-version.properties file, which is then read in similar to isis-non-changing.properties"
ISIS-2021,Improvement,Closed,Allow initial bootswatch theme to be specified via configuration property,"initially implemented in 2.0.0-M2, backported to 1.16.x"
ISIS-2020,New Feature,Closed,Experimental Support for DataNucleus Federated Datastore,"Insert and Update operations work as expected, but query operations operate on the primary datastore.  I see from stepping through the M1 code that Insert and Update operations use a transaction that accesses a FederatedDataStore.  I guess that is where the difference occurs in that the query operations get a data store another way, failing to get the FederatedDataStore that is configured.

example code created from helloworld-archetype is at [https://github.com/bkalbfus/isis-federatedDS-2_0_0-M1]

Mailing list: [https://lists.apache.org/thread.html/2edea2f8d802532c3672eddc83b484bbc2e31d1cac16f2759feeb95f@%3Cusers.isis.apache.org%3E]

 

 "
ISIS-2019,Improvement,Closed,Fix NPEs when rendering REST API.,"Undoubtedly resulting from earlier refactorings, eg removal of some fallback facets?

Anyway, need the guards."
ISIS-2018,Improvement,Closed,[WON'T DO] Improve spec cache management,"Add in some checks to ensure that the two caches within SpecificationCacheDefault never get out of step.  

Needs to take into account / improve the horrible kludge of the ThreadLocal used in calls around invalidateCache, in ObjectSpecificationAbstract#getAssociation(String id)

~~~
Also, probably don't need to eagerly introspect all specs.  Perhaps just enough to determine the ObjectSpecId.  Should there be three levels of introspection? NOT_INTROSPECTED, OBJECT_SPEC_ID_INTROSPECTED, FULLY_INTROSPECTED ?"
ISIS-2017,Improvement,Closed,Include the $$domainType for v1 representation.,
ISIS-2016,Improvement,Closed,[NOT A PROBLEM] Slow initial loading - webjars for bootswatch themes?,"I thinik we used to use webjars as a cache for bootswatch themes; have we removed them accidentally?  

https://www.webjars.org/documentation#wicket

and commented out stuff in web.xml

{code:xml}
<!--
    <servlet>
        <servlet-name>WebjarsServlet</servlet-name>
        <servlet-class>org.webjars.servlet.WebjarsServlet</servlet-class>
        <init-param>
            <param-name>disableCache</param-name>
            <param-value>false</param-value>
        </init-param>
        <load-on-startup>2</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>WebjarsServlet</servlet-name>
        <url-pattern>/webjars/*</url-pattern>
    </servlet-mapping>
-->
{code}"
ISIS-2015,Bug,Closed,"Text (multiline?) can be changed on non-editable field, without using edit.","If you select with your mouse the text inside the note field (a disabled multiline text field) from right to left to the first character, the text will be selected and you can replace it with another text without entering 'edit mode' on the note field. this new text will not be saved however but still gives this impression to the uninformed user. This happens with Chrome.

With Firefox trying to select the text results in pasting a copy of the current url into the note field without edit mode."
ISIS-2014,Improvement,Closed,Minor API refinements for integration testing.,"w() as synonym for wrap(...)
m() as synonym for mixin(...)
wm() as synonym for wrap(mixin(...))

given( () -> {} ), givenT, givenS, 
when, whenT, whenS,
then"
ISIS-2013,Improvement,Closed,Add support for H2 embedded database.,
ISIS-2012,Improvement,Closed,"[WON'T FIX] For integ tests, allow individual services to be removed from the system.",
ISIS-2011,Improvement,Closed,"[superceded] Merge up AppManifest2 into AppManifest, untangle those builders",perhaps there's a deeper composite pattern (we already have ModuleOrSomethingAbstract ... I think that AppManifest might be the root of a hierarchy with a common supertype).
ISIS-2010,Improvement,Closed,Define a formal natureOfService of MODULE_API for programmatic interactions via wrapper across module trust boundaries.,"One idea:
 - NatureOfService.MODULE_API 

For the API, can wrap (and perhaps are auto-wrapped)

For the DOMAIN, are not wrapped, and don't introspect the methods to create actions.

Questions:

* It's not clear to me which of the Isis services should be MODULE_API vs DOMAIN.

* Do we also auto-wrap entities returned from a service thus annotated?"
ISIS-2009,Improvement,Closed,Allow footer to be customised with multiple credits,"initially implemented in 2.0.0-M2, backported."
ISIS-2008,Improvement,Closed,"Add null guards in Blob and Clob, to detect errors in application code early",
ISIS-2007,Improvement,Closed,"Use Objects.requireNonNull(Obj, Supplier<String>) to avoid masking errors","If use Objects.requireNonNull(Object, String), then this will evaluate String eagerly.  That might itself cause an exception, hiding if the object is null."
ISIS-2006,Improvement,Closed,reimplementing a JAX-RS 2.0 restful client for Isis from scratch,"Proposed to be a first class citizen living in core-applib, without introducing any new maven dependencies by just conforming to the JAX-RS 2.0 standard.

Also provides
- support for basic-auth 
- support for async requests


 "
ISIS-2005,Bug,Closed,Java built-in temporal type java.sql.Date rendered with -1 day offset after edit,Editing java.sql.Date type via Wicket-Viewer results in a minus 1 day being saved.
ISIS-2004,Bug,Closed,Concurrent Modification Exception in grid service,"This occurred when invoking ""latestFastnetImportLog"" within Estatio (having just restarted, in estatio-test - prototype mode)

{code}
11:20:44,677 [RequestCycleExtra             ] Handling the following exception


org.apache.wicket.WicketRuntimeException: Error attaching this container for rendering: [RepeatingViewWithDynamicallyVisibleContent [Component id = tabGroups]]


	at org.apache.wicket.MarkupContainer.onBeforeRenderChildren(MarkupContainer.java:1837)


	at org.apache.wicket.Component.onBeforeRender(Component.java:3916)


	at org.apache.wicket.markup.repeater.AbstractRepeater.onBeforeRender(AbstractRepeater.java:143)


	at org.apache.wicket.Component.internalBeforeRender(Component.java:950)


	at org.apache.wicket.Component.beforeRender(Component.java:1018)


	at org.apache.wicket.MarkupContainer.onBeforeRenderChildren(MarkupContainer.java:1825)


	at org.apache.wicket.Component.onBeforeRender(Component.java:3916)


	at org.apache.wicket.Component.internalBeforeRender(Component.java:950)


	at org.apache.wicket.Component.beforeRender(Component.java:1018)


	at org.apache.wicket.MarkupContainer.onBeforeRenderChildren(MarkupContainer.java:1825)


	at org.apache.wicket.Component.onBeforeRender(Component.java:3916)


	at org.apache.wicket.Component.internalBeforeRender(Component.java:950)


	at org.apache.wicket.Component.beforeRender(Component.java:1018)


	at org.apache.wicket.MarkupContainer.onBeforeRenderChildren(MarkupContainer.java:1825)


	at org.apache.wicket.Component.onBeforeRender(Component.java:3916)


	at org.apache.wicket.markup.repeater.AbstractRepeater.onBeforeRender(AbstractRepeater.java:143)


	at org.apache.wicket.Component.internalBeforeRender(Component.java:950)


	at org.apache.wicket.Component.beforeRender(Component.java:1018)


	at org.apache.wicket.MarkupContainer.onBeforeRenderChildren(MarkupContainer.java:1825)


	at org.apache.wicket.Component.onBeforeRender(Component.java:3916)


	at org.apache.wicket.Component.internalBeforeRender(Component.java:950)


	at org.apache.wicket.Component.beforeRender(Component.java:1018)


	at org.apache.wicket.MarkupContainer.onBeforeRenderChildren(MarkupContainer.java:1825)


	at org.apache.wicket.Component.onBeforeRender(Component.java:3916)


	at org.apache.wicket.markup.repeater.AbstractRepeater.onBeforeRender(AbstractRepeater.java:143)


	at org.apache.wicket.Component.internalBeforeRender(Component.java:950)


	at org.apache.wicket.Component.beforeRender(Component.java:1018)


	at org.apache.wicket.MarkupContainer.onBeforeRenderChildren(MarkupContainer.java:1825)


	at org.apache.wicket.Component.onBeforeRender(Component.java:3916)


	at org.apache.wicket.Component.internalBeforeRender(Component.java:950)


	at org.apache.wicket.Component.beforeRender(Component.java:1018)


	at org.apache.wicket.MarkupContainer.onBeforeRenderChildren(MarkupContainer.java:1825)


	at org.apache.wicket.Component.onBeforeRender(Component.java:3916)


	at org.apache.wicket.Component.internalBeforeRender(Component.java:950)


	at org.apache.wicket.Component.beforeRender(Component.java:1018)


	at org.apache.wicket.MarkupContainer.onBeforeRenderChildren(MarkupContainer.java:1825)


	at org.apache.wicket.Component.onBeforeRender(Component.java:3916)


	at org.apache.wicket.Component.internalBeforeRender(Component.java:950)


	at org.apache.wicket.Component.beforeRender(Component.java:1018)


	at org.apache.wicket.MarkupContainer.onBeforeRenderChildren(MarkupContainer.java:1825)


	at org.apache.wicket.Component.onBeforeRender(Component.java:3916)


	at org.apache.wicket.Page.onBeforeRender(Page.java:801)


	at org.apache.wicket.Component.internalBeforeRender(Component.java:950)


	at org.apache.wicket.Component.beforeRender(Component.java:1018)


	at org.apache.wicket.Component.internalPrepareForRender(Component.java:2236)


	at org.apache.wicket.Page.internalPrepareForRender(Page.java:242)


	at org.apache.wicket.Component.render(Component.java:2325)


	at org.apache.wicket.Page.renderPage(Page.java:1018)


	at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:124)


	at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:195)


	at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:175)


	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:895)


	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)


	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:265)


	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:222)


	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:293)


	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:261)


	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:203)


	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:284)


	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)


	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)


	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)


	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)


	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)


	at org.togglz.servlet.TogglzFilter.doFilter(TogglzFilter.java:100)


	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)


	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)


	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)


	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)


	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)


	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)


	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)


	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)


	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)


	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)


	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)


	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199)


	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)


	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:478)


	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)


	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:81)


	at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:650)


	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)


	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)


	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:803)


	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)


	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)


	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1459)


	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)


	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)


	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)


	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)


	at java.lang.Thread.run(Thread.java:748)


Caused by: java.util.ConcurrentModificationException


	at java.util.HashMap$HashIterator.nextNode(HashMap.java:1437)


	at java.util.HashMap$ValueIterator.next(HashMap.java:1466)


	at java.util.AbstractCollection.toArray(AbstractCollection.java:141)


	at java.util.ArrayList.<init>(ArrayList.java:177)


	at org.apache.isis.core.metamodel.facetapi.FacetUtil.getFacets(FacetUtil.java:122)


	at org.apache.isis.core.metamodel.facetapi.FacetHolderImpl.getFacets(FacetHolderImpl.java:104)


	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectMemberAbstract.getFacets(ObjectMemberAbstract.java:155)


	at org.apache.isis.core.metamodel.facetapi.FacetUtil.addOrReplaceFacet(FacetUtil.java:41)


	at org.apache.isis.core.metamodel.services.grid.GridSystemServiceAbstract$1.visit(GridSystemServiceAbstract.java:320)


	at org.apache.isis.applib.layout.grid.GridAbstract.traverseFieldSets(GridAbstract.java:124)


	at org.apache.isis.applib.layout.grid.bootstrap3.BS3Grid.traverseCols(BS3Grid.java:191)


	at org.apache.isis.applib.layout.grid.bootstrap3.BS3Grid.traverseRows(BS3Grid.java:174)


	at org.apache.isis.applib.layout.grid.bootstrap3.BS3Grid.visit(BS3Grid.java:163)


	at org.apache.isis.core.metamodel.services.grid.GridSystemServiceAbstract.overwriteFacets(GridSystemServiceAbstract.java:216)


	at org.apache.isis.core.metamodel.services.grid.GridSystemServiceAbstract.normalize(GridSystemServiceAbstract.java:169)


	at org.apache.isis.core.metamodel.services.grid.GridServiceDefault.normalize(GridServiceDefault.java:102)


	at org.apache.isis.core.metamodel.facets.object.grid.GridFacetDefault.load(GridFacetDefault.java:75)


	at org.apache.isis.core.metamodel.facets.object.grid.GridFacetDefault.getGrid(GridFacetDefault.java:65)


	at org.apache.isis.viewer.wicket.ui.components.collectioncontents.ajaxtable.CollectionContentsAsAjaxTablePanel.addPropertyColumnsIfRequired(CollectionContentsAsAjaxTablePanel.java:170)


	at org.apache.isis.viewer.wicket.ui.components.collectioncontents.ajaxtable.CollectionContentsAsAjaxTablePanel.buildGui(CollectionContentsAsAjaxTablePanel.java:102)


	at org.apache.isis.viewer.wicket.ui.components.collectioncontents.ajaxtable.CollectionContentsAsAjaxTablePanel.onInitialize(CollectionContentsAsAjaxTablePanel.java:80)


	at org.apache.wicket.Component.fireInitialize(Component.java:878)


	at org.apache.wicket.MarkupContainer.internalInitialize(MarkupContainer.java:1070)


	at org.apache.wicket.MarkupContainer.addedComponent(MarkupContainer.java:1047)


	at org.apache.wicket.MarkupContainer.add(MarkupContainer.java:241)


	at org.apache.wicket.MarkupContainer.addOrReplace(MarkupContainer.java:265)


	at org.apache.isis.viewer.wicket.ui.components.collectioncontents.multiple.CollectionContentsMultipleViewsPanel.addUnderlyingViews(CollectionContentsMultipleViewsPanel.java:118)


	at org.apache.isis.viewer.wicket.ui.components.collectioncontents.multiple.CollectionContentsMultipleViewsPanel.onInitialize(CollectionContentsMultipleViewsPanel.java:87)


	at org.apache.wicket.Component.fireInitialize(Component.java:878)


	at org.apache.wicket.MarkupContainer.internalInitialize(MarkupContainer.java:1070)


	at org.apache.wicket.MarkupContainer.addedComponent(MarkupContainer.java:1047)


	at org.apache.wicket.MarkupContainer.add(MarkupContainer.java:241)


	at org.apache.wicket.MarkupContainer.addOrReplace(MarkupContainer.java:265)


	at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.addOrReplaceComponent(ComponentFactoryRegistryDefault.java:107)


	at org.apache.isis.viewer.wicket.ui.components.collection.CollectionPanel.buildGui(CollectionPanel.java:105)


	at org.apache.isis.viewer.wicket.ui.components.collection.CollectionPanel.onInitialize(CollectionPanel.java:101)


	at org.apache.wicket.Component.fireInitialize(Component.java:878)


	at org.apache.wicket.MarkupContainer$3.component(MarkupContainer.java:1076)


	at org.apache.wicket.MarkupContainer$3.component(MarkupContainer.java:1072)


	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:144)


	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:123)


	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:192)


	at org.apache.wicket.MarkupContainer.visitChildren(MarkupContainer.java:983)


	at org.apache.wicket.MarkupContainer.internalInitialize(MarkupContainer.java:1071)


	at org.apache.wicket.MarkupContainer.addedComponent(MarkupContainer.java:1047)


	at org.apache.wicket.MarkupContainer.add(MarkupContainer.java:241)


	at org.apache.isis.viewer.wicket.ui.components.entity.collection.EntityCollectionPanel.onInitialize(EntityCollectionPanel.java:94)


	at org.apache.wicket.Component.fireInitialize(Component.java:878)


	at org.apache.wicket.MarkupContainer$3.component(MarkupContainer.java:1076)


	at org.apache.wicket.MarkupContainer$3.component(MarkupContainer.java:1072)


	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:144)


	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:162)


	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:162)


	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:162)


	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:162)


	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:162)


	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:162)


	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:162)


	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:123)


	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:192)


	at org.apache.wicket.MarkupContainer.visitChildren(MarkupContainer.java:983)


	at org.apache.wicket.MarkupContainer.internalInitialize(MarkupContainer.java:1071)


	at org.apache.wicket.MarkupContainer.addedComponent(MarkupContainer.java:1047)


	at org.apache.wicket.MarkupContainer.replace(MarkupContainer.java:855)


	at org.apache.wicket.MarkupContainer.addOrReplace(MarkupContainer.java:269)


	at org.apache.wicket.extensions.markup.html.tabs.TabbedPanel.setCurrentTab(TabbedPanel.java:439)


	at org.apache.wicket.extensions.markup.html.tabs.TabbedPanel.setSelectedTab(TabbedPanel.java:397)


	at org.apache.isis.viewer.wicket.ui.components.layout.bs3.tabs.TabGroupPanel.setSelectedTab(TabGroupPanel.java:102)


	at org.apache.wicket.extensions.markup.html.tabs.TabbedPanel.onBeforeRender(TabbedPanel.java:268)


	at org.apache.wicket.Component.internalBeforeRender(Component.java:950)


	at org.apache.wicket.Component.beforeRender(Component.java:1018)


	at org.apache.wicket.MarkupContainer.onBeforeRenderChildren(MarkupContainer.java:1825)


	... 92 more
{code}"
ISIS-2003,New Feature,Closed,Serialize representation of metamodel to allow before/after checking,
ISIS-2002,New Feature,Open,"Allow RO viewer to define actions accepting an (JAXB) DTO as a value, to be invoked with appropriate Content-Type so that can be deserialized.",
ISIS-2001,New Feature,Closed,"Dynamically hide/disable/default action parameters (based on other parameter arguments) (also fixed in ""v1 maintenance"")","some notes:

ActionParametersForm.java

ScalarPanelAbstract2#updateIfNecessary(..) as a new hook method to be implemented everywhere

- if choices facet then update choices ... DONE ALREADY
- if default facet then recompute ... TO DO EVERYWHERE, on the getModel() 
  - and ""sync"" the value into the UI widget





1. for the existing logic that evaluates choicesX based on choices(Y<x), should also evaluate any defaultX that we see.
2. also do this for an autoCompleteX

3. new logic looking for a change in any scalar, then search for other params with a default that depend on that.

Nice to have, but will need changes to metamodel so we'll leave for now:
4. support the idea of disableX for params
5. support the idea of hideX for params

based on a change (autoComplete, choices or scalar)
... re-evaluate choices, default, disable, hide


~~~~~~~~~~

Organisation -> BankAccount

public void doSomething(
	Organisation org,
	BankAccount bankAccount,
	...
	) {
	
}

public List<Organisation> autoComplete0DoSomething(String str) { .... }

public List<Organisation> choices0DoSomething() { .... }
public List<BankAccount> choices1DoSomething(Organisation org) { ... }

public BankAccount default1DoSomething(Organisation org) { /*return choices1DoSomething(organisation).get(0); */ }

~~~~~~~~~~

public void calc(
	BigDecimal netAmount,
	BigDecimal vatAmount,
	BigDecimal grossAmount
	...
	) {
	
}

public BigDecimal default2Calc(BigDecimal netAmount, BigDecimal vatAmount) { return netAmount + vatAmount; }

//public String disable2Calc() { return ""disabled""; }
//public boolean hide2Calc(BigDecimal netAmount, BigDecimal vatAmount) { return netAmount == null; }

"
ISIS-2000,New Feature,Closed,"[Duplicate] Display an optional help page in a sidebar, eg on the right.",overlap with ISIS-1307
ISIS-1999,New Feature,Open,"For action mixins, allow read-only properties and collections to be defined, to show useful/relevant context data.","These would simply be rendered underneath the OK/Cancel button.

One property might also show help markup, or hyperlink to reference guides etc.

As a refinement (perhaps split out to separate story), allow a layout file (with same name( as mixin to be specified.   Perhaps this might even (through some extension to the existing syntax) allow the parameters to be laid out differently, eg over multiple columns).

~~~
* https://bootstrapious.com/p/bootstrap-sidebar
* https://bootsnipp.com/tags/sidebar
* 

"
ISIS-1998,New Feature,Closed,"Simplify syntax way for mixins, to better express intent using @Action, @Collection and @Property","For regular action mixins, we currently write:

 {code}
@Mixin(method=""act"")
public class Contributee_someAction() {

    private final Contributee contributee;  // constructor omitted
    @Action(...)
    @ActionLayout(...)
    public ReturnValue act(.... ) { ... }
}
{code}

instead, the proposal is:

{code}
@Action(...)              // presence of Action on class implies this is a mixin; 
@ActionLayout(...)
public class Contributee_someAction() {
    private final Contributee contributee;
    public ReturnValue act( ... ) { ... }   // no need for annotations here.   ""act"" assumed
}
{code}

The details of the @Action and @ActionLayout facets are ""copied"" down to the ""act"" method.

for properties, we currently write:

{code}
@Mixin(method=""prop"")
public class Contributee_someProperty() {
    private final Contributee contributee;  
    @Action(semantics=SAFE)   // required
    @ActionLayout(contributed=ASSOCIATION)  // required
    @Property(...)
    @PropertyLayout(...)
    public ReturnValue prop( /* no args */ ) { ... }
}
{code}

instead we'd rather write:

{code}
@Property(...)     // implies this class is a mixin
@PropertyLayout(...)
public class Contributee_someProperty()
    private final Contributee contributee;
    public ReturnValue prop() { ... }                    // ""prop"" is assumed
}
{code}

The boilerplate (and confusing) @Action(SAFE) and @ActionLayout(AS_ASSOCIATION) are implied.  The facets from @Property and @PropertyLayout are copied down to the ""prop"" method

And finally, for collections, we currently write:

{code}
@Mixin(method=""coll"")
public class Contributee_someCollection() {
    private final Contributee contributee;  
    @Action(semantics=SAFE)   // required
    @ActionLayout(contributed=ASSOCIATION)  // required
    @Collection(...)
    @CollectionLayout(...)
    public List<ReturnValue> coll( /* no args */ ) { ... }
}
{code}

instead we'd rather write:

{code}
@Collection(...)     // implies this class is a mixin
@CollectionLayout(...)
public class Contributee_someCollection()
    private final Contributee contributee;
    public List<ReturnValue> coll() { ... }                    // ""coll"" is assumed
}
{code}

similar to properties."
ISIS-1997,New Feature,Closed,"For an alternative for non-obtrusive bulk entry of info, use a sidebar as action prompt (for top-level actions only).","add new @ActionLayout(prompt=SIDEBAR), only for ""top-level"" actions"
ISIS-1996,New Feature,Closed,"[DUPLICATE, WON'T FIX] For non-obtrusive bulk entry of info, use panel/fieldset as action prompt (for actions associated with panel).","intepret @ActionLayout(prompt=INLINE|INLINE,position=PANEL|PANEL_DROPDOWN) to temporarily replace the panel with the dialog
"
ISIS-1995,Wish,Open,[Wish] Render collection of objects as panels,
ISIS-1994,Wish,Open,[Wish] Render collection of objects as tabs,
ISIS-1993,New Feature,Closed,[Duplicate] Allow factory actions to be associated with both properties and parameters,"See also ISIS-1509

 
{code:java}
@Property(createRepository=Supplier.Repository.class, createAction=""create"")
@Getter @Setter Party supplier;{code}
and
{code:java}
public IncomingInvoice edit(
    @Parameter(createRepository=Supplier.Repository.class, createAction=""create"")
    Party supplier,
    ...
) {
   ...
}{code}
 

to invoke a nominated action ""in-situ"".

This could be bound to a keystroke, eg ""F3""

 "
ISIS-1992,New Feature,Closed,"[WON'T FIX] Actions associated with the panel should optionally be rendered ""in-place"" (rather than modal).",
ISIS-1991,Bug,Closed,Determining the deployment type is broken,"We seem to have multiple classes within 'core' that act as advisors for determining the application's deployment-type.

Maybe we need to rethink and cleanup. I think it should be sufficient to have one and only one place to configure the deployment type. eg. simply via a single environment variable.

To pick up this idea [1], we could introduce one layer of abstraction. Also note: We need to have access to this variable very early in the bootstrapping phase.

[1] https://stackoverflow.com/questions/8168884/how-to-test-code-dependent-on-environment-variables-using-junit
"
ISIS-1990,Sub-task,Closed,Buttons (action-links) don't honor disabled state if providing a confirmation dialog,"Disabled buttons (action-links) with confirmation dialog do open the dialog on click, but should not. Should instead show a 'no access' tooltip."
ISIS-1989,Sub-task,Closed,Disabled buttons (action-links) won't show the styled tooltip,"Disabled buttons (action-links) won't show the styled tooltip, only the browser's built in one.

jquery select for tooltip() does ignore disabled dom elements"
ISIS-1988,Improvement,Closed,Move isis-core-wrapper into isis-core-runtime.,I don't see any good reason at the moment why this module is separated out from the rest of the runtime.
ISIS-1987,Improvement,Closed,Delete wicket applib,There's no code in there worth keeping... it's unused anyway.
ISIS-1986,New Feature,Closed,skinnywar support (backport from v2),
ISIS-1985,Bug,Closed,Incomplete Metamodel Validation,When refactoring for v2 we discovered inconsistencies.
ISIS-1984,Improvement,Open,Extend RO representation to show property format or type in object members,"See attached json representation of a contact number

""x-isis-format"": ""string""
is present in string properties
however, this attribute is not on object properties.
It would be very benefitial to have all I need to render that property in this page only. Ideally, something like
""x-isis-returntype"" with the url to the domain-type (e.g. [http://localhost:8080/restful/domain-types/org.incode.eurocommercial.contactapp.dom.number.ContactNumber/properties/owner])

for now, I will render any non-string as a generic catch all object viewer
 
 
 "
ISIS-1983,Improvement,Closed,[WONT-FIX] UI: upgrade to bootstrap 4,"There seems to be a Wicket 8 build for bootstrap 4.

https://github.com/l0rdn1kk0n/wicket-bootstrap/tree/wicket-8.x-bootstrap-4.x"
ISIS-1982,Improvement,Closed,UI: CollectionSelectionPanel replace split button by normal button,
ISIS-1981,Bug,Closed,[WONT-FIX] Eclipse: DataNucleus enhancer does see 2 different javax.jdo:jdo-api versions on class-path,"Conflicting are javax.jdo:jdo-api:3.1 and javax.jdo:jdo-api:3.2-m8

pom.xml files that declare dependence on javax.jdo:jdo-api should do so with scope *provided*.

Only the jdo-datanucleus plugins should declare *test*- and *compile*-scoped dependencies."
ISIS-1980,Bug,Closed,Unexpected error when accessing collection through wrapper.,"As reported by Gabriel Terwesten <gabriel@terwesten.net> [1]

Inside of integration tests i can’t seem to access collections through the getter if the object is wrapped. From the documentation I got the impression that that should be possible. 

This is the offending line:

assertThat(wrap(food).getCustomUnits()).hasSize(1);


{noformat}
IllegalArgumentException: d.m.c.d.i.Food#customUnits: more than one ImperativeFacet for method getCustomUnits , with inconsistent intents: ...

at o.a.i.c.m.facets.ImperativeFacet$Util.getIntent(ImperativeFacet.java:167)
{noformat}


[1] https://lists.apache.org/thread.html/cd92d8cd28ae877104fc965f83ca90b98e2e8188f464b65181e79a27@%3Cusers.isis.apache.org%3E"
ISIS-1979,Bug,Closed,Integration test logging includes a lot of log events twice.,"As reported by Gabriel Terwesten <gabriel@terwesten.net> [1]

During the bootstrapping of Isis for the integration test there seem to be two appenders. The lines starting with the current time come from the appender configured in `logging-integtest.properties`. I was not able to understand where the second appender is configured. This is not a big problem just a bit distracting.

[1] https://lists.apache.org/thread.html/cd92d8cd28ae877104fc965f83ca90b98e2e8188f464b65181e79a27@%3Cusers.isis.apache.org%3E"
ISIS-1978,Bug,Closed,Integration tests are not executed in module `module-simple`,"As reported by Gabriel Terwesten <gabriel@terwesten.net> [1]


This is only true for projects generated from the 2.0.0-M1 archetype. The integration tests in module `application` are executed.

To reproduce generate a project:

mvn archetype:generate  \
    -D archetypeGroupId=org.apache.isis.archetype \
    -D archetypeArtifactId=simpleapp-archetype \
    -D archetypeVersion=2.0.0-M1 \
    -D groupId=com.mycompany \
    -D artifactId=isis-2 \
    -D version=1.0-SNAPSHOT \
    -B

Then execute:

- mvn clean install
- mvn -pl module-simple verify

The test output for integration tests is empty.

[1] https://lists.apache.org/thread.html/cd92d8cd28ae877104fc965f83ca90b98e2e8188f464b65181e79a27@%3Cusers.isis.apache.org%3E"
ISIS-1977,Improvement,Closed,Improve flattening for -Drevision=...,"Currently flatten-maven-plugin is inherited from the parent pom to all children, and this results in ,<dependencyManagement> being "
ISIS-1976,Improvement,Closed,Improve the metamodel cache management,"The cache management we have with ObjectAdapter, might be simplified such that we just work with java.lang.Object so far as possible. We would have a ""disposable"" ObjectAdapter that we instantiate around an Object whenever we need it - to access into the metamodel - and then throw it away after. Or perhaps eventually we might not need ObjectAdapter at all, just simply use #getClass() to look up the ObjectSpecification.

~~~

The main objective is to get rid of these two maps:

[https://github.com/apache/isis/blob/master/core/runtime/src/main/java/org/apache/isis/core/runtime/system/persistence/adaptermanager/OidAdapterHashMap.java]

and

[https://github.com/apache/isis/blob/master/core/runtime/src/main/java/org/apache/isis/core/runtime/system/persistence/adaptermanager/PojoAdapterHashMap.java]

As their name suggests, these map:

oid -> adapter (look up an adapter from an oid)

pojo -> adapter  (look up an adapter from a pojo)

The adapter itself has a reference to its oid (getOid()) and to its pojo (getObject()).

Most, though not all, objects have Oids.  Certainly DN persistent objects do, in fact they do even if they are not yet persisted (prior to calling RepositoryService#persist(...).  These will have a RootOid, which will indicate if the object is persistent or still transient.

The same is true of view models, these also have a RootOid.  They also have a RecreatableObjectFacet which is used to actually manufacture the Oid (because the oid for view models is basically a serialization of the state of the domain object).  The RootOid for view models will indicate that they are view models.

Values (ints, strings etc), do NOT have an oid.  This also means that - obviously - they don't get saved in the OidAdapterHashMap; and they probably aren't saved in PojoAdapterHashMap.  Value objects will have a ValueFacet.  

There's one other subtype of Oid (apart from RootOid), namely ParentedCollectionOid.  That's because the Set or List that holds ""child"" objects is also managed as an adapter; ie:
{code:java}
public class Order {

   @Getter @Setter
   Set<OrderItem> orderItems = Sets.newTreeSet();
   ...
}{code}
Why is this done?  Because a long time ago (before DN) the framework did its own persistence, so this was for lazy loading etc.

 

The ""ensureMapsConsistent"" method in PersistenceSessionXxx is there to ensure that these are maintained correctly; it's rather paranoid because if these get out of sync, then bad things would happen; eg:

[https://github.com/apache/isis/blob/master/core/plugins/jdo-datanucleus-4/src/main/java/org/apache/isis/core/runtime/system/persistence/PersistenceSession4.java#L1184] 

There's also some rather horrible ""remapRecreatedPojo"" methods that hack this stuff

[https://github.com/apache/isis/blob/master/core/plugins/jdo-datanucleus-4/src/main/java/org/apache/isis/core/runtime/system/persistence/PersistenceSession4.java#L1739]

 

All this stuff is a legacy from the original client/server architecture that the framework used to have; it was probably needed then but I really don't think it's needed now.

~~~

At the moment the object adapters are created eagerly, typically using PersistenceSession#adapterFor(...).  For domain services, we eagerly create an adapter around every service before each session, ""just in case"" it gets interacted with.  This could be removed

[https://github.com/apache/isis/blob/master/core/plugins/jdo-datanucleus-4/src/main/java/org/apache/isis/core/runtime/system/persistence/PersistenceSession4.java#L237] 

 

This also requires the ability to infer the Oid from the pojo, on the fly.  There are two different ways this is done:
 * for DN entities, there is the JdoObjectIdSerlaizer
 * for view models, there's RecreatableObjectFacet, already mentioned.

[https://github.com/apache/isis/blob/master/core/plugins/jdo-datanucleus-4/src/main/java/org/apache/isis/objectstore/jdo/datanucleus/persistence/spi/JdoObjectIdSerializer.java]

 

Ideally the code to recreate/rehydrate the object should define a consistent API to the rest of the framework.  My thinking is that it could perhaps be a pluggable service so that we can then support other persistence runtime stores ... The idea is that the framework encounters a pojo and then asks for a service (via an SPI) to see which can extract/infer an Oid from it, using the usual chain-of-responsibility pattern.  Out-of-the-box the framework would provide two default implementations, one for DN entities (JdoIdHelper), the other for view models.  

 

~~~~~~

 Looking forward, ideally, PersistenceSession shouldn't need to use ObjectAdapter at all; the ObjectAdapter really exists only for the viewer(s) etc to obtain the ObjectSpecification to know how to render the object.  Ultimately, we could get rid of ObjectAdapter completely and just uses pojos (=domain objects) everywhere.  ObjectSpecification would remain, though.  I think this is for other tickets, though, not this one.

 

~~~~~~

 OK, hopefully some the above makes sense!!! 

 "
ISIS-1975,Improvement,Closed,REST: discrepancy between schema export and actual response content,"We do have some property names $$... in our REST responses, which are not part of the swagger schema (which is available for download from the UI when in prototyping mode).

This was reported on the user mailing list [1] ...

[1] [https://lists.apache.org/thread.html/ecbf2d3c25527c55716ea02c0adae2d815aa1546244c6ee15131b26c@%3Cusers.isis.apache.org%3E]"
ISIS-1974,Improvement,Closed,Reduce time to bootstrap,
ISIS-1973,Bug,Closed,"""republish"" mixin - action button is rendered but attempting to invoke throws an exception","h2. To reproduce:
 * login with estatio-user-it, ensure has ""estatio-user"" role but doesn't have ""estatio-superuser"" role. 
- navigate to http://estatiotest.int.prd.ecpnv.com/wicket/entity/org.estatio.dom.invoice.Invoice:106874
- the ""republish"" action (contributed from 
- when invoke, get an exception in the UI, with stack trace below:

 

message shown to user:

Reason: Not authorized to view. Identifier: org.isisaddons.module.publishmq.dom.jdo.events.PublishedEvent_republish#$$()

stack trace:

{code}
Caused by: org.apache.isis.core.commons.exceptions.IsisApplicationException: org.apache.isis.applib.services.wrapper.HiddenException: Reason: Not authorized to view. Identifier: org.isisaddons.module.publishmq.dom.jdo.events.PublishedEvent_republish#$$()
 at org.apache.isis.core.commons.lang.ThrowableExtensions.throwWithinIsisException(ThrowableExtensions.java:55)
 at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$2.execute(ActionInvocationFacetForDomainEventAbstract.java:303)
 at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$2.execute(ActionInvocationFacetForDomainEventAbstract.java:222)
 at org.apache.isis.applib.services.iactn.Interaction.executeInternal(Interaction.java:173)
 at org.apache.isis.applib.services.iactn.Interaction.execute(Interaction.java:143)
 at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.doInvoke(ActionInvocationFacetForDomainEventAbstract.java:310)
 at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$1.execute(ActionInvocationFacetForDomainEventAbstract.java:164)
 at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:142)
 at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:132)
 at org.apache.isis.core.runtime.services.persistsession.PersistenceSessionServiceInternalDefault.executeWithinTransaction(PersistenceSessionServiceInternalDefault.java:192)
 at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.invoke(ActionInvocationFacetForDomainEventAbstract.java:160)
 at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeInternal(ObjectActionDefault.java:400)
 at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionMixedIn.execute(ObjectActionMixedIn.java:230)
 at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeWithRuleChecking(ObjectActionDefault.java:370)
 at org.apache.isis.viewer.wicket.model.models.ActionModel.executeAction(ActionModel.java:460)
 at org.apache.isis.viewer.wicket.model.models.ActionModel.load(ActionModel.java:439)
 at org.apache.isis.viewer.wicket.model.models.ActionModel.load(ActionModel.java:76)
 at org.apache.wicket.model.LoadableDetachableModel.getObject(LoadableDetachableModel.java:135)
 at org.apache.isis.viewer.wicket.model.models.ActionModel.execute(ActionModel.java:569)
 at org.apache.isis.viewer.wicket.ui.components.actions.ActionFormExecutorStrategy.obtainResultAdapter(ActionFormExecutorStrategy.java:71)
 at org.apache.isis.viewer.wicket.ui.panels.FormExecutorDefault.obtainResultAdapter(FormExecutorDefault.java:514)
 at org.apache.isis.viewer.wicket.ui.panels.FormExecutorDefault.executeAndProcessResults(FormExecutorDefault.java:147)
 at org.apache.isis.viewer.wicket.ui.components.widgets.linkandlabel.ActionLinkFactoryAbstract.onClick(ActionLinkFactoryAbstract.java:214)
 at org.apache.isis.viewer.wicket.ui.components.widgets.linkandlabel.ActionLinkFactoryAbstract.access$100(ActionLinkFactoryAbstract.java:71)
 at org.apache.isis.viewer.wicket.ui.components.widgets.linkandlabel.ActionLinkFactoryAbstract$1.performOnClick(ActionLinkFactoryAbstract.java:147)
 at org.apache.isis.viewer.wicket.ui.components.widgets.linkandlabel.ActionLinkFactoryAbstract$1.doOnClick(ActionLinkFactoryAbstract.java:142)
 at org.apache.isis.viewer.wicket.ui.components.widgets.linkandlabel.ActionLink.onClick(ActionLink.java:94)
 at org.apache.wicket.ajax.markup.html.AjaxLink$1.onEvent(AjaxLink.java:85)
 at org.apache.wicket.ajax.AjaxEventBehavior.respond(AjaxEventBehavior.java:155)
 at org.apache.wicket.ajax.AbstractDefaultAjaxBehavior.onRequest(AbstractDefaultAjaxBehavior.java:601)

more
Caused by: org.apache.isis.applib.services.wrapper.HiddenException: Reason: Not authorized to view. Identifier: org.isisaddons.module.publishmq.dom.jdo.events.PublishedEvent_republish#$$()
 at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.toException(DomainObjectInvocationHandler.java:765)
 at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.notifyListenersAndVetoIfRequired(DomainObjectInvocationHandler.java:746)
 at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.checkVisibility(DomainObjectInvocationHandler.java:726)
 at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.handleActionMethod(DomainObjectInvocationHandler.java:645)
 at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.invoke(DomainObjectInvocationHandler.java:284)
 at org.apache.isis.core.wrapper.proxy.ProxyCreator$1.invoke(ProxyCreator.java:72)
 at org.isisaddons.module.publishmq.dom.jdo.events.PublishedEvent_republish_$$_jvstdb2_b.$$(PublishedEvent_republish_$$_jvstdb2_b.java)
 at org.estatio.module.coda.contributions.republish.InvoiceRepublisherService.publish(InvoiceRepublisherService.java:75)
 at org.estatio.module.coda.contributions.republish.InvoiceRepublisherService.republishIfPresent(InvoiceRepublisherService.java:48)
 at org.estatio.module.coda.contributions.republish.InvoiceForLease_republish.act(InvoiceForLease_republish.java:37)
 at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
 at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
 at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
 at java.lang.reflect.Method.invoke(Method.java:498)
 at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.invokeMethodElseFromCache(ActionInvocationFacetForDomainEventAbstract.java:407)
 at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$2.execute(ActionInvocationFacetForDomainEventAbstract.java:261)

more
06:38:16,008 [RequestCycleExtra ] ********************************
06:38:16,009 [IsisTransaction ] abort transaction IsisTransaction@259ae8ad[state=MUST_ABORT,commands=0]
06:39:35,783 [PublisherServiceUsingActiveMq ] Sending JMS message, id:ID:171eda4a-d08c-4569-9864-51a71a6c0e1b.0; type:org.incode.module.userimpersonate.app.ImpersonateMenu#impersonate()
06:39:44,136 [RequestCycleExtra ] ********************************
06:39:44,136 [RequestCycleExtra ] Handling the following exception
org.apache.wicket.WicketRuntimeException: Method onRequest of interface org.apache.wicket.behavior.IBehaviorListener targeted at org.apache.wicket.ajax.markup.html.AjaxLink$1@3973ad3f on component [ActionLink [Component id = additionalLink]] threw an exception
 at org.apache.wicket.RequestListenerInterface.internalInvoke(RequestListenerInterface.java:268)
 at org.apache.wicket.RequestListenerInterface.invoke(RequestListenerInterface.java:241)
 at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.invokeListener(ListenerInterfaceRequestHandler.java:248)
 at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.respond(ListenerInterfaceRequestHandler.java:234)
 at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:895)
 at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
 at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:265)
 at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:222)
 at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:293)
 at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:261)
 at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:203)
 at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:284)
 at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
 at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
 at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
 at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
 at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
 at org.togglz.servlet.TogglzFilter.doFilter(TogglzFilter.java:100)
 at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
 at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
 at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
 at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
 at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
 at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
 at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
 at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
 at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
 at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
 at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
 at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199)
 at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
 at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:478)
 at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)
 at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:81)
 at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:650)
 at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
 at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
 at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:803)
 at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
 at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
 at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1459)
 at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
 at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
 at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
 at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
 at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.reflect.InvocationTargetException
 at sun.reflect.GeneratedMethodAccessor353.invoke(Unknown Source)
 at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
 at java.lang.reflect.Method.invoke(Method.java:498)
 at org.apache.wicket.RequestListenerInterface.internalInvoke(RequestListenerInterface.java:258)
{code}"
ISIS-1972,Improvement,Closed,JAXB view model: add default XmlAdapters for Java 8 Time,"see https://stackoverflow.com/questions/36156741/marshalling-localdate-using-jaxb

sample code:


{code:java}

// DOMAIN CODE

@XmlRootElement(name = ""Demo"")
@XmlType
@XmlAccessorType(XmlAccessType.FIELD)
@DomainObject(nature=Nature.VIEW_MODEL, editing=Editing.ENABLED)
@Log
public class TemporalDemo extends DemoStub {

    @PostConstruct
    public void initDefaults() {
        
        log.info(""TemporalDemo::initDefaults"");
        
        javaLocalDate = LocalDate.now();
        javaLocalDateTime = LocalDateTime.now();
    }
    
    @XmlJavaTypeAdapter(value = LocalDateAdapter.class)
    @XmlElement @Getter @Setter private LocalDate javaLocalDate;
    
    @XmlJavaTypeAdapter(value = LocalDateTimeAdapter.class)
    @XmlElement @Getter @Setter private LocalDateTime javaLocalDateTime;
    
}

// COULD BE PART OF CORE

public final class JaxbAdapters {

    
    public static final class LocalDateAdapter extends XmlAdapter<String, LocalDate>{

        public LocalDate unmarshal(String v) throws Exception {
            return LocalDate.parse(v);
        }

        public String marshal(LocalDate v) throws Exception {
            return v.toString();
        }

    }
    
    public static final class LocalDateTimeAdapter extends XmlAdapter<String, LocalDateTime>{

        public LocalDateTime unmarshal(String v) throws Exception {
            return LocalDateTime.parse(v);
        }

        public String marshal(LocalDateTime v) throws Exception {
            return v.toString();
        }

    }

   ...
    
}
{code}


"
ISIS-1971,Bug,Closed,[WON'T FIX] JAXB view model: setting view's properties via PostConstruct method not honored,"{code:java}
// CALLER

@DomainService(nature=NatureOfService.VIEW_MENU_ONLY)
@DomainObjectLayout(named=""Scalar Demo"")
public class ScalarMenu {
    
    @Inject private FactoryService factoryService;

    @Action
    @ActionLayout(cssClassFa=""fa-font"")
    public TextDemo text(){
        val demo = factoryService.instantiate(TextDemo.class);
        return demo;
    }
}

// VIEW MODEL

@XmlRootElement(name = ""Demo"")
@XmlType
@XmlAccessorType(XmlAccessType.FIELD)
@DomainObject(nature=Nature.VIEW_MODEL)
@Log
public class TextDemo {

    @PostConstruct
    public void initDefaults() {
        
        log.info(""TextDemo::initDefaults"");
        
        string = ""a string (click me)"";
    }
    
    @Property(editing=Editing.ENABLED) 
    @XmlElement @Getter @Setter private String string; // string shows up on UI as empty, even though initDefaults was called
}
{code}
"
ISIS-1970,Bug,Closed,JAXB view model: setting class-level editing=enabled not honored,"{code:java}
@XmlRootElement(name = ""Demo"")
@XmlType
@XmlAccessorType(XmlAccessType.FIELD)
@DomainObject(nature=Nature.VIEW_MODEL, editing=Editing.ENABLED)
public class TextDemo  {
   
    // -- EDITABLE
    
    @Property(editing=Editing.ENABLED) // this should not be required, as its already defined above
    @XmlElement @Getter @Setter private String string;

}
{code}"
ISIS-1969,New Feature,Closed,"Distribute Isis as a Docker image, with the libraries in Tomcat's lib/ folder (skinny wars)",
ISIS-1968,Bug,Closed,@Title on a field should use the getter (to allow the ORM to lazily retrieve the data),"otherwise, can result in ""Untitled Simple Object"" - because DN hasn't always retrieved object.

 

To reproduce, use the simpleapp and remove SimpleObject#title and instead add:

 
{code:java}
@Title(prepend=""Object: "")
private String name;
{code}
When edit the name, will see ""Untitled Simple Object"" on re-rendering"
ISIS-1967,Test,Closed,[WON'T FIX] Add tests from Diffblue Deeptest,"[Diffblue|https://www.diffblue.com/] is an Oxford, UK-based start-up which develops software to analyse code and automatically generate tests. We have run an analysis against the apache-isis repository on github, which has produced 8891 verified tests. I am proposing to file a PR to add a sample (21) of these tests into the Isis repo."
ISIS-1966,Improvement,Closed,Introduce extension of HasTransactionId that includes sequence number,"So can SPIs contribute onto it.

 "
ISIS-1965,Bug,Closed,Enable CI/CD for maint-1.16.3,
ISIS-1964,Bug,Closed,ConcurrentModificationException when stating application,"Hi Dan, meanwhile we are using 1.16.2 and observe still (more rarely) this exception during startup.

 
{code:java}
018-06-20 15:10:47.546 [localhost-startStop-1] init ERROR org.apache.isis.viewer.wicket.viewer.IsisWicketApplication - Failed to initialize
com.google.inject.ProvisionException: Unable to provision, see the following errors:

1) Error in custom provider, java.lang.RuntimeException: An error occurred while executing code in a temporary session
at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
while locating org.apache.isis.core.runtime.system.session.IsisSessionFactory
for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.isisSessionFactory(IsisWicketApplication.java:155)
while locating at.a1ta.cll.webapp.CllWebApplication

1 error
at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:486)
at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:67)
at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:987)
at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:368)
at at.a1ta.cll.webapp.CllWebApplication.init(CllWebApplication.java:32)
at org.apache.wicket.Application.initApplication(Application.java:953)
at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:429)
at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:353)
at org.apache.catalina.core.ApplicationFilterConfig.initFilter(ApplicationFilterConfig.java:285)
at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:266)
at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:108)
at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4590)
at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5233)
at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:752)
at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:728)
at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:734)
at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:629)
at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1839)
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
at java.util.concurrent.FutureTask.run(FutureTask.java:266)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: An error occurred while executing code in a temporary session
at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:366)
at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:330)
at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:317)
at org.apache.isis.core.runtime.system.session.IsisSessionFactoryBuilder.buildSessionFactory(IsisSessionFactoryBuilder.java:211)
at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:118)
at org.apache.isis.core.runtime.runner.IsisInjectModule$$FastClassByGuice$$a813f90e.invoke(<generated>)
at com.google.inject.internal.ProviderMethod$FastClassProviderMethod.doProvision(ProviderMethod.java:264)
at com.google.inject.internal.ProviderMethod$Factory.provision(ProviderMethod.java:401)
at com.google.inject.internal.ProviderMethod$Factory.get(ProviderMethod.java:376)
at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1092)
at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
at com.google.inject.internal.SingletonScope$1.get(SingletonScope.java:194)
at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:41)
at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:54)
at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:132)
at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:93)
at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:80)
at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1085)
at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:80)
at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:62)
... 22 more
Caused by: java.util.ConcurrentModificationException
at java.util.HashMap$HashIterator.nextNode(HashMap.java:1442)
at java.util.HashMap$ValueIterator.next(HashMap.java:1471)
at java.util.AbstractCollection.toArray(AbstractCollection.java:141)
at java.util.Collections$UnmodifiableCollection.toArray(Collections.java:1033)
at java.util.ArrayList.<init>(ArrayList.java:178)
at com.google.common.collect.Lists.newArrayList(Lists.java:146)
at org.apache.isis.core.metamodel.specloader.SpecificationLoader.allSpecifications(SpecificationLoader.java:495)
at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorVisiting.validateSpecs(MetaModelValidatorVisiting.java:71)
at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorVisiting.validateAll(MetaModelValidatorVisiting.java:58)
at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorVisiting.validate(MetaModelValidatorVisiting.java:49)
at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorComposite.validate(MetaModelValidatorComposite.java:60)
at org.apache.isis.core.metamodel.specloader.SpecificationLoader.validate(SpecificationLoader.java:272)
at org.apache.isis.core.metamodel.specloader.SpecificationLoader.validateAndAssert(SpecificationLoader.java:262)
at org.apache.isis.core.runtime.system.session.IsisSessionFactoryBuilder$1.run(IsisSessionFactoryBuilder.java:217)
at org.apache.isis.core.runtime.system.session.IsisSessionFactory$1.call(IsisSessionFactory.java:333)
at org.apache.isis.core.runtime.system.session.IsisSessionFactory$1.call(IsisSessionFactory.java:330)
at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:364)
... 42 more
2018-06-20 15:10:47.573 [localhost-startStop-1] join INFO org.apache.isis.core.runtime.threadpool.ThreadPoolSupport - join'ing 6 tasks: waited 0 milliseconds
{code}"
ISIS-1963,Bug,Closed,Wicket UI: IllegalArgumentExceptions after persistent field update using AJAX,"Possibly related to the latest Isis upgrade using Wicket 8 instead of 7.9.

{noformat}

 java.lang.IllegalArgumentException
Cannot update component because its page is not the same as the one this handler has been created for. Component: [PropertyEditForm [Component id = inputForm]]
org.apache.wicket.ajax.AjaxRequestHandler#add(AjaxRequestHandler.java:245)
org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract#onOkSubmittedOf(PromptFormAbstract.java:239)
org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract#access$0(PromptFormAbstract.java:223)
org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract$1#onSubmit(PromptFormAbstract.java:123)
org.apache.wicket.ajax.markup.html.form.AjaxButton$1#onSubmit(AjaxButton.java:113)
org.apache.wicket.ajax.form.AjaxFormSubmitBehavior$AjaxFormSubmitter#onSubmit(AjaxFormSubmitBehavior.java:223)
org.apache.wicket.markup.html.form.Form#delegateSubmit(Form.java:1271)
org.apache.wicket.markup.html.form.Form#process(Form.java:964)
org.apache.isis.viewer.wicket.ui.panels.FormAbstract#process(FormAbstract.java:77)
org.apache.wicket.markup.html.form.Form#onFormSubmitted(Form.java:788)
org.apache.wicket.ajax.form.AjaxFormSubmitBehavior#onEvent(AjaxFormSubmitBehavior.java:176)
org.apache.wicket.ajax.AjaxEventBehavior#respond(AjaxEventBehavior.java:127)
org.apache.wicket.ajax.AbstractDefaultAjaxBehavior#onRequest(AbstractDefaultAjaxBehavior.java:598)
org.apache.wicket.core.request.handler.ListenerRequestHandler#internalInvoke(ListenerRequestHandler.java:306)
org.apache.wicket.core.request.handler.ListenerRequestHandler#invoke(ListenerRequestHandler.java:280)
org.apache.wicket.core.request.handler.ListenerRequestHandler#invokeListener(ListenerRequestHandler.java:222)
org.apache.wicket.core.request.handler.ListenerRequestHandler#respond(ListenerRequestHandler.java:208)
org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:912)
org.apache.wicket.request.RequestHandlerExecutor#execute(RequestHandlerExecutor.java:65) 
{noformat}
"
ISIS-1962,Improvement,Closed,[WONT-FIX] Introduce an alternative core-plugin for sub class discovery,"We try to get rid of javassist dependencies.

But currently we depend on 'swagger.io' and 'reflections.org' which both have javassist dependencies.

With core-plugin 'discovery-reflections' we depend on 'reflections.org' which seems no longer actively maintained.

I'm thinking of introducing a new core-plugin 'discovery-cdi' that does not depend on 'reflections.org' but instead utilizes CDI's class discovery mechanics.

 "
ISIS-1961,Improvement,Closed,ResourceCachingFilter: Suppress 'client connection abort' exceptions.,"I think with Firefox's latest Quantum engine I started to see frequent IOExceptions caused by 'client connection abort'.

So we might try to suppress java.io.IOException of kind 'An established connection was aborted by the software in your host machine'

1) the TCP protocol (by design) does not provide a means to check, whether a connection has been closed by the client

2) the exception thrown and the exception message text are specific to the servlet-engine implementation"
ISIS-1960,Improvement,Closed,Action background execution: provide built-in default implementation,"We want this code to run out-of the box (without the need for developers to provide their own implementation of *BackgroundCommandService*) ...
{code:java}
@Inject BackgroundService backgroundService;
@Inject RepositoryService repositoryService;
@Inject MessageService messageService;

@Action
public SimpleObject runInBackground(){
    backgroundService.execute(this).backgroundTask();
    return this;
}
    
@Programmatic
public void backgroundTask(){
    messageService.informUser(""backgroundTask started"");	

    try {
        Thread.sleep(8000); // wait 8s
    } catch (InterruptedException e) {
        e.printStackTrace();
    }	
	
    val dummy = new SimpleObject();
    dummy.setName(""Dummy"");
	
    repositoryService.persist(dummy);
	
    messageService.informUser(""backgroundTask finished"");	
}
{code}
We solve this using a default ExecutorService to run Action invocations in the background."
ISIS-1959,Improvement,Closed,Update to Wicket 8,
ISIS-1958,Improvement,Closed,Integration Tests: HSQL-DB is forced upon users,"As reported per user mailing list:

https://lists.apache.org/thread.html/cc2966892bdd5723e0087dad3967d6bec858d00f0133cd6fb8310816@%3Cusers.isis.apache.org%3E"
ISIS-1957,Bug,Closed,ServiceInjector fails to handle Generic Types in target fields of type List,"works

{code:java}
@javax.inject.Inject
List<GridSystemService> gridSystemServices;
{code}

does not work

{code:java}
@javax.inject.Inject
List<GridSystemService<?>> gridSystemServices;
{code}

"
ISIS-1956,Improvement,Closed,Remove dependencies on guava from unittestsupport,
ISIS-1955,Improvement,Closed,Allow for ErrorReportingService Tickets to render arbitrary HTML,"1. Refactor `org.apache.isis.applib.services.error.Ticket` into an interface.
2. Add a method `getMarkup()` that provides the html to be rendered.
3. Implement as SimpleTicket providing legacy rendering behavior, but allowing to override the actual html formatting.

 

 

 "
ISIS-1954,Improvement,Closed,JUnit 5 support,"Allow users to also write JUnit-5 Tests, while not breaking existing JUnit-4 infrastructure.

We replace the JUnit-4 (4.12) dependencies with Jupiter (5.2.0) including vintage which provides backwards compatibility ...
{code:xml}
<!-- JUPITER -->
<dependency>
	<!-- JUnit API for writing tests and extensions -->
	<groupId>org.junit.jupiter</groupId>
	<artifactId>junit-jupiter-api</artifactId>
</dependency>
<dependency>
	<!-- implementation of the JUnit Jupiter test engine -->
	<groupId>org.junit.jupiter</groupId>
	<artifactId>junit-jupiter-engine</artifactId>
</dependency>
<dependency>
	<!-- support for unit tests that use JUnit 4 or JUnit 3 -->
	<groupId>org.junit.vintage</groupId>
	<artifactId>junit-vintage-engine</artifactId>
</dependency>
{code}
 "
ISIS-1953,Improvement,Closed,Migration notes: @NotPersistable has been removed,
ISIS-1952,Improvement,Closed,Java Module Path Support,"The Java module path does no longer allow split packages.

[1] [https://www.logicbig.com/tutorials/core-java-tutorial/modules/split-packages.html]"
ISIS-1951,Sub-task,Closed,Move objenesis dependency to plugin codegen-javassist,
ISIS-1950,Improvement,Closed,Add a ByteBuddy plugin implementing proxy-factory mechanics,
ISIS-1949,Improvement,Closed,Make proxy-factory mechanics a plugin (Javassist),"This allows for 'low risk' drop-in replacement with a bytebuddy plugin later on, once properly tested.

proposed plugin-name: 'codegen-javassist'"
ISIS-1948,Improvement,Closed,Remove Javassist as a dependency,"We currently use Javassist library for our implementation of the WrapperFactory (critical for integration tests).

We investigate whether we can do without our instead switch to using ByteBuddy."
ISIS-1947,Bug,Closed,Tree View: serialization issues with tree nodes using ViewModels,
ISIS-1946,Bug,Closed,Running with o.a.i.WebServer throws exception due to empty context path.,
ISIS-1945,Improvement,Closed,[WONT FIX] Tree View: allow tree-node icon decorators (overlay-icons),Could be realized doing specific CSS class expression.
ISIS-1944,Improvement,Closed,Tree View: allow programmatic expand/collapse of tree-nodes,By now expand/collapse is only available via user interaction.
ISIS-1943,Improvement,Closed,Tree View: tree-node content IDs must be unique within a tree structure,"Tree-node content IDs must be unique within a tree structure, otherwise the wicket viewer runs into a stack overflow."
ISIS-1942,Improvement,Closed,New Facet: XmlAccessorTypeFacet,"Added for future uses.

Corresponds to XmlAccessorType(value=...) annotation"
ISIS-1941,Bug,Closed,[NOT A PROBLEM] Metamodel: XmlJavaTypeAdapterFacetFactory broken somehow,"{noformat}
org.apache.isis.core.metamodel.facets.jaxb.XmlJavaTypeAdapterFacetFactory{noformat}
when scanning for JAXB annotations picks up the 'XmlJavaTypeAdapter' annotation correctly, but meta-model validation fails, stating that there is no such corresponding facet."
ISIS-1940,Bug,Closed,MultiSelect Action Invocation throws IllegalArgumentException,"Need to investigate this further, by now I just have this ...
{code:java}
java.lang.IllegalArgumentException
argument type mismatch
sun.reflect.NativeMethodAccessorImpl#invoke0(NativeMethodAccessorImpl.java:-2)
sun.reflect.NativeMethodAccessorImpl#invoke(NativeMethodAccessorImpl.java:62)
sun.reflect.DelegatingMethodAccessorImpl#invoke(DelegatingMethodAccessorImpl.java:43)
java.lang.reflect.Method#invoke(Method.java:498)
org.apache.isis.core.commons.lang.MethodExtensions#invoke(MethodExtensions.java:44) {code}"
ISIS-1939,Bug,Closed,Internal API: Memento deserialization requires proper class-loader,Might throw class-not-found exception when using skinny-WAR setup.
ISIS-1938,Bug,Closed,[WON'T FIX] Unable to specify FakeDataModule as a dependency using ModuleAbstract#withAdditionalDependencies,"as a workaround, had to override getDependencies()
{code:java}
java.lang.IllegalArgumentException: Module domainapp.modules.PetClinicModule has returned class org.isisaddons.module.fakedata.FakeDataModule from getAdditionalModules(). This class implements 'Module' interface so should instead be returned from getDependencies()

at org.apache.isis.applib.Module$Util.transitiveAdditionalModulesOf(Module.java:150)
at org.apache.isis.applib.ModuleOrBuilderAbstract.withTransitiveFrom(ModuleOrBuilderAbstract.java:66)
at org.apache.isis.applib.AppManifestAbstract2$Builder.<init>(AppManifestAbstract2.java:99)
at org.apache.isis.applib.AppManifestAbstract2$Builder.forModule(AppManifestAbstract2.java:92)
at org.apache.isis.core.runtime.headless.IsisSystemBootstrapper.<init>(IsisSystemBootstrapper.java:60)
at org.apache.isis.core.runtime.headless.HeadlessWithBootstrappingAbstract.<init>(HeadlessWithBootstrappingAbstract.java:94)
at org.apache.isis.core.integtestsupport.IntegrationTestAbstract3.<init>(IntegrationTestAbstract3.java:160)
at org.apache.isis.core.integtestsupport.IntegrationTestAbstract3.<init>(IntegrationTestAbstract3.java:154)
at domainapp.modules.impl.PetClinicModuleIntegTestAbstract.<init>(PetClinicModuleIntegTestAbstract.java:34)
at domainapp.modules.impl.visits.integtests.Visit_enterOutcome_IntegTest.<init>(Visit_enterOutcome_IntegTest.java:37)
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
at org.junit.runners.BlockJUnit4ClassRunner.createTest(BlockJUnit4ClassRunner.java:217)
at org.junit.runners.BlockJUnit4ClassRunner$1.runReflectiveCall(BlockJUnit4ClassRunner.java:266)
at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
at org.junit.runners.BlockJUnit4ClassRunner.methodBlock(BlockJUnit4ClassRunner.java:263)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
{code}"
ISIS-1937,Bug,Closed,NPE when render domain entity for first time that has contributed action on contributed collection.,"for example

[https://github.com/danhaywood/busydevtutorial]

in Pets.layout.xml, remove the ""visits"" collection to reproduce.  The contributed Pet_bookVisit action causes the issue because its ""owner"" is not declared and so returns null.

 
{code:java}
Caused by: java.lang.NullPointerException
at org.apache.isis.core.metamodel.services.grid.bootstrap3.GridSystemServiceBS3.addActionTo(GridSystemServiceBS3.java:661)
at org.apache.isis.core.metamodel.services.grid.bootstrap3.GridSystemServiceBS3.validateAndNormalize(GridSystemServiceBS3.java:529)
at org.apache.isis.core.metamodel.services.grid.GridSystemServiceAbstract.normalize(GridSystemServiceAbstract.java:165)
at org.apache.isis.core.metamodel.services.grid.GridServiceDefault.normalize(GridServiceDefault.java:102)
at org.apache.isis.core.metamodel.facets.object.grid.GridFacetDefault.load(GridFacetDefault.java:75)
at org.apache.isis.core.metamodel.facets.object.grid.GridFacetDefault.getGrid(GridFacetDefault.java:65)
at org.apache.isis.viewer.wicket.ui.components.collectioncontents.ajaxtable.CollectionContentsAsAjaxTablePanel.addPropertyColumnsIfRequired(CollectionContentsAsAjaxTablePanel.java:170)
at org.apache.isis.viewer.wicket.ui.components.collectioncontents.ajaxtable.CollectionContentsAsAjaxTablePanel.buildGui(CollectionContentsAsAjaxTablePanel.java:102)
at org.apache.isis.viewer.wicket.ui.components.collectioncontents.ajaxtable.CollectionContentsAsAjaxTablePanel.onInitialize(CollectionContentsAsAjaxTablePanel.java:80)
at org.apache.wicket.Component.fireInitialize(Component.java:878)
at org.apache.wicket.MarkupContainer.internalInitialize(MarkupContainer.java:1070)
at org.apache.wicket.MarkupContainer.addedComponent(MarkupContainer.java:1047)
at org.apache.wicket.MarkupContainer.add(MarkupContainer.java:241)
at org.apache.wicket.MarkupContainer.addOrReplace(MarkupContainer.java:265)
at{code}"
ISIS-1936,Bug,Closed,FK exception on delete action not rendered to user correctly.,"To reproduce:
 * for simpleapp, introduce a child entity (not cascade)
 * delete parent entity to force an FK exception (due to child entities still present)

this results in a 500 html exception (RestartResponseException).  the FK exception messages are queued and only rendered subsequently.

(Also, see two exceptions queued, one warning - orange - and one error - red)."
ISIS-1935,Improvement,Closed,Remove the requirement for event-bus plugins to implement QueryResultCacheControl,"This requires extensions to both interfaces:
 * EventBusImplementation
 * EventBusService

such that event-listening can be subscribed programmatically."
ISIS-1934,Improvement,Closed,Menu Action Confirmation Dialog does not escape menu boundaries,"to reproduce (see attached screenshots) use this sample code for a menu action:
{code:java}
    @Action(semantics=SemanticsOf.NON_IDEMPOTENT_ARE_YOU_SURE) 
    public List<SimpleObject> listAllWithConfirmation() {
        return simpleObjectRepository.listAll();
    }
{code}"
ISIS-1933,Bug,Closed,Dropdown menu of dependent choices for an action parameter closes immediately on first open,"The first time a user clicks on a dropdown menu for a bounded parameter of which the choices are dependent on another parameter, the menu window closes immediately. On the second click it does stay open. During the very brief moment the window is open on the first click the 'unfiltered' set of choices is visible."
ISIS-1932,Improvement,Closed,Consolidation of Collection Utility classes,"We should consolidate those 3 classes into one:
 * org.apache.isis.core.metamodel.specloader.CollectionUtils
 * org.apache.isis.core.metamodel.services.CollectionHelper
 * org.apache.isis.core.metamodel.facets.CollectionUtils

... and simplify:
 * org.apache.isis.core.metamodel.facets.actions.action.invocation.MethodIncompatibilityWorkaround"
ISIS-1931,Improvement,Closed,ServicesInjector: Reduce Heap Pollution,"ServicesInjector, by caching Fields and Methods by Class I could reduce heap pollution of a particular integration test (involving 15k domain-objects) from more than 20GiB down to less then 7GiB."
ISIS-1930,Improvement,Closed,PersistenceSession: Reduce Heap Pollution,"I encountered heavy heap pollution with the PersistenceSession#ensureMapConsistent method, when using lots of large persistable blob objects.

I've attached 2 screenshots (flight recorder, recording an integration-test), to demonstrate the effect of this patch.

 "
ISIS-1929,Bug,Closed,Skinny WAR Redeployment: Isis Core Plugins might not be resolved,"Running on latest Payara 4 or 5, Skinny WAR deployment requires a JEE Container restart in order for the resteasy (3 or 4) core plugin to be resolved on the class-path.

Simple redeployment on a running Container throws Exception: 

{noformat}
java.lang.RuntimeException: RESTEASY003325: Failed to construct public org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication()
	...
Caused by: org.apache.isis.applib.NonRecoverableException: No plugin implementing org.apache.isis.viewer.restfulobjects.server.IsisJaxrsServerPlugin found on class path.
	at org.apache.isis.applib.internal.context._Plugin.absenceNonRecoverable(_Plugin.java:122)
	at org.apache.isis.viewer.restfulobjects.server.IsisJaxrsServerPlugin.lambda$1(IsisJaxrsServerPlugin.java:22)
{noformat}
"
ISIS-1928,Improvement,Closed,Don't log ERROR if fail to authenticate (INFO is enough),
ISIS-1927,Bug,Closed,Invoking an action returning a non-null Blob via RO results in exception,"Also as per Erik on users ml

[https://lists.apache.org/thread.html/2055cf053e713d768c36d2cf25632c8bed74bf757a4be4d3ab540b05@%3Cusers.isis.apache.org%3E]

the second issue he reports suggests that hitting an action returning a  non-null Blob via RO results in an exception in OidUtils. 

 
{code:java}
public static String getOidStr(final ObjectAdapter objectAdapter) {
  final Oid oid = objectAdapter.getOid();
  if (!(oid instanceof RootOid)) {
    throw new IllegalArgumentException(""objectAdapter must be a root adapter"");
  }
  return oid.enStringNoVersion();
}{code}"
ISIS-1926,Improvement,Closed,Why do we create an ActionInvocationDto for a mixin property anyway ?,see ISIS-1925
ISIS-1925,Bug,Closed,Invoking an action on an entity with contributed blobs (or clobs) returning null will result in an NPE.,"Also as per Erik on users ml

[https://lists.apache.org/thread.html/2055cf053e713d768c36d2cf25632c8bed74bf757a4be4d3ab540b05@%3Cusers.isis.apache.org%3E]

the first issue he reports suggests that hitting an action returning a Blob via RO also results in this issue.

 "
ISIS-1924,Sub-task,Closed,[WON'T FIX] Indicator for Long Running Actions,"Actions that take more than 1-2 sec to execute should indicate activity.

Maybe we can do this the same way as its already done when switching a Collection-View's rendering mode. (eg 'excel' to 'table')"
ISIS-1923,Improvement,Closed,Table Column Headers do not honor 'describedAs',Table Column Headers (Collection Views) should provide a mouse over effect displaying the 'describedAs' layout info.
ISIS-1922,Improvement,Closed,Session Timeout Indication,"Eg when a user clicks on a Menu Item, while the session has already timed out, the session silently refreshes and no action is executed.

From a user's perspective, she/he experiences an application that sometimes is ignoring clicks.

We should a least show a fade-in/out message to give a user friendly notification, that her/his session was timed out and hence needed to be refreshed.

 "
ISIS-1921,Sub-task,Closed,Confirmation-Popups sometimes render outside window bounds,ARE_YOU_SURE semantics triggers a UI popup that sometimes might render outside the windows bounds.
ISIS-1920,Improvement,Closed,'No Access' mouse over effect on domain-object properties.,Users having no write access to a domain-object's property should (like with Menu Items) see a 'No Access' mouse over effect.
ISIS-1919,Task,Closed,Collective UI Improvements,Main task to track various sub-tasks.
ISIS-1918,Improvement,Closed,Remove hamcrest as a compile dependency from core modules,
ISIS-1917,Improvement,Closed,[WONT FIX] new PropertyLayout::navigable needs proper integration with layout.xml,"We have programming model logic to handle
{noformat}@PropertyLayout(navigable=Navigable.PARENT){noformat}

But we don't support setting this 'flag' with layout.xml yet."
ISIS-1916,Improvement,Closed,enhance archetype so runs out-of-the-box in gitlab CI,
ISIS-1915,Sub-task,Closed,Migration Notes: We have core plugins now,"{code:xml}
<dependency>
    <groupId>org.apache.isis.core</groupId>
    <artifactId>isis-core-plugins-codegen-javassist</artifactId>
    <version>${isis.version}</version>
</dependency>

<dependency>
    <groupId>org.apache.isis.core</groupId>
    <artifactId>isis-core-plugins-discovery-reflections</artifactId>
    <version>${isis.version}</version>
</dependency>

<dependency>
    <groupId>org.apache.isis.core</groupId>
    <artifactId>isis-core-plugins-eventbus-guava</artifactId>
    <version>${isis.version}</version>
</dependency>

<dependency>
    <groupId>org.apache.isis.core</groupId>
    <artifactId>isis-core-plugins-jdo-datanucleus-4</artifactId>
    <version>${isis.version}</version>
</dependency>

<dependency>
    <groupId>org.apache.isis.core</groupId>
    <artifactId>isis-core-plugins-jaxrs-resteasy-3</artifactId>
    <version>${isis.version}</version>
</dependency>
{code}
With variants to that:
 * codegen-bytebuddy (for java 8+, javassist might no longer work on java 10+)
 * eventbus-axon
 * datanucleus-5
 * resteasy-4 (for deployment to JEE 8)"
ISIS-1914,Question,Closed,Remove the ability to add additional services to an AppManifest or Module,"Instead, should work only at the Module level.

~~~

this is prompted by Andi's original reason for raising this ticket, where he noted:

 

Adding a Service outside of the scope of configured modules fails with
{noformat}
java.lang.AssertionError: Metamodel is invalid: 
Domain objects discovered in package 'x.x.x' are not in the set of modules obtained from the AppManifest's top-level module 'y.y.y.MyModule'.  Classes are: x.x.x.MyService
{noformat}
+Source:+
{code:java}
public abstract class DomainAppIntegTestAbstract extends IntegrationTestAbstract3 {

    public DomainAppIntegTestAbstract() {
        super(new MyModule()
        	.withAdditionalServices(MyService.class)
				
		...
				
		;
    }

}
{code}
If this behavior is intended, than what is the point of adding additional services?

 

~~~

^^^ which is a fair point.  So, we ought to just get rid of that capability to add adhoc services, and instead require only that the user specifies additional modules (which they already can do) and pick up any services within those modules.

 "
ISIS-1913,Improvement,Closed,Extend REST API to return object icon,
ISIS-1912,Improvement,Closed,simpleapp 1.16.2 archetype is missing webapp/resources/Dockerfile,
ISIS-1911,Improvement,Closed,TranslationServicePo: new config option to disable the service,"Always stumbling over integration test issues stating, that there is no Application on the current thread, triggered by the PoReader when locating translation resources.

So adding an option for disabling this service should not harm.

Usage: 
{noformat}
isis.services.translation.po.mode=disable|disabled{noformat}
Default behavior is not affected by this new option."
ISIS-1910,Improvement,Closed,Rename IsisJdoSupport0 back to its original name,"'IsisJdoSupport0', as provided by Isis API (applib) should be renamed back to its original name 'IsisJdoSupport'. It breaks compatibility by removing the 3 methods for typed queries. At the moment these 3 are commented out. But we could provide some java-doc hinting users in the right direction, where to find these 3 typed query methods now, namely in
 - IsisJdoSupport_v3_1 (JDO API 3.1) as provided by plugin core/plugins/jdo-datanucleus-4
 - IsisJdoSupport_v3_2 (JDO API 3.2) as provided by plugin core/plugins/jdo-datanucleus-5"
ISIS-1909,Sub-task,Closed,Migration Notes: Moved and Deprecated Classes,"+Removed+
 * IsisJdoSupport (replaced by API specific variants)
 * Annotation Parseable removed
 * Annotation Encodable removed
 * ...

+Moved+

FROM
 org/apache/isis/applib/services/eventbus/*

TO
 org/apache/isis/applib/events/domain/AbstractDomainEvent
 org/apache/isis/applib/events/domain/ActionDomainEvent
 org/apache/isis/applib/events/domain/CollectionDomainEvent
 org/apache/isis/applib/events/domain/PropertyDomainEvent
 org/apache/isis/applib/events/lifecycle/AbstractLifecycleEvent
 org/apache/isis/applib/events/lifecycle/ObjectCreatedEvent
 org/apache/isis/applib/events/lifecycle/ObjectLoadedEvent
 org/apache/isis/applib/events/lifecycle/ObjectPersistedEvent
 org/apache/isis/applib/events/lifecycle/ObjectPersistingEvent
 org/apache/isis/applib/events/lifecycle/ObjectRemovingEvent
 org/apache/isis/applib/events/lifecycle/ObjectUpdatedEvent
 org/apache/isis/applib/events/lifecycle/ObjectUpdatingEvent
 org/apache/isis/applib/events/ui/AbstractUiEvent
 org/apache/isis/applib/events/ui/CssClassUiEvent
 org/apache/isis/applib/events/ui/IconUiEvent
 org/apache/isis/applib/events/ui/TitleUiEvent

+ISIS-1599+

Meta-Data validation will now fail if a collection action parameter is found that is not exactly one of the following supported types: List, Set, SortedSet, Collection or Array.

+In case we ship the legacy build (unlikely) ...+

to ease transition from 1.x to 2.0 we introduced legacy variants as drop-in replacements
- RepositoryService -> RepositoryServiceLegacy
- ExceptionRecognizerAbstract -> ExceptionRecognizerAbstractLegacy
- ExceptionRecognizerForType -> ExceptionRecognizerForTypeLegacy"
ISIS-1908,Sub-task,Closed,Mirgation Notes: swagger-ui is now packed with metamodel,ISIS-1881 users need to remove their swagger-ui folder from web-app's webcontent path (is now bundled with metamodel)
ISIS-1907,Sub-task,Closed,Migration Notes: Apply workaround for DN plugins,This issue is tracked with ISIS-1902.
ISIS-1906,Improvement,Closed,Programming Model: @Parent needs replacement,"the proposed replacement is
{noformat}
@PropertyLayout(navigable=Navigable.PARENT|IGNORE|NOT_SPECIFIED){noformat}"
ISIS-1905,Improvement,Closed,utilize jee friendly version of axonframework,see https://github.com/AxonFramework/AxonFramework/issues/534
ISIS-1904,Improvement,Closed,"gitlab setup, supporting CI/CD builds with externalized version","as per [https://maven.apache.org/maven-ci-friendly.html]

mvn clean package -B -Dskip.arch -D revision=2.0.0-M1.$(date +%Y%m%d)-$(git rev-parse --short HEAD)

 "
ISIS-1903,Task,Closed,Update helloworld/simpleapp for Isis version 2,
ISIS-1902,Bug,Closed,Datanucles: plugging in of Isis provided JDO value types is broken,"After moving the 'org.apache.isis.objectstore.jdo.datanucleus.valuetypes' from 'runtime' into both new 'core-plugin-jdo-datanucleus', datanulces does no longer register these! 

This breaks Blob/Clob fetching from persistence layer."
ISIS-1901,Improvement,Closed,Swagger-UI: Replace index.html with a Servlet that is aware of restful config,
ISIS-1900,Task,Closed,[NOT A PROBLEM] Fix the release process to also generate .sha512 files,"as per updated ASF guidelines.

the .md5 are no longer required.

~~~

[https://www.apache.org/dev/release-distribution#sigs-and-sums]

For every artifact distributed to the public through Apache channels, the PMC
 * MUST supply a [valid|https://www.apache.org/dev/release-signing#verifying-signature] [OpenPGP compatible ASCII armored detached signature|https://www.apache.org/dev/release-signing#openpgp-ascii-detach-sig] file,
 * MUST supply at least one ([SHA|https://www.apache.org/dev/release-signing#sha-checksum] or [MD5|https://www.apache.org/dev/release-signing#md5]) checksum file,
 * SHOULD supply a SHA-1, SHA-256 or SHA-512 checksum file,
 * SHOULD NOT supply a MD5 checksum file (because MD5 is [too broken|https://en.wikipedia.org/wiki/MD5#Overview_of_security_issues]).

So, we are compliant already."
ISIS-1899,Task,Closed,Release tasks for 1.17.0,
ISIS-1898,Improvement,Closed,Use Joda Interval for LocalDate collection parameter,"{code:java}
// code placeholder
{code}
To accommodate to the requirement of a {{choicesXxx}}/{{autoCompleteXxx}} method for a collection parameter on an action, it would be useful to be able to return a Joda Interval instead of a collection of LocalDates.

Furthermore, it is desirable that the available options are offered through the date picker that is currently used for single LocalDate parameters."
ISIS-1897,Improvement,Closed,applib: the new ObjectContracts needs backward compatibility,"ObjectContracts seems to be heavily used with the incode platform.

To ease migration, I've provided functional backward compatibility.

However the old methods are now marked for deprecation!

 

 
----
Isis until 1.16. uses reflection on every of these 4 calls ...
{code:java}
public class ApplicationPermission implements Comparable<ApplicationPermission> {

	...

    private final static String propertyNames = ""role, featureType, featureFqn, mode"";

    @Override
    public int compareTo(final ApplicationPermission other) {
        return ObjectContracts.compare(this, other, propertyNames);
    }

    @Override
    public boolean equals(final Object obj) {
        return ObjectContracts.equals(this, obj, propertyNames);
    }

    @Override
    public int hashCode() {
        return ObjectContracts.hashCode(this, propertyNames);
    }

    @Override
    public String toString() {
        return ObjectContracts.toString(this, propertyNames);
    }
	
	...
	
}
{code}
----
Isis since 2.0.0 provides an optimized variant now: reflection is used only once at class initialization ...
{code:java}
public class ApplicationPermission implements Comparable<ApplicationPermission> {

	...

    private final static String propertyNames = ""role, featureType, featureFqn, mode"";
    
    private final static ObjectContract<ApplicationPermission> contract 
    	= ObjectContracts.parse(ApplicationPermission.class, propertyNames);

    @Override
    public int compareTo(final ApplicationPermission other) {
        return contract.compare(this, other);
    }

    @Override
    public boolean equals(final Object other) {
        return contract.equals(this, other);
    }

    @Override
    public int hashCode() {
    	return contract.hashCode(this);
    }

    @Override
    public String toString() {
        return contract.toString(this);
    }
	
	...
	
}
{code}
----
However the *recommended* way to use 'object contracts' now is to no longer resort to reflection.

Parsing as shown above can be replaced by static method handles to enforce that properties actually exist (at compile-time)
{code:java}
private final static ObjectContract<ApplicationPermission> contract	= 
	ObjectContracts.contract(ApplicationPermission.class)
	.thenUse(""role"", ApplicationPermission::getRole)
	.thenUse(""featureType"", ApplicationPermission::getFeatureType)
	.thenUse(""featureFqn"", ApplicationPermission::getFeatureFqn)
	.thenUse(""mode"", ApplicationPermission::getMode);
{code}
If different then natural order comparators are needed then resort to Java's Comparator composition ...
{code:java}
private final static ObjectContract<ApplicationPermission> contract	= 
	ObjectContracts.contract(ApplicationPermission.class)
	.thenUse(""role"", ApplicationPermission::getRole, Comparator.naturalOrder())
	.thenUse(""featureType"", ApplicationPermission::getFeatureType, Comparator.reverseOrder())
	.thenUse(""featureFqn"", ApplicationPermission::getFeatureFqn, Comparator.nullsFirst(Comparator.naturalOrder()))
	.thenUse(""mode"", ApplicationPermission::getMode, Comparator.nullsLast(Comparator.naturalOrder()));	
{code}"
ISIS-1896,Improvement,Closed,Swagger-UI: provide a link for convenient login to restful API,
ISIS-1895,Improvement,Closed,Simplify deployment descriptors (web.xml),"Instead of having users configure filters, listeners and servlets within their web.xml files, we'd rather provide a programmatic approach to setting up the ServletContext.

We introduce a new interface WebModule, that encapsulates the configuration required for a set of filters, listeners and servlets.

We also introduce a new WebContextLister that acts as the single web-Application entry-point for setting up the ServletContext using these new WebModules.

 "
ISIS-1894,Sub-task,Closed,[WONT-FIX] Resteasy: Reactivate PrettyPrinting ,"When splitting resteasy specific classes into the new isis/plugins/jaxrs-resteasy-3 plugin I deactivated the PrettyPrinting integration.
"
ISIS-1893,Sub-task,Closed,fix mvn build issues,"After major refactoring steps, we have multiple new modules.

The dependency structure (mvn) has been updated as well.

Now we need to check the maven core build and fix any issues."
ISIS-1892,Sub-task,Closed,Move Guice out of 'core',"at least we need to investigate, whether this can be done without breaking too much"
ISIS-1891,Improvement,Closed,Make jax-rs provider (resteasy) a plugin ,"let core modules depend only on standard jax-rs API (provided by the JEE 7 standard)

make 2 new plugins
* jaxrs-resteasy-3 (for deployment on JEE 7)
* jaxrs-resteasy-4 (for deployment on JEE 8)"
ISIS-1890,Sub-task,Closed,configure surefire for all new plugins,
ISIS-1889,Sub-task,Closed,Backport datanucleus specific commits from M2 into M1.,backports need to go into isis/core/plugins/jdo-datanucleus-5
ISIS-1888,Improvement,Closed,Tweak/add CSS class names to better support E2E tests (page object selectors),
ISIS-1887,Bug,Closed,Metamodel: restore java.sql.Timestamp support,"Because java.sql.Timestamp support in Isis depends on deprecated Isis-Applib-Timestamp implementation, required classes are currently on the 'legacy' lane.

Should be brought back in into metamodel (non-legacy)."
ISIS-1886,Sub-task,Closed,Port QueryResultCache back into applib,"We removed guava from applib!

Last remaining puzzle was QueryResultCache.

QueryResultCache was moved from applib to plugins/eventbus-guava because it depends on guava. (Also depends on axon.)

Functionality should be ported back into applib. If not possible, we provide it via the 2 eventbus plugins:
 * eventbus-axon
 * eventbus-guava

 "
ISIS-1885,Sub-task,Closed,Re-invent ObjectContracts' JUnit Tests,The new ObjectContracts class requires JUnit Tests to be ported into applib from those that are in applib-legacy now testing ObjectContractsLegacy.
ISIS-1884,Improvement,Closed,Restrict where choices and autoComplete are implicitly provided on parameters ,"to avoid accidental breakage of existing code, only infer choices and defaults if @Action(associatedWith=) has been used to bind an action to a collection.

Do NOT infer if @MemberOrder or .layout.xml are used"
ISIS-1883,Improvement,Open,[Validation] Scalar ref params should have a choices or autoComplete.,"With a metamodel validator.

 

We do this for collection parameters already (see 

ActionChoicesForCollectionParameterFacetFactory) but not for scalar reference parameter.

NOTE: be careful to ignore scalar VALUE parameters (such as string or date); obviously they *aren't* required to have a choices or autoComplete facet."
ISIS-1882,New Feature,Closed,Extend RO viewer to (optionally) automatically wrap action-results in a view model.,
ISIS-1881,Improvement,Closed,Package swagger-ui web-content with metamodel module,"Instead of having swagger-ui web-content in web-app artifacts, bundle it with the metamodel module instead. 

This allows for a single point of maintenance, instead of users having to update their web-applications independently."
ISIS-1880,Bug,Closed,LocalResourcePath: new value type for local URLs,"The framework in prototyping mode (when rendering domain objects) provides links to swagger and the restful api.

However, this links do not work in general.

Currently these links are contributed by actions that return java.net.URL value types. Which works fine if we want to link to external web-resources. But when linking to internal web-resources its almost impossible to derive the absolute URL a client actually sees.

E.g. we have the relative path to swagger: '/swagger-ui/index.html' but it's impossible to derive the absolute path in general like 'http://some-server:someport:/...'. Not to mention that the servlet container hosting Isis could sit behind a http-reverse-proxy, or that we don't know if the protocol is http or https (SSL could be terminated somewhere else).

And I believe, we should not even have to care!

So I'd propose, we introduce a new value type similar to URL, but one that only represents relative paths within the web-app. 

Feel free to comment, if I'm wrong our there is a better solution.



"
ISIS-1879,Improvement,Closed,"Date header returned by RO resuts should be the Clock time, not the system time.","RO does already return a ""Date"" header, but this is the system time.  Should instead by the ClockService's time."
ISIS-1878,Sub-task,Closed,[WON'T FIX] JEE Support - User Guide (adoc),"* How to setup (best practice)
* Docker example (optional)
* Explain skinny-war deployment and its benefits (fast re-deployments during web-app development)
*  Refer to an always open task (jira) that tracks JEE compatibility regarding vendors and versions as well as known issues and workarounds
"
ISIS-1877,Improvement,Closed,Enhance representation of action invocation,"From Seb:

I want to allow GET actions to be bookmark-able. For example, a link to ""Contacts.listall"" or similar finder.

I am able to do so by bookmarking a url such as
http://localhost:8080/restful/services/org.incode.eurocommercial.contactapp.dom.contacts.ContactMenu/actions/listAll/invoke

However, I don't know how to get the action descriptor from this result . The returned links contain the invoke link only. I see no link to ""up"" or ""describedby""

Is it possible to locate this from the results?

 

 "
ISIS-1876,Improvement,Closed,Convert IsisApplibModule (and archetype app modules) to use ModuleAbstract,
ISIS-1875,Task,Closed,Release tasks for 1.16.2,
ISIS-1874,Bug,Closed,Parented checkboxes fails - NPEs and incorrect facets.,"Two separate issues:
 # NPE for a parented collection with no toggle box column (the AssociatedWithProvider is always created, but may return a null toggle box column; this isn't guarded for.
 # When a choices facet is installed for a parameter, doesn't check the type of the parameter against the collection, meaning cannot invoke action.

Workaround: disable the ""associateWith"" or memberOrder

Example of (1) - fails with NPE (though action is executed)
{code:java}
@Getter @Setter
private SortedSet<Occupancy> occupancies = new TreeSet<>();

// associated via .layout.xml
public Occupancy newOccupancy(
        final @Parameter(optionality = Optionality.OPTIONAL) LocalDate startDate,
        final Unit unit) {
    Occupancy occupancy = occupancyRepository.newOccupancy(this, unit, startDate);
    occupancies.add(occupancy);
    return occupancy;
}

public LocalDate default0NewOccupancy() {
    return getTenancyStartDate();
}

public List<Unit> choices1NewOccupancy() {
    return getProperty()!=null ? unitRepository.findByProperty(getProperty()) : unitRepository.allUnits();
}
{code}
 

Example of (2) - fails with AgreementRole incompatible with Party.  Workaround is to ensure there's an explicit autoComplete or choices
{code:java}

@javax.jdo.annotations.Persistent(mappedBy = ""agreement"", defaultFetchGroup = ""true"")
@Collection(editing = Editing.DISABLED)
@CollectionLayout(render = RenderType.EAGERLY)
@Getter @Setter
private SortedSet<AgreementRole> roles = new TreeSet<>();

@MemberOrder(name = ""roles"", sequence = ""1"")
public Agreement newRole(
        final AgreementRoleType type,
        final Party party,
        final @Parameter(optionality = Optionality.OPTIONAL) LocalDate startDate,
        final @Parameter(optionality = Optionality.OPTIONAL) LocalDate endDate) {
    createRole(type, party, startDate, endDate);
    return this;
}
public List<AgreementRoleType> choices0NewRole() {
    return agreementRoleTypeRepository.findApplicableTo(getType());
}

public LocalDate default2NewRole() {
    return getEffectiveInterval().startDate();
}

public LocalDate default3NewRole() {
    return getEffectiveInterval().endDate();
}
{code}
^^^ the problem triggers on Party, not on AgreementRoleType, because the latter has an explicit choices method.

 "
ISIS-1873,Improvement,Open,"[JUnit] Resilience: if hideXxx, disableXxx or validateXxx method throws NPE, then assume veto and log a WARNing.","Currently the framework doesn't degrade gracefully.

For example, had a coding error in a hideXxx() method.

This resulted in the error page, rather than simply hide the relevant member.
{code:java}
org.eclipse.jetty.util.thread.QueuedThreadPool#runJob(QueuedThreadPool.java:672)
org.eclipse.jetty.util.thread.QueuedThreadPool$2#run(QueuedThreadPool.java:590)
java.lang.Thread#run(Thread.java:745)
Caused by:
java.lang.NullPointerException
org.isisaddons.module.command.dom.CommandJdo#hideReplayStateFailureReason(CommandJdo.java:386)
sun.reflect.NativeMethodAccessorImpl#invoke0(NativeMethodAccessorImpl.java:-2)
sun.reflect.NativeMethodAccessorImpl#invoke(NativeMethodAccessorImpl.java:62)
sun.reflect.DelegatingMethodAccessorImpl#invoke(DelegatingMethodAccessorImpl.java:43)
java.lang.reflect.Method#invoke(Method.java:498)
org.apache.isis.core.commons.lang.MethodExtensions#invoke(MethodExtensions.java:53)
org.apache.isis.core.metamodel.adapter.ObjectAdapter$InvokeUtils#invoke(ObjectAdapter.java:38{code}"
ISIS-1872,Improvement,Closed,"Extend ModuleOrBuilderAbstract, with #withAdditionalDependencies(Module... modules)",.... so that it is easier to fine-tune modules (eg adding in FakeDataModule) within integration tests.
ISIS-1871,Task,Closed,"Pull changes, that do not conflict with DN-4, from M2 into M1","Remember:

  * 2.0.0-M1 is a transition to JDK 8
  * 2.0.0-M2 is a transition to Datanucleus 5"
ISIS-1870,Bug,Closed,Fix JUnit Tests previously not picked up by surefire,"These modules have failing tests ...
* core/security-shiro
* core/viewer-restfulobjects-applib
* core/viewer-restfulobjects-server"
ISIS-1869,Bug,Closed,Surefire does not pick up all relevant tests,"||Module	||Surefire Tests via Maven plugin	||Eclipse running Junit Tests on src/test/java||
|core/unittestsupport	|Tests run: 32, Failures: 0, Errors: 0, Skipped: 2	|Tests run: 51, Failures: 0, Errors: 0, Skipped: 3|
|core/applib	|Tests run: 303, Failures: 0, Errors: 0, Skipped: 0	|Tests run: 354, Failures: 0, Errors: 0, Skipped: 1|
|core/metamodel	|Tests run: 828, Failures: 0, Errors: 0, Skipped: 12	|Tests run: 1319, Failures: 0, Errors: 0, Skipped: 21|
|core/runtime	|Tests run: 83, Failures: 0, Errors: 0, Skipped: 0	|Tests run: 111, Failures: 0, Errors: 0, Skipped: 0|
|core/wrapper	|Tests run: 3, Failures: 0, Errors: 0, Skipped: 0	|n.a.|
|core/security-shiro	|Tests run: 2, Failures: 0, Errors: 0, Skipped: 0	|Tests run: 15, Failures: *4*, Errors: *4*, Skipped: 0|
|core/viewer-restfulobjects-applib	|Tests run: 16, Failures: 0, Errors: 0, Skipped: 0	|Tests run: 169, Failures: 0, Errors: *9*, Skipped: 0|
|core/viewer-restfulobjects-rendering	|Tests run: 3, Failures: 0, Errors: 0, Skipped: 0	|Tests run: 74, Failures: *2*, Errors: 0, Skipped: 0|
|core/viewer-restfulobjects-server	|Tests run: 8, Failures: 0, Errors: 0, Skipped: 0	|Tests run: 32, Failures: *2*, Errors: *12*, Skipped: 0|
|core/viewer-wicket-model	|Tests run: 4, Failures: 0, Errors: 0, Skipped: 0	|Tests run: 11, Failures: 0, Errors: 0, Skipped: 7|
|core/viewer-wicket-ui	|Tests run: 36, Failures: 0, Errors: 0, Skipped: 0	|Tests run: 55, Failures: 0, Errors: 0, Skipped: 0|
|core/viewer-wicket-impl	|Tests run: 0, Failures: 0, Errors: 0, Skipped: 0	|Tests run: 33, Failures: 0, Errors: 0, Skipped: 7|
"
ISIS-1868,Bug,Closed,Eclipse fails to build the schema module,
ISIS-1867,Improvement,Closed,Avoid queuing/contention issues - cache JAXBContext in MemberExecutionDtoUtils.,
ISIS-1866,Bug,Closed,Metamodel: 38 JUnit Test Failures,"Eclipse discovers 1325 JUnit tests, 18 are skipped (ignored) and 38 do fail."
ISIS-1865,Bug,Closed,Wicket-Impl: Some JUnit tests are failing,"Some JUnit tests are failing due to missing IsisSessionFactory, which seems not required for these tests anyway."
ISIS-1864,Improvement,Closed,Refactor EntityModel and ScalarModel so that don't unnecessarily reset scalar model properties after action invocation.,"as per [https://lists.apache.org/thread.html/9924509e3d3e0398e230467d80370e2f9d6dc94641aaa402db56c24e@%3Cusers.isis.apache.org%3E]

 

I think that the parent EntityModel shouldnt' really have this responsibility of telling each of its child ScalarModel's to reset themselves. Rather, perhaps it should simply instruct the ScalarModels that they are now dirty, so that if and when the ScalarModels are next asked for their state (for re-rendering) they then will query the underlying domain object ... but not before.

 

Also, ScalarModel inherits from EntityModel, but I think that's not correct; should factor out a common supertype for both."
ISIS-1863,Improvement,Closed,[WON'T FIX] Code generate page object classes to allow smoke tests using Selenium to be developed more easily,
ISIS-1862,Improvement,Closed,"Delete CukeGlueBootstrappingAbstract, since of no practicable use.",
ISIS-1861,New Feature,Closed,Extend tabgroup layout control so that a tabgroup with only one tab can show either collapsed (default) or with the one tab.,
ISIS-1860,Documentation,Closed,CommandReification.DISABLED is broken / incorrectly documented.,"Don't intend to change the implementation, but what I observe is that setting commandReification=DISABLED does not necessarily prevent a command from being persisted.  All it does is prevent a CommandFacet from being installed on the corresponding action or property in the metamodel.

A Command object is always created by CommandContext.  If there is a CommandService implementation, then it delegates to that to act as the factory of the Command.  So reification always occurs.

If an action invocation or property edit causes objects to be modified, then the Command#setPersistHint(...) is set to true.  And, if there is no command facet, then the CommandServiceJdo will default the Command#setPersistence(...) to PERSIST_IF_HINTED.

The net result is that if commandReification is DISABLED, then commands are still persisted if they cause any objects to be dirtied.  

To prevent commands being persisted, instead use @Action(commandPersistence=NOT_PERSISTED), and make sure that @Action(command=ENABLED).

 

object is updated with a persist hint.  In the case of the incode platform's Command module, the CommandService#complete(Command) is called, its implementation will "
ISIS-1859,Documentation,Closed,"Use of ""timestamp"" in JDOQL queries.","As posted by me on the DN gitter channel...
{code:java}
I have an entity CommandJdo that has a property called ""timestamp"", of type java.sql.Timestamp

My JDOQL for this is:

SELECT
FROM org.isisaddons.module.command.dom.CommandJdo
WHERE executeIn == 'FOREGROUND'
&& timestamp > :timestamp
&& startedAt != null
&& completedAt != null
ORDER BY timestamp ASC

Running against SQL Server 2016 this gave me a different result first time it was run compared to subsequent times.
Running SQL Profiler I found the underlying SQL as:

exec sp_prepexec @p1 output,N'@P0 datetime2',N'SELECT ''org.isisaddons.module.command.dom.CommandJdo'' AS NUCLEUS_TYPE,A0.arguments,A0.completedAt,A0.""exception"",A0.executeIn,A0.memberIdentifier,A0.memento,A0.replayState,A0.replayStateFailureReason,A0.""result"",A0.startedAt,A0.targetAction,A0.targetClass,A0.target,A0.""timestamp"",A0.transactionId,A0.""user"",''2018-01-24 17:29:18.3'' AS NUCORDER0 FROM isiscommand.Command A0 WHERE A0.executeIn = ''FOREGROUND'' AND A0.""timestamp"" > @P0 AND A0.startedAt IS NOT NULL AND A0.completedAt IS NOT NULL ORDER BY NUCORDER0 OFFSET 0 ROWS FETCH NEXT 2 ROWS ONLY ','2018-01-24 17:29:18.3000000'

To unpick this, the key bit is: '

'2018-01-24 17:29:18.3'' AS NUCORDER0
... ORDER BY NUCORDER0

So in the JDOQL the ""ORDER BY timestamp ASC"", the ""timestamp"" is being evaluated as the current time, I suppose as a sort-of built-in function.

Which was surprising.

My fix was to change the JDOQL to be:
ORDER BY this.timestamp ASC{code}
 

 "
ISIS-1858,Bug,Closed,NPE when Log at Debug Level,"As reported by Martin Hesse [1].

[1] https://lists.apache.org/thread.html/b4a6ddfa2c612dd62f8661e6612f385625dfbf01b53bcb9ebe5a6e58@%3Cusers.isis.apache.org%3E "
ISIS-1857,Bug,Closed,help block for properties/parameters with drop down actions to right encroaches on the field.,
ISIS-1856,New Feature,Closed,Add git.properties and SCM-Revision into MANIFEST.MF,
ISIS-1855,Bug,Closed,scm entries in core pom.xml are incorrect,"<scm>
 <connection>scm:git:http://git.apache.org/isis.git/core</connection>
 <developerConnection>scm:git:https://git-wip-us.apache.org/repos/asf/isis.git/trunk/framework/</developerConnection>
 <url>git://git.apache.org/isis.git/core</url>
 <tag>HEAD</tag>
</scm>"
ISIS-1854,Bug,Closed,menubars.layout.xml seems to ignore the embedded <Name> ?,
ISIS-1853,Bug,Closed,Fix AbstractSessionTemplate and to unmarshal collection and reference arguments.,This is blocking replay (ISIS-1569) of actions with parameter collections.
ISIS-1852,Bug,Closed,Iterating over query result list with parallelStream produces next exception,"Given the the result from database, e.g.
{code:java}
final List<MobileDevice> devices = repositoryService.allInstances(MobileDevice.class);{code}
When I iterate over list with parallelStream
{code:java}
filteredDevices.parallelStream().forEach(mobileDevice -> {
// my stuff here
});{code}
Then I get this exception
{code:java}
... 134 more
Caused by: java.lang.IllegalStateException: No service of type class org.apache.isis.core.runtime.services.metrics.MetricsServiceDefault is available on this 
at org.apache.isis.core.runtime.services.ServiceInstantiator$2.invoke(ServiceInstantiator.java:217)
at org.apache.isis.core.runtime.services.metrics.MetricsServiceDefault_$$_jvstad5_7.postLoad(MetricsServiceDefault_$$_jvstad5_7.java)
at org.datanucleus.api.jdo.JDOCallbackHandler.postLoad(JDOCallbackHandler.java:305)
at org.datanucleus.state.StateManagerImpl.postLoad(StateManagerImpl.java:4443)
at org.datanucleus.state.StateManagerImpl.initialiseForCachedPC(StateManagerImpl.java:645)
at org.apache.isis.objectstore.jdo.datanucleus.JDOStateManagerForIsis.initialiseForCachedPC(JDOStateManagerForIsis.java:112)
at org.datanucleus.state.ObjectProviderFactoryImpl.newForCachedPC(ObjectProviderFactoryImpl.java:280)
at org.datanucleus.ExecutionContextImpl.getObjectFromLevel2Cache(ExecutionContextImpl.java:5210)
at org.datanucleus.ExecutionContextImpl.getObjectFromCache(ExecutionContextImpl.java:5101)
at org.datanucleus.ExecutionContextImpl.findObject(ExecutionContextImpl.java:3048)
at org.datanucleus.store.rdbms.query.PersistentClassROF.getObjectForDatastoreId(PersistentClassROF.java:460)
at org.datanucleus.store.rdbms.query.PersistentClassROF.getObject(PersistentClassROF.java:385)
at org.datanucleus.store.rdbms.scostore.CollectionStoreIterator.<init>(CollectionStoreIterator.java:100)
at org.datanucleus.store.rdbms.scostore.FKSetStore.iterator(FKSetStore.java:1080)
at org.datanucleus.store.types.wrappers.backed.Collection.loadFromStore(Collection.java:374)
at org.datanucleus.store.types.java8.wrappers.backed.Collection.stream(Collection.java:70)
at a1.guidedselling.offer.hardware.MobileDevice.referenceNextDevicePriceForTarifWithoutService(MobileDevice.java:195)
at a1.guidedselling.templates.OfferTemplatesRepository.lambda$offerTemplatesFor$1(OfferTemplatesRepository.java:102)
at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1374)
at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:291)
at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157){code}"
ISIS-1851,Bug,Closed,"Improve the dynamic visibility of PropertyGroups so works with pdf js viewer (anything that isn't a ScalarPanelAbstract2, basically).",A property group with only a PdfJsViewer (which doesn't inherit from ScalarPanelAbstract2) was being hidden.  This is because the algorithm used in ISIS-1761 was too aggressive/naive.
ISIS-1850,Improvement,Closed,[NOT IMPLEMENTED] Rename 'default' in JSON Response,"Invoking
{code:java}
http://localhost:8080/restful/services/isisApplib.FixtureScriptsDefault/actions/runFixtureScript{code}

answers:
{code}
        ""parameters"": {
            ""script"": {
                ""num"": 0,
                ""id"": ""script"",
                ""name"": ""Script"",
                ""description"": """",
                ""choices"": [
                    {
                        ""rel"": ""urn:org.restfulobjects:rels/value"",
                        ""href"": ""http://localhost:8080/restful/objects/domainapp.application.fixture.scenarios.DomainAppDemo/PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPG1lbWVudG8-PHBhdGg-PC9wYXRoPjwvbWVtZW50bz4="",
                        ""method"": ""GET"",
                        ""type"": ""application/json;profile=\""urn:org.restfulobjects:repr-types/object\"""",
                        ""title"": ""Domain App Demo""
                    }
                ],
                ""default"": {
                    ""rel"": ""urn:org.restfulobjects:rels/value"",
                    ""href"": ""http://localhost:8080/restful/objects/domainapp.application.fixture.scenarios.DomainAppDemo/PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPG1lbWVudG8-PHBhdGg-PC9wYXRoPjwvbWVtZW50bz4="",
                    ""method"": ""GET"",
                    ""type"": ""application/json;profile=\""urn:org.restfulobjects:repr-types/object\"""",
                    ""title"": ""Domain App Demo""
                }
            },
{code}

default is a keyword in ActionScript and converting JSON to AS like in https://github.com/joerg-rade/roViz/blob/master/src/main/flex/org/ro/to/AbstractTransferObject.as#L10

is not possible since 'public var default:Object' is illegal.

Please rename 'default' into eg. defaultChoice"
ISIS-1849,Documentation,Closed,1.16.0 - Broken Links according to W3C checker,"According to [https://validator.w3.org/checklink?uri=https%3A%2F%2Fisis.apache.org%2F&summary=on&hide_type=all&recursive=on&depth=3&cookie=nochanges&check=Check] 
 there are some 404 errors:

 

NOFIX - nothing to be fixed

TOFIX - an error, to be fixed

 

[https://isis.apache.org/guides/cgcom/cgcom.html] (probably on purpose)
 NOFIX - Line: 2321 [https://git-wip-us.apache.org/repos/asf/isis/repo?p=isis.git;a=blob_plain;f=STATUS;hb=HEAD]
 NOFIX - Line: 3512 [http://people.apache.org/~xxxxxxxx/nnnnnnnn.asc]

 

 

[https://isis.apache.org/guides/rgcms/rgcms.html]
 FIXED - Line: 5198 [https://isis.apache.org/guides/rgcms/images/value-types/markup/.png]
 FIXED - Line: 6378 [http://isis.apache.org/applib/layout/menus/menubars.xsd]

[https://isis.apache.org/guides/ugtst/ugtst.html]
 FIXED - Line: 2276 [https://isis.apache.org/guides/ugtst/rgsvc.html]

[https://isis.apache.org/migration-notes/migration-notes.html]
 FIXED - Line: 619 [https://isis.apache.org/rgcms/rgcms.html]
 FIXED - Lines: 464, 564, 565 [https://isis.apache.org/ugfun/ugfun.html]
 FIXED - Line: 1072 [https://isis.apache.org/migration-notes/rgsvc.html]
 FIXED - Line: 572 [https://isis.apache.org/rgcfg.html]
 FIXED - Line: 552 [https://isis.apache.org/ugfun.html]
 FIXED - Line: 619 [https://isis.apache.org/ugtst/ugtst.html]

[https://isis.apache.org/guides/dg/dg.html]
FIXED - Line: 4441 [https://isis.apache.org/setting-up/concepts/concepts.html]
FIXED - Lines: 4412, 4426 [https://isis.apache.org/guides/dg/_images/vscode.png]

 "
ISIS-1848,Bug,Closed,References of type java.lang.Object (sometimes) not rendered correctly in Wicket viewer,"This is down to a race condition, I think.

At any rate, the ObjectSpecificationOnStandaloneList for FreeStandingList (the internal pojo that holds the result of an action invocation) is asked for its ObjectSpecId.  It tries to do this by asking for the value of the corresponding ObjectSpecIfFacet.

However, no such facet (in some circumstances, presumably) is installed for this ObjectSpec, and so it searches up the hierarchy.  The superclass is java.lang.Object, and so we return the ObjectSpecId for java.lang.Object.

This in turn causes the cache of ObjectSpecId -> ObjectSpecification's to be corrupted, with java.lang.Object mapping to the list.

In the Wicket viewer, when attempting to render a reference property of type java.lang.Object (such as the Task_object mixin for Estatio), the SpecificationLoader reports that a reference of this type is not isObject() (because it's using ObjectSpecificationOnStandaloneList), resulting in an UnknownPanel being selected to render the Wicket model for the reference property.  This simply shows a toString().

The fix, I think, is to not search up the hierarchy in the case of ObjectSpecIdFacet... an ObjectSpecification must be able to answer this question itself."
ISIS-1847,Bug,Closed,Eventbus: AbstractDomainEvent incorrect veto handling?,"When refactoring switch statements I found 2 in
 isis-core-applib's
 *org.apache.isis.applib.services.eventbus.AbstractDomainEvent*
 where the cases have no break statements.

Is this intentional or a bug?

Just for reference, here's the refactored version [1].

[1] [https://github.com/apache/isis/blob/8e8b5f1a8e4780b467ab31a7d909f89e499244a9/core/applib/src/main/java/org/apache/isis/applib/services/eventbus/AbstractDomainEvent.java]"
ISIS-1846,Improvement,Closed,Code deduplication (new Internal API),"isis-core-applib would be the perfect place to consolidate any internal utility classes such as

NullSafe (common null check idioms), StringExtensions, ordering algorithms, etc ...

but we would want to keep these classes contained, meaning they should not be available for public use, just for internal use within Isis' code-base.

Java 9 has the perfect solution for this. But what can we do in the meantime (with Java 8)?"
ISIS-1845,Sub-task,Closed,[WONT-FIX] Improve code coverage regarding applib's test-suite,Currently we have about 28% code covered by tests.
ISIS-1844,Improvement,Closed,API cleanup: make any unchecked casts explicit,"replace occurrences of
 
{code:java}
public <T> T myMethod() {
    ...
    return (T) myObject;
}
{code}

... with ... 

{code:java}
public <T> T myMethod() {
    ...
    return Casts.uncheckedCast(myObject);
}
{code}

... such that we have a programmatic entry point for any unchecked casts.
 "
ISIS-1843,Improvement,Closed,remove occurences of Thread.currentThread().getContextClassLoader(),"... replace by calling a singleton (of application-scope) that is responsible for providing Isis' default class-loader.

We have such a mechanism in 2.0.0-M2 with IsisContext, but this is in isis-core-runtime, while e.g. the ClassDiscoveryService is in isis-core-applib and makes calls to Thread.currentThread().getContextClassLoader()

 

 "
ISIS-1842,Improvement,Closed,API cleanup: add generic type arguments where missing,
ISIS-1841,Task,Closed,API cleanup + refactoring for version 2,"add generic type arguments where missing

reduce number of compiler warnings (enums with missing cases, unchecked casts, vararg type safety, ...)

reduce duplicate code occurrences (e.g. DeweyOrder Utils, ...)

reduce occurrences of guava's (Predicate, Function, ...)  interfaces, that have direct Java 8 replacements (at least where easily possible)

reduce occurrences of deprecated uses"
ISIS-1840,Improvement,Closed,[WON'T FIX] integration test given/when/then sections,"// wraps in its own session
given( () -> {


});

// wraps in its own transaction
when( () -> {

 

});


// does nothing, justs for consistency
then( () -> {

 

});

 "
ISIS-1839,Improvement,Closed,Remove isis-core-wrapper artifact.,in ISIS-1838 (1.16.1) we prevoiusly moved the code from isis-core-wrapper to isis-core-runtime; in this ticket we just get rid of the (now empty) isis-core-wrapper.
ISIS-1838,Improvement,Closed,Move WrapperFactory in isis-core-wrapper to isis-core-runtime.,
ISIS-1837,Improvement,Closed,Metamodel validator should check for cyclic dependencies (reference to entities that live outside of the module set),"at the moment this shows up as an error of an entity referencing a non-existent repository.  This is where the entity is found by walking the graph outside the set of defined modules, and yet the domain services are only ever strictly loaded.

The metamodel validator should basically check that every entity and view model type in the metamodel resides within one of the packages of the set of modules that make up the application."
ISIS-1836,Improvement,Closed,Better diagnostic reporting in RO viewer if passed in a non-parseable value,was passing transactionId=null for a parameter of type UUID... underlying issue swallowed.
ISIS-1835,Improvement,Closed,Better diagnostic reporting if fail to read a configuration flie.,
ISIS-1834,Improvement,Closed,Relax metamodel validation to allow @PersistenceCapable on interfaces,"as per

https://lists.apache.org/thread.html/4f0595f6c7ba05e86604cc35f9b2f79614ca367437adef586df2897d@%3Cusers.isis.apache.org%3E"
ISIS-1833,Bug,Closed,Mandatory marker (red asterisk) not shown on mandatory parameters,"(though not on properties).

 "
ISIS-1832,Bug,Closed,Entering a non-valid string into a parameter of type UUID results in a stacktrace.,"The workaround is to define the parameter as a string and implement validation, eg using a UuidSpecification."
ISIS-1831,Bug,Closed,"If Accept header bad, then our exception handler throws an NPE and so issue of bad header is not reported.","If RestEasy throws exception due to bad Accept header, this happens before Isis has set up a session.  We therefore need to guard against this in the exception handler to avoid the NPE."
ISIS-1830,Improvement,Closed,Eliminate dependence on any JDK internal APIs (jdeps JDK 9),"Running a
{noformat}
jdeps -jdkinternals
{noformat}
against these 4 classes
 * org.apache.isis.schema.utils.jaxbadapters.JodaLocalDateTimeXMLGregorianCalendarAdapter
 * org.apache.isis.schema.utils.jaxbadapters.JodaLocalDateXMLGregorianCalendarAdapter
 * org.apache.isis.schema.utils.jaxbadapters.JodaDateTimeXMLGregorianCalendarAdapter
 * org.apache.isis.schema.utils.jaxbadapters.JodaLocalTimeXMLGregorianCalendarAdapter

results with warning

{noformat}
JDK internal API (java.xml)Warning: JDK internal APIs are unsupported and private to JDK implementation that aresubject to be removed or changed incompatibly and could break your application.Please modify your code to eliminate dependence on any JDK internal APIs.For the most recent update on JDK internal API replacements, please check:https://wiki.openjdk.java.net/display/JDK8/Java+Dependency+Analysis+Tool
{noformat}

"
ISIS-1829,Bug,Closed,AppManifestAbstract#withFixtureScripts no longer works.,"workaround is to use overrideFixtureScripts

I also think that the inverse of using overrideConfigurationProperties is broken in 1.16.0"
ISIS-1828,Task,Closed,Jdeps analysis of core code-base In preparation for Java 9+,"Let's do a jdeps analysis [1][2] of Isis' code-base and check for uses of deprecated language features.

From that derive Tasks or Issues if any.

[1][https://www.oracle.com/corporate/features/migrating-from-java-8-to-java-9.html]

[2][https://docs.oracle.com/javase/9/migrate/toc.htm#GUID-BA521187-60FD-4CA5-B998-58A1D05587BC]

 "
ISIS-1827,Improvement,Closed,Remove dependencies on guava from isis-core-applib (public API),
ISIS-1826,Improvement,Closed,Add Automatic-Module-Name to support Java 9.,
ISIS-1825,Bug,Closed,"@CollectionLayout(hidden=STANDALONE_COLLECTION) results in scalar panels being hidden when in parented collection, (but the column is still there, ie blank).",
ISIS-1824,Question,Closed,menubars.layout.xml vs Wicket Viewer annotations,"I am trying to use menubars.layout.xml in combination with annotations. I tried to add another primary menu to the simpleApp archetype. I added them as annotations in actions rather than in the maenubars.layout.xml. This doesnot work. The application always picks up what is available in the layout xml and the annotations added in the action are ignored. Is it ot possible to use a combination of menubars.layout.xml and annotations in action files together? I dont find much information in the documentation for this particular scenario.  SO my questions are:

  1. Could you please clarify if we can use either the layout xmls or the annotations and not both at the same time?

2. Are there any other scenarios where these combinations of xml files and annotations dont work together?

3. I tried removing the layout file and try working with only annotations, but that didnt work too. So is it a mandate that we have to use menubars.layout.xml? Cannot we use annotations alone to define the menu layout? "
ISIS-1823,Improvement,Closed,Config property for disabling footer entirly,"Provide a config property in isis.properties that allows disabling of the footer. This is related to ISIS-1025 but not the same.

 "
ISIS-1822,Bug,Closed,non-existent action in menubars.layout.xml causes an NPE,
ISIS-1821,Bug,Closed,Metadata validation failure when no @Nullable is present,"Given an action like ...
{code:java}
@Action
public SimpleObject create(
    @Parameter(optionality=Optionality.MANDATORY)
    String name    ) {
    
    ...
}{code}

Though valid, will provoke a 

{code:java}
Conflicting @Parameter#optionality with other optionality annotation: d.d.SimpleObjects#create(java.lang.String)
{code}
"
ISIS-1820,Bug,Closed,New style BDD tests broken in 1.16.0,"on incode quickstart, get:
cucumber.runtime.CucumberException: You're not allowed to extend classes that define Step Definitions or hooks. class ie.welfare.app.rtrm.appdefn.bdd.specglue.BootstrappingGlue extends class org.apache.isis.core.specsupport.specs.CukeGlueBootstrappingAbstract

inlining code then getting NPEs, ie not injecting in.

~~~
on simpleapp archetype, simply not getting any cucumber.json - doesn't seem to attempt to run the BDD specs

"
ISIS-1819,Sub-task,Closed,Documentation (guide) of where-am-i feature,Take the main issue's examples/comments as a starting point.
ISIS-1818,Improvement,Closed,new config property: max navigable parent chain length,"* new Isis config property: max navigable parent chain length
* infinite loop detection on the navigable parent chain

... and reflect that behavior in code

do this in metamodel's
{code:java}
org.apache.isis.core.metamodel.util.pchain.ParentChain
{code}
.. and/or implementing classes
"
ISIS-1817,Improvement,Closed,new config property that allows to disable the where-am-i feature,"new Isis config property: allow to disable this feature ... and reflect that behavior in code

Do this in viewer-wicket-model's
{code:java}
org.apache.isis.viewer.wicket.model.models.whereami.WhereAmIModelDefault
{code}

"
ISIS-1816,Sub-task,Closed,Specify framework's behavior if multiple @Parent annotations or parent() methods are resolved in the object's hierarchy,"We need a clear specification on how the framework behaves if multiple @Parent annotations or parent() methods are resolved in the object's hierarchy.

And reflect this with code in metamodel's
{code:java}
org.apache.isis.core.metamodel.facets.object.navparent.annotation.NavigableParentAnnotationFacetFactory
{code}
"
ISIS-1815,Improvement,Closed,Log URL for when we get Tomcat ClientConnection closed error (which we think is mostly due to slow response and users getting tired of waiting).,
ISIS-1814,Improvement,Closed,JAXB validator fails requiring @XmlJavaTypeAdapter even if annotated with @XmlTransient,
ISIS-1813,Task,Closed,Release tasks for 1.16.1,
ISIS-1812,Bug,Closed,NPE when attempt to render mixed-in property as a column.,"Bug arises from CSS fix, ISIS-1787

Calling ObjectOneToOneAssociationMixedIn#getOnType() - to obtain the parent type's name to use as the CSS prefix - returns null, so results in an NPE"
ISIS-1811,Task,Closed,Release tasks for 2.0.0-M2,see [Migration Notes|https://github.com/apache/isis/blob/v2/migration-notes.adoc]
ISIS-1810,Task,Closed,Release tasks for 2.0.0-M1,Migration Notes and ToDos are gathered as subtasks.
ISIS-1809,New Feature,Closed,Convenience adapter implementations of UrlEncodingService,
ISIS-1808,Improvement,Closed,"Let the error page be customisable, eg embed an image from randomkittengenerator.com",
ISIS-1807,Wish,Closed,Wrap Domain Entities by default,"Maybe this should be controlled by a new nature on domain services?  Whether to wrap should be ""inherited"", ie if invoke a wrapped domain service then any entities returned would also be wrapped.

~~~~~~

 

This way, all hide/disable/validate constraints, and other constraints/invariants forced through actions, are always ensured by default.

This will require to wrap by default:
 * New Domain Entity instances / objects (ie, changes on FactoryService).
 * Domain Entities returned by queries (ie, changes on RepositoryService).

Users might disable this new default behaviour through configuration, as some projects can prioritize performance (avoiding wrapping invocations) vs Domain constraints/invariants enforcement.

~~~~
 Dan's notes:

I'd like to refine the concept of wrapping while implementing this ticket.

The idea of wrapping was originally to allow the UI to be simulated within integration tests. The intent of this ticket is to formalize the idea of the same set of validations being done automatically between programmatic interactions from one service/entity to another service/entity.

So, the more general concept (common to both UI/domain interactions and domain-to-domain programmatic interactions) is one of _trust boundaries_. If there is no trust from the calling client to the supplying service/entity, then that interaction should be wrapped.

However, the wrapping model as it currently stands is a little bit too UI/domain oriented, in that it has both hidden AND disabled as well as validate phases. From the perspective of a programmatic domain-to-domain interaction there's no meaningful distinction between the hidden and disabled constraints: they both mean: ""that object isn't in a state to be called"". In other words its a pre constraint that is not satisfied.

The other aspect here is that I can imagine that there are actions that we would like to allow to be made programmatically (ie through a wrapper) but which shouldn't be part of the UI. In other words these actions form part of the programmatic API of a module, just not part of its UI.

Putting all this together, I propose that we slightly change the meaning of wrapping (though we'll keep the current implementation too for backwards compatibility), namely that by default wrapped object will check the disable and validate phases only, ie it will _not_ check the hidden phase. This allows such actions to be indicated as hidden (probably using @ActionLayout or .layout.xml or security) but still able to be called programmatically. The disable phase = pre check.

We could define the following terminology:
 - ""default"" wrapping : as described above, checks only disable and validate, not hidden
 - ""strict"" wrapping - for backward compatibility, also checks hidden first

We could define a configuration property:

isis.runtime.wrapping=default | strict | none

with ""default"" wrapping being the default if not specified.

In terms of the programming API, the WrapperFactory#wrap(...) will obviously be less important than it was, because by default objects will be wrapped. For backward compatibilty, I think this should continue to create strict wrappers

The wrap(...) method is also overloaded, with wrap(ExecutionMode). We can extend this enum:
 - EXECUTE - (existing) returns a strict wrapper
 - SKIP_RULES - (existing) skips applying the hidden/disable/validate rules
 - NO_EXECUTE - (existing) applies hidden/disabled/validate, but does not execute
 - DEFAULT - (new) returns a ""default"" wrapper, applies only disable/validate but not hidden

(new:) if the object passed in is already wrapped, then it should be replaced with a wrapper with the specified mode. Prevoiusly this was a no-op, I think.

The unwrap(...) method is unchanged."
ISIS-1806,Bug,Closed,[WON'T FIX] Reinstate ability to bookmark action invocations ,"broken in 1.15.0, and commented out in 1.16.0 to avoid user failures.

The issue is that the BookmarkTreeNode infers a pageType of ACTION_PROMPT, which causes the ActionPromptPage to be rendered.  This in turn has a ComponentType of ACTION_PARAMETERS.  

However, the ActionParametersPromptPanelFactory explicitly does not match for actions that take no arguments, and so the only component found is UnknownPanel which - of course - fails to add the correct ActionParametersPanel component.

This whole area needs reworking ... the ActionParametersPanel now no-longer supports being invoked with no-args or with populated n-args and automatically resolving to the result of the action invocation.  

Instead, will need to move the action execution stuff into the implementation of the AbstractLink that is created within the BookmarkedPagesPanel.

~~

or: maybe we just keep this functionality commented out; is it used anyway ?"
ISIS-1805,Improvement,Closed,PersistenceQueryFindUsingApplibQueryProcessor#getResultsPk looks to be unused.,
ISIS-1804,Improvement,Closed,"Deprecate isis-mavendeps-intellij, fold into isis-mavendeps-webapp",
ISIS-1803,Bug,Closed,Hitting escape twice on prompt results in the error page.,
ISIS-1802,Bug,Closed,JDOQL using SELECT UNIQUE causes NPE to be thrown.,as per https://lists.apache.org/thread.html/4658ae59347ee600242d1bc8fae7afebd912111799aad36b74ac57fd@%3Cusers.isis.apache.org%3E
ISIS-1801,New Feature,Closed,BookmarkUiService to clear Wicket bookmarks and breadcrumbs programmatically.,
ISIS-1800,Improvement,Closed,Blank out apiKey and authToken when listing configuration properties.,
ISIS-1799,Bug,Closed,Extend TransactionService with overload of nextTransaction for more control.,
ISIS-1798,Improvement,Closed,Error page should suppress stack trace if an ErrorReportingService returns a Ticket indicating stack trace should be hidden,
ISIS-1797,Improvement,Closed,"Error page should show a ""Continue"" button to go back to previous page.",
ISIS-1796,Improvement,Closed,Extend info in ErrorDetails for the ErrorReportingService,provide a separate stack trace for each cause in the exception causal chaing
ISIS-1795,Bug,Closed,Error page heading is white-on-white for some themes.,
ISIS-1794,New Feature,Closed,Rework BDD bootstrapping to support app manifest/modules + dependency injection into glue,"ie, IntegrationBootstrapAbstract"
ISIS-1793,New Feature,Closed,Extend MetaModelService to expose the AppManifest used to bootstrap the app,
ISIS-1792,New Feature,Closed,DtoMappingHelper domain service.,
ISIS-1791,New Feature,Closed,provide a ClockFixture and TickingClockFixture,
ISIS-1790,Bug,Closed,[DUPLICATE] Concurrent modification exception at startup,"I have occasionally next exception during startup

{code}

1) Error in custom provider, java.lang.RuntimeException: An error occurred while executing code in a temporary session
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
  while locating org.apache.isis.core.runtime.system.session.IsisSessionFactory
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.isisSessionFactory(IsisWicketApplication.java:155)
  while locating domainapp.webapp.BgwWebApplication

1 error
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:455)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:353)
	at org.eclipse.jetty.servlet.FilterHolder.initialize(FilterHolder.java:139)
	at org.eclipse.jetty.servlet.ServletHandler.initialize(ServletHandler.java:725)
	at org.eclipse.jetty.servlet.ServletContextHandler.startContext(ServletContextHandler.java:348)
	at org.eclipse.jetty.webapp.WebAppContext.startWebapp(WebAppContext.java:1480)
	at org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1442)
	at org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:799)
	at org.eclipse.jetty.servlet.ServletContextHandler.doStart(ServletContextHandler.java:261)
	at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:540)
	at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:68)
	at org.eclipse.jetty.util.component.ContainerLifeCycle.start(ContainerLifeCycle.java:131)
	at org.eclipse.jetty.server.Server.start(Server.java:452)
	at org.eclipse.jetty.util.component.ContainerLifeCycle.doStart(ContainerLifeCycle.java:105)
	at org.eclipse.jetty.server.handler.AbstractHandler.doStart(AbstractHandler.java:113)
	at org.eclipse.jetty.server.Server.doStart(Server.java:419)
	at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:68)
	at org.apache.isis.core.webserver.WebServer.start(WebServer.java:179)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:131)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:98)
	at org.apache.isis.WebServer.main(WebServer.java:25)
Caused by: com.google.inject.ProvisionException: Unable to provision, see the following errors:

1) Error in custom provider, java.lang.RuntimeException: An error occurred while executing code in a temporary session
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
  while locating org.apache.isis.core.runtime.system.session.IsisSessionFactory
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.isisSessionFactory(IsisWicketApplication.java:155)
  while locating domainapp.webapp.BgwWebApplication

1 error
	at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:486)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:67)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:987)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:368)
	at domainapp.webapp.BgwWebApplication.init(BgwWebApplication.java:41)
	at org.apache.wicket.Application.initApplication(Application.java:953)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:429)
	... 20 more
Caused by: java.lang.RuntimeException: An error occurred while executing code in a temporary session
	at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:355)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:319)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:306)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactoryBuilder.buildSessionFactory(IsisSessionFactoryBuilder.java:201)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:118)
	at org.apache.isis.core.runtime.runner.IsisInjectModule$$FastClassByGuice$$a813f90e.invoke(<generated>)
	at com.google.inject.internal.ProviderMethod$FastClassProviderMethod.doProvision(ProviderMethod.java:264)
	at com.google.inject.internal.ProviderMethod$Factory.provision(ProviderMethod.java:401)
	at com.google.inject.internal.ProviderMethod$Factory.get(ProviderMethod.java:376)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1092)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.internal.SingletonScope$1.get(SingletonScope.java:194)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:41)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:54)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:132)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:93)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:80)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1085)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:80)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:62)
	... 25 more
Caused by: java.util.ConcurrentModificationException
	at java.util.HashMap$HashIterator.nextNode(HashMap.java:1437)
	at java.util.HashMap$ValueIterator.next(HashMap.java:1466)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1042)
	at org.apache.isis.core.metamodel.facets.object.domainobject.DomainObjectAnnotationFacetFactory$1.validate(DomainObjectAnnotationFacetFactory.java:555)
	at org.apache.isis.core.metamodel.facets.object.domainobject.DomainObjectAnnotationFacetFactory$1.visit(DomainObjectAnnotationFacetFactory.java:544)
	at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorVisiting.validateSpecs(MetaModelValidatorVisiting.java:81)
	at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorVisiting.validateAll(MetaModelValidatorVisiting.java:57)
	at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorVisiting.validate(MetaModelValidatorVisiting.java:48)
	at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorComposite.validate(MetaModelValidatorComposite.java:60)
	at org.apache.isis.core.metamodel.specloader.SpecificationLoader.validate(SpecificationLoader.java:261)
	at org.apache.isis.core.metamodel.specloader.SpecificationLoader.validateAndAssert(SpecificationLoader.java:251)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactoryBuilder$1.run(IsisSessionFactoryBuilder.java:206)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactory$1.call(IsisSessionFactory.java:322)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactory$1.call(IsisSessionFactory.java:319)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:353)
	... 45 more
{code}
"
ISIS-1789,Bug,Closed,Metamodel validator thinks SQL query is a JDOQL query and fails,"the following SQL Query definition :

{code:java}

@javax.jdo.annotations.Queries(Array(
  new javax.jdo.annotations.Query(
    name = ""findByDescriptiveName"",
    value = ""SELECT ""
      + ""FROM domainapp.modules.system.dom.impl.FileObject ""
      + ""WHERE descriptiveName.indexOf(:descriptiveName) >= 0 ""),
  new javax.jdo.annotations.Query(
    name = ""findByApplicationComponent"",
    language=""SQL"",
    value = ""select fo.* "" +
            "" from "" +
            ""    FileObject fo, "" +
            ""     Component_File cf, "" +
            ""     ComponentObject co, "" +
            ""     Application_Component ac, "" +
            ""     ApplicationObject ao "" +
            "" where "" +
            ""    ao.name = :application and "" +
            ""     ao.application_id = ac.application_id and "" +
            ""     co.component_id = ac.component_id and "" +
            ""     co.name = :component and "" +
            ""     co.component_id = cf.component_id and "" +
            ""     cf.file_id = fo.file_id "",
    resultClass=classOf[FileObject] )
  )
)
{code}

makes the metamodel validator fail thinking that the query type is JDOQL.

{noformat}
domainapp.modules.system.dom.impl.FileObject: error in JDOQL query, class name for FROM clause not recognized (JDOQL : select fo.*  from  	  FileObject fo,      Component_File cf,      ComponentObject co,      Application_Component ac,      ApplicationObject ao  where  	  ao.name = :application and      ao.application_id = ac.application_id and      co.component_id = ac.component_id and      co.name = :component and      co.component_id = cf.component_id and      cf.file_id = fo.file_id )

Please inspect the above messages and correct your domain model.
{noformat}

The validator should ignore SQL query types and let DataNucleus handle it.
"
ISIS-1788,Improvement,Open,[Performance] Reduce the number of calls on a dependent choices field,", should only be called when the preceding param changes.

ref: ECP-396 (editSeller on IncomingDocAsViewModel), in-line prompt."
ISIS-1787,Bug,Closed,Property named 'Active' conflicts with Bootstrap CSS class (optional configuration property to set as a prefix on all CSS classes),"Property names are added as a class to the corresponding HTML element:
!cssclass.png!

For a property named 'Active', this conflicts with the CSS class {{.active}} of Bootstrap, indicating a selected/active element in the UI. In my example, this results in the column of this property in tables being highlighted:

!highlighted.png!
"
ISIS-1786,Improvement,Closed,Allow the default defaultView for collections to be configured globally.,"The current default is officially ""hidden""; ie need to annotate with @CollectionLayout(defaultView=""table"") or the equivalent in the .layout.xml.

This ticket is to introduce a new configuration property that would allow the default used to be set to ""table"", thus obviating the need to explicitly configure everywhere."
ISIS-1785,Bug,Closed,DomainService#menuOrder and DomainServiceLayout#menuOrder are not equivalent,"The Apache Isis documentation mentions that these two options are equivalent:

{code}
     * <p>
     *     Either this attribute or {@link DomainServiceLayout#menuOrder()} can be used; they are equivalent.
     *     Typically this attribute is used for services with a {@link #nature() nature} of
     *     {@link NatureOfService#DOMAIN domain} (these are not visible in the UI) whereas
     *     {@link DomainServiceLayout#menuOrder()} is used for services with a nature of
     *     {@link NatureOfService#VIEW_MENU_ONLY} (which do appear in the UI)
     * </p>
{code}

However, using DomainService#menuOrder on NatureOfService#VIEW_MENU_ONLY services did not appear to work correctly. DomainServiceLayout#menuOrder does appear to be working.

Our application was using DomainService#menuOrder in this [commit|https://github.com/incodehq/ecpcrm/tree/711461c7224ee3e564fb8e6709d34673fb62938d], after which we changed to DomainServiceLayout#menuOrder in the next [commit|https://github.com/incodehq/ecpcrm/tree/154cc56607342870aad1832371e58c1b10eece25]"
ISIS-1784,New Feature,Closed,"Support for the builder pattern for fixtures, along with more flexibility in fixture setup using BuilderScriptAbstract",... and return the previously executed script where necessary whenever a SKIP occurs.
ISIS-1783,Bug,Closed,Prevent classpath scanning from returning services outside the list of (packages of) modules,"due to a bug, it would seem, in the Reflections library"
ISIS-1782,Improvement,Closed,Revamp support for bootstrapping using transitive modules,
ISIS-1781,Bug,Closed,JsonValueConverter as implemented for int->long throws class cast exception,"org.apache.isis.viewer.restfulobjects.rendering.domainobjects.JsonValueConverter failes to convert from int to long.
"
ISIS-1780,Bug,Closed,Unable to remove facets (isis.reflector.facets.exclude),The issue is that we attempt to remove the facet class from a list of *instances* of the facet classes.
ISIS-1779,Improvement,Closed,Transition to JAX-RS 2.0 Client API,"Dedicated Branch
dev/2.0.0/ISIS-1779-jax-rs-2


It seems JEE 8 servers (compliant with JAX-RS 2.1 API) conflict with deployment of resteasy-jaxrs.version 3.x (which is JAX-RS 2.0 API) 

and JEE 7 servers (compliant with JAX-RS 2.0 API) conflict with deployment of resteasy-jaxrs.version 4.x (which is JAX-RS 2.1 API).

So by now there is no easy way to package a war file with resteasy included, that will run on both JEE 7 and 8.

I've successfully tested 
<resteasy-jaxrs.version>4.0.0.Beta1</resteasy-jaxrs.version> on glassfish 5,
<resteasy-jaxrs.version>3.0.17.Final</resteasy-jaxrs.version> on glassfish 4,
<resteasy-jaxrs.version>3.1.4.Final</resteasy-jaxrs.version> on glassfish 4.

Note: transitioning resteasy-jaxrs from 3.0.x to any higher version involves removal of deprecated classes in
org.jboss.resteasy.client.*, which we are using it in core/viewer-resfulobjects-applib.

"
ISIS-1778,Improvement,Closed,"Handle anonymous classes in the metamodel, and ignore also any explicitly annotated as @Programmatic","Motivation: for integration test that pick up unit tests' fixtures on their classpath.

For anonymous classes, we treat them as simply their superclass."
ISIS-1777,Bug,Closed,swagger-ui/index.html in helloworld and simpleapp needs to honor context paths,"As soon as we deploy helloworld or simpleapp with web-app context path the absolute links (/restful/...) provided in 
{{webapp/swagger-ui/index.html}}
will not work.

Proposed fix: 
https://issues.apache.org/jira/browse/ISIS-1775?focusedCommentId=16248942&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-16248942"
ISIS-1776,Improvement,Closed,"Remove lombok from helloworld, to reduce # of concepts need to understand",
ISIS-1775,Improvement,Closed,Context-Path support for SwaggerService,"Let's say we deploy a web-app that has e.g. context path '/simple'.
Then we would need to configure the IsisConfiguration property 'isis.services.swagger.restfulBasePath' (default = '/restful') to '/simple/restful', in order for the swagger-ui to work properly.

We can instead implement o.a.i.c.m.services.SwaggerServiceDefault such that it automatically prefixes the swaggerBasePath with the app's context path (if present).

"
ISIS-1774,Improvement,Closed,Handle N+1 issue for first page and subsequent pages.,"see users ML 
https://lists.apache.org/thread.html/77a07739053fa8d6fa544e60590720e1457e47371d407828ab36846f@%3Cusers.isis.apache.org%3E

One option is to switch to REDIRECT_TO_BUFFER to avoid N+1 issue, provide optional configuration property to revert if required

However, this only handles the first page; subsequent pages will still generate N requests.

Further discussion in email thread."
ISIS-1773,Bug,Closed,default view of a collection seems to be broken,"Setting the default view as implemented and described in ISIS-1151 seems to be broken. 

Also I encountered a similar issue with default view map."
ISIS-1772,New Feature,Closed,Assume @Programmatic for public methods not annotated with @Action (make this configurable).,
ISIS-1771,Improvement,Closed,Restful viewer shows unreadable warnings,"When using RestfulObjects, I get sometimes next warnings

{code}
0:44:18,219  [i18n                 qtp1635985705-32 WARN ]  RESTEASY002142: Multiple resource methods match request. Selecting one.
10:44:18,856  [i18n                 qtp1635985705-31 WARN ]  RESTEASY002142: Multiple resource methods match request. Selecting one.
10:44:19,143  [i18n                 qtp1635985705-31 WARN ]  RESTEASY002142: Multiple resource methods match request. Selecting one.
10:44:19,226  [i18n                 qtp1635985705-14 WARN ]  RESTEASY002142: Multiple resource methods match request. Selecting one.
10:44:19,273  [i18n                 qtp1635985705-14 WARN ]  RESTEASY002142: Multiple resource methods match request. Selecting one.
{code}

After research, I think the reason is known issue in the underlying RESTEasy version - in Isis 1.15.1 we use version '3.0.17.Final' and according to this RESTEasy issue https://issues.jboss.org/browse/RESTEASY-1398 the problem should be fixed since version '3.0.18.Final'.

Possible way would be upgrade to latest RESTEasy version - '3.1.4.Final' or '3.0.24.Final'




"
ISIS-1770,Bug,Closed,REST API action resources with _ARE_YOU_SURE result in NPE,
ISIS-1769,New Feature,Closed,Mixin to navigate to equivalent REST API URL for each domain object.,
ISIS-1768,Bug,Closed,REST API returning 500 not 404 when try to access non-existent object,"eg http://localhost:8080/restful/objects/helloworld.HelloWorldObject/0

generates

{code}
HTTP ERROR 500

Problem accessing /restful/objects/helloworld.HelloWorldObject/0. Reason:

    Server Error
Caused by:

javax.servlet.ServletException: Filtered request failed.
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:384)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1613)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:541)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:190)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1593)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:188)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1239)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:168)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:481)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1562)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:166)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1141)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.Server.handle(Server.java:564)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:279)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:110)
	at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:124)
	at org.eclipse.jetty.util.thread.Invocable.invokePreferred(Invocable.java:122)
	at org.eclipse.jetty.util.thread.strategy.ExecutingExecutionStrategy.invoke(ExecutingExecutionStrategy.java:58)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:201)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:133)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:672)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:590)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.apache.isis.core.commons.exceptions.IsisException: org.apache.isis.core.runtime.persistence.ObjectNotFoundException: Object not found in store with oid helloworld.HelloWorldObject:0
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:198)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:178)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadObjectInTransaction(PersistenceSession.java:927)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.adapterForAny(PersistenceSession.java:1509)
	at org.apache.isis.viewer.restfulobjects.server.util.OidUtils.getObjectAdapter(OidUtils.java:62)
	at org.apache.isis.viewer.restfulobjects.server.util.OidUtils.getObjectAdapterElseNull(OidUtils.java:42)
	at org.apache.isis.viewer.restfulobjects.server.resources.ResourceAbstract.getObjectAdapterElseNull(ResourceAbstract.java:153)
	at org.apache.isis.viewer.restfulobjects.server.resources.ResourceAbstract.getObjectAdapterElseThrowNotFound(ResourceAbstract.java:143)
	at org.apache.isis.viewer.restfulobjects.server.resources.DomainObjectResourceServerside.object(DomainObjectResourceServerside.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:139)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:295)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:249)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:236)
	at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:402)
	at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:209)
	at org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:221)
	at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:56)
	at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:51)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:841)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1634)
	at org.apache.isis.viewer.restfulobjects.server.webapp.IsisTransactionFilterForRestfulObjects.doFilter(IsisTransactionFilterForRestfulObjects.java:50)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.IsisSessionFilter.doFilter(IsisSessionFilter.java:341)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	... 30 more
Caused by: org.apache.isis.core.runtime.persistence.ObjectNotFoundException: Object not found in store with oid helloworld.HelloWorldObject:0
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadPojo(PersistenceSession.java:965)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$2.execute(PersistenceSession.java:935)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$2.execute(PersistenceSession.java:928)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:188)
	... 66 more
Caused by: javax.jdo.JDOObjectNotFoundException: No such database row
FailedObject:0[OID]domainapp.dom.impl.HelloWorldObject
NestedThrowables:
org.datanucleus.exceptions.NucleusObjectNotFoundException: No such database row
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:564)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1728)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1741)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadPojo(PersistenceSession.java:954)
	... 69 more
Caused by: org.datanucleus.exceptions.NucleusObjectNotFoundException: No such database row
	at org.datanucleus.store.rdbms.request.FetchRequest.execute(FetchRequest.java:347)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.fetchObject(RDBMSPersistenceHandler.java:319)
	at org.datanucleus.state.AbstractStateManager.loadFieldsFromDatastore(AbstractStateManager.java:1147)
	at org.datanucleus.state.StateManagerImpl.validate(StateManagerImpl.java:4297)
	at org.datanucleus.ExecutionContextImpl.findObject(ExecutionContextImpl.java:3621)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1723)
	... 71 more
Caused by:

org.apache.isis.core.commons.exceptions.IsisException: org.apache.isis.core.runtime.persistence.ObjectNotFoundException: Object not found in store with oid helloworld.HelloWorldObject:0
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:198)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:178)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadObjectInTransaction(PersistenceSession.java:927)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.adapterForAny(PersistenceSession.java:1509)
	at org.apache.isis.viewer.restfulobjects.server.util.OidUtils.getObjectAdapter(OidUtils.java:62)
	at org.apache.isis.viewer.restfulobjects.server.util.OidUtils.getObjectAdapterElseNull(OidUtils.java:42)
	at org.apache.isis.viewer.restfulobjects.server.resources.ResourceAbstract.getObjectAdapterElseNull(ResourceAbstract.java:153)
	at org.apache.isis.viewer.restfulobjects.server.resources.ResourceAbstract.getObjectAdapterElseThrowNotFound(ResourceAbstract.java:143)
	at org.apache.isis.viewer.restfulobjects.server.resources.DomainObjectResourceServerside.object(DomainObjectResourceServerside.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:139)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:295)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:249)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:236)
	at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:402)
	at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:209)
	at org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:221)
	at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:56)
	at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:51)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:841)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1634)
	at org.apache.isis.viewer.restfulobjects.server.webapp.IsisTransactionFilterForRestfulObjects.doFilter(IsisTransactionFilterForRestfulObjects.java:50)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.IsisSessionFilter.doFilter(IsisSessionFilter.java:341)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1613)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:541)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:190)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1593)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:188)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1239)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:168)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:481)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1562)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:166)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1141)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.Server.handle(Server.java:564)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:279)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:110)
	at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:124)
	at org.eclipse.jetty.util.thread.Invocable.invokePreferred(Invocable.java:122)
	at org.eclipse.jetty.util.thread.strategy.ExecutingExecutionStrategy.invoke(ExecutingExecutionStrategy.java:58)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:201)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:133)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:672)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:590)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.apache.isis.core.runtime.persistence.ObjectNotFoundException: Object not found in store with oid helloworld.HelloWorldObject:0
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadPojo(PersistenceSession.java:965)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$2.execute(PersistenceSession.java:935)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$2.execute(PersistenceSession.java:928)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:188)
	... 66 more
Caused by: javax.jdo.JDOObjectNotFoundException: No such database row
FailedObject:0[OID]domainapp.dom.impl.HelloWorldObject
NestedThrowables:
org.datanucleus.exceptions.NucleusObjectNotFoundException: No such database row
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:564)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1728)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1741)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadPojo(PersistenceSession.java:954)
	... 69 more
Caused by: org.datanucleus.exceptions.NucleusObjectNotFoundException: No such database row
	at org.datanucleus.store.rdbms.request.FetchRequest.execute(FetchRequest.java:347)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.fetchObject(RDBMSPersistenceHandler.java:319)
	at org.datanucleus.state.AbstractStateManager.loadFieldsFromDatastore(AbstractStateManager.java:1147)
	at org.datanucleus.state.StateManagerImpl.validate(StateManagerImpl.java:4297)
	at org.datanucleus.ExecutionContextImpl.findObject(ExecutionContextImpl.java:3621)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1723)
	... 71 more
Caused by:

org.apache.isis.core.runtime.persistence.ObjectNotFoundException: Object not found in store with oid helloworld.HelloWorldObject:0
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadPojo(PersistenceSession.java:965)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$2.execute(PersistenceSession.java:935)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$2.execute(PersistenceSession.java:928)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:188)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:178)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadObjectInTransaction(PersistenceSession.java:927)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.adapterForAny(PersistenceSession.java:1509)
	at org.apache.isis.viewer.restfulobjects.server.util.OidUtils.getObjectAdapter(OidUtils.java:62)
	at org.apache.isis.viewer.restfulobjects.server.util.OidUtils.getObjectAdapterElseNull(OidUtils.java:42)
	at org.apache.isis.viewer.restfulobjects.server.resources.ResourceAbstract.getObjectAdapterElseNull(ResourceAbstract.java:153)
	at org.apache.isis.viewer.restfulobjects.server.resources.ResourceAbstract.getObjectAdapterElseThrowNotFound(ResourceAbstract.java:143)
	at org.apache.isis.viewer.restfulobjects.server.resources.DomainObjectResourceServerside.object(DomainObjectResourceServerside.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:139)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:295)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:249)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:236)
	at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:402)
	at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:209)
	at org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:221)
	at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:56)
	at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:51)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:841)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1634)
	at org.apache.isis.viewer.restfulobjects.server.webapp.IsisTransactionFilterForRestfulObjects.doFilter(IsisTransactionFilterForRestfulObjects.java:50)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.IsisSessionFilter.doFilter(IsisSessionFilter.java:341)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1613)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:541)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:190)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1593)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:188)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1239)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:168)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:481)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1562)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:166)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1141)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.Server.handle(Server.java:564)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:279)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:110)
	at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:124)
	at org.eclipse.jetty.util.thread.Invocable.invokePreferred(Invocable.java:122)
	at org.eclipse.jetty.util.thread.strategy.ExecutingExecutionStrategy.invoke(ExecutingExecutionStrategy.java:58)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:201)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:133)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:672)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:590)
	at java.lang.Thread.run(Thread.java:745)
Caused by: javax.jdo.JDOObjectNotFoundException: No such database row
FailedObject:0[OID]domainapp.dom.impl.HelloWorldObject
NestedThrowables:
org.datanucleus.exceptions.NucleusObjectNotFoundException: No such database row
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:564)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1728)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1741)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadPojo(PersistenceSession.java:954)
	... 69 more
Caused by: org.datanucleus.exceptions.NucleusObjectNotFoundException: No such database row
	at org.datanucleus.store.rdbms.request.FetchRequest.execute(FetchRequest.java:347)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.fetchObject(RDBMSPersistenceHandler.java:319)
	at org.datanucleus.state.AbstractStateManager.loadFieldsFromDatastore(AbstractStateManager.java:1147)
	at org.datanucleus.state.StateManagerImpl.validate(StateManagerImpl.java:4297)
	at org.datanucleus.ExecutionContextImpl.findObject(ExecutionContextImpl.java:3621)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1723)
	... 71 more
Caused by:

javax.jdo.JDOObjectNotFoundException: No such database row
FailedObject:0[OID]domainapp.dom.impl.HelloWorldObject
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:564)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1728)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1741)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadPojo(PersistenceSession.java:954)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$2.execute(PersistenceSession.java:935)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$2.execute(PersistenceSession.java:928)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:188)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:178)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadObjectInTransaction(PersistenceSession.java:927)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.adapterForAny(PersistenceSession.java:1509)
	at org.apache.isis.viewer.restfulobjects.server.util.OidUtils.getObjectAdapter(OidUtils.java:62)
	at org.apache.isis.viewer.restfulobjects.server.util.OidUtils.getObjectAdapterElseNull(OidUtils.java:42)
	at org.apache.isis.viewer.restfulobjects.server.resources.ResourceAbstract.getObjectAdapterElseNull(ResourceAbstract.java:153)
	at org.apache.isis.viewer.restfulobjects.server.resources.ResourceAbstract.getObjectAdapterElseThrowNotFound(ResourceAbstract.java:143)
	at org.apache.isis.viewer.restfulobjects.server.resources.DomainObjectResourceServerside.object(DomainObjectResourceServerside.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:139)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:295)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:249)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:236)
	at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:402)
	at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:209)
	at org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:221)
	at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:56)
	at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:51)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:841)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1634)
	at org.apache.isis.viewer.restfulobjects.server.webapp.IsisTransactionFilterForRestfulObjects.doFilter(IsisTransactionFilterForRestfulObjects.java:50)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.IsisSessionFilter.doFilter(IsisSessionFilter.java:341)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1613)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:541)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:190)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1593)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:188)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1239)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:168)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:481)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1562)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:166)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1141)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.Server.handle(Server.java:564)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:279)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:110)
	at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:124)
	at org.eclipse.jetty.util.thread.Invocable.invokePreferred(Invocable.java:122)
	at org.eclipse.jetty.util.thread.strategy.ExecutingExecutionStrategy.invoke(ExecutingExecutionStrategy.java:58)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:201)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:133)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:672)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:590)
	at java.lang.Thread.run(Thread.java:745)
NestedThrowablesStackTrace:
No such database row
org.datanucleus.exceptions.NucleusObjectNotFoundException: No such database row
	at org.datanucleus.store.rdbms.request.FetchRequest.execute(FetchRequest.java:347)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.fetchObject(RDBMSPersistenceHandler.java:319)
	at org.datanucleus.state.AbstractStateManager.loadFieldsFromDatastore(AbstractStateManager.java:1147)
	at org.datanucleus.state.StateManagerImpl.validate(StateManagerImpl.java:4297)
	at org.datanucleus.ExecutionContextImpl.findObject(ExecutionContextImpl.java:3621)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1723)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1741)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadPojo(PersistenceSession.java:954)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$2.execute(PersistenceSession.java:935)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$2.execute(PersistenceSession.java:928)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:188)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:178)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadObjectInTransaction(PersistenceSession.java:927)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.adapterForAny(PersistenceSession.java:1509)
	at org.apache.isis.viewer.restfulobjects.server.util.OidUtils.getObjectAdapter(OidUtils.java:62)
	at org.apache.isis.viewer.restfulobjects.server.util.OidUtils.getObjectAdapterElseNull(OidUtils.java:42)
	at org.apache.isis.viewer.restfulobjects.server.resources.ResourceAbstract.getObjectAdapterElseNull(ResourceAbstract.java:153)
	at org.apache.isis.viewer.restfulobjects.server.resources.ResourceAbstract.getObjectAdapterElseThrowNotFound(ResourceAbstract.java:143)
	at org.apache.isis.viewer.restfulobjects.server.resources.DomainObjectResourceServerside.object(DomainObjectResourceServerside.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:139)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:295)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:249)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:236)
	at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:402)
	at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:209)
	at org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:221)
	at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:56)
	at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:51)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:841)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1634)
	at org.apache.isis.viewer.restfulobjects.server.webapp.IsisTransactionFilterForRestfulObjects.doFilter(IsisTransactionFilterForRestfulObjects.java:50)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.IsisSessionFilter.doFilter(IsisSessionFilter.java:341)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1613)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:541)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:190)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1593)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:188)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1239)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:168)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:481)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1562)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:166)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1141)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.Server.handle(Server.java:564)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:279)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:110)
	at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:124)
	at org.eclipse.jetty.util.thread.Invocable.invokePreferred(Invocable.java:122)
	at org.eclipse.jetty.util.thread.strategy.ExecutingExecutionStrategy.invoke(ExecutingExecutionStrategy.java:58)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:201)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:133)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:672)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:590)
	at java.lang.Thread.run(Thread.java:745)
Caused by:

No such database row
org.datanucleus.exceptions.NucleusObjectNotFoundException: No such database row
	at org.datanucleus.store.rdbms.request.FetchRequest.execute(FetchRequest.java:347)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.fetchObject(RDBMSPersistenceHandler.java:319)
	at org.datanucleus.state.AbstractStateManager.loadFieldsFromDatastore(AbstractStateManager.java:1147)
	at org.datanucleus.state.StateManagerImpl.validate(StateManagerImpl.java:4297)
	at org.datanucleus.ExecutionContextImpl.findObject(ExecutionContextImpl.java:3621)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1723)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1741)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadPojo(PersistenceSession.java:954)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$2.execute(PersistenceSession.java:935)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$2.execute(PersistenceSession.java:928)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:188)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:178)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadObjectInTransaction(PersistenceSession.java:927)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.adapterForAny(PersistenceSession.java:1509)
	at org.apache.isis.viewer.restfulobjects.server.util.OidUtils.getObjectAdapter(OidUtils.java:62)
	at org.apache.isis.viewer.restfulobjects.server.util.OidUtils.getObjectAdapterElseNull(OidUtils.java:42)
	at org.apache.isis.viewer.restfulobjects.server.resources.ResourceAbstract.getObjectAdapterElseNull(ResourceAbstract.java:153)
	at org.apache.isis.viewer.restfulobjects.server.resources.ResourceAbstract.getObjectAdapterElseThrowNotFound(ResourceAbstract.java:143)
	at org.apache.isis.viewer.restfulobjects.server.resources.DomainObjectResourceServerside.object(DomainObjectResourceServerside.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:139)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:295)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:249)
	at org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:236)
	at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:402)
	at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:209)
	at org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:221)
	at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:56)
	at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:51)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:841)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1634)
	at org.apache.isis.viewer.restfulobjects.server.webapp.IsisTransactionFilterForRestfulObjects.doFilter(IsisTransactionFilterForRestfulObjects.java:50)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.IsisSessionFilter.doFilter(IsisSessionFilter.java:341)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1613)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:541)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:190)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1593)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:188)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1239)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:168)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:481)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1562)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:166)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1141)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.Server.handle(Server.java:564)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:279)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:110)
	at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:124)
	at org.eclipse.jetty.util.thread.Invocable.invokePreferred(Invocable.java:122)
	at org.eclipse.jetty.util.thread.strategy.ExecutingExecutionStrategy.invoke(ExecutingExecutionStrategy.java:58)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:201)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:133)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:672)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:590)
	at java.lang.Thread.run(Thread.java:745)
{code}
"
ISIS-1767,Improvement,Closed,[Duplicate] JEE 7+ Support,"Collective tasks for Java EE 7+ support.

Designated branch ...
{code}dev/2.0.0/ISIS-1767-jee-7{code}

+Tests+
* *Server*: JEE 7+ implementation (or similar), launched with JDK8 (Version 1.8.0_152); for deployment we use the HelloWorld artifact 1.15.1 with minor modifications
* *fat-war*: deploy all dependencies with single war (hsqldb in memory)
* *skinny-war*: prepare container with shared libraries and shared domain objects, deploy only a subset of domain classes with single war (hsqldb in memory)
* *restEasy*: check whether restEasy responds
* managed connection pool (*con.pool*): use mysql db connection pool managed by the JEE container and provided via JNDI
* domain events (*dom.events*): test whether domain events are emitted and handled using AxonFramework's SimpleEventBus
* *swagger-ui*: test whether the static index.html from swagger-ui is served and verify that a request for '/<app-context>/restful/swagger/private' returns a JSON, that has the 'basePath' set to '/<app-context>/restful'
* *redeploy*: test whether all previous tests succeed if we do a deploy-undeploy-deploy process

||Server                  ||fat-war                     ||skinny-war             ||restEasy               ||con.pool               ||dom.events       		||swagger-ui       		||redeploy||
|Payara (full 4.1.2.173)  |{color:green}*OK*{color}     |{color:green}*OK*{color}|{color:green}*OK*{color}|{color:green}*OK*{color}|{color:green}*OK*{color}|{color:green}*OK*{color}|{color:green}*OK*{color}(6)|
|Payara (web 4.1.2.173)   |{color:green}*OK*{color}     |{color:green}*OK*{color}|{color:green}*OK*{color}|{color:green}*OK*{color}|{color:green}*OK*{color}|{color:green}*OK*{color}|{color:green}*OK*{color}(6)|
|Glassfish (full 4.1.2)   |*OK*(1)                      |*OK*(1)                 |{color:green}*OK*{color}|todo                    |{color:green}*OK*{color}|{color:green}*OK*{color}|{color:green}*OK*{color}(6)|
|Glassfish (web 5.0.1 beta)|{color:green}*OK*{color}    |{color:green}*OK*{color}|*OK*(5)|todo               |{color:green}*OK*{color}|{color:green}*OK*{color}|todo|
|Glassfish (full 5.0)     |{color:red}*FAILED*(2){color}|todo                    |todo                    |todo                    |todo                    |todo                    |todo|
|Wildfly (full 11.0.0)    |{color:red}*FAILED*(3){color}|todo                    |todo                    |todo                    |todo                    |todo                    |todo|
|TomEE (plume 7.0.4)      |*OK*(4)                      |todo                    |{color:green}*OK*{color}|todo                    |todo                    |todo                    |todo|

Notes:

(1) 
Guava version conflict: GF 4.2.1 has Guava-13, Isis has Guava-19; 
WORKAROUND modify your glassfish installation ...
* in glassfish/modules/ replace guava.jar with that which comes packaged with Payara-4.1.2.173 (Guava-19)
* you need to clear the OSGI cache: delete the folder glassfish/domains/domainXXX/osgi-cache/felix

(2)
ON-HOLD waiting for GF 5.0.1 release!
class-loading issues with Hibernate Validator, though library is included in war ... java.lang.ClassNotFoundException: org.joda.time.ReadableInstant;
using patch https://github.com/hibernate/hibernate-validator/pull/857/files does not help: introduces new class-loading issues;

(3)
class-loading issues, though library is included in war ... javax.persistence.PersistenceException: WFLYJPA0057: PersistenceProvider 'org.apache.isis.core.webapp.jee.PersistenceUnitNoopProvider' not found;

(4) 
requires CXF to be disabled, see https://stackoverflow.com/questions/41496204/tomee-7-0-2-how-to-disable-cxf-rs 
throws exceptions on undeploy

(5)
JAX-RS API version clash
requires <resteasy-jaxrs.version>4.0.0.Beta1</resteasy-jaxrs.version>
see https://issues.apache.org/jira/browse/ISIS-1779

(6)	
successfully tested against DN-5.1.5-SNAPSHOT (dedicated issue https://issues.apache.org/jira/browse/ISIS-1754)

"
ISIS-1766,New Feature,Closed,Allow Xxx.layout.xml and menu.layout.xml to be served up as JSON via REST API,"(dependent upon Accept Content header).

Both Jackson and Moxy recognise JAXB annotations to serialize as JSON."
ISIS-1765,New Feature,Closed,Extend menu.layout.xml to include HATEOAS links when served by REST API.,
ISIS-1764,New Feature,Closed,"Expose the ""layout"" resource for domain objects via REST API, with HATEOAS links.",
ISIS-1763,Improvement,Closed,Change @DomainObject#bounded (a boolean) to @DomainObject#bounding (an enum),"required in support of meta annotations, ISIS-1632."
ISIS-1762,Improvement,Closed,Java 8+ Miscellaneous Utilities,"Introducing a collection of utility classes not meant to be public API. The goal is to simplify recurring code idioms within Isis' code base.

Such idioms are null-checks, lazy values and exception handling.



"
ISIS-1761,Bug,Closed,Hiding empty fieldset + similar issues with contributed props/colls.,"as per https://lists.apache.org/thread.html/b4e2d76d8da40e26df142d239eed37ca807e8694d13dd472a3858f5e@%3Cusers.isis.apache.org%3E

see also ISIS-1739."
ISIS-1760,New Feature,Closed,[NOT A PROBLEM] Integration of Apache Isis and Ignite,"as per https://lists.apache.org/thread.html/2f6a146ff2a2b623d6006ced32ad8c86c521dafe9b15af64522940a7@%3Cusers.isis.apache.org%3E


example app:
https://bitbucket.org/dhamapurkar/isisignitesample"
ISIS-1759,Improvement,Closed,Always calling getXxx() and hideXxx() both decreases performance of application (?),as per https://lists.apache.org/thread.html/6eb586e378bf239891189791b214f0a4b44e12ae4f1ddd0c49478d78@%3Cusers.isis.apache.org%3E
ISIS-1758,Improvement,Closed,cssClass() not working any more if css class definition exists on DomainObjectLayout,as per https://lists.apache.org/thread.html/2f228e10680b7f65a520c1bf47042ec8bba14602e61b9b56d90393b3@%3Cusers.isis.apache.org%3E
ISIS-1757,Sub-task,Closed,[Duplicate] JEE Support - container-provided connection pools,"as per https://lists.apache.org/thread.html/a815c6d3e50c02111d0cd3df93b70b529c18193f321e613b116119b4@%3Cdev.isis.apache.org%3E

I use JEE container provided connection pools and bind them to  Isis/JDO via JNDI. I'm not an expert on this, but I believe this works  totally sane."
ISIS-1756,Improvement,Closed,JEE Support - proper life-cycling,"as per https://lists.apache.org/thread.html/a815c6d3e50c02111d0cd3df93b70b529c18193f321e613b116119b4@%3Cdev.isis.apache.org%3E

The isis-context needs a proper lifecycling, meaning a  deploy/undeploy cycle should properly invalidate any state. (e.g meta model validation is currently not cleared after an undeploy, in my case after calling IsisContext.testReset())"
ISIS-1755,Improvement,Closed,JEE Support - let CDI ignore certain beans,"as per https://lists.apache.org/thread.html/a815c6d3e50c02111d0cd3df93b70b529c18193f321e613b116119b4@%3Cdev.isis.apache.org%3E

During JEE-Application bootstrapping the JEE container identifies a 
list of Isis classes it feels responsible for, but does not know how to 
instantiate; so errors are thrown. For me it was sufficient to provide a 
single stateless JEE bean that states, that it produces all these 
classes. As long as you deploy your Isis application including this 
dummy-bean, CDI does not complain.
"
ISIS-1754,Sub-task,Closed,JEE Support - Investigate Class Loading on Payara 4.1.2,"Investigating whether there are class-loading issues specifically on Payara (full 4.1.2.173). 

This requires a proper test case:
* skinny-war scenario with shared libraries
* test deployment
* also test a deploy/undeploy/deploy cycle

This issue will be closed, once this test-case is developed, automated and tests are successful. 



"
ISIS-1753,Improvement,Closed,Plugable support for guava and axon event bus implementation.,"Because Axon does not queue dispatching, whereas guava doesn't allow event bus calls to be nested."
ISIS-1752,New Feature,Closed,"Extend RO viewer, return a menu.layout.xml resource",and as part of commits tagged ISIS-1766
ISIS-1751,Wish,Open,[Wish] Verify Isis Applib backward compatibility (was: History of API changes for Isis AppLib since 1.8.0),"Hi,

I'd like to share report on API changes and backward binary compatibility for the Isis AppLib library: https://abi-laboratory.pro/java/tracker/timeline/isis-core-applib/

The report is generated by the https://github.com/lvc/japi-tracker tool for jars found at http://central.maven.org/maven2/org/apache/isis/core/isis-core-applib/ according to the article https://wiki.eclipse.org/Evolving_Java-based_APIs_2.

The tool checks all public API methods and classes by default. Please let me know if it should not check some parts of the API (private, undocumented, etc.).

Thank you.

!isis-core-applib-2.png|API symbols timeline!
!isis-core-applib-1.png|API changes review!"
ISIS-1750,Bug,Closed,SQL Exception when invoke action (inline prompt) not handled correctly in UI,"Invoked an action that threw SQL exception due to DB constraint being hit.

reproduce: 
* github shaId: ca2923908b4f2c3f07b088c79e698bdd849fb48d, 
* bitbucket shaId: 3df4e10b5d3f8f584ffb7bb468ebc2c337d659ea

using org.estatio.app.EstatioEcpAppManifestWithDemoFixture
http://localhost:8080/wicket/entity/orders.OrderItem:2
editCharge : WORKS -> MARKETING

What I see is that the prompt doesn't change when hit OK (this is a single autoComplete parameter), and in the browser we see a Javascript error, and the following stacktrace server-side:

{code}
14:09:37,954 [TitleFacetViaTitleMethod      ] title failure
javax.jdo.JDODataStoreException: Update of object ""org.estatio.capex.dom.order.OrderItem@a0ac5fc"" using statement ""UPDATE ""dbo"".""OrderItem"" SET ""chargeId""=?, ""version""=? WHERE ""id""=?"" failed : java.sql.SQLIntegrityConstraintViolationException: integrity constraint violation: unique constraint or index violation; ""OrderItem_order_charge_UNQ"" table: ""OrderItem""
	at org.hsqldb.jdbc.JDBCUtil.sqlException(Unknown Source)
	at org.hsqldb.jdbc.JDBCUtil.sqlException(Unknown Source)
	at org.hsqldb.jdbc.JDBCPreparedStatement.fetchResult(Unknown Source)
	at org.hsqldb.jdbc.JDBCPreparedStatement.executeUpdate(Unknown Source)
	at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeUpdate(NewProxyPreparedStatement.java:105)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeUpdate(ParamLoggingPreparedStatement.java:393)
	at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:431)
	at org.datanucleus.store.rdbms.request.UpdateRequest.execute(UpdateRequest.java:395)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateObjectInTable(RDBMSPersistenceHandler.java:409)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateObject(RDBMSPersistenceHandler.java:383)
	at org.datanucleus.state.StateManagerImpl.flush(StateManagerImpl.java:4585)
	at org.datanucleus.flush.FlushOrdered.execute(FlushOrdered.java:106)
	at org.datanucleus.ExecutionContextImpl.flushInternal(ExecutionContextImpl.java:4054)
	at org.datanucleus.store.query.Query.prepareDatastore(Query.java:1647)
	at org.datanucleus.store.query.Query.executeQuery(Query.java:1832)
	at org.datanucleus.store.query.Query.executeWithMap(Query.java:1762)
	at org.datanucleus.api.jdo.JDOQuery.executeWithMap(JDOQuery.java:346)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.queries.PersistenceQueryFindUsingApplibQueryProcessor.getResults(PersistenceQueryFindUsingApplibQueryProcessor.java:117)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.queries.PersistenceQueryFindUsingApplibQueryProcessor.process(PersistenceQueryFindUsingApplibQueryProcessor.java:57)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.queries.PersistenceQueryFindUsingApplibQueryProcessor.process(PersistenceQueryFindUsingApplibQueryProcessor.java:41)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.processPersistenceQuery(PersistenceSession.java:606)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.access$000(PersistenceSession.java:147)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$1.execute(PersistenceSession.java:567)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$1.execute(PersistenceSession.java:564)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:188)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:178)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.findInstancesInTransaction(PersistenceSession.java:563)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.allMatchingQuery(PersistenceSession.java:530)
	at org.apache.isis.core.runtime.services.persistsession.PersistenceSessionServiceInternalDefault.allMatchingQuery(PersistenceSessionServiceInternalDefault.java:171)
	at org.apache.isis.core.metamodel.services.repository.RepositoryServiceInternalDefault.submitQuery(RepositoryServiceInternalDefault.java:173)
	at org.apache.isis.core.metamodel.services.repository.RepositoryServiceInternalDefault.allMatches(RepositoryServiceInternalDefault.java:169)
	at org.apache.isis.core.metamodel.services.container.DomainObjectContainerDefault.allMatches(DomainObjectContainerDefault.java:495)
	at org.apache.isis.applib.AbstractContainedObject.allMatches(AbstractContainedObject.java:289)
	at org.estatio.dom.UdoDomainRepositoryAndFactory.allMatches(UdoDomainRepositoryAndFactory.java:69)
	at org.estatio.capex.dom.orderinvoice.OrderItemInvoiceItemLinkRepository.findByOrderItem(OrderItemInvoiceItemLinkRepository.java:76)
	at org.estatio.capex.dom.orderinvoice.OrderItemInvoiceItemLinkRepository.calculateNetAmountLinkedToOrderItem(OrderItemInvoiceItemLinkRepository.java:126)
	at org.estatio.capex.dom.order.OrderItem.netAmountInvoiced(OrderItem.java:507)
	at org.estatio.capex.dom.order.OrderItem.netAmountOutstanding(OrderItem.java:502)
	at org.estatio.capex.dom.order.OrderItem.title(OrderItem.java:145)
	at sun.reflect.GeneratedMethodAccessor457.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.adapter.ObjectAdapter$InvokeUtils.invoke(ObjectAdapter.java:373)
	at org.apache.isis.core.metamodel.facets.object.title.methods.TitleFacetViaTitleMethod.title(TitleFacetViaTitleMethod.java:68)
	at org.apache.isis.core.metamodel.facets.object.domainobjectlayout.TitleFacetViaDomainObjectLayoutAnnotationUsingTitleUiEvent.title(TitleFacetViaDomainObjectLayoutAnnotationUsingTitleUiEvent.java:108)
	at org.apache.isis.core.metamodel.facets.object.title.TitleFacetAbstract.title(TitleFacetAbstract.java:42)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectSpecificationAbstract.getTitle(ObjectSpecificationAbstract.java:397)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectSpecificationAbstract.getTitle(ObjectSpecificationAbstract.java:389)
	at org.apache.isis.core.metamodel.services.title.TitleServiceDefault.titleOf(TitleServiceDefault.java:42)
	at org.isisaddons.module.publishmq.dom.jdo.spi.InteractionExecutionRepositoryJdo.buildTitle(InteractionExecutionRepositoryJdo.java:75)
	at org.isisaddons.module.publishmq.dom.jdo.spi.InteractionExecutionRepositoryJdo.persist(InteractionExecutionRepositoryJdo.java:64)
	at org.isisaddons.module.publishmq.dom.servicespi.PublisherServiceUsingActiveMq.persist(PublisherServiceUsingActiveMq.java:200)
	at org.isisaddons.module.publishmq.dom.servicespi.PublisherServiceUsingActiveMq.publish(PublisherServiceUsingActiveMq.java:150)
	at org.apache.isis.core.runtime.services.publish.PublishingServiceInternalDefault.publishToPublisherServices(PublishingServiceInternalDefault.java:400)
	at org.apache.isis.core.runtime.services.publish.PublishingServiceInternalDefault.publishAction(PublishingServiceInternalDefault.java:235)
	at sun.reflect.GeneratedMethodAccessor517.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.isis.core.runtime.services.ServiceInstantiator$2.invoke(ServiceInstantiator.java:219)
	at org.apache.isis.core.runtime.services.publish.PublishingServiceInternalDefault_$$_jvst45b_8.publishAction(PublishingServiceInternalDefault_$$_jvst45b_8.java)
	at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.doInvoke(ActionInvocationFacetForDomainEventAbstract.java:343)
	at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$1.execute(ActionInvocationFacetForDomainEventAbstract.java:164)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:142)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:132)
	at org.apache.isis.core.runtime.services.persistsession.PersistenceSessionServiceInternalDefault.executeWithinTransaction(PersistenceSessionServiceInternalDefault.java:181)
	at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.invoke(ActionInvocationFacetForDomainEventAbstract.java:160)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeInternal(ObjectActionDefault.java:400)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.execute(ObjectActionDefault.java:389)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeWithRuleChecking(ObjectActionDefault.java:370)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.executeAction(ActionModel.java:460)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.load(ActionModel.java:439)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.load(ActionModel.java:76)
	at org.apache.wicket.model.LoadableDetachableModel.getObject(LoadableDetachableModel.java:135)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.execute(ActionModel.java:564)
	at org.apache.isis.viewer.wicket.ui.components.actions.ActionFormExecutorStrategy.obtainResultAdapter(ActionFormExecutorStrategy.java:72)
	at org.apache.isis.viewer.wicket.ui.panels.FormExecutorDefault.obtainResultAdapter(FormExecutorDefault.java:514)
	at org.apache.isis.viewer.wicket.ui.panels.FormExecutorDefault.executeAndProcessResults(FormExecutorDefault.java:145)
	at org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract.onOkSubmittedOf(PromptFormAbstract.java:228)
	at org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract.access$000(PromptFormAbstract.java:60)
	at org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract$1.onSubmit(PromptFormAbstract.java:122)
	at org.apache.wicket.ajax.markup.html.form.AjaxButton$1.onSubmit(AjaxButton.java:113)
	at org.apache.wicket.ajax.form.AjaxFormSubmitBehavior$AjaxFormSubmitter.onSubmit(AjaxFormSubmitBehavior.java:215)
	at org.apache.wicket.markup.html.form.Form.delegateSubmit(Form.java:1307)
	at org.apache.wicket.markup.html.form.Form.process(Form.java:976)
	at org.apache.isis.viewer.wicket.ui.panels.FormAbstract.process(FormAbstract.java:77)
	at org.apache.wicket.markup.html.form.Form.onFormSubmitted(Form.java:797)
	at org.apache.wicket.ajax.form.AjaxFormSubmitBehavior.onEvent(AjaxFormSubmitBehavior.java:171)
	at org.apache.wicket.ajax.AjaxEventBehavior.respond(AjaxEventBehavior.java:155)
	at org.apache.wicket.ajax.AbstractDefaultAjaxBehavior.onRequest(AbstractDefaultAjaxBehavior.java:601)
	at sun.reflect.GeneratedMethodAccessor481.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.wicket.RequestListenerInterface.internalInvoke(RequestListenerInterface.java:258)
	at org.apache.wicket.RequestListenerInterface.invoke(RequestListenerInterface.java:241)
	at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.invokeListener(ListenerInterfaceRequestHandler.java:248)
	at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.respond(ListenerInterfaceRequestHandler.java:234)
	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:895)
	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:265)
	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:222)
	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:293)
	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:261)
	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:203)
	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:284)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.togglz.servlet.TogglzFilter.doFilter(TogglzFilter.java:100)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1613)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:541)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:190)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1593)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:188)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1239)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:168)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:481)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1562)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:166)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1141)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.Server.handle(Server.java:564)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:279)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:110)
	at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:124)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:672)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:590)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.hsqldb.HsqlException: integrity constraint violation: unique constraint or index violation; ""OrderItem_order_charge_UNQ"" table: ""OrderItem""
	at org.hsqldb.error.Error.error(Unknown Source)
	at org.hsqldb.Constraint.getException(Unknown Source)
	at org.hsqldb.index.IndexAVLMemory.insert(Unknown Source)
	at org.hsqldb.persist.RowStoreAVL.indexRow(Unknown Source)
	at org.hsqldb.TransactionManager2PL.addInsertAction(Unknown Source)
	at org.hsqldb.Session.addInsertAction(Unknown Source)
	at org.hsqldb.Table.insertSingleRow(Unknown Source)
	at org.hsqldb.StatementDML.update(Unknown Source)
	at org.hsqldb.StatementDML.executeUpdateStatement(Unknown Source)
	at org.hsqldb.StatementDML.getResult(Unknown Source)
	at org.hsqldb.StatementDMQL.execute(Unknown Source)
	at org.hsqldb.Session.executeCompiledStatement(Unknown Source)
	at org.hsqldb.Session.execute(Unknown Source)
	... 141 more

	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)
	at org.datanucleus.api.jdo.JDOQuery.executeWithMap(JDOQuery.java:363)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.queries.PersistenceQueryFindUsingApplibQueryProcessor.getResults(PersistenceQueryFindUsingApplibQueryProcessor.java:117)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.queries.PersistenceQueryFindUsingApplibQueryProcessor.process(PersistenceQueryFindUsingApplibQueryProcessor.java:57)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.queries.PersistenceQueryFindUsingApplibQueryProcessor.process(PersistenceQueryFindUsingApplibQueryProcessor.java:41)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.processPersistenceQuery(PersistenceSession.java:606)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.access$000(PersistenceSession.java:147)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$1.execute(PersistenceSession.java:567)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$1.execute(PersistenceSession.java:564)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:188)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:178)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.findInstancesInTransaction(PersistenceSession.java:563)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.allMatchingQuery(PersistenceSession.java:530)
	at org.apache.isis.core.runtime.services.persistsession.PersistenceSessionServiceInternalDefault.allMatchingQuery(PersistenceSessionServiceInternalDefault.java:171)
	at org.apache.isis.core.metamodel.services.repository.RepositoryServiceInternalDefault.submitQuery(RepositoryServiceInternalDefault.java:173)
	at org.apache.isis.core.metamodel.services.repository.RepositoryServiceInternalDefault.allMatches(RepositoryServiceInternalDefault.java:169)
	at org.apache.isis.core.metamodel.services.container.DomainObjectContainerDefault.allMatches(DomainObjectContainerDefault.java:495)
	at org.apache.isis.applib.AbstractContainedObject.allMatches(AbstractContainedObject.java:289)
	at org.estatio.dom.UdoDomainRepositoryAndFactory.allMatches(UdoDomainRepositoryAndFactory.java:69)
	at org.estatio.capex.dom.orderinvoice.OrderItemInvoiceItemLinkRepository.findByOrderItem(OrderItemInvoiceItemLinkRepository.java:76)
	at org.estatio.capex.dom.orderinvoice.OrderItemInvoiceItemLinkRepository.calculateNetAmountLinkedToOrderItem(OrderItemInvoiceItemLinkRepository.java:126)
	at org.estatio.capex.dom.order.OrderItem.netAmountInvoiced(OrderItem.java:507)
	at org.estatio.capex.dom.order.OrderItem.netAmountOutstanding(OrderItem.java:502)
	at org.estatio.capex.dom.order.OrderItem.title(OrderItem.java:145)
	at sun.reflect.GeneratedMethodAccessor457.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.adapter.ObjectAdapter$InvokeUtils.invoke(ObjectAdapter.java:373)
	at org.apache.isis.core.metamodel.facets.object.title.methods.TitleFacetViaTitleMethod.title(TitleFacetViaTitleMethod.java:68)
	at org.apache.isis.core.metamodel.facets.object.domainobjectlayout.TitleFacetViaDomainObjectLayoutAnnotationUsingTitleUiEvent.title(TitleFacetViaDomainObjectLayoutAnnotationUsingTitleUiEvent.java:108)
	at org.apache.isis.core.metamodel.facets.object.title.TitleFacetAbstract.title(TitleFacetAbstract.java:42)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectSpecificationAbstract.getTitle(ObjectSpecificationAbstract.java:397)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectSpecificationAbstract.getTitle(ObjectSpecificationAbstract.java:389)
	at org.apache.isis.core.metamodel.services.title.TitleServiceDefault.titleOf(TitleServiceDefault.java:42)
	at org.isisaddons.module.publishmq.dom.jdo.spi.InteractionExecutionRepositoryJdo.buildTitle(InteractionExecutionRepositoryJdo.java:75)
	at org.isisaddons.module.publishmq.dom.jdo.spi.InteractionExecutionRepositoryJdo.persist(InteractionExecutionRepositoryJdo.java:64)
	at org.isisaddons.module.publishmq.dom.servicespi.PublisherServiceUsingActiveMq.persist(PublisherServiceUsingActiveMq.java:200)
	at org.isisaddons.module.publishmq.dom.servicespi.PublisherServiceUsingActiveMq.publish(PublisherServiceUsingActiveMq.java:150)
	at org.apache.isis.core.runtime.services.publish.PublishingServiceInternalDefault.publishToPublisherServices(PublishingServiceInternalDefault.java:400)
	at org.apache.isis.core.runtime.services.publish.PublishingServiceInternalDefault.publishAction(PublishingServiceInternalDefault.java:235)
	at sun.reflect.GeneratedMethodAccessor517.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.isis.core.runtime.services.ServiceInstantiator$2.invoke(ServiceInstantiator.java:219)
	at org.apache.isis.core.runtime.services.publish.PublishingServiceInternalDefault_$$_jvst45b_8.publishAction(PublishingServiceInternalDefault_$$_jvst45b_8.java)
	at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.doInvoke(ActionInvocationFacetForDomainEventAbstract.java:343)
	at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$1.execute(ActionInvocationFacetForDomainEventAbstract.java:164)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:142)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:132)
	at org.apache.isis.core.runtime.services.persistsession.PersistenceSessionServiceInternalDefault.executeWithinTransaction(PersistenceSessionServiceInternalDefault.java:181)
	at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.invoke(ActionInvocationFacetForDomainEventAbstract.java:160)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeInternal(ObjectActionDefault.java:400)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.execute(ObjectActionDefault.java:389)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeWithRuleChecking(ObjectActionDefault.java:370)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.executeAction(ActionModel.java:460)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.load(ActionModel.java:439)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.load(ActionModel.java:76)
	at org.apache.wicket.model.LoadableDetachableModel.getObject(LoadableDetachableModel.java:135)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.execute(ActionModel.java:564)
	at org.apache.isis.viewer.wicket.ui.components.actions.ActionFormExecutorStrategy.obtainResultAdapter(ActionFormExecutorStrategy.java:72)
	at org.apache.isis.viewer.wicket.ui.panels.FormExecutorDefault.obtainResultAdapter(FormExecutorDefault.java:514)
	at org.apache.isis.viewer.wicket.ui.panels.FormExecutorDefault.executeAndProcessResults(FormExecutorDefault.java:145)
	at org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract.onOkSubmittedOf(PromptFormAbstract.java:228)
	at org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract.access$000(PromptFormAbstract.java:60)
	at org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract$1.onSubmit(PromptFormAbstract.java:122)
	at org.apache.wicket.ajax.markup.html.form.AjaxButton$1.onSubmit(AjaxButton.java:113)
	at org.apache.wicket.ajax.form.AjaxFormSubmitBehavior$AjaxFormSubmitter.onSubmit(AjaxFormSubmitBehavior.java:215)
	at org.apache.wicket.markup.html.form.Form.delegateSubmit(Form.java:1307)
	at org.apache.wicket.markup.html.form.Form.process(Form.java:976)
	at org.apache.isis.viewer.wicket.ui.panels.FormAbstract.process(FormAbstract.java:77)
	at org.apache.wicket.markup.html.form.Form.onFormSubmitted(Form.java:797)
	at org.apache.wicket.ajax.form.AjaxFormSubmitBehavior.onEvent(AjaxFormSubmitBehavior.java:171)
	at org.apache.wicket.ajax.AjaxEventBehavior.respond(AjaxEventBehavior.java:155)
	at org.apache.wicket.ajax.AbstractDefaultAjaxBehavior.onRequest(AbstractDefaultAjaxBehavior.java:601)
	at sun.reflect.GeneratedMethodAccessor481.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.wicket.RequestListenerInterface.internalInvoke(RequestListenerInterface.java:258)
	at org.apache.wicket.RequestListenerInterface.invoke(RequestListenerInterface.java:241)
	at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.invokeListener(ListenerInterfaceRequestHandler.java:248)
	at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.respond(ListenerInterfaceRequestHandler.java:234)
	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:895)
	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:265)
	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:222)
	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:293)
	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:261)
	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:203)
	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:284)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.togglz.servlet.TogglzFilter.doFilter(TogglzFilter.java:100)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1613)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:541)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:190)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1593)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:188)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1239)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:168)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:481)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1562)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:166)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1141)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.Server.handle(Server.java:564)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:279)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:110)
	at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:124)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:672)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:590)
	at java.lang.Thread.run(Thread.java:745)
NestedThrowablesStackTrace:
java.sql.SQLIntegrityConstraintViolationException: integrity constraint violation: unique constraint or index violation; ""OrderItem_order_charge_UNQ"" table: ""OrderItem""
	at org.hsqldb.jdbc.JDBCUtil.sqlException(Unknown Source)
	at org.hsqldb.jdbc.JDBCUtil.sqlException(Unknown Source)
	at org.hsqldb.jdbc.JDBCPreparedStatement.fetchResult(Unknown Source)
	at org.hsqldb.jdbc.JDBCPreparedStatement.executeUpdate(Unknown Source)
	at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeUpdate(NewProxyPreparedStatement.java:105)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeUpdate(ParamLoggingPreparedStatement.java:393)
	at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:431)
	at org.datanucleus.store.rdbms.request.UpdateRequest.execute(UpdateRequest.java:395)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateObjectInTable(RDBMSPersistenceHandler.java:409)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.updateObject(RDBMSPersistenceHandler.java:383)
	at org.datanucleus.state.StateManagerImpl.flush(StateManagerImpl.java:4585)
	at org.datanucleus.flush.FlushOrdered.execute(FlushOrdered.java:106)
	at org.datanucleus.ExecutionContextImpl.flushInternal(ExecutionContextImpl.java:4054)
	at org.datanucleus.store.query.Query.prepareDatastore(Query.java:1647)
	at org.datanucleus.store.query.Query.executeQuery(Query.java:1832)
	at org.datanucleus.store.query.Query.executeWithMap(Query.java:1762)
	at org.datanucleus.api.jdo.JDOQuery.executeWithMap(JDOQuery.java:346)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.queries.PersistenceQueryFindUsingApplibQueryProcessor.getResults(PersistenceQueryFindUsingApplibQueryProcessor.java:117)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.queries.PersistenceQueryFindUsingApplibQueryProcessor.process(PersistenceQueryFindUsingApplibQueryProcessor.java:57)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.queries.PersistenceQueryFindUsingApplibQueryProcessor.process(PersistenceQueryFindUsingApplibQueryProcessor.java:41)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.processPersistenceQuery(PersistenceSession.java:606)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.access$000(PersistenceSession.java:147)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$1.execute(PersistenceSession.java:567)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession$1.execute(PersistenceSession.java:564)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:188)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:178)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.findInstancesInTransaction(PersistenceSession.java:563)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.allMatchingQuery(PersistenceSession.java:530)
	at org.apache.isis.core.runtime.services.persistsession.PersistenceSessionServiceInternalDefault.allMatchingQuery(PersistenceSessionServiceInternalDefault.java:171)
	at org.apache.isis.core.metamodel.services.repository.RepositoryServiceInternalDefault.submitQuery(RepositoryServiceInternalDefault.java:173)
	at org.apache.isis.core.metamodel.services.repository.RepositoryServiceInternalDefault.allMatches(RepositoryServiceInternalDefault.java:169)
	at org.apache.isis.core.metamodel.services.container.DomainObjectContainerDefault.allMatches(DomainObjectContainerDefault.java:495)
	at org.apache.isis.applib.AbstractContainedObject.allMatches(AbstractContainedObject.java:289)
	at org.estatio.dom.UdoDomainRepositoryAndFactory.allMatches(UdoDomainRepositoryAndFactory.java:69)
	at org.estatio.capex.dom.orderinvoice.OrderItemInvoiceItemLinkRepository.findByOrderItem(OrderItemInvoiceItemLinkRepository.java:76)
	at org.estatio.capex.dom.orderinvoice.OrderItemInvoiceItemLinkRepository.calculateNetAmountLinkedToOrderItem(OrderItemInvoiceItemLinkRepository.java:126)
	at org.estatio.capex.dom.order.OrderItem.netAmountInvoiced(OrderItem.java:507)
	at org.estatio.capex.dom.order.OrderItem.netAmountOutstanding(OrderItem.java:502)
	at org.estatio.capex.dom.order.OrderItem.title(OrderItem.java:145)
	at sun.reflect.GeneratedMethodAccessor457.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.adapter.ObjectAdapter$InvokeUtils.invoke(ObjectAdapter.java:373)
	at org.apache.isis.core.metamodel.facets.object.title.methods.TitleFacetViaTitleMethod.title(TitleFacetViaTitleMethod.java:68)
	at org.apache.isis.core.metamodel.facets.object.domainobjectlayout.TitleFacetViaDomainObjectLayoutAnnotationUsingTitleUiEvent.title(TitleFacetViaDomainObjectLayoutAnnotationUsingTitleUiEvent.java:108)
	at org.apache.isis.core.metamodel.facets.object.title.TitleFacetAbstract.title(TitleFacetAbstract.java:42)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectSpecificationAbstract.getTitle(ObjectSpecificationAbstract.java:397)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectSpecificationAbstract.getTitle(ObjectSpecificationAbstract.java:389)
	at org.apache.isis.core.metamodel.services.title.TitleServiceDefault.titleOf(TitleServiceDefault.java:42)
	at org.isisaddons.module.publishmq.dom.jdo.spi.InteractionExecutionRepositoryJdo.buildTitle(InteractionExecutionRepositoryJdo.java:75)
	at org.isisaddons.module.publishmq.dom.jdo.spi.InteractionExecutionRepositoryJdo.persist(InteractionExecutionRepositoryJdo.java:64)
	at org.isisaddons.module.publishmq.dom.servicespi.PublisherServiceUsingActiveMq.persist(PublisherServiceUsingActiveMq.java:200)
	at org.isisaddons.module.publishmq.dom.servicespi.PublisherServiceUsingActiveMq.publish(PublisherServiceUsingActiveMq.java:150)
	at org.apache.isis.core.runtime.services.publish.PublishingServiceInternalDefault.publishToPublisherServices(PublishingServiceInternalDefault.java:400)
	at org.apache.isis.core.runtime.services.publish.PublishingServiceInternalDefault.publishAction(PublishingServiceInternalDefault.java:235)
	at sun.reflect.GeneratedMethodAccessor517.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.isis.core.runtime.services.ServiceInstantiator$2.invoke(ServiceInstantiator.java:219)
	at org.apache.isis.core.runtime.services.publish.PublishingServiceInternalDefault_$$_jvst45b_8.publishAction(PublishingServiceInternalDefault_$$_jvst45b_8.java)
	at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.doInvoke(ActionInvocationFacetForDomainEventAbstract.java:343)
	at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$1.execute(ActionInvocationFacetForDomainEventAbstract.java:164)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:142)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:132)
	at org.apache.isis.core.runtime.services.persistsession.PersistenceSessionServiceInternalDefault.executeWithinTransaction(PersistenceSessionServiceInternalDefault.java:181)
	at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.invoke(ActionInvocationFacetForDomainEventAbstract.java:160)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeInternal(ObjectActionDefault.java:400)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.execute(ObjectActionDefault.java:389)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.executeWithRuleChecking(ObjectActionDefault.java:370)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.executeAction(ActionModel.java:460)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.load(ActionModel.java:439)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.load(ActionModel.java:76)
	at org.apache.wicket.model.LoadableDetachableModel.getObject(LoadableDetachableModel.java:135)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.execute(ActionModel.java:564)
	at org.apache.isis.viewer.wicket.ui.components.actions.ActionFormExecutorStrategy.obtainResultAdapter(ActionFormExecutorStrategy.java:72)
	at org.apache.isis.viewer.wicket.ui.panels.FormExecutorDefault.obtainResultAdapter(FormExecutorDefault.java:514)
	at org.apache.isis.viewer.wicket.ui.panels.FormExecutorDefault.executeAndProcessResults(FormExecutorDefault.java:145)
	at org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract.onOkSubmittedOf(PromptFormAbstract.java:228)
	at org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract.access$000(PromptFormAbstract.java:60)
	at org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract$1.onSubmit(PromptFormAbstract.java:122)
	at org.apache.wicket.ajax.markup.html.form.AjaxButton$1.onSubmit(AjaxButton.java:113)
	at org.apache.wicket.ajax.form.AjaxFormSubmitBehavior$AjaxFormSubmitter.onSubmit(AjaxFormSubmitBehavior.java:215)
	at org.apache.wicket.markup.html.form.Form.delegateSubmit(Form.java:1307)
	at org.apache.wicket.markup.html.form.Form.process(Form.java:976)
	at org.apache.isis.viewer.wicket.ui.panels.FormAbstract.process(FormAbstract.java:77)
	at org.apache.wicket.markup.html.form.Form.onFormSubmitted(Form.java:797)
	at org.apache.wicket.ajax.form.AjaxFormSubmitBehavior.onEvent(AjaxFormSubmitBehavior.java:171)
	at org.apache.wicket.ajax.AjaxEventBehavior.respond(AjaxEventBehavior.java:155)
	at org.apache.wicket.ajax.AbstractDefaultAjaxBehavior.onRequest(AbstractDefaultAjaxBehavior.java:601)
	at sun.reflect.GeneratedMethodAccessor481.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.wicket.RequestListenerInterface.internalInvoke(RequestListenerInterface.java:258)
	at org.apache.wicket.RequestListenerInterface.invoke(RequestListenerInterface.java:241)
	at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.invokeListener(ListenerInterfaceRequestHandler.java:248)
	at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.respond(ListenerInterfaceRequestHandler.java:234)
	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:895)
	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:265)
	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:222)
	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:293)
	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:261)
	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:203)
	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:284)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.togglz.servlet.TogglzFilter.doFilter(TogglzFilter.java:100)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1613)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:541)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:190)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1593)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:188)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1239)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:168)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:481)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1562)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:166)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1141)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.Server.handle(Server.java:564)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:279)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:110)
	at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:124)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:672)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:590)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.hsqldb.HsqlException: integrity constraint violation: unique constraint or index violation; ""OrderItem_order_charge_UNQ"" table: ""OrderItem""
	at org.hsqldb.error.Error.error(Unknown Source)
	at org.hsqldb.Constraint.getException(Unknown Source)
	at org.hsqldb.index.IndexAVLMemory.insert(Unknown Source)
	at org.hsqldb.persist.RowStoreAVL.indexRow(Unknown Source)
	at org.hsqldb.TransactionManager2PL.addInsertAction(Unknown Source)
	at org.hsqldb.Session.addInsertAction(Unknown Source)
	at org.hsqldb.Table.insertSingleRow(Unknown Source)
	at org.hsqldb.StatementDML.update(Unknown Source)
	at org.hsqldb.StatementDML.executeUpdateStatement(Unknown Source)
	at org.hsqldb.StatementDML.getResult(Unknown Source)
	at org.hsqldb.StatementDMQL.execute(Unknown Source)
	at org.hsqldb.Session.executeCompiledStatement(Unknown Source)
	at org.hsqldb.Session.execute(Unknown Source)
	... 141 more
14:09:37,960 [PublisherServiceUsingActiveMq ] Sending JMS message, id:ID:74b73571-0e66-4801-b82d-1d05a7d7a5cb.0; type:org.estatio.capex.dom.order.OrderItem#editCharge()
14:09:38,112 [IsisTransaction               ] abort transaction IsisTransaction@19af19f9[state=MUST_ABORT,commands=0]
14:09:38,113 [RequestCycleExtra             ] ********************************
14:09:38,113 [RequestCycleExtra             ] Handling the following exception
java.lang.IllegalStateException: Response is no longer buffering!
	at org.apache.wicket.protocol.http.HeaderBufferingWebResponse.reset(HeaderBufferingWebResponse.java:210)
	at org.apache.wicket.request.flow.ResetResponseException$ResponseResettingDecorator.respond(ResetResponseException.java:87)
	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:895)
	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:265)
	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:273)
	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:222)
	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:293)
	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:261)
	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:203)
	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:284)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.togglz.servlet.TogglzFilter.doFilter(TogglzFilter.java:100)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1613)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:541)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:190)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1593)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:188)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1239)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:168)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:481)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1562)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:166)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1141)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.Server.handle(Server.java:564)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:279)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:110)
	at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:124)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:672)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:590)
	at java.lang.Thread.run(Thread.java:745)
14:09:38,115 [RequestCycleExtra             ] ********************************

{code}"
ISIS-1749,Bug,Closed,Allow domain object nature of XXX_ENTITY to be specified for JAXB view models,"as per

https://lists.apache.org/thread.html/0f731129a8975e793eefe16ac66cb0fc02849beab3f4db4daccefc4d@%3Cusers.isis.apache.org%3E"
ISIS-1748,Bug,Closed,Update HelloWorld & Simpleapp archetype to run under Eclipse,"add in 

<maven.compiler.source>1.8</maven.compiler.source>
<maven.compiler.target>1.8</maven.compiler.target>

and also the webserver reference (as per intellij)... maybe an additional mavendeps for this?

also https://lists.apache.org/thread.html/1dcb00ab4a36522d113e9294d8f679be88d111c5aa24f20769020fac@%3Cusers.isis.apache.org%3E

and https://lists.apache.org/thread.html/9f33738c59472e0e6ea47749e31b3650974bf01a78b84572cfca7620@%3Cusers.isis.apache.org%3E"
ISIS-1747,Improvement,Closed,"Update docs, hints-n-tips for view models","see https://github.com/incodehq/incode-platform/issues/10

~~~~~~~~~

here's the text that has been removed

## Demo App: Highlighting Current

As a by-the-by, the demo app has one further ""trick up its sleeve"".
If you run the app you'll notice that the currently selected `DemoObject` is highlighted in the left-hand table of the `HomePageViewModel`.

This is accomplished by having the view model collaborate with a subscribing domain service that configures a CSS class.

We start by ensuring that the `DemoObject` emits an event for its CSS class:

.DemoObject.java
````java
@DomainObjectLayout(
        ...
        cssClassUiEvent = DemoObject.CssClassUiEvent.class
)
public class DemoObject ... {

    public static class CssClassUiEvent
            extends org.apache.isis.applib.services.eventbus.CssClassUiEvent<DemoObject> {}
    ...
}
````

Next, we define the domain service to act as the subscriber.
Since it will be interact

.HomePageViewModel.java
````java
public class HomePageViewModel ... {

    @DomainService(nature = NatureOfService.DOMAIN)
    public static class CssHighlighter extends AbstractSubscriber {

        @EventHandler
        @Subscribe
        public void on(DemoObject.CssClassUiEvent ev) {
            if(getContext() == null) {
                return;
            }
            if(ev.getSource() == getContext().getSelected()) {      // <1>
                ev.setCssClass(""selected"");
            }
        }

        private HomePageViewModel getContext() {                    // <2>
            return (HomePageViewModel) scratchpad.get(""context"");
        }
        void setContext(final HomePageViewModel homePageViewModel) {
            scratchpad.put(""context"", homePageViewModel);
        }

        @Inject
        Scratchpad scratchpad;                                      // <3>
    }
}
````
<1> If the domain object is the currently selected then set the CSS class
<2> Provide methods to set and get the current `HomePageViewModel` (acting as the context)
<3> Store the context using the `Scratchpad` domain service (request-scoped so thread-safe).

The `HomePageViewModel` is responsible for setting itself as the context for the domain service:

.HomePageViewModel.java
````java
public class HomePageViewModel ... {
    ...
    public TranslatableString title() {
        cssHighlighter.setContext(this);    // <1>
        ...
    }
    ...
    @javax.inject.Inject
    CssHighlighter cssHighlighter;
}
````
<1> set the context on the domain service


Finally we just need some CSS, in the `application.css` file:


.application.css
````css
.selected {
    font-style: italic;
    font-weight: bolder;
}
````"
ISIS-1746,Improvement,Closed,Provide a default implementation of UserProfileService so that don't need special case logic in each viewer.,"currently don't have a default impl; the docs say:

If the method returns null or throws an exception then the framework will default to using the current user name.

"
ISIS-1745,Improvement,Closed,[CANNOT REPRODUCE] isis maven plugin (validate) swallows NPEs from DN.,"To reproduce:

due to an error in DN annotations, running mvn validate plugin just gave a very minimal exception:

{code}
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 18.576 s
[INFO] Finished at: 2017-10-11T14:53:44+01:00
[INFO] Final Memory: 206M/710M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.isis.tool:isis-maven-plugin:1.15.0.20170915-1224:validate (default) on project estatio-app: Execution default of goal org.apache.isis.tool:isis-maven-plugin:1.15.0.20170915-1224:validate failed: java.lang.NullPointerException -> [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
{code}

running with -X indicated the problem was in DN annotations somewhere:

{code}
[ERROR] Failed to execute goal org.apache.isis.tool:isis-maven-plugin:1.15.0.20170915-1224:validate (default) on project estatio-app: Execution default of goal org.apache.isis.tool:isis-maven-plugin:1.15.0.20170915-1224:validate failed: java.lang.NullPointerException -> [Help 1]
org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.apache.isis.tool:isis-maven-plugin:1.15.0.20170915-1224:validate (default) on project estatio-app: Execution default of goal org.apache.isis.tool:isis-maven-plugin:1.15.0.20170915-1224:validate failed: java.lang.NullPointerException
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:213)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:154)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:146)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:117)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:81)
        at org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder.build(SingleThreadedBuilder.java:51)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:128)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:309)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:194)
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:107)
        at org.apache.maven.cli.MavenCli.execute(MavenCli.java:993)
        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:345)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:191)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:289)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:229)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:415)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:356)
Caused by: org.apache.maven.plugin.PluginExecutionException: Execution default of goal org.apache.isis.tool:isis-maven-plugin:1.15.0.20170915-1224:validate failed: java.lang.NullPointerException
        at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:145)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:208)
        ... 20 more
Caused by: org.datanucleus.exceptions.NucleusException: java.lang.NullPointerException
        at org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.run(RDBMSStoreManager.java:2930)
        at org.datanucleus.store.rdbms.AbstractSchemaTransaction.execute(AbstractSchemaTransaction.java:119)
        at org.datanucleus.store.rdbms.RDBMSStoreManager.createSchemaForClasses(RDBMSStoreManager.java:3855)
        at org.apache.isis.core.runtime.system.persistence.DataNucleusApplicationComponents.createSchema(DataNucleusApplicationComponents.java:194)
        at org.apache.isis.core.runtime.system.persistence.DataNucleusApplicationComponents.createPmfAndSchemaIfRequired(DataNucleusApplicationComponents.java:1
{code}

It would be nice if the default validation error could provide more guidance here, ie to catch an NPE from DN and convert it into a suitable validation error.

to reproduce:

for https://github.com/estatio/estatio

{code}
git checkout 46739ac06
{code}

then

{code}
mvn clean install -DskipTests
{code}

or (to rerun subsequently):

{code}
mvn install -DskipTests -pl estatioapp/app 
{code}
"
ISIS-1744,Improvement,Closed,Update DataNucleus to the latest version (5.1.5 or later),"Please update dependencies to DataNucleus to the latest available versions:
org.datanucleus:datanucleus-core ...................... 4.1.7 -> 5.1.6
org.datanucleus:datanucleus-api-jdo ...................4.1.1 -> 5.1.4
org.datanucleus:datanucleus-jdo-query ...............4.0.5 -> 5.0.4
org.datanucleus:datanucleus-jodatime ................4.1.0-release -> 5.1.0-release
org.datanucleus:datanucleus-rdbms ....................4.1.9 -> 5.1.6"
ISIS-1743,Improvement,Closed,fa-Icon mapping for mixin provided methods not honored intuitively,"This example will not have the Action displayed with the font-awesome icon as mapped by e.g. remove.*:fa-minus-square ...

{code:java}
@Mixin
public class SimpleObject_removeEntries {

	...

	@Action
	public SimpleObject $$(	List<Entry> entries	) {

		...
		
		return holder;
	}
}
{code}

I believe this is counter-intuitive.
"
ISIS-1742,Improvement,Closed,"Remove deprecated annotations, methods etc.",
ISIS-1741,Bug,Closed,ConcurrentModificationException during startup when launching packaged webapp with jetty,"I get this exception (see attachment [^1741_applog.txt]) only when launching the version packaged with jetty, exception doesn't occur when launching within IDE (IntelliJ).

Maybe any idea? Not sure how could I reproduce it with simpleapp...."
ISIS-1740,New Feature,Closed,New Feature: Where am I,"Its common practice to display a navigation hint somewhere at top of an application's page or below the main menu, indicating where the user currently has navigated to. (Typically within a navigable tree-structure.) 

Let's call this the *WhereAmI hint*. We could integrate such a feature into ISIS.

+Examples+
[^Clipboard01.png]
[^Clipboard02.png]
[^Clipboard03.png]

Note: we could optionally include the DomainObject's icons

+Proposal+

For any DomainObject/View currently displayed ISIS would need to know its corresponding
navigable tree-structure. Let's call this the DomainObject's *WhereAmI tree*.

All the framework needs to known to build the relevant sub-tree, is to know the parent node of any DomainObject/View that 'takes part' in the tree.

We could provide this 'who is your parent' meta information similar to the existing 'what is your title' mechanism:

{code:java}
// Who is your parent? if null there is none
public AnyDomainObjectOrView parent()
{
    return foo;
}
{code}

or

{code:java}
// Who is your parent? if null there is none
@Parent
public AnyDomainObjectOrView anyMethodName()
{
    return foo;
}
{code}

The typical layout.xml could look like this:

{code:xml}
<bs3:grid >
    <bs3:row>
        <bs3:col span=""12"" unreferencedActions=""true"">
            <cpt:whereAmI />
            <cpt:domainObject />
            ...
        </bs3:col>
    </bs3:row>
     ...
</bs3:grid >
{code}

+Implementation Notes+

# The framework needs to ensure that the chain of parent references starting at the current DomainObject/View is finite. (No circular or self references.) If it detects a circle, be nice and just stop the 'tree-up' traversal there.
# For standalone Collection Views we could display a WhereAmI hint that allows back navigation to the DomainObject/View that had produced the collection.




"
ISIS-1739,Bug,Closed,DisableXxx() method is always called while hideXxx() returns true,"I have a contributed action that must be rendered on the first parameter's page (OrderAbstract) on top of the page but shouldn't be rendered on the other parameter's page.

public Blob downloadDealerQuotationAsPdf(final OrderAbstract order, final Contact recipient){
     Blob quotation = ...
     return quotation;
}
public String disableDownloadDealerQuotationAsPdf(final OrderAbstract order, final Contact recipient){
     if(order.getOrderLines().isEmpty()){
         return ""No orderline added yet"");
     }
     return null;
}
public boolean hideDownloadDealerQuotationAsPdf(final OrderAbstract order, final Contact recipient) {
     return order == null || !order.getCompany().hasDealer();
}

As far as I can see the disableXXX method wouldn't be called in Apache Isis 1.14.x when the Contact page was rendered, because this was suppressed by the fact that the action was already hidden by the hiddenXXX method. But now they're both called but when rendering the
Contact page it will fail due to a NPE on the first line of the disableXXX method so I have to change this method to

public String disableDownloadDealerQuotationAsPdf(final OrderAbstract order, final Contact recipient){
     if(order == null){
         return ""Some dummy reason"";
     }
     // actual disable conditions
     ...
}"
ISIS-1738,Bug,Closed,ObjectMember's compator is not transitive,"
If both elements are null, depending on the order they're passed as params, it would return one result or another.

It failed on the TimeSort in some cases, throwing the following stacktrace:

java.lang.IllegalArgumentException: Comparison method violates its general contract!
    at java.util.TimSort.mergeLo(TimSort.java:773)
    at java.util.TimSort.mergeAt(TimSort.java:510)
    at java.util.TimSort.mergeCollapse(TimSort.java:437)
    at java.util.TimSort.sort(TimSort.java:241)
    at java.util.Arrays.sort(Arrays.java:1438)
    at com.google.common.collect.Ordering.immutableSortedCopy(Ordering.java:888)
    at com.google.common.collect.FluentIterable.toSortedList(FluentIterable.java:501)
    at org.apache.isis.core.metamodel.services.grid.bootstrap3.GridSystemServiceBS3.validateAndNormalize(GridSystemServiceBS3.java:467)
    at org.apache.isis.core.metamodel.services.grid.GridSystemServiceAbstract.normalize(GridSystemServiceAbstract.java:165)
    at org.apache.isis.core.metamodel.services.grid.GridServiceDefault.normalize(GridServiceDefault.java:102)
    at org.apache.isis.core.metamodel.facets.object.grid.GridFacetDefault.load(GridFacetDefault.java:75)
    at org.apache.isis.core.metamodel.facets.object.grid.GridFacetDefault.getGrid(GridFacetDefault.java:65)
    at org.apache.isis.viewer.wicket.ui.components.collectioncontents.ajaxtable.CollectionContentsAsAjaxTablePanel.addPropertyColumnsIfRequired(CollectionContentsAsAjaxTablePanel.java:167)
    at org.apache.isis.viewer.wicket.ui.components.collectioncontents.ajaxtable.CollectionContentsAsAjaxTablePanel.buildGui(CollectionContentsAsAjaxTablePanel.java:102)
    at org.apache.isis.viewer.wicket.ui.components.collectioncontents.ajaxtable.CollectionContentsAsAjaxTablePanel.onInitialize(CollectionContentsAsAjaxTablePanel.java:80)
    at org.apache.wicket.Component.fireInitialize(Component.java:878)
    at org.apache.wicket.MarkupContainer.internalInitialize(MarkupContainer.java:1070)
    at org.apache.wicket.MarkupContainer.addedComponent(MarkupContainer.java:1047)
    at org.apache.wicket.MarkupContainer.add(MarkupContainer.java:241)
    at org.apache.wicket.MarkupContainer.addOrReplace(MarkupContainer.java:265)
    at org.apache.isis.viewer.wicket.ui.components.collectioncontents.multiple.CollectionContentsMultipleViewsPanel.addUnderlyingViews(CollectionContentsMultipleViewsPanel.java:118)
    at org.apache.isis.viewer.wicket.ui.components.collectioncontents.multiple.CollectionContentsMultipleViewsPanel.onInitialize(CollectionContentsMultipleViewsPanel.java:87)
    at org.apache.wicket.Component.fireInitialize(Component.java:878)
    at org.apache.wicket.MarkupContainer$3.component(MarkupContainer.java:1076)
    at org.apache.wicket.MarkupContainer$3.component(MarkupContainer.java:1072)
    at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:144)
    at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:162)
    at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:162)
    at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:162)
    at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:123)
    at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:192)
    at org.apache.wicket.MarkupContainer.visitChildren(MarkupContainer.java:983)
    at org.apache.wicket.MarkupContainer.internalInitialize(MarkupContainer.java:1071)
    at org.apache.wicket.Page.internalPrepareForRender(Page.java:240)
    at org.apache.wicket.Component.render(Component.java:2325)
    at org.apache.wicket.Page.renderPage(Page.java:1018)
    at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:124)
    at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:195)
    at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:175)
    at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:895)
    at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
    at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:265)
    at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:222)
    at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:293)
    at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:261)
    at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:203)
    at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:284)
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1676)
    at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1676)
    at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
    at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
    at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
    at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
    at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
    at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
    at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)
    at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:581)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
    at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
    at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)
    at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180)
    at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:511)
    at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
    at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
    at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)
    at org.eclipse.jetty.server.Server.handle(Server.java:524)
    at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:319)
    at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:253)
    at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:273)
    at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)
    at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)
    at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)
    at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)
    at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)
    at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)
    at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)
    at java.lang.Thread.run(Thread.java:745)
"
ISIS-1737,Bug,Closed,Hiding of elements doesn't work on interfaces,"Hi,

While upgrading to Apache Isis 1.15.0 I noticed hiding didn't work
anymore on properties represented by an interface. In the following
example the String will be hidden but the HideMe-property will not:

public HideMe getInterfaceToBeHidden(){
         return null;
     }
     public boolean hideInterfaceToBeHidden(){
         return true;
     }
     public String getStringToBeHidden(){
         return ""foo"";
     }
     public boolean hideStringToBeHidden(){
         return true;
     }

With Apache Isis 1.14.x this works as expected."
ISIS-1736,Bug,Closed,ConfigurationServiceDefault is inconsistent,"This class is confusing, it has its own properties Map which it uses for some methods and then defers to an injected  ConfigurationServiceInternal reference for others.

I am using it in a fixture and it will not find a property using getProperty(String) which is using ConfigurationServiceInternal reference but will find it if I use getProperties() and loop through the entries returned 
//doesn't find key
String xml = configurationService.getProperty(""au.com.vuse.oneid.fixtures.companyinputfile"");
//does find key
for (ConfigurationProperty str : configurationService.allProperties()) {
	if (str.getKey().equals(""au.com.vuse.oneid.fixtures.companyinputfile""))
		xml = str.getValue();
	}"
ISIS-1735,Improvement,Closed,[DUPLICATE] Bind action with property/collection by naming convention.,
ISIS-1734,Improvement,Closed,"[WON'T FIX] Enhance TitleService , return an enhanced TitleBuffer that uses TitleService for new appendTitleOf(...)","thus:

TitleBuffer buffer = titleService.newBuffer();"
ISIS-1733,Improvement,Closed,"Improve API of RepositoryService#persist, so returns the object being persisted.",Allows for more fluent coding.
ISIS-1732,Improvement,Open,"Document ""hidden"" as a supported method for services.","eg, in kitchensink, we have:

{code}
public abstract class RepositoryAbstract<T extends Entity> {

    private final Class<T> cls;

    public RepositoryAbstract(Class<T> cls, Visibility visibility) {
        this.cls = cls;
        this.visibility = visibility;
    }

    //region > visibility

    private final Visibility visibility;

    protected enum Visibility {
        VISIBLE,
        NOT_VISIBLE
    }

    public boolean hidden() {
        return this.visibility == Visibility.NOT_VISIBLE;
    }
    //endregion
 ....
{code}

and then:

{code}
@DomainService(
        repositoryFor = ChildObject.class
)
public class ChildObjects extends RepositoryAbstract<ChildObject> {

    public ChildObjects() {
        super(ChildObject.class, Visibility.NOT_VISIBLE);
    }

    public ChildObject create(
            final String name,
            final ParentObject parentObject) {
        return repositoryService.persist(ChildObject.create(name, parentObject));
    }

    public List<ChildObject> listAll() {
        return repositoryService.allInstances(ChildObject.class);
    }

}
{code}

if use super(...VISIBLE) then this service appears in the menu.  so, ""hidden()"" is a way of globally hiding an object (or a domain service, at least)."
ISIS-1731,Bug,Closed,@Property(hidden=Where.PARENTED_TABLES) does not render correctly in standalone collection view,"Having a tree-structure of a domain class _A_ with persistent parent child relationship, there seems to be an issue with rendering the parent property column, when asking for a standalone collection view (of a list of these objects). The +parent+ column is present, but the column's cells are empty. 

{code:java}
class A {

	@Property(hidden=Where.PARENTED_TABLES) 
	@Column(allowsNull=""true"")
	@Getter @Setter
	private A parent;
	
	@Property
	@Persistent(mappedBy=""parent"")
	@Getter @Setter 
	private SortedSet<A> children;
	
}
{code}

Strangely, if we switch to the excel view and download the collection, the cells of the parent column are filled in as expected. And this is no CSS issue (of hiding elements in the DOM), because there the corresponding HTML tags are actually empty."
ISIS-1730,Bug,Closed,Invoking an action button which was rendered enabled but which is actually disabled at point of invocation throws stacktrace.,"For example, if the domain object is rendered and then some other user changes its state such that an action is no longer available.

The framework *does* correctly re-check the state of the action, but if now found to be disabled then we get a stack trace rather than - say - a toast pop-up with the reason that the action can no longer be invoked."
ISIS-1729,Improvement,Closed,Auditer Service probably shouldn't submit records for an object that is [new] -> [deleted] ,"ie is created but then deleted in the same xactn.

eg
{code}
16:07:18,365 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:294 by estatio-admin, transitionType: [NEW] -> [DELETED]
16:07:18,365 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:294 by estatio-admin, task: [NEW] -> [DELETED]
16:07:18,366 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:294 by estatio-admin, createdOn: [NEW] -> [DELETED]
16:07:18,367 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:294 by estatio-admin, paymentBatch: [NEW] -> [DELETED]
16:07:18,367 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:294 by estatio-admin, fromState: [NEW] -> [DELETED]
16:07:18,368 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:294 by estatio-admin, toState: [NEW] -> [DELETED]
16:07:18,370 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:294 by estatio-admin, completed: [NEW] -> [DELETED]
16:07:18,370 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:294 by estatio-admin, completedBy: [NEW] -> [DELETED]
16:07:18,371 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:294 by estatio-admin, completedOn: [NEW] -> [DELETED]
16:07:18,372 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:294 by estatio-admin, comment: [NEW] -> [DELETED]
16:07:18,372 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentBatch:128 by estatio-admin, debtorBankAccount: [NEW] -> [DELETED]
16:07:18,373 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentBatch:128 by estatio-admin, createdOn: [NEW] -> [DELETED]
16:07:18,374 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentBatch:128 by estatio-admin, requestedExecutionDate: [NEW] -> [DELETED]
16:07:18,375 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentBatch:128 by estatio-admin, approvalState: [NEW] -> [DELETED]
16:07:18,375 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:295 by estatio-admin, transitionType: [NEW] -> [DELETED]
16:07:18,376 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:295 by estatio-admin, task: [NEW] -> [DELETED]
16:07:18,377 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:295 by estatio-admin, createdOn: [NEW] -> [DELETED]
16:07:18,377 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:295 by estatio-admin, paymentBatch: [NEW] -> [DELETED]
16:07:18,378 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:295 by estatio-admin, fromState: [NEW] -> [DELETED]
16:07:18,379 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:295 by estatio-admin, toState: [NEW] -> [DELETED]
16:07:18,379 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:295 by estatio-admin, completed: [NEW] -> [DELETED]
16:07:18,380 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:295 by estatio-admin, completedBy: [NEW] -> [DELETED]
16:07:18,381 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:295 by estatio-admin, completedOn: [NEW] -> [DELETED]
16:07:18,381 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: payment.PaymentApprovalStateTransition:295 by estatio-admin, comment: [NEW] -> [DELETED]
16:07:18,382 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: task.Task:4365 by estatio-admin, description: [NEW] -> [DELETED]
16:07:18,383 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: task.Task:4365 by estatio-admin, createdOn: [NEW] -> [DELETED]
16:07:18,384 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: task.Task:4365 by estatio-admin, transitionObjectType: [NEW] -> [DELETED]
16:07:18,384 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: task.Task:4365 by estatio-admin, assignedTo: [NEW] -> [DELETED]
16:07:18,385 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: task.Task:4365 by estatio-admin, personAssignedTo: [NEW] -> [DELETED]
16:07:18,386 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: task.Task:4365 by estatio-admin, completedBy: [NEW] -> [DELETED]
16:07:18,387 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: task.Task:4365 by estatio-admin, completedOn: [NEW] -> [DELETED]
16:07:18,387 [AuditerServiceLogging         ] 376bb280-73e6-490e-a6a3-b4ff95063229,0: task.Task:4365 by estatio-admin, comment: [NEW] -> [DELETED]
{code}"
ISIS-1728,Improvement,Closed,Rework helloworld and simpleapp to use typesafe queries.,
ISIS-1727,Improvement,Closed,Minor internal refactorings from upgrade to JDK 8,
ISIS-1726,New Feature,Closed,Support DataNucleus meta annotations for @PersistenceCapable.,
ISIS-1725,Improvement,Closed,"Simplify bootstrapping logic by requiring an AppManifest to be supplied, remoev cfg property","implies that the isis.persistor.datanucleus.RegisterEntities.packagePrefix config property is not longer used

// no longer used ...
    public final static String PACKAGE_PREFIX_KEY = ""isis.persistor.datanucleus.RegisterEntities.packagePrefix"";

in ISIS-1276-dn-5-1 branch"
ISIS-1724,Improvement,Closed,Remove JDO applib's IsisJdoSupport,This has been deprecated for a long while
ISIS-1723,Improvement,Closed,Remove JDO applib's Auditable interface and @Auditable annotation,"These have been deprecated for a long while, with equivalents in the regular applib."
ISIS-1722,Dependency upgrade,Closed,Upgrade to Wicket 7.9.0 once available,
ISIS-1721,Bug,Closed,Isis should optionally not override the default values of entities.,"(recreated from ISIS-1082, which has got incorrect commits against it).

In a domain entity I wanted to use a property with a default value:

{code}
private boolean flag = true;
// getter & setter
{code}

Surprisingly Isis re-initialized its value to 'false' after creating the instance by using the setter.

http://isis.apache.org/more-advanced-topics/how-to-07-010-How-to-set-up-the-initial-value-of-a-property-programmatically.html explains the behavior but maybe we should rething whether Isis should initialize the properties at all."
ISIS-1720,Improvement,Closed,"namedXxx() supporting method for dynamic names of actions, properties etc.",
ISIS-1719,Improvement,Closed,QueryResultsCache should be disable when running fixture scripts.,"This is currently done if invoked via the FixtureScripts menu service, but not automatically for integration tests.

Suggest that this can be disabled, in case it starts breaking tests for folk.

see (IsisSessionFactory):

{code}
 @Programmatic
    public void constructServices() {

            ...

            //
            // installFixturesIfRequired
            //
            final FixturesInstallerFromConfiguration fixtureInstaller =
                    new FixturesInstallerFromConfiguration(this);
            fixtureInstaller.installFixtures();

			...
			
}
{code}

and (in FixtureScriptsDefault):

{code}
    public List<FixtureResult> runFixtureScript(
            final FixtureScript fixtureScript,
            @ParameterLayout(
                named = ""Parameters"",
                describedAs =
                        ""Script-specific parameters (if any).  The format depends on the script implementation (eg key=value, CSV, JSON, XML etc)"",
                multiLine = 10)
            @Parameter(optionality = Optionality.OPTIONAL)
            final String parameters) {
        try {
            eventBusService.post(new FixturesInstallingEvent(this));
            return super.runFixtureScript(fixtureScript, parameters);
        } finally {
            eventBusService.post(new FixturesInstalledEvent(this));
        }
    }

{code}

"
ISIS-1718,Dependency upgrade,Closed,Upgrade to Jetty 9.4.3,"having to override this in the incode quickstart and elsewhere, anyway."
ISIS-1717,New Feature,Closed,"To make monitoring applications reliably able to logout, allow session to be logged out just by hitting a simple HTTP GET page (""/logout"")",
ISIS-1716,Bug,Closed,"Framework is silently aborted xactns that have a JDOUserExceptions thrown, resulting in an audit trail that is misleading and confusing behaviour in some circumstances","eg as in Estatio, EST-1634"
ISIS-1715,Bug,Closed,Service priority as defined by @DomainServiceLayout#menuOrder or @DomainService#menuOrder not honored.,"It seems menu contributing service's will not always produce submenus ordered correctly:

I found a case, where menuOrder was not honored while 2 menu-services were both contributing to the same menu. The member sequence for each group was correct, but the order of the groups was wrong.


{code:java}
@DomainService(nature = NatureOfService.VIEW_MENU_ONLY)
@DomainServiceLayout(named=""TODO"", menuOrder=""30.2"")
public class A {

    @Action
    @MemberOrder(sequence = ""1.1"")
    public void getAProperty() {
        
    }

}

@DomainService(nature=NatureOfService.VIEW_MENU_ONLY)
@DomainServiceLayout(named=""TODO"", menuOrder=""30.1"")
public class B {

    @Action
    @MemberOrder(sequence = ""1.1"")
    public void getBProperty() {
        
    }

}
{code}

Menu group B should be positioned above group A, but it sometimes is not.
"
ISIS-1714,Bug,Closed,AppManifestAbstract#withConfigurationProperty overwrites value set by -D system property.,
ISIS-1713,Bug,Closed,Revert to Wicket 7.7.0 (issue with Wicket filestore filling up),due to bug in Wicket 7.8.0
ISIS-1712,Task,Closed,1.15.1 release activities,
ISIS-1711,Bug,Closed,Reference panel that returns choices not same as current field tramples over.,
ISIS-1710,Bug,Closed,AppManifestAbstract#withAdditionalServices replaces rather than appends.,"Unlike withAdditionalModules, that appends."
ISIS-1709,Bug,Closed,[INVALID] Inconsistent handling of commands vs auditing for objects implementing HasTransactionId,"Noticed that if 

ApplicationUser#updateEmailAddress(...)

with 

isis.services.audit.objects=none
isis.services.command.actions=none

then  do get a Command persisted, but don't get any audit records persisted.

The auditing behaviour is correct, but the command behaviour is wrong.

What seems to happen is that no CommandFacet is installed (ActionAnnotationFacetFactory#processCommand), and then in the ObjectMemberAbstract because there is no command facet it defaults to 

""// if no facet, assume do want to execute right now, but only persist (eventually) if hinted.""

My guess is that the hinting does occur (PersistenceSession#completeCommandFromInteractionAndClearDomainEvents as objects are dirtied."
ISIS-1708,Documentation,Closed,Broken Links according to W3C checker,"According to https://validator.w3.org/checklink?uri=https%3A%2F%2Fisis.apache.org%2F&summary=on&hide_type=all&recursive=on&depth=3&cookie=nochanges&check=Check 
there are some 404 errors, see attachment.

grtnx -j"
ISIS-1707,Improvement,Closed,Suppress mandatory red-star on read-only properties,"Mandatory red-star indicator isn't needed when the user cannot change a property value. 

For example if the following is used: 
@DomainObject(objectType = ""XXX"", nature = Nature.VIEW_MODEL, editing = Editing.DISABLED)

It seems a View Model will by default have all mandatory properties ( @Column(allowsNull=""false"")?), so the class level attribute 'editing = Editing.DISABLED' is useful to suppress that."
ISIS-1706,Improvement,Closed,Add 'username' config parameter to email service,"Currently the EmailService requires two configuration parameters:

    isis.service.email.sender.address
    isis.service.email.sender.password

with three optional:

    isis.service.email.sender.hostname
    isis.service.email.port
    isis.service.email.tls.enabled

Another optional one is needed:

    isis.service.email.sender.username

Currently when logging on to an email server the isis.service.email.sender.address value is used as an account username, in addition to also being used as the 'sent-by' email address, if you don't have a choice as to the username this is problematic, such as with Amazon Simple Email Service (SES).

With the additional config parameter, when present this value should override the isis.service.email.sender.address value as the account username, when not present the present arrangement should be used.





"
ISIS-1705,Bug,Closed,Addon module isis-module-settings is not working after upgrade to Isis 1.15.0,"Here the mail thread describing the issue: https://www.mail-archive.com/users@isis.apache.org/msg05286.html 


h1. How to reproduce
* Integrate addon with simpleapp
* Try to create an Application Settings ""New String""


Exception
{code}
07:45:49,678  [RequestCycleExtra    qtp942986815-17 WARN ]  Handling the
following exception
org.apache.wicket.WicketRuntimeException: Method onRequest of interface
org.apache.wicket.behavior.IBehaviorListener targeted at
org.apache.wicket.ajax.markup.html.form.AjaxButton$1@302b1c47 on component
[IndicatingAjaxButton [Component id = okButton]] threw an exception
at
org.apache.wicket.RequestListenerInterface.internalInvoke(RequestListenerInterface.java:268)
at
org.apache.wicket.RequestListenerInterface.invoke(RequestListenerInterface.java:241)
at
org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.invokeListener(ListenerInterfaceRequestHandler.java:248)
at
org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.respond(ListenerInterfaceRequestHandler.java:234)
at
org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:895)
at
org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
at
org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:265)
at
org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:222)
at
org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:293)
at
org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:261)
at
org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:203)
at
org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:284)
at
org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1676)
at
org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
at
org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1676)
at
org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
at
org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
at
org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
at
org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
at
org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
at
org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
at
org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
at
org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)
at
org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:581)
at
org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
at
org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
at
org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)
at
org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180)
at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:511)
at
org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
at
org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112)
at
org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
at
org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)
at org.eclipse.jetty.server.Server.handle(Server.java:524)
at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:319)
at
org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:253)
at
org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:273)
at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)
at
org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)
at
org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)
at
org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)
at
org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)
at
org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)
at
org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)
at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.reflect.InvocationTargetException
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
at
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:498)
at
org.apache.wicket.RequestListenerInterface.internalInvoke(RequestListenerInterface.java:258)
... 44 more
Caused by: java.lang.RuntimeException: java.lang.NumberFormatException: For
input string: ""dd""
at
org.apache.isis.core.metamodel.adapter.mgr.AdapterManager$ConcurrencyChecking.executeWithConcurrencyCheckingDisabled(AdapterManager.java:90)
at
org.apache.isis.viewer.wicket.ui.actionresponse.ActionResultResponseType.toEntityPage(ActionResultResponseType.java:159)
at
org.apache.isis.viewer.wicket.ui.actionresponse.ActionResultResponseType.access$200(ActionResultResponseType.java:46)
at
org.apache.isis.viewer.wicket.ui.actionresponse.ActionResultResponseType$1.interpretResult(ActionResultResponseType.java:51)
at
org.apache.isis.viewer.wicket.ui.actionresponse.ActionResultResponseType.determineAndInterpretResult(ActionResultResponseType.java:178)
at
org.apache.isis.viewer.wicket.ui.components.actions.ActionFormExecutorStrategy.redirectTo(ActionFormExecutorStrategy.java:79)
at
org.apache.isis.viewer.wicket.ui.panels.FormExecutorDefault.redirectTo(FormExecutorDefault.java:520)
at
org.apache.isis.viewer.wicket.ui.panels.FormExecutorDefault.executeAndProcessResults(FormExecutorDefault.java:166)
at
org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract.onOkSubmittedOf(PromptFormAbstract.java:228)
at
org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract.access$000(PromptFormAbstract.java:60)
at
org.apache.isis.viewer.wicket.ui.panels.PromptFormAbstract$1.onSubmit(PromptFormAbstract.java:122)
at
org.apache.wicket.ajax.markup.html.form.AjaxButton$1.onSubmit(AjaxButton.java:113)
at
org.apache.wicket.ajax.form.AjaxFormSubmitBehavior$AjaxFormSubmitter.onSubmit(AjaxFormSubmitBehavior.java:215)
at org.apache.wicket.markup.html.form.Form.delegateSubmit(Form.java:1307)
at org.apache.wicket.markup.html.form.Form.process(Form.java:976)
at
org.apache.isis.viewer.wicket.ui.panels.FormAbstract.process(FormAbstract.java:77)
at org.apache.wicket.markup.html.form.Form.onFormSubmitted(Form.java:797)
at
org.apache.wicket.ajax.form.AjaxFormSubmitBehavior.onEvent(AjaxFormSubmitBehavior.java:171)
at
org.apache.wicket.ajax.AjaxEventBehavior.respond(AjaxEventBehavior.java:155)
at
org.apache.wicket.ajax.AbstractDefaultAjaxBehavior.onRequest(AbstractDefaultAjaxBehavior.java:601)
... 49 more
Caused by: java.lang.NumberFormatException: For input string: ""dd""
at
java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)
at java.lang.Integer.parseInt(Integer.java:580)
at java.lang.Integer.parseInt(Integer.java:615)
at
org.isisaddons.module.settings.dom.SettingAbstract.parseValueAsInt(SettingAbstract.java:89)
at
org.isisaddons.module.settings.dom.SettingAbstract.getValueAsInt(SettingAbstract.java:147)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
at
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:498)
at
org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
at
org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
at
org.apache.isis.core.metamodel.adapter.ObjectAdapter$InvokeUtils.invoke(ObjectAdapter.java:373)
at
org.apache.isis.core.metamodel.facets.properties.accessor.PropertyAccessorFacetViaAccessor.getProperty(PropertyAccessorFacetViaAccessor.java:76)
at
org.apache.isis.core.metamodel.specloader.specimpl.OneToOneAssociationDefault.get(OneToOneAssociationDefault.java:146)
at
org.apache.isis.viewer.wicket.model.models.ScalarModel$Kind$1.reset(ScalarModel.java:293)
at
org.apache.isis.viewer.wicket.model.models.ScalarModel$Kind$1.init(ScalarModel.java:283)
at
org.apache.isis.viewer.wicket.model.models.ScalarModel.init(ScalarModel.java:683)
at
org.apache.isis.viewer.wicket.model.models.ScalarModel.<init>(ScalarModel.java:677)
at
org.apache.isis.viewer.wicket.model.models.EntityModel.getPropertyModel(EntityModel.java:357)
at
org.apache.isis.viewer.wicket.ui.components.entity.fieldset.PropertyGroup.addPropertyToForm(PropertyGroup.java:204)
at
org.apache.isis.viewer.wicket.ui.components.entity.fieldset.PropertyGroup.buildGui(PropertyGroup.java:104)
at
org.apache.isis.viewer.wicket.ui.components.entity.fieldset.PropertyGroup.<init>(PropertyGroup.java:78)
at
org.apache.isis.viewer.wicket.ui.components.layout.bs3.col.Col.buildGui(Col.java:243)
at
org.apache.isis.viewer.wicket.ui.components.layout.bs3.col.Col.<init>(Col.java:79)
at
org.apache.isis.viewer.wicket.ui.components.layout.bs3.row.Row.buildGui(Row.java:69)
at
org.apache.isis.viewer.wicket.ui.components.layout.bs3.row.Row.<init>(Row.java:53)
at
org.apache.isis.viewer.wicket.ui.components.layout.bs3.BS3GridPanel.buildGui(BS3GridPanel.java:53)
at
org.apache.isis.viewer.wicket.ui.components.layout.bs3.BS3GridPanel.<init>(BS3GridPanel.java:42)
at
org.apache.isis.viewer.wicket.ui.components.entity.selector.links.EntityLinksSelectorPanelFactory.createComponent(EntityLinksSelectorPanelFactory.java:57)
at
org.apache.isis.viewer.wicket.ui.ComponentFactoryAbstract.createComponent(ComponentFactoryAbstract.java:98)
at
org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.createComponent(ComponentFactoryRegistryDefault.java:121)
at
org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.addOrReplaceComponent(ComponentFactoryRegistryDefault.java:106)
at
org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addComponent(PageAbstract.java:404)
at
org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addChildComponents(PageAbstract.java:399)
at
org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage.buildPage(EntityPage.java:182)
at
org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage.<init>(EntityPage.java:115)
at
org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage.<init>(EntityPage.java:83)
at
org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage.<init>(EntityPage.java:95)
at
org.apache.isis.viewer.wicket.ui.actionresponse.ActionResultResponseType$9.call(ActionResultResponseType.java:162)
at
org.apache.isis.viewer.wicket.ui.actionresponse.ActionResultResponseType$9.call(ActionResultResponseType.java:160)
at
org.apache.isis.core.metamodel.adapter.mgr.AdapterManager$ConcurrencyChecking.executeWithConcurrencyCheckingDisabled(AdapterManager.java:88)
... 68 more
07:45:49,684  [RequestCycleExtra    qtp942986815-17 WARN ]
{code}


Here the fork with simpleapp and addon:
https://github.com/niv0/isis/tree/simpleapp-with-settings-addon


"
ISIS-1704,Wish,Open,[Wish] BigDecimal properties are not right aligned in Wicket viewer when shown in read-only mode.,
ISIS-1703,Improvement,Closed,Mixin property that returns a BigDecimal does not support @Digits(...) annotation as a return type.,
ISIS-1702,Improvement,Closed,[DUPLICATE] Infer @Programmatic on methods within @DomainService(nature=DOMAIN),to remove some boilerplate
ISIS-1701,Improvement,Closed,"Document the polymorphic associations pattern, xref dom-alias and dom-classification.",Part of platform.incode.org
ISIS-1700,Improvement,Closed,Enhance ObjectContracts#compare to allow different types of objects to be compared.,"eg in Estatio, when sorting Task#object column through the UI.

See Estatio codebase for a fix (ObjectContracts2)"
ISIS-1699,Bug,Closed,Titles of (editable) references not shown in collections,"The css class 'inlinePrompt' appears in ReferencePanels within the collection view.

I suppose, this should never happen. It results in references' titles being hidden.

(see attached screenshot)"
ISIS-1698,Bug,Closed,CollectionLayout.defaultView not honored,"It seems setting the defaultView for Collections does no longer work. (Since release 1.15.0)

The collection's view instead always defaults to ""table"", no matter if set via Annotation or layout.xml.

However the 'hinting mechanism' does work. The framework remembers the last view as selected via user-interface . ('table, 'excel, ...')

Steps to reproduce ...
Take the SimpleObject demo app and test the following snipped:

{code:java}

    @javax.inject.Inject
    SimpleObjectRepository simpleObjectRepository;

    @CollectionLayout(defaultView=""hidden"")
    public List<SimpleObject> getAll(){
    	return simpleObjectRepository.listAll();
    }
{code}

The collection should default to view type 'hidden' but renders as 'table'. (Same applies if we try to default to 'excel', in case the excel-addon is available.)


"
ISIS-1697,New Feature,Closed,"Extend RO viewer, new ""layout"" resource to provide the BS3 layout grid.",
ISIS-1696,New Feature,Closed,Extend RO viewer so that services indicate their menuBar (primary/secondary) as an extension,
ISIS-1695,New Feature,Closed,Support value types (simple ones at least) as a first-class citizen,"I would like to reintroduce value types as a first-class citizen, but without requiring the developer to have to write lots of code to teach DataNucleus, Wicket and the RO viewer about these.

I don't have a general solution in mind on how to do this.

However, for very simple value types that are just a type-safe wrapper around a single field (eg Password, or Money, or Temperature, or Email say), then perhaps there might be a way to support this, eg :

public class Temperature implements org.apache.isis.valuetypes.Value<BigDecimal> {

    public Temperature(BigDecimal value) \{ ... }

    BigDecimal getValue() \{ ... }

}
 
 or
 
 @Value(underlying=BigDecimal.class)
 public class Temperature \{ ... }

The idea here is that the framework would treat any instance of this custom value type as if it were the underlying type (BigDecimal in the case above). It would also be possible to apply validations to the value type that would apply everywhere it is used as a property/parameter.

 

We would expect these value types to be immutable, and (although this can't be expressed in an interface), would expect there to be a public 1-arg constructor of the appropriate type, and a package-local ""getValue()"" method.  These allow the framework to marshal values in and out of the value type.

 

 "
ISIS-1694,Improvement,Closed,[WON'T FIX] Docs: hints and tips for writing view models: use Lombok,"{code}
@NoArgsConstructor
@AllArgsConstructor
public class IncomingInvoiceDownloadManager {

    @Getter
    private LocalDate fromInputDate;

    @Getter
    private LocalDate toInputDate;
{code}	
"
ISIS-1693,Bug,Closed,exception when attempt to render ErrorPage itself,"exception when attempt to render ErrorPage itself

- to reproduce:
  - open Estatio's home page
  - copy-n-paste the URL to render in a new tabGroups
  - on the first page, attempt to invoke the PaymentBatchManager using the button
	
{code}
07:02:22,506 [RequestCycleExtra             ] Handling the following exception
org.apache.wicket.behavior.InvalidBehaviorIdException: Cannot find behavior with id '0' on component 'org.isisaddons.wicket.pdfjs.cpt.ui.PdfJsViewerPanel:theme:entityPageContainer:entity:rows:1:rowContents:2:col:tabGroups:1:1:rowContents:1:col:fieldSets:1:memberGroup:properties:1:property' in page '[Page class = org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage, id = 20, render count = 0]'. Perhaps the behavior did not properly implement getStatelessHint() and returned 'true' to indicate that it is stateless instead of returning 'false' to indicate that it is stateful.
	at org.apache.wicket.Behaviors.getBehaviorById(Behaviors.java:316)
	at org.apache.wicket.Component.getBehaviorById(Component.java:4596)
	at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.invokeListener(ListenerInterfaceRequestHandler.java:247)
	at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.respond(ListenerInterfaceRequestHandler
{code}

"
ISIS-1692,Improvement,Open,[JUnit] Resilient if TableColumnOrderingService returns non-existent property name.,"at least in 1.15.0-SNAPSHOT, this gave me an NPE

eg in Estatio, because of non-existent property in TableColumnOrderingService

{code}
 @DomainService(nature = NatureOfService.DOMAIN)
    public static class TableColumnOrderServiceForCreditTransfer implements TableColumnOrderService {

        @Override
        public List<String> orderParented(
                final Object parent,
                final String collectionId,
                final Class<?> collectionType,
                final List<String> propertyIds) {
            if(parent instanceof PaymentBatch && CreditTransfer.class.isAssignableFrom(collectionType)) {
                return Lists.newArrayList(
                        ""endToEndId"",
                        ""seller"",
                        ""sellerBankAccount"",
                        ""amount"",
                        ""remittanceInformation""
                );
            }
            return null;
        }

        @Override
        public List<String> orderStandalone(final Class<?> collectionType, final List<String> propertyIds) {
            return null;
        }
    }
{code}

resulted in stack trace:

{code}
java.lang.NullPointerException
org.apache.isis.viewer.wicket.ui.components.collectioncontents.ajaxtable.CollectionContentsAsAjaxTablePanel#createObjectAdapterPropertyColumn(CollectionContentsAsAjaxTablePanel.java:256)
org.apache.isis.viewer.wicket.ui.components.collectioncontents.ajaxtable.CollectionContentsAsAjaxTablePanel#addPropertyColumnsIfRequired(CollectionContentsAsAjaxTablePanel.java:208)
org.apache.isis.viewer.wicket.ui.components.collectioncontents.ajaxtable.CollectionContentsAsAjaxTablePanel#buildGui(CollectionContentsAsAjaxTablePanel.java:102)
org.apache.isis.viewer.wicket.ui.components.collectioncontents.ajaxtable.CollectionContentsAsAjaxTablePanel#onInitialize(CollectionContentsAsAjaxTablePanel.java:80)
org.apache.wicket.Component#fireInitialize(Component.java:878)
org.apache.wicket.MarkupContainer#internalInitialize(MarkupContainer.java:1081)
org.apache.wicket.MarkupContainer#addedComponent(MarkupContainer.java:1058)
org.apache.wicket.MarkupContainer#add(MarkupContainer.java:241)
org.apache.wicket.MarkupContainer#addOrReplace(MarkupContainer.java:265)
org.apache.isis.viewer.wicket.ui.components.collectioncontents.multiple.CollectionContentsMultipleViewsPanel#addUnderlyingViews(CollectionContentsMultipleViewsPanel.java:118)
org.apache.isis.viewer.wicket.ui.components.collectioncontents.multiple.CollectionContentsMultipleViewsPanel#onInitialize(CollectionContentsMultipleViewsPanel.java:87)
org.apache.wicket.Component#fireInitialize(Component.java:878)
org.apache.wicket.MarkupContainer#internalInitialize(MarkupContainer.java:1081)
org.apache.wicket.MarkupContainer#addedComponent(MarkupContainer.java:1058)
org.apache.wicket.MarkupContainer#add(MarkupContainer.java:241)
org.apache.wicket.MarkupContainer#addOrReplace(MarkupContainer.java:265)
org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault#addOrReplaceComponent(ComponentFactoryRegistryDefault.java:107)
org.apache.isis.viewer.wicket.ui.components.collection.CollectionPanel#buildGui(CollectionPanel.java:87)
org.apache.isis.viewer.wicket.ui.components.collection.CollectionPanel#onInitialize(CollectionPanel.java:83)
org.apache.wicket.Component#fireInitialize(Component.java:878)
org.apache.wicket.MarkupContainer$3#component(MarkupContainer.java:1087)
org.apache.wicket.MarkupContainer$3#component(MarkupContainer.java:1083)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:144)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:123)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:192)
org.apache.wicket.MarkupContainer#visitChildren(MarkupContainer.java:983)
org.apache.wicket.MarkupContainer#internalInitialize(MarkupContainer.java:1082)
org.apache.wicket.MarkupContainer#addedComponent(MarkupContainer.java:1058)
org.apache.wicket.MarkupContainer#add(MarkupContainer.java:241)
org.apache.isis.viewer.wicket.ui.components.entity.collection.EntityCollectionPanel#onInitialize(EntityCollectionPanel.java:94)
org.apache.wicket.Component#fireInitialize(Component.java:878)
org.apache.wicket.MarkupContainer$3#component(MarkupContainer.java:1087)
org.apache.wicket.MarkupContainer$3#component(MarkupContainer.java:1083)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:144)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:123)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:192)
org.apache.wicket.MarkupContainer#visitChildren(MarkupContainer.java:983)
org.apache.wicket.MarkupContainer#internalInitialize(MarkupContainer.java:1082)
org.apache.wicket.MarkupContainer#addedComponent(MarkupContainer.java:1058)
org.apache.wicket.MarkupContainer#replace(MarkupContainer.java:855)
org.apache.wicket.MarkupContainer#addOrReplace(MarkupContainer.java:269)
org.apache.wicket.extensions.markup.html.tabs.TabbedPanel#setCurrentTab(TabbedPanel.java:439)
org.apache.wicket.extensions.markup.html.tabs.TabbedPanel#setSelectedTab(TabbedPanel.java:397)
org.apache.isis.viewer.wicket.ui.components.layout.bs3.tabs.TabGroupPanel#setSelectedTab(TabGroupPanel.java:102)
org.apache.isis.viewer.wicket.ui.components.layout.bs3.tabs.TabGroupPanel#setSelectedTabFromSessionIfAny(TabGroupPanel.java:113)
org.apache.isis.viewer.wicket.ui.components.layout.bs3.tabs.TabGroupPanel#onInitialize(TabGroupPanel.java:95)
org.apache.wicket.Component#fireInitialize(Component.java:878)
org.apache.wicket.MarkupContainer$3#component(MarkupContainer.java:1087)
org.apache.wicket.MarkupContainer$3#component(MarkupContainer.java:1083)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:144)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:162)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:123)
org.apache.wicket.util.visit.Visits#visitChildren(Visits.java:192)
org.apache.wicket.MarkupContainer#visitChildren(MarkupContainer.java:983)
org.apache.wicket.MarkupContainer#internalInitialize(MarkupContainer.java:1082)
org.apache.wicket.Page#isPageStateless(Page.java:465)
org.apache.wicket.request.handler.render.WebPageRenderer#isPageStateless(WebPageRenderer.java:287)
org.apache.wicket.request.handler.render.WebPageRenderer#shouldRenderPageAndWriteResponse(WebPageRenderer.java:329)
org.apache.wicket.request.handler.render.WebPageRenderer#respond(WebPageRenderer.java:193)
org.apache.wicket.core.request.handler.RenderPageRequestHandler#respond(RenderPageRequestHandler.java:175)
org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:895)
org.apache.wicket.request.RequestHandlerStack#execute(RequestHandlerStack.java:64)
org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:265)
org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:222)
org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:293)
org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:261)
org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:203)
org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:284)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1621)
org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter#doFilter(IsisLogOnExceptionFilter.java:52)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1621)
org.togglz.servlet.TogglzFilter#doFilter(TogglzFilter.java:100)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1621)
org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1613)
org.eclipse.jetty.servlet.ServletHandler#doHandle(ServletHandler.java:541)
org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:143)
org.eclipse.jetty.security.SecurityHandler#handle(SecurityHandler.java:548)
org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:132)
org.eclipse.jetty.server.handler.ScopedHandler#nextHandle(ScopedHandler.java:190)
org.eclipse.jetty.server.session.SessionHandler#doHandle(SessionHandler.java:1593)
org.eclipse.jetty.server.handler.ScopedHandler#nextHandle(ScopedHandler.java:188)
org.eclipse.jetty.server.handler.ContextHandler#doHandle(ContextHandler.java:1239)
org.eclipse.jetty.server.handler.ScopedHandler#nextScope(ScopedHandler.java:168)
org.eclipse.jetty.servlet.ServletHandler#doScope(ServletHandler.java:481)
org.eclipse.jetty.server.session.SessionHandler#doScope(SessionHandler.java:1562)
org.eclipse.jetty.server.handler.ScopedHandler#nextScope(ScopedHandler.java:166)
org.eclipse.jetty.server.handler.ContextHandler#doScope(ContextHandler.java:1141)
org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:141)
org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:132)
org.eclipse.jetty.server.Server#handle(Server.java:564)
org.eclipse.jetty.server.HttpChannel#handle(HttpChannel.java:320)
org.eclipse.jetty.server.HttpConnection#onFillable(HttpConnection.java:251)
org.eclipse.jetty.io.AbstractConnection$ReadCallback#succeeded(AbstractConnection.java:279)
org.eclipse.jetty.io.FillInterest#fillable(FillInterest.java:110)
org.eclipse.jetty.io.ChannelEndPoint$2#run(ChannelEndPoint.java:124)
org.eclipse.jetty.util.thread.Invocable#invokePreferred(Invocable.java:122)
org.eclipse.jetty.util.thread.strategy.ExecutingExecutionStrategy#invoke(ExecutingExecutionStrategy.java:58)
org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#produceConsume(ExecuteProduceConsume.java:201)
org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#run(ExecuteProduceConsume.java:133)
org.eclipse.jetty.util.thread.QueuedThreadPool#runJob(QueuedThreadPool.java:672)
org.eclipse.jetty.util.thread.QueuedThreadPool$2#run(QueuedThreadPool.java:590)
java.lang.Thread#run(Thread.java:745)
{code}"
ISIS-1691,Bug,Closed,"[NOT A PROBLEM] Bootstrap paging navigators ""pageNumber"" failing to render correctly",
ISIS-1690,Bug,Closed,"Better diagnostics if a service's @PostConstruct fails, and ensure that all get initialized",.. currently does not call @PostConstruct for remaining...
ISIS-1689,Bug,Closed,"ObjectSpecIdFacet from JDO schema being clobbered by objectType inferred from class name, causing a validator to fail unnecessarily",
ISIS-1688,Improvement,Closed,Service priority should honour either @DomainServiceLayout#menuOrder or @DomainService#menuOrder,... and should take the minimum if both are present.
ISIS-1687,Improvement,Closed,Support for TypeSafe queries with a unique result in IsisJdoSupport,"Currently we have the abstraction in IsisJdoSupport for executing a typesafe query, returning a list of matches, but not yet for returning a unique match."
ISIS-1686,Improvement,Closed,Allow integration tests to be bootstrapped with less boilerplate,"specifically, new subclasses of IntegrationTestAbstract and a convenience implementation of AppManifestAbstract"
ISIS-1685,Improvement,Closed,Add missing javadocs for packages in the applib,
ISIS-1684,Improvement,Closed,"Remove org.apache.isis.applib.fixtures.InstallableFixture, replace with FixtureScripts",
ISIS-1683,Improvement,Closed,Move org.apache.isis.applib.services.timestamp.Timestampable to mixins.timestamp,
ISIS-1682,Improvement,Closed,Move org.apache.isis.applib.services.layout.Object_downloadLayoutXml mixins out of services.layout and into mixins.layout,
ISIS-1681,Improvement,Closed,Move wrapper factory events (eg org.apache.isis.applib.events.AccessEvent) to subpackage of services.wrapper,
ISIS-1680,Improvement,Closed,Move event classes (eg org.apache.isis.applib.services.eventbus.AbstractDomainEvent) out of services.eventbus and into applib.events (subpackages thereof),"use subpackages:

* events.domain
* events.ui
* events.lifecycle

nb: there is already an events package, but will be moved, see ISIS-1681"
ISIS-1679,Improvement,Closed,Move org.apache.isis.applib.services.dto.Dto to org.apache.isis.applib.mixins,
ISIS-1678,Improvement,Closed,"Remove org.apache.isis.applib.clock.Clock, replace with org.apache.isis.applib.services.clock.ClockService",
ISIS-1677,Improvement,Closed,Move org.apache.isis.applib.conmap.ContentMappingService to org.apache.isis.applib.services.conmap (subpackage of services),
ISIS-1676,Bug,Closed,"Standardise framework mxins to use @Mixin(method=""act"") or @Mixin(method=""prop"") etc.",
ISIS-1675,Bug,Closed,"swagger spec file does not support parameters with an id starting with "".""","discovered when testing swagger-ui within new helloworld app with the downloadJdoMetadata where the fileName was named "".jdo file name""

Fix, for now is to rename the parameter name to just ""File name"" (same as other mixins, actually).  This seems to work well enough."
ISIS-1674,New Feature,Closed,"Create a ""hello world"" archetype","to reduce boilerplate, also:
- AppManifestAbstract
- IsisWicketApplication#readLines(...)"
ISIS-1673,Improvement,Closed,"[CAN'T REPRODUCE] jdoqlFromClause validator is too strict, does not allow for NOT EXISTS","

For example:
{code}
@Query(
                name = ""findNotInAnyPaymentBatchByApprovalStateAndPaymentMethod"", language = ""JDOQL"",
                value = ""SELECT ""
                        + ""FROM org.estatio.capex.dom.invoice.IncomingInvoice ""
                        + ""WHERE !(SELECT invoice ""
                        +         ""  FROM org.estatio.capex.dom.payment.PaymentLine).contains(this) ""
                        + ""   && approvalState == :approvalState ""
                        + ""   && paymentMethod == :paymentMethod ""
                        + ""ORDER BY invoiceDate ASC "" // oldest first
        ),
{code}"
ISIS-1672,Improvement,Closed,"Simplify handling of autoComplete facet, by copying autoComplete from parameter type's spec down to the parameter itself","Currently ReferencePanel and (as of ISIS-1600) the  ActionChoicesForCollectionParameterFacetFactory both check for autoComplete/choices of a parameter in two places:

a) on the parameter itself (as per a choicesNXxx() or an autoCompleteNXxx())
b) on the parameter's type (as per @DomainObject(autoCompleteRepository=...)

To simplify and make more consistent, should derive a parameter-level ActionParameterAutoCompleteFacet from the objectspec's AutoCompletefacet."
ISIS-1671,Improvement,Closed,[DUPLICATE] Upgrade to Wicket 7.8.0,Now on Wicket 7.9.0
ISIS-1670,Bug,Open,ScalarPanelAbstract2 in edit mode (or with INLINE_AS_IF_EDIT action) does not dynamically update enablement/disability based on other state.,"... because the gui is built during onInitialize callback, and this is called when re-rendered

Funnily enough, ScalarPanelAbstract (which ScalarPanelAbstract2 replaces) uses onBeforeRender.

Am guessing there was probably a reason to move the gui building to onInitialize..."
ISIS-1669,Improvement,Closed,"For JAXB view models, metamodel validator for missing JAXB adapters on date/time properties, or on persistable reference types.",
ISIS-1668,Bug,Closed,INLINE_AS_IF_EDIT actions do not honour hidden or disabled facets.,"If an action is hidden but also INLINE_AS_IF_EDIT, then the action prompt can still be opened (by clicking on the associated property's field).  Moreover, the action can be executed.

If an action is disabled but also INLINE_AS_IF_EDIT, then the action prompt can still be opened (by clicking on the associated property's field).  Attempting to execute the action will result in a confusing NOT_AUTHORISED error."
ISIS-1667,Bug,Closed,Rework ActionParametersPanel so that only rendered if there is a N-arg action ... it isn't used to implicitly invoke an action for a no-arg action.,"This change required because the previous design was found to be incompatible with Wicket 7.8.0 (investigating with martin-g).

Note that the upgrade to Wicket 7.8.0 itself has been moved to a different ticket, ISIS-1671, to minimize risk."
ISIS-1666,Improvement,Closed,Inline prompt should show the name of the action,
ISIS-1665,New Feature,Closed,inline prompt for panel action should replace entire panel,
ISIS-1664,New Feature,Closed,editXxx as an action should implicitly associate with xxx property,"ie, as if 
{code}
@MemberOrder(named=""xxx"", sequence=""1"")
@PropertyLayout(promptStyle=INLINE_AS_IF_EDIT)
public String getXxx() { ... }
{code}"
ISIS-1663,Improvement,Closed,@Property/@Collection/@Action methods must be public.,Metamodel validator to check
ISIS-1662,Improvement,Closed,Metamodel validator that any view model should have a no-arg constructor.,
ISIS-1661,Bug,Closed,"[NOT A PROBLEM] once selected, doesn't seem to be possible to set a @Nullable parameter that has an autoComplete back to null","once selected, doesn't seem to be possible to set a @Nullable parameter that has an autoComplete back to null,  (eg IncomingInvoiceItem#addItem(... Property....)"
ISIS-1660,Bug,Closed,"[WON'T FIX] When copy link with hints, the hints do not seem to be honoured when reconstructing page (any session hints seem to take priority).",
ISIS-1659,Improvement,In Progress,[Performance] no-arg actions (eg toggle) don't respect config property isRedirectOnlyIfSameObject=false,"eg:
{code}
public SomeObject toggle() {
    setFlag(! isFlag());
    return this;
}
{code}

will cause a redirect to the same page, even though the same object is being rendered.  

The reason is because the current viewer implementation does not expose the AjaxRequestTarget.  Need some deep surgery somewhere..."
ISIS-1658,Improvement,Closed,"Subscribers on title UI event, css and icon should override title() or @Title etc in the class itself.",just a matter of changing the order of the appropriate facet factories in ProgrammingModelFacetsJava5
ISIS-1657,Bug,Closed,Fix for CSS for disabled drop-down actions on right of property.,"is missing bootstrap ""btn"" styling, meaning not shown as disabled cursor etc."
ISIS-1656,Improvement,Open,"[Performance] Flush auditing/publishing etc to end of the ACTION phase, rather than end of RENDER phase.","cf ISIS=1655, whereby we can only flush QueryResultsCache and not the other two transaction-scoped services.

I think we should probably bring the hook for the auditing etc forward to the beginning of the RENDER phase, ie using the same hook that we have installed TargetRespondListenerToResetQueryResultCache class."
ISIS-1655,Improvement,Closed,QueryResultsCache should be invalidated prior to the render phase.,"... so that rendering is correct.

The problem has been recreated within Kitchensink, BusRulesObject's disabling of actions via a result held in QueryResultsCache.

NOTE: that it *isn't* correct to invalidate the other two transaction-scoped services (ChangedObjectsServicesInternal, and MetricsServiceDefault) because these don't flush until the end.    I've raised ISIS-1656 for that improvement.

"
ISIS-1654,Improvement,Closed,per-arg validation not fired for enum (ValueChoicesSelect2Panel),
ISIS-1653,Improvement,Closed,Allow properties to be dynamically made visible/non-visible when not redirecting,"In previous versions the page was always redrawn, even if same object.  Now, though (unless ""redirectEvenIfSameObject"" property is enabled), the page is repainted.  If a property toggles its visibility, what was happening is that it would never be made visible once made invisible.

"
ISIS-1652,Improvement,Closed,Inline prompts should not show gap when no action buttons visible,
ISIS-1651,Improvement,Closed,Inline prompt should provide CSS identifying the action being prompted for.,
ISIS-1650,Bug,Closed,Disabled properties for JAXB view models are never disabled.,
ISIS-1649,Bug,Closed,Update docs with Erik's runAs gist,"as per https://gist.github.com/erikdehair/efa3005440ca982cca41ebe5347e82d8


Suggest this is added to http://isis.apache.org/guides/ugsec/ugsec.html#_ugsec_hints-and-tips

https://github.com/apache/isis/tree/master/adocs/documentation/src/main/asciidoc/guides/ugsec

"
ISIS-1648,Bug,Closed,Disable copy link (because hint as provided in the bookmarks seems to be broken),raised https://issues.apache.org/jira/browse/ISIS-1648 to resurrect
ISIS-1647,Bug,Closed,Hitting escape twice for modal dialogs causes a stack trace,introduced as a problem during the inline edit stuff
ISIS-1646,Bug,Closed,[WON'T FIX] (non-fatal) ConcurrentModificationException when invoking an action,"this occurred in Estatio when invoking the ""lookupBic"" action that returns a URL

from the UI/end-user perspective, nothing awry.  But noticed this stack trace in the IDE:

{code}
""C:\Program Files\Java\jdk1.8.0_121\bin\java"" -agentlib:jdwp=transport=dt_socket,address=127.0.0.1:62853,suspend=y,server=n -Disis.persistor.datanucleus.impl.javax.jdo.option.ConnectionDriverName=com.microsoft.sqlserver.jdbc.SQLServerDriver -Disis.persistor.datanucleus.impl.javax.jdo.option.ConnectionURL=jdbc:sqlserver://localhost:1433;instance=.;databaseName=estatio -Disis.persistor.datanucleus.impl.javax.jdo.option.ConnectionUserName=estatio -Disis.persistor.datanucleus.impl.javax.jdo.option.ConnectionPassword=estatio -Disis.persistor.datanucleus.impl.datanucleus.schema.autoCreateAll=false -javaagent:C:\Users\Dan\.IdeaIC2017.1\system\groovyHotSwap\gragent.jar -classpath C:\Users\Dan\AppData\Local\Temp\classpath2.jar -Dfile.encoding=UTF-8 org.apache.isis.WebServer -m org.estatio.app.EstatioEcpAppManifest
Connected to the target VM, address: '127.0.0.1:62853', transport: 'socket'
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/C:/Users/Dan/.m2/repository/org/apache/activemq/activemq-all/5.14.3/activemq-all-5.14.3.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/C:/Users/Dan/.m2/repository/org/slf4j/slf4j-log4j12/1.7.21/slf4j-log4j12-1.7.21.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
log4j:ERROR Could not find value for key log4j.appender.console
log4j:ERROR Could not instantiate appender named ""console"".
log4j:ERROR Could not find value for key log4j.appender.console
log4j:ERROR Could not instantiate appender named ""console"".
09:50:05,123 [OptionHandlerAppManifest      ] priming: isis.appManifest=org.estatio.app.EstatioEcpAppManifest
09:50:05,129 [IsisConfigurationDefault      ] adding isis.appManifest = org.estatio.app.EstatioEcpAppManifest
09:50:05,130 [OptionHandlerSystemProperties ] priming: isis.persistor.datanucleus.impl.datanucleus.schema.autoCreateAll=false
09:50:05,130 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.datanucleus.schema.autoCreateAll = false
09:50:05,130 [OptionHandlerSystemProperties ] priming: isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionDriverName=com.microsoft.sqlserver.jdbc.SQLServerDriver
09:50:05,130 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionDriverName = com.microsoft.sqlserver.jdbc.SQLServerDriver
09:50:05,130 [OptionHandlerSystemProperties ] priming: isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionPassword=estatio
09:50:05,130 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionPassword = *******
09:50:05,130 [OptionHandlerSystemProperties ] priming: isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionURL=jdbc:sqlserver://localhost:1433;instance=.;databaseName=estatio
09:50:05,130 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionURL = jdbc:sqlserver://localhost:1433;instance=.;databaseName=estatio
09:50:05,130 [OptionHandlerSystemProperties ] priming: isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionUserName=estatio
09:50:05,130 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionUserName = estatio
09:50:05,141 [IsisConfigurationDefault      ] adding isis.deploymentType = SERVER_PROTOTYPE
09:50:05,142 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionPassword = *******
09:50:05,142 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionURL = jdbc:sqlserver://localhost:1433;instance=.;databaseName=estatio
09:50:05,142 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.datanucleus.schema.autoCreateAll = false
09:50:05,142 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionDriverName = com.microsoft.sqlserver.jdbc.SQLServerDriver
09:50:05,142 [IsisConfigurationDefault      ] adding isis.appManifest = org.estatio.app.EstatioEcpAppManifest
09:50:05,142 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionUserName = estatio
09:50:05,142 [IsisConfigurationDefault      ] adding isis.deploymentType = SERVER_PROTOTYPE
09:50:05,142 [WebServer                     ] Running Jetty on port '8080' to serve the web application
09:50:05,194 [log                           ] Logging initialized @1086ms to org.eclipse.jetty.util.log.Slf4jLog
09:50:05,603 [ContextHandler                ] Empty contextPath
09:50:05,739 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionPassword = *******
09:50:05,739 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionURL = jdbc:sqlserver://localhost:1433;instance=.;databaseName=estatio
09:50:05,739 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.datanucleus.schema.autoCreateAll = false
09:50:05,739 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionDriverName = com.microsoft.sqlserver.jdbc.SQLServerDriver
09:50:05,739 [IsisConfigurationDefault      ] adding isis.appManifest = org.estatio.app.EstatioEcpAppManifest
09:50:05,739 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionUserName = estatio
09:50:05,739 [IsisConfigurationDefault      ] adding isis.deploymentType = SERVER_PROTOTYPE
09:50:05,745 [Server                        ] jetty-9.4.3.v20170317
09:50:06,134 [StandardDescriptorProcessor   ] NO JSP Support for /, did not find org.eclipse.jetty.jsp.JettyJspServlet
09:50:06,219 [session                       ] DefaultSessionIdManager workerName=node0
09:50:06,219 [session                       ] No SessionScavenger set, using defaults
09:50:06,225 [session                       ] Scavenging every 600000ms
09:50:06,253 [3de8f619                      ] Initializing Spring root WebApplicationContext
09:50:06,254 [ContextLoader                 ] Root WebApplicationContext: initialization started
09:50:06,502 [XmlWebApplicationContext      ] Refreshing Root WebApplicationContext: startup date [Fri Jul 07 09:50:06 BST 2017]; root of context hierarchy
09:50:06,602 [XmlBeanDefinitionReader       ] Loading XML bean definitions from class path resource [org/estatio/webapp/propertyPlaceholderConfigurer-config.xml]
09:50:06,725 [XmlBeanDefinitionReader       ] Loading XML bean definitions from class path resource [org/estatio/webapp/activemq-config.xml]
09:50:07,520 [XmlBeanDefinitionReader       ] Loading XML bean definitions from class path resource [org/estatio/routing/camel-config.xml]
09:50:08,872 [PropertyPlaceholderConfigurerUsingSpringOpts] Loading properties file from class path resource [org/estatio/webapp/spring.properties]
09:50:09,553 [BrokerService                 ] Loaded the Bouncy Castle security provider.
09:50:09,715 [BrokerService                 ] Using Persistence Adapter: JDBCPersistenceAdapter(org.datanucleus.store.rdbms.datasource.dbcp.BasicDataSource@16a5eb6d)
09:50:10,119 [JDBCPersistenceAdapter        ] Database adapter driver override recognized for : [hsql_database_engine_driver] - adapter: class org.apache.activemq.store.jdbc.adapter.HsqldbJDBCAdapter
09:50:10,167 [JDBCPersistenceAdapter        ] Database lock driver override not found for : [hsql_database_engine_driver].  Will use default implementation.
09:50:10,177 [DefaultDatabaseLocker         ] Attempting to acquire the exclusive lock to become the Master broker
09:50:10,188 [DefaultDatabaseLocker         ] Becoming the master on dataSource: org.datanucleus.store.rdbms.datasource.dbcp.BasicDataSource@16a5eb6d
09:50:10,197 [PListStoreImpl                ] PListStore:[C:\bitbucket\incodehq\estatio-ecp\estatioapp\webapp\activemq-data\broker\tmp_storage] started
09:50:10,482 [BrokerService                 ] Apache ActiveMQ 5.14.3 (broker, ID:HALCHILLBLAST-62863-1499417410231-0:1) is starting
09:50:10,518 [TransportConnector            ] Connector vm started
09:50:10,528 [BrokerService                 ] Apache ActiveMQ 5.14.3 (broker, ID:HALCHILLBLAST-62863-1499417410231-0:1) started
09:50:10,539 [BrokerService                 ] For help or more information please see: http://activemq.apache.org
09:50:10,553 [BrokerService                 ] Store limit is 102400 mb (current store usage is 0 mb). The data directory: C:\bitbucket\incodehq\estatio-ecp\estatioapp\webapp\activemq-data\broker only has 82418 mb of usable space. - resetting to maximum available disk space: 82418 mb
09:50:14,492 [ReflectionServiceFactoryBean  ] Creating Service {http://www.coda.com/efinance/schemas/elementmaster/elementmaster-12.0/webservice}ElementMasterServicePortTypesService from WSDL: classpath:org/incode/ecp/coda/wsdl/finance/elementmaster/elementmaster-12.0.wsdl
09:50:18,556 [ReflectionServiceFactoryBean  ] Creating Service {http://www.coda.com/efinance/schemas/elementmaster/elementmaster-12.0/webservice}ElementMasterServicePortTypesService from WSDL: classpath:org/incode/ecp/coda/wsdl/finance/elementmaster/elementmaster-12.0.wsdl
09:50:18,749 [ReflectionServiceFactoryBean  ] Creating Service {http://www.coda.com/efinance/schemas/inputext/input-12.0/webservice}InputServicePortTypesService from WSDL: classpath:org/incode/ecp/coda/wsdl/finance/inputext/input-12.0.wsdl
09:50:22,469 [ReflectionServiceFactoryBean  ] Creating Service {http://www.coda.com/efinance/schemas/selector/selector-1.0/webservice}SelectorServicePortTypesService from WSDL: classpath:org/incode/ecp/coda/wsdl/finance/selector/selector-1.0.wsdl
09:50:24,713 [SpringCamelContext            ] Apache Camel 2.16.3 (CamelContext: camel-1) is starting
09:50:24,718 [ManagedManagementStrategy     ] JMX is enabled
09:50:24,939 [DefaultTypeConverter          ] Loaded 201 type converters
09:50:24,980 [DefaultRuntimeEndpointRegistry] Runtime endpoint registry is in extended mode gathering usage statistics of all incoming and outgoing endpoints (cache limit: 1000)
09:50:25,172 [SpringCamelContext            ] AllowUseOriginalMessage is enabled. If access to the original message is not needed, then its recommended to turn this option off as it may improve performance.
09:50:25,174 [SpringCamelContext            ] StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
09:50:25,234 [JaxbDataFormat                ] Creating JAXBContext with contextPath: org.apache.isis.schema.ixn.v1 and ApplicationContextClassLoader: WebAppClassLoader=Estatio@2525ff7e
09:50:25,536 [SpringCamelContext            ] Route: inToOutRoute started and consuming from: Endpoint[activemq-broker://queue:memberInteractionsQueue]
09:50:25,539 [SpringCamelContext            ] Total 1 routes, of which 1 is started.
09:50:25,543 [SpringCamelContext            ] Apache Camel 2.16.3 (CamelContext: camel-1) started in 0.828 seconds
09:50:25,548 [ContextLoader                 ] Root WebApplicationContext: initialization completed in 19294 ms
09:50:25,550 [3de8f619                      ] Initializing Shiro environment
09:50:25,551 [EnvironmentLoader             ] Starting Shiro environment initialization.
09:50:26,470 [IniSecurityManagerFactory     ] Realms have been explicitly set on the SecurityManager instance - auto-setting of realms will not occur.
09:50:26,470 [EnvironmentLoader             ] Shiro environment initialized in 918 ms.
09:50:26,639 [i18n                          ] RESTEASY002225: Deploying javax.ws.rs.core.Application: class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
09:50:26,642 [i18n                          ] RESTEASY002200: Adding class resource org.apache.isis.viewer.restfulobjects.server.resources.HomePageResourceServerside from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
09:50:26,643 [i18n                          ] RESTEASY002200: Adding class resource org.apache.isis.viewer.restfulobjects.server.resources.DomainTypeResourceServerside from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
09:50:26,644 [i18n                          ] RESTEASY002200: Adding class resource org.apache.isis.viewer.restfulobjects.server.resources.UserResourceServerside from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
09:50:26,644 [i18n                          ] RESTEASY002200: Adding class resource org.apache.isis.viewer.restfulobjects.server.resources.DomainObjectResourceServerside from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
09:50:26,645 [i18n                          ] RESTEASY002200: Adding class resource org.apache.isis.viewer.restfulobjects.server.resources.DomainServiceResourceServerside from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
09:50:26,646 [i18n                          ] RESTEASY002200: Adding class resource org.apache.isis.viewer.restfulobjects.server.resources.VersionResourceServerside from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
09:50:26,646 [i18n                          ] RESTEASY002200: Adding class resource org.apache.isis.viewer.restfulobjects.server.resources.SwaggerSpecResource from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
09:50:26,647 [i18n                          ] RESTEASY002210: Adding provider singleton org.apache.isis.viewer.restfulobjects.server.conneg.RestfulObjectsJaxbWriterForXml from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
09:50:26,648 [i18n                          ] RESTEASY002210: Adding provider singleton org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplicationExceptionMapper from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
09:50:26,649 [i18n                          ] RESTEASY002210: Adding provider singleton org.apache.isis.viewer.restfulobjects.server.RuntimeExceptionMapper from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
09:50:26,649 [i18n                          ] RESTEASY002210: Adding provider singleton org.apache.isis.viewer.restfulobjects.rendering.service.acceptheader.AcceptHeaderServiceForRest$RequestFilter from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
09:50:26,650 [i18n                          ] RESTEASY002210: Adding provider singleton org.apache.isis.viewer.restfulobjects.rendering.service.acceptheader.AcceptHeaderServiceForRest$ResponseFilter from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
Jul 07, 2017 9:50:26 AM org.togglz.core.logging.Jdk14LogProvider$Jdk14Log info
INFO: Togglz 2.1.0.Final started
09:50:26,899 [WebXmlFile                    ] web.xml: url mapping found for filter with name WicketFilter: [/wicket/*]
09:50:27,064 [OptionHandlerInitParameters   ] priming configuration builder: 1 properties to prime
09:50:27,065 [OptionHandlerInitParameters   ] priming: isis.viewers=wicket,restfulobjects
09:50:27,066 [IsisConfigurationDefault      ] adding isis.viewers = wicket,restfulobjects
09:50:27,066 [IsisWebAppBootstrapper        ] Config override location: No override location configured
09:50:27,068 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionPassword = *******
09:50:27,068 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionURL = jdbc:sqlserver://localhost:1433;instance=.;databaseName=estatio
09:50:27,068 [IsisConfigurationDefault      ] adding isis.viewers = wicket,restfulobjects
09:50:27,068 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.datanucleus.schema.autoCreateAll = false
09:50:27,068 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionDriverName = com.microsoft.sqlserver.jdbc.SQLServerDriver
09:50:27,068 [IsisConfigurationDefault      ] adding isis.appManifest = org.estatio.app.EstatioEcpAppManifest
09:50:27,068 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionUserName = estatio
09:50:27,068 [IsisConfigurationDefault      ] adding isis.deploymentType = SERVER_PROTOTYPE
09:50:27,100 [Application                   ] [WicketFilter] init: Wicket core library initializer
09:50:27,104 [RequestListenerInterface      ] registered listener interface [RequestListenerInterface name=IBehaviorListener, method=public abstract void org.apache.wicket.behavior.IBehaviorListener.onRequest()]
09:50:27,106 [RequestListenerInterface      ] registered listener interface [RequestListenerInterface name=IFormSubmitListener, method=public abstract void org.apache.wicket.markup.html.form.IFormSubmitListener.onFormSubmitted()]
09:50:27,107 [RequestListenerInterface      ] registered listener interface [RequestListenerInterface name=ILinkListener, method=public abstract void org.apache.wicket.markup.html.link.ILinkListener.onLinkClicked()]
09:50:27,109 [RequestListenerInterface      ] registered listener interface [RequestListenerInterface name=IOnChangeListener, method=public abstract void org.apache.wicket.markup.html.form.IOnChangeListener.onSelectionChanged()]
09:50:27,111 [RequestListenerInterface      ] registered listener interface [RequestListenerInterface name=IResourceListener, method=public abstract void org.apache.wicket.IResourceListener.onResourceRequested()]
09:50:27,114 [Application                   ] [WicketFilter] init: DevUtils DebugBar Initializer
09:50:27,141 [Application                   ] [WicketFilter] init: Wicket extensions initializer
09:50:27,236 [wicket-webjars                ] initialize wicket webjars with given settings: WebjarsSettings{readFromCacheTimeout=3 seconds, resourceStreamProvider=ClassLoader, recentVersionPlaceHolder='current', assetPathCollectors=[de.agilecoders.wicket.webjars.collectors.ClasspathAssetPathCollector@36b17933, de.agilecoders.wicket.webjars.collectors.VfsAssetPathCollector@6675a6db, de.agilecoders.wicket.webjars.collectors.FileAssetPathCollector@60e9b05e], webjarsPackage='META-INF.resources.webjars', webjarsPath='META-INF/resources/webjars', resourcePattern=META-INF/resources/webjars/.*, webjarsPathPattern=/webjars/([^\/]*)\/([^\/]*)\/(.*), useCdnResources=false, cdnUrl='//cdn.jsdelivr.net:80'}
09:50:27,248 [wicket-jquery-selectors       ] initialize wicket jquery selectors with given settings: de.agilecoders.wicket.jquery.settings.WicketJquerySelectorsSettings@682b94bc
09:50:27,249 [wicket-jquery-selectors       ] try to get settings, but WicketJquerySelectors wasn't installed to current application. Fallback to default settings.
log4j:ERROR Could not find value for key log4j.appender.console
log4j:ERROR Could not instantiate appender named ""console"".
log4j:ERROR Could not find value for key log4j.appender.console
log4j:ERROR Could not instantiate appender named ""console"".
09:50:27,310 [IsisConfigurationBuilder      ] loading properties from isis.properties
09:50:27,310 [IsisConfigurationDefault      ] adding incode.module.docrendering.stringinterpolator.UrlDownloaderUsingNtlmCredentials.user = ECP/jvanderwal
09:50:27,310 [IsisConfigurationDefault      ] adding isis.services.PublisherServiceUsingActiveMq.memberInteractionsQueue = memberInteractionsQueue
09:50:27,310 [IsisConfigurationDefault      ] adding isis.viewer.wicket.rememberMe.encryptionKey = aa480e55-b5ba-417d-86a4-032558d87657
09:50:27,310 [IsisConfigurationDefault      ] adding estatio.application.cmisServerDefaultRepoBaseUrl = http://ams-s-nuxeo02.ecp.loc/nuxeo/nxdoc/default
09:50:27,311 [IsisConfigurationDefault      ] ignoring isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionPassword= as value already set (with estatio)
09:50:27,311 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.javax.jdo.PersistenceManagerFactoryClass = org.isisaddons.module.flywaydb.dom.FlywayJdoPersistenceManagerFactory
09:50:27,312 [IsisConfigurationDefault      ] adding isis.service.email.sender.password = *******
09:50:27,312 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.datanucleus.Mapping = sqlserver
09:50:27,312 [IsisConfigurationDefault      ] adding isis.service.email.override.to = jeroen@stromboli.it
09:50:27,312 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.flyway.baselineOnMigrate = true
09:50:27,312 [IsisConfigurationDefault      ] adding org.apache.isis.viewer.restfulobjects.rendering.eventserializer.RestfulObjectsSpecEventSerializer.baseUrl = http://localhost:8080/restful/
09:50:27,312 [IsisConfigurationDefault      ] adding isis.service.email.tls.enabled = false
09:50:27,312 [IsisConfigurationDefault      ] ignoring isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionDriverName=org.hsqldb.jdbcDriver as value already set (with com.microsoft.sqlserver.jdbc.SQLServerDriver)
09:50:27,312 [IsisConfigurationDefault      ] adding isis.service.email.override.bcc = 
09:50:27,312 [IsisConfigurationDefault      ] adding isis.services.PublisherServiceUsingActiveMq.vmTransportUri = vm://broker
09:50:27,312 [IsisConfigurationDefault      ] adding isis.persistor.disableConcurrencyChecking = false
09:50:27,312 [IsisConfigurationDefault      ] adding isis.service.email.port = 25
09:50:27,312 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.datanucleus.schema.validateAll = true
09:50:27,312 [IsisConfigurationDefault      ] adding incode.module.docrendering.stringinterpolator.UrlDownloaderUsingNtlmCredentials.host = ams-s-sql08
09:50:27,312 [IsisConfigurationDefault      ] ignoring isis.persistor.datanucleus.impl.datanucleus.schema.autoCreateAll=true as value already set (with false)
09:50:27,312 [IsisConfigurationDefault      ] adding isis.service.email.sender.hostname = proxy.ecp.loc
09:50:27,312 [IsisConfigurationDefault      ] adding isis.viewer.restfulobjects.RestfulObjectsSpecEventSerializer.baseUrl = http://localhost:8080/restful/
09:50:27,312 [IsisConfigurationDefault      ] ignoring isis.appManifest=org.estatio.app.EstatioEcpAppManifest as value already set (with org.estatio.app.EstatioEcpAppManifest)
09:50:27,312 [IsisConfigurationDefault      ] adding isis.service.email.override.cc = 
09:50:27,312 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.flyway.schemas = dbo,incodeClassification,incodeDocFragment,incodeDocuments,isisaudit,isiscommand,isispublishmq,isissecurity,isissessionlogger,isissettings
09:50:27,312 [IsisConfigurationDefault      ] adding isis.service.email.sender.address = no-reply@eurocommercialproperties.com
09:50:27,312 [IsisConfigurationDefault      ] ignoring isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionURL=jdbc:hsqldb:mem:test;sqllog=3 as value already set (with jdbc:sqlserver://localhost:1433;instance=.;databaseName=estatio)
09:50:27,312 [IsisConfigurationDefault      ] ignoring isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionUserName=sa as value already set (with estatio)
09:50:27,316 [IsisConfigurationDefault      ] adding incode.module.docrendering.stringinterpolator.UrlDownloaderUsingNtlmCredentials.password = *******
09:50:27,316 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.flyway.baselineVersion = 20161202.1515
09:50:27,316 [IsisConfigurationDefault      ] adding estatio.application.reportServerBaseUrl = http://www.pdfpdf.com/samples/Sample5.PDF?name=
09:50:27,316 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.datanucleus.schema.autoCreateConstraints = true
09:50:27,325 [IsisConfigurationBuilder      ] loading properties from viewer_wicket.properties
09:50:27,330 [IsisConfigurationBuilder      ] loading properties from viewer_restfulobjects.properties
09:50:27,330 [IsisConfigurationBuilder      ] loading properties from persistor_datanucleus.properties
09:50:27,331 [IsisConfigurationBuilder      ] loading properties from persistor.properties
09:50:27,379 [IsisConfigurationDefault      ] overwriting isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionUserName=estatio (previous value was estatio)
09:50:27,379 [IsisConfigurationDefault      ] overwriting isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionPassword=estatio (previous value was estatio)
09:50:27,379 [IsisConfigurationDefault      ] overwriting isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionURL=jdbc:sqlserver://localhost:1433;instance=.;databaseName=estatio (previous value was jdbc:sqlserver://localhost:1433;instance=.;databaseName=estatio)
09:50:27,379 [IsisConfigurationDefault      ] overwriting isis.persistor.datanucleus.impl.datanucleus.schema.autoCreateAll=false (previous value was false)
09:50:27,379 [IsisConfigurationDefault      ] overwriting isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionDriverName=com.microsoft.sqlserver.jdbc.SQLServerDriver (previous value was com.microsoft.sqlserver.jdbc.SQLServerDriver)
09:50:28,118 [IsisConfigurationDefault      ] overwriting isis.appManifest=org.estatio.app.EstatioEcpAppManifest (previous value was org.estatio.app.EstatioEcpAppManifest)
09:50:32,059 [IsisConfigurationDefault      ] adding isis.services.ServicesInstallerFromAnnotation.packagePrefix = org.estatio.dom,org.estatio.dom.agreement,org.estatio.dom.asset,org.estatio.dom.assetfinancial,org.estatio.dom.bankmandate,org.estatio.dom.budgeting,org.estatio.dom.budgetassignment,org.estatio.charge,org.estatio.dom.charge,org.estatio.capex,org.estatio.capex.dom,org.estatio.dom.currency,org.estatio.dom.document,org.estatio.dom.event,org.estatio.dom.financial,org.estatio.dom.guarantee,org.estatio.dom.index,org.estatio.dom.invoice,org.estatio.dom.lease,org.estatio.lease.fixture,org.estatio.domlink,org.estatio.numerator,org.estatio.dom.party,org.estatio.domsettings,org.estatio.dom.asset.registration,org.estatio.dom.tax,org.estatio.dom.dto,org.incode.module.country.dom,org.incode.module.communications.dom,org.incode.module.docfragment.dom,org.incode.module.document.dom,org.incode.module.classification.dom,org.estatio.capex.fixture,org.estatio.fixture,org.estatio.fixturescripts,org.isisaddons.module.pdfbox.dom,org.incode.module.docrendering.stringinterpolator.dom,org.isisaddons.module.security,org.isisaddons.module.command,org.isisaddons.module.togglz,org.estatio.app,org.isisaddons.module.excel,org.isisaddons.module.poly,org.isisaddons.module.sessionlogger,org.isisaddons.module.stringinterpolator,org.isisaddons.module.freemarker.dom,org.isisaddons.module.xdocreport.dom,org.isisaddons.wicket.excel.cpt.ui,org.isisaddons.wicket.fullcalendar2.cpt.ui,org.isisaddons.wicket.fullcalendar2.cpt.applib,org.isisaddons.wicket.gmap3.cpt.applib,org.isisaddons.wicket.gmap3.cpt.service,org.isisaddons.wicket.gmap3.cpt.ui,org.isisaddons.module.audit,org.isisaddons.module.command,org.isisaddons.module.publishmq
09:50:32,059 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.RegisterEntities.packagePrefix = org.estatio.dom,org.estatio.dom.agreement,org.estatio.dom.asset,org.estatio.dom.assetfinancial,org.estatio.dom.bankmandate,org.estatio.dom.budgeting,org.estatio.dom.budgetassignment,org.estatio.charge,org.estatio.dom.charge,org.estatio.capex,org.estatio.capex.dom,org.estatio.dom.currency,org.estatio.dom.document,org.estatio.dom.event,org.estatio.dom.financial,org.estatio.dom.guarantee,org.estatio.dom.index,org.estatio.dom.invoice,org.estatio.dom.lease,org.estatio.lease.fixture,org.estatio.domlink,org.estatio.numerator,org.estatio.dom.party,org.estatio.domsettings,org.estatio.dom.asset.registration,org.estatio.dom.tax,org.estatio.dom.dto,org.incode.module.country.dom,org.incode.module.communications.dom,org.incode.module.docfragment.dom,org.incode.module.document.dom,org.incode.module.classification.dom,org.estatio.capex.fixture,org.estatio.fixture,org.estatio.fixturescripts,org.isisaddons.module.pdfbox.dom,org.incode.module.docrendering.stringinterpolator.dom,org.isisaddons.module.security,org.isisaddons.module.command,org.isisaddons.module.togglz,org.estatio.app,org.isisaddons.module.excel,org.isisaddons.module.poly,org.isisaddons.module.sessionlogger,org.isisaddons.module.stringinterpolator,org.isisaddons.module.freemarker.dom,org.isisaddons.module.xdocreport.dom,org.isisaddons.wicket.excel.cpt.ui,org.isisaddons.wicket.fullcalendar2.cpt.ui,org.isisaddons.wicket.fullcalendar2.cpt.applib,org.isisaddons.wicket.gmap3.cpt.applib,org.isisaddons.wicket.gmap3.cpt.service,org.isisaddons.wicket.gmap3.cpt.ui,org.isisaddons.module.audit,org.isisaddons.module.command,org.isisaddons.module.publishmq
09:50:32,062 [IsisConfigurationDefault      ] adding isis.services = org.incode.module.base.services.calendar.CalendarService,org.isisaddons.module.security.dom.password.PasswordEncryptionServiceUsingJBcrypt,org.isisaddons.module.security.dom.permission.PermissionsEvaluationServiceAllowBeatsVeto
09:50:32,063 [IsisConfigurationDefault      ] adding isis.services.eventbus.implementation = axon
09:50:32,063 [IsisConfigurationDefault      ] adding isis.viewer.restfulobjects.suppressMemberDisabledReason = true
09:50:32,063 [IsisConfigurationDefault      ] adding isis.services.publish.actions = ignoreSafe
09:50:32,063 [IsisConfigurationDefault      ] adding isis.reflector.validator.serviceActionsOnly = true
09:50:32,063 [IsisConfigurationDefault      ] adding isis.reflector.validator.jdoqlFromClause = false
09:50:32,063 [IsisConfigurationDefault      ] adding isis.services.command.actions = ignoreQueryOnly
09:50:32,063 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.datanucleus.deletionPolicy = DataNucleus
09:50:32,063 [IsisConfigurationDefault      ] adding isis.reflector.validator.explicitObjectType = true
09:50:32,063 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.datanucleus.defaultInheritanceStrategy = TABLE_PER_CLASS
09:50:32,063 [IsisConfigurationDefault      ] adding isis.reflector.facets.include = org.isisaddons.module.security.facets.TenantedAuthorizationFacetFactory,org.isisaddons.metamodel.paraname8.NamedFacetOnParameterParaname8Factory,org.isisaddons.wicket.pdfjs.cpt.applib.PdfJsViewerFacetFromAnnotationFactory
09:50:32,063 [IsisConfigurationDefault      ] adding isis.viewers.paged.standalone = 30
09:50:32,063 [IsisConfigurationDefault      ] adding isis.services.audit.objects = all
09:50:32,063 [IsisConfigurationDefault      ] adding isis.viewers.paged.parented = 10
09:50:32,063 [IsisConfigurationDefault      ] adding isis.viewer.restfulobjects.objectPropertyValuesOnly = true
09:50:32,063 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.datanucleus.persistenceByReachabilityAtCommit = false
09:50:32,063 [IsisConfigurationDefault      ] adding isis.reflector.validator.noParamsOnly = true
09:50:32,063 [IsisConfigurationDefault      ] adding isis.objects.editing = false
09:50:32,063 [IsisConfigurationDefault      ] adding isis.services.injector.injectPrefix = true
09:50:32,063 [IsisConfigurationDefault      ] adding isis.viewer.wicket.themes.showChooser = true
09:50:32,063 [IsisConfigurationDefault      ] adding isis.reflector.facet.cssClassFa.patterns = new.*:fa-plus,add.*:fa-plus-square,attach.*:fa-plus-square,create.*:fa-plus,update.*:fa-edit,save.*:fa-floppy-o,change.*:fa-edit,maintain.*:fa-edit,remove.*:fa-minus-square,detach.*:fa-minus-square,copy.*:fa-copy,move.*:fa-arrow-right,first.*:fa-star,find.*:fa-search,lookup.*:fa-search,search.*:fa-search,view.*:fa-search,clear.*:fa-remove,previous.*:fa-step-backward,next.*:fa-step-forward,list.*:fa-list,all.*:fa-list,download.*:fa-download,upload.*:fa-upload,export.*:fa-download,import.*:fa-upload,switch.*:fa-exchange,execute.*:fa-bolt,run.*:fa-bolt,calculate.*:fa-calculator,verify.*:fa-check-circle,check.*:fa-check-circle,refresh.*:fa-refresh,install.*:fa-wrench,stop.*:fa-stop,terminate.*:fa-stop,cancel.*:fa-stop,discard.*:fa-trash-o,pause.*:fa-pause,suspend.*:fa-pause,resume.*:fa-play,renew.*:fa-repeat,reset.*:fa-repeat,categorise.*:fa-folder-open-o,edit.*:fa-pencil-square-o,assign.*:fa-hand-o-right,approve.*:fa-thumbs-o-up,decline.*:fa-thumbs-o-down
09:50:32,063 [IsisConfigurationDefault      ] adding isis.viewer.wicket.maxTitleLengthInStandaloneTables = 0
09:50:32,063 [IsisConfigurationDefault      ] adding isis.viewer.wicket.developmentUtilities.enable = true
09:50:32,063 [IsisConfigurationDefault      ] adding isis.viewer.wicket.maxTitleLengthInParentedTables = 0
09:50:32,063 [IsisConfigurationDefault      ] adding datanucleus.cache.queryCompilation.type = soft
09:50:32,063 [IsisConfigurationDefault      ] adding isis.reflector.facet.cssClass.patterns = update.*:btn-default,change.*:btn-default,maintain.*:btn-default,delete.*:btn-danger,discard.*:btn-warning,remove.*:btn-warning
09:50:32,066 [IsisConfigurationDefault      ] adding datanucleus.cache.queryCompilationDatastore.type = soft
09:50:32,066 [IsisConfigurationDefault      ] adding isis.persistor.datanucleus.impl.datanucleus.identifier.case = MixedCase
09:50:32,066 [IsisConfigurationDefault      ] adding isis.services.eventbus.allowLateRegistration = true
09:50:32,072 [ServicesInstallerFromConfigurationAndAnnotation] installing org.apache.isis.core.runtime.services.ServicesInstallerFromConfigurationAndAnnotation
09:50:32,661 [IsisSessionFactoryBuilder     ] initialising Isis System
09:50:32,661 [IsisSessionFactoryBuilder     ] working directory: C:\bitbucket\incodehq\estatio-ecp\estatioapp\webapp\.
09:50:32,661 [IsisSessionFactoryBuilder     ] resource stream source: chain [file system (directory 'C:\bitbucket\incodehq\estatio-ecp\estatioapp\webapp\src\main\webapp\WEB-INF'), context loader classpath, context loader classpath, context loader classpath, current class' classpath, servlet context ('/WEB-INF')]
09:50:41,408 [PersistenceSessionFactory     ] did *not* find config properties to use JNDI datasource; will use JDBC
09:50:41,952 [VersionPrinter                ] Flyway 4.0.3 by Boxfuse
09:50:42,457 [DbSupportFactory              ] Database: jdbc:sqlserver://localhost:1433;authenticationScheme=nativeAuthentication;xopenStates=false;sendTimeAsDatetime=true;trustServerCertificate=false;sendStringParametersAsUnicode=true;selectMethod=direct;responseBuffering=adaptive;packetSize=8000;multiSubnetFailover=false;loginTimeout=15;lockTimeout=-1;lastUpdateCount=true;encrypt=false;disableStatementPooling=true;databaseName=estatio;applicationName=Microsoft JDBC Driver for SQL Server;applicationIntent=readwrite; (Microsoft SQL Server 13.0)
09:50:42,982 [MetaDataTableImpl             ] Repair of failed migration in metadata table [dbo].[schema_version] not necessary. No failed migration detected.
09:50:43,286 [DbRepair                      ] Successfully repaired metadata table [dbo].[schema_version] (execution time 00:00.314s).
09:50:43,288 [SQLServerDbSupport            ] SQLServer does not support setting the schema for the current session. Default schema NOT changed to dbo
09:50:43,437 [DbValidate                    ] Successfully validated 150 migrations (execution time 00:00.110s)
09:50:43,481 [DbMigrate                     ] Current version of schema [dbo]: 20170630.1100
09:50:43,482 [DbMigrate                     ] Schema [dbo] is up to date. No migration necessary.
09:50:43,563 [MLog                          ] MLog clients using log4j logging.
09:50:43,650 [C3P0Registry                  ] Initializing c3p0-0.9.1.1 [built 15-March-2007 01:32:31; debug? true; trace: 10]
09:50:43,962 [AbstractPoolBackedDataSource  ] Initializing c3p0 pool... com.mchange.v2.c3p0.PoolBackedDataSource@301da0d [ connectionPoolDataSource -> com.mchange.v2.c3p0.WrapperConnectionPoolDataSource@96a93c91 [ acquireIncrement -> 3, acquireRetryAttempts -> 30, acquireRetryDelay -> 1000, autoCommitOnClose -> false, automaticTestTable -> null, breakAfterAcquireFailure -> false, checkoutTimeout -> 0, connectionCustomizerClassName -> null, connectionTesterClassName -> com.mchange.v2.c3p0.impl.DefaultConnectionTester, debugUnreturnedConnectionStackTraces -> false, factoryClassLocation -> null, forceIgnoreUnresolvedTransactions -> false, identityToken -> 2rwcn59p7u4ems1y2hj6a|591b8063, idleConnectionTestPeriod -> 0, initialPoolSize -> 3, maxAdministrativeTaskTime -> 0, maxConnectionAge -> 0, maxIdleTime -> 0, maxIdleTimeExcessConnections -> 0, maxPoolSize -> 15, maxStatements -> 0, maxStatementsPerConnection -> 0, minPoolSize -> 3, nestedDataSource -> com.mchange.v2.c3p0.DriverManagerDataSource@9b1b7008 [ description -> null, driverClass -> null, factoryClassLocation -> null, identityToken -> 2rwcn59p7u4ems1y2hj6a|381f2af0, jdbcUrl -> jdbc:sqlserver://localhost:1433;instance=.;databaseName=estatio, properties -> {user=******, password=******} ], preferredTestQuery -> null, propertyCycle -> 0, testConnectionOnCheckin -> false, testConnectionOnCheckout -> false, unreturnedConnectionTimeout -> 0, usesTraditionalReflectiveProxies -> false; userOverrides: {} ], dataSourceName -> null, factoryClassLocation -> null, identityToken -> 2rwcn59p7u4ems1y2hj6a|236e33ca, numHelperThreads -> 3 ]
09:50:48,250 [Datastore                     ] Column dbo.Invoice.status should not allow nulls but does. You can prevent nulls by specifying ""allows-null"" as ""false"" for the <field> in the MetaData
09:50:48,250 [Datastore                     ] Column dbo.Invoice.status should not allow nulls but does. You can prevent nulls by specifying ""allows-null"" as ""false"" for the <field> in the MetaData
09:50:53,750 [MetaData                      ] Class ""org.estatio.dom.party.OrganisationPreviousName"" : @Unique specified but had no field/column specification and so is ignored
09:50:53,750 [MetaData                      ] Class ""org.estatio.dom.party.OrganisationPreviousName"" : @Unique specified but had no field/column specification and so is ignored
09:51:03,941 [AbstractPoolBackedDataSource  ] Initializing c3p0 pool... com.mchange.v2.c3p0.PoolBackedDataSource@1d91c53c [ connectionPoolDataSource -> com.mchange.v2.c3p0.WrapperConnectionPoolDataSource@99eb802d [ acquireIncrement -> 3, acquireRetryAttempts -> 30, acquireRetryDelay -> 1000, autoCommitOnClose -> false, automaticTestTable -> null, breakAfterAcquireFailure -> false, checkoutTimeout -> 0, connectionCustomizerClassName -> null, connectionTesterClassName -> com.mchange.v2.c3p0.impl.DefaultConnectionTester, debugUnreturnedConnectionStackTraces -> false, factoryClassLocation -> null, forceIgnoreUnresolvedTransactions -> false, identityToken -> 2rwcn59p7u4ems1y2hj6a|17658efb, idleConnectionTestPeriod -> 0, initialPoolSize -> 3, maxAdministrativeTaskTime -> 0, maxConnectionAge -> 0, maxIdleTime -> 0, maxIdleTimeExcessConnections -> 0, maxPoolSize -> 15, maxStatements -> 0, maxStatementsPerConnection -> 0, minPoolSize -> 3, nestedDataSource -> com.mchange.v2.c3p0.DriverManagerDataSource@63b89f37 [ description -> null, driverClass -> null, factoryClassLocation -> null, identityToken -> 2rwcn59p7u4ems1y2hj6a|39469104, jdbcUrl -> jdbc:sqlserver://localhost:1433;instance=.;databaseName=estatio, properties -> {user=******, password=******} ], preferredTestQuery -> null, propertyCycle -> 0, testConnectionOnCheckin -> false, testConnectionOnCheckout -> false, unreturnedConnectionTimeout -> 0, usesTraditionalReflectiveProxies -> false; userOverrides: {} ], dataSourceName -> null, factoryClassLocation -> null, identityToken -> 2rwcn59p7u4ems1y2hj6a|1e374429, numHelperThreads -> 3 ]
09:51:07,403 [MetaData                      ] Class ""org.estatio.dom.party.OrganisationPreviousName"" : @Unique specified but had no field/column specification and so is ignored
09:51:07,403 [MetaData                      ] Class ""org.estatio.dom.party.OrganisationPreviousName"" : @Unique specified but had no field/column specification and so is ignored
09:51:12,166 [AbstractPoolBackedDataSource  ] Initializing c3p0 pool... com.mchange.v2.c3p0.PoolBackedDataSource@ae80d358 [ connectionPoolDataSource -> com.mchange.v2.c3p0.WrapperConnectionPoolDataSource@15390c7f [ acquireIncrement -> 3, acquireRetryAttempts -> 30, acquireRetryDelay -> 1000, autoCommitOnClose -> false, automaticTestTable -> null, breakAfterAcquireFailure -> false, checkoutTimeout -> 0, connectionCustomizerClassName -> null, connectionTesterClassName -> com.mchange.v2.c3p0.impl.DefaultConnectionTester, debugUnreturnedConnectionStackTraces -> false, factoryClassLocation -> null, forceIgnoreUnresolvedTransactions -> false, identityToken -> 2rwcn59p7u4ems1y2hj6a|1e82eb3d, idleConnectionTestPeriod -> 0, initialPoolSize -> 3, maxAdministrativeTaskTime -> 0, maxConnectionAge -> 0, maxIdleTime -> 0, maxIdleTimeExcessConnections -> 0, maxPoolSize -> 15, maxStatements -> 0, maxStatementsPerConnection -> 0, minPoolSize -> 3, nestedDataSource -> com.mchange.v2.c3p0.DriverManagerDataSource@89645b40 [ description -> null, driverClass -> null, factoryClassLocation -> null, identityToken -> 2rwcn59p7u4ems1y2hj6a|32a395d2, jdbcUrl -> jdbc:sqlserver://localhost:1433;instance=.;databaseName=estatio, properties -> {user=******, password=******} ], preferredTestQuery -> null, propertyCycle -> 0, testConnectionOnCheckin -> false, testConnectionOnCheckout -> false, unreturnedConnectionTimeout -> 0, usesTraditionalReflectiveProxies -> false; userOverrides: {} ], dataSourceName -> null, factoryClassLocation -> null, identityToken -> 2rwcn59p7u4ems1y2hj6a|7e339372, numHelperThreads -> 3 ]
document-types-and-templates-fixture                        : EXEC org.estatio.fixturescripts.DocumentTypesAndTemplatesFixture
document-types-and-templates-fixture/rendering-strategies   : EXEC org.estatio.fixture.documents.RenderingStrategies
document-types-and-templates-fixture/rendering-strategies/rendering-strategy-fs-for-string-interpolator-preview-and-capture-url             : EXEC org.incode.module.docrendering.stringinterpolator.fixture.RenderingStrategyFSForStringInterpolatorPreviewAndCaptureUrl
document-types-and-templates-fixture/rendering-strategies/rendering-strategy-fs-for-string-interpolator-preview-and-capture-url/item-1      : [SIPC] String interpolate URL for Preview and Capture
document-types-and-templates-fixture/rendering-strategies/rendering-strategy-fs-for-string-interpolator-capture-url                         : EXEC org.incode.module.docrendering.stringinterpolator.fixture.RenderingStrategyFSForStringInterpolatorCaptureUrl
document-types-and-templates-fixture/rendering-strategies/rendering-strategy-fs-for-string-interpolator-capture-url/item-1                  : [SINC] String interpolate URL for Capture (no preview)
document-types-and-templates-fixture/rendering-strategies/rendering-strategy-fs-for-string-interpolator                                     : EXEC org.incode.module.docrendering.stringinterpolator.fixture.RenderingStrategyFSForStringInterpolator
document-types-and-templates-fixture/rendering-strategies/rendering-strategy-fs-for-string-interpolator/item-1                              : [SI] String interpolate
document-types-and-templates-fixture/rendering-strategies/rendering-strategy-fs-for-freemarker                                              : EXEC org.incode.module.docrendering.freemarker.fixture.RenderingStrategyFSForFreemarker
document-types-and-templates-fixture/rendering-strategies/rendering-strategy-fs-for-freemarker/item-1                                       : [FMK] RendererForFreemarker Rendering Strategy
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs                                                 : EXEC org.estatio.fixture.documents.DocumentTypeAndTemplatesFSForInvoicesUsingSsrs
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/application-tenancy-for-global                  : EXEC org.estatio.fixture.security.tenancy.ApplicationTenancyForGlobal
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/application-tenancy-for-global/Global           :  /
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/application-tenancy-for-it                      : EXEC org.estatio.fixture.security.tenancy.ApplicationTenancyForIt
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/application-tenancy-for-it/Italy                : /ITA
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/rendering-strategies                            : SKIP org.estatio.fixture.documents.RenderingStrategies
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-1                                          : [COVER-NOTE-PRELIM-LETTER] Email Cover Note for Preliminary Letter
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-2                                          : [COVER-NOTE-PRELIM-LETTER] (2012-01-01)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-3                                          : [COVER-NOTE-PRELIM-LETTER] (2012-01-01)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-4                                          : [COVER-NOTE-PRELIM-LETTER] (2012-01-01)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-5                                          : [COVER-NOTE-PRELIM-LETTER] (2012-01-01)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-6                                          : [PRELIM-LETTER] Preliminary letter for Invoice
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-7                                          : [PRELIM-LETTER] (2012-01-01)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-8                                          : [PRELIM-LETTER] (2012-01-01)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-9                                          : [COVER-NOTE-INVOICE] Email Cover Note for Invoice
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-10                                         : [COVER-NOTE-INVOICE] (2012-01-01)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-11                                         : [COVER-NOTE-INVOICE] (2012-01-01)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-12                                         : [COVER-NOTE-INVOICE] (2012-01-01)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-13                                         : [COVER-NOTE-INVOICE] (2012-01-01)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-14                                         : [INVOICE] Invoice
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-15                                         : [INVOICE] (2012-01-01)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-16                                         : [INVOICE] (2012-01-01)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-17                                         : [SUPPLIER-RECEIPT] Supplier Receipt (for Invoice)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-18                                         : [TAX-REGISTER] Tax Register (for Invoice)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-19                                         : [SPECIAL-COMMUNICATION] Special Communication (for Preliminary Letter)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-20                                         : [CALCULATION] Calculation (for Preliminary Letter)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-21                                         : [INVOICES] Invoices overview
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-22                                         : [INVOICES] (2012-01-01)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-23                                         : [INVOICES-PRELIM] Preliminary letter for Invoices
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-24                                         : [INVOICES-PRELIM] (2012-01-01)
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-25                                         : [INVOICES-FOR-SELLER] Preliminary Invoice for Seller
document-types-and-templates-fixture/document-type-and-templates-fs-for-invoices-using-ssrs/item-26                                         : [INVOICES-FOR-SELLER] (2012-01-01)
document-types-and-templates-fixture/document-type-fs-for-incoming                                                                          : EXEC org.estatio.fixture.documents.DocumentTypeFSForIncoming
document-types-and-templates-fixture/document-type-fs-for-incoming/item-1                                                                   : [INCOMING] Incoming
document-types-and-templates-fixture/document-type-fs-for-incoming/item-2                                                                   : [INCOMING_INVOICE] Incoming Invoice
document-types-and-templates-fixture/document-type-fs-for-incoming/item-3                                                                   : [INCOMING_ORDER] Incoming Order
document-types-and-templates-fixture/document-type-fs-for-iban-proof                                                                        : EXEC org.estatio.fixture.documents.DocumentTypeFSForIbanProof
document-types-and-templates-fixture/document-type-fs-for-iban-proof/item-1                                                                 : [IBAN_PROOF] Iban verification proof
doc-fragment-seed-fixture                                   : EXEC org.estatio.lease.fixture.seed.DocFragmentSeedFixture
doc-fragment-seed-fixture/                                  : EXEC org.estatio.lease.fixture.seed.DocFragmentData$1$1
doc-fragment-seed-fixture/                                  : EXEC org.estatio.lease.fixture.seed.DocFragmentData$2$1
doc-fragment-seed-fixture/                                  : EXEC org.estatio.lease.fixture.seed.DocFragmentData$3$1
doc-fragment-seed-fixture/                                  : EXEC org.estatio.lease.fixture.seed.DocFragmentData$4$1
doc-fragment-seed-fixture/                                  : EXEC org.estatio.lease.fixture.seed.DocFragmentData$5$1
doc-fragment-seed-fixture/                                  : EXEC org.estatio.lease.fixture.seed.DocFragmentData$6$1
09:51:13,123 [EmailServiceDefault           ] NOT configured
seed-users-and-roles-fixture-script                         : EXEC org.isisaddons.module.security.seed.SeedUsersAndRolesFixtureScript
seed-users-and-roles-fixture-script/global-tenancy          : EXEC org.isisaddons.module.security.seed.scripts.GlobalTenancy
seed-users-and-roles-fixture-script/global-tenancy/Global   :  /
seed-users-and-roles-fixture-script/isis-module-security-admin-role-and-permissions                 : EXEC org.isisaddons.module.security.seed.scripts.IsisModuleSecurityAdminRoleAndPermissions
seed-users-and-roles-fixture-script/isis-module-security-fixture-role-and-permissions               : EXEC org.isisaddons.module.security.seed.scripts.IsisModuleSecurityFixtureRoleAndPermissions
seed-users-and-roles-fixture-script/isis-module-security-regular-user-role-and-permissions          : EXEC org.isisaddons.module.security.seed.scripts.IsisModuleSecurityRegularUserRoleAndPermissions
seed-users-and-roles-fixture-script/isis-module-security-admin-user                                 : EXEC org.isisaddons.module.security.seed.scripts.IsisModuleSecurityAdminUser
seed-users-and-roles-fixture-script/isis-applib-fixture-results-role-and-permissions                : EXEC org.isisaddons.module.security.seed.scripts.IsisApplibFixtureResultsRoleAndPermissions
09:51:13,856 [FakeValuesService             ] Using locale en
estatio-security-module-seed-fixture                        : EXEC org.estatio.fixture.security.EstatioSecurityModuleSeedFixture
estatio-security-module-seed-fixture/seed-users-and-roles-fixture-script        : EXEC org.isisaddons.module.security.seed.SeedUsersAndRolesFixtureScript
estatio-security-module-seed-fixture/seed-users-and-roles-fixture-script/global-tenancy             : EXEC org.isisaddons.module.security.seed.scripts.GlobalTenancy
estatio-security-module-seed-fixture/seed-users-and-roles-fixture-script/global-tenancy/Global      :  /
estatio-security-module-seed-fixture/seed-users-and-roles-fixture-script/isis-module-security-admin-role-and-permissions                    : EXEC org.isisaddons.module.security.seed.scripts.IsisModuleSecurityAdminRoleAndPermissions
estatio-security-module-seed-fixture/seed-users-and-roles-fixture-script/isis-module-security-fixture-role-and-permissions                  : EXEC org.isisaddons.module.security.seed.scripts.IsisModuleSecurityFixtureRoleAndPermissions
estatio-security-module-seed-fixture/seed-users-and-roles-fixture-script/isis-module-security-regular-user-role-and-permissions             : EXEC org.isisaddons.module.security.seed.scripts.IsisModuleSecurityRegularUserRoleAndPermissions
estatio-security-module-seed-fixture/seed-users-and-roles-fixture-script/isis-module-security-admin-user                                    : EXEC org.isisaddons.module.security.seed.scripts.IsisModuleSecurityAdminUser
estatio-security-module-seed-fixture/seed-users-and-roles-fixture-script/isis-applib-fixture-results-role-and-permissions                   : EXEC org.isisaddons.module.security.seed.scripts.IsisApplibFixtureResultsRoleAndPermissions
estatio-security-module-seed-fixture/application-tenancy-for-global                                                                         : EXEC org.estatio.fixture.security.tenancy.ApplicationTenancyForGlobal
estatio-security-module-seed-fixture/application-tenancy-for-global/Global                                                                  :  /
estatio-security-module-seed-fixture/application-tenancy-for-global-only                                                                    : EXEC org.estatio.fixture.security.tenancy.ApplicationTenancyForGlobalOnly
estatio-security-module-seed-fixture/application-tenancy-for-global-only/Global Only                                                        : /_
estatio-security-module-seed-fixture/application-tenancy-for-fr                                                                             : EXEC org.estatio.fixture.security.tenancy.ApplicationTenancyForFr
estatio-security-module-seed-fixture/application-tenancy-for-fr/France                                                                      : /FRA
estatio-security-module-seed-fixture/application-tenancy-for-fr-other                                                                       : EXEC org.estatio.fixture.security.tenancy.ApplicationTenancyForFrOther
estatio-security-module-seed-fixture/application-tenancy-for-fr-other/France Other                                                          : /FRA/_
estatio-security-module-seed-fixture/application-tenancy-for-it                                                                             : EXEC org.estatio.fixture.security.tenancy.ApplicationTenancyForIt
estatio-security-module-seed-fixture/application-tenancy-for-it/Italy                                                                       : /ITA
estatio-security-module-seed-fixture/application-tenancy-for-it-other                                                                       : EXEC org.estatio.fixture.security.tenancy.ApplicationTenancyForItOther
estatio-security-module-seed-fixture/application-tenancy-for-it-other/Italy Other                                                           : /ITA/_
estatio-security-module-seed-fixture/application-tenancy-for-nl                                                                             : EXEC org.estatio.fixture.security.tenancy.ApplicationTenancyForNl
estatio-security-module-seed-fixture/application-tenancy-for-nl/NLD                                                                         : /NLD
estatio-security-module-seed-fixture/application-tenancy-for-nl-other                                                                       : EXEC org.estatio.fixture.security.tenancy.ApplicationTenancyForNlOther
estatio-security-module-seed-fixture/application-tenancy-for-nl-other/Netherlands Other                                                     : /ITA/_
estatio-security-module-seed-fixture/application-tenancy-for-se                                                                             : EXEC org.estatio.fixture.security.tenancy.ApplicationTenancyForSe
estatio-security-module-seed-fixture/application-tenancy-for-se/Sweden                                                                      : /SWE
estatio-security-module-seed-fixture/application-tenancy-for-se-other                                                                       : EXEC org.estatio.fixture.security.tenancy.ApplicationTenancyForSeOther
estatio-security-module-seed-fixture/application-tenancy-for-se-other/Sweden Other                                                          : /SWE/_
estatio-security-module-seed-fixture/application-tenancy-for-gb                                                                             : EXEC org.estatio.fixture.security.tenancy.ApplicationTenancyForGb
estatio-security-module-seed-fixture/application-tenancy-for-gb/Great Britain                                                               : /GBR
estatio-security-module-seed-fixture/application-tenancy-for-gb-other                                                                       : EXEC org.estatio.fixture.security.tenancy.ApplicationTenancyForGbOther
estatio-security-module-seed-fixture/application-tenancy-for-gb-other/Great Britain Other                                                   : /GBR/_
estatio-security-module-seed-fixture/estatio-roles-and-permissions                                                                          : EXEC org.estatio.fixture.security.perms.EstatioRolesAndPermissions
estatio-security-module-seed-fixture/estatio-roles-and-permissions/estatio-admin-role-and-permissions                                       : EXEC org.estatio.fixture.security.perms.EstatioAdminRoleAndPermissions
estatio-security-module-seed-fixture/estatio-roles-and-permissions/estatio-user-role-and-permissions                                        : EXEC org.estatio.fixture.security.perms.EstatioUserRoleAndPermissions
estatio-security-module-seed-fixture/estatio-admin                                                                                          : EXEC org.estatio.fixture.security.users.EstatioAdmin
estatio-security-module-seed-fixture/estatio-user                                                                                           : EXEC org.estatio.fixture.security.users.EstatioUser
estatio-security-module-seed-fixture/estatio-user-in-france                                                                                 : EXEC org.estatio.fixture.security.users.EstatioUserInFrance
estatio-security-module-seed-fixture/estatio-user-in-great-britain                                                                          : EXEC org.estatio.fixture.security.users.EstatioUserInGreatBritain
estatio-security-module-seed-fixture/estatio-user-in-italy                                                                                  : EXEC org.estatio.fixture.security.users.EstatioUserInItaly
estatio-security-module-seed-fixture/estatio-user-in-netherlands                                                                            : EXEC org.estatio.fixture.security.users.EstatioUserInNetherlands
estatio-security-module-seed-fixture/estatio-user-in-sweden                                                                                 : EXEC org.estatio.fixture.security.users.EstatioUserInSweden
estatio-security-module-seed-fixture/togglz-module-admin-role                                                                               : EXEC org.isisaddons.module.togglz.glue.seed.TogglzModuleAdminRole
estatio-security-module-seed-fixture/estatio-user-role-and-permissions                                                                      : SKIP org.estatio.fixture.security.perms.EstatioUserRoleAndPermissions
estatio-security-module-seed-fixture/estatio-admin-role-and-permissions                                                                     : SKIP org.estatio.fixture.security.perms.EstatioAdminRoleAndPermissions
estatio-security-module-seed-fixture/estatio-superuser-role-and-permissions                                                                 : EXEC org.estatio.fixture.security.perms.EstatioSuperuserRoleAndPermissions
estatio-security-module-seed-fixture/estatio-admin_-has_-estatio-admin-role                                                                 : EXEC org.estatio.fixture.security.userrole.EstatioAdmin_Has_EstatioAdminRole
estatio-security-module-seed-fixture/estatio-admin_-has_-estatio-admin-role/estatio-admin                                                   : estatio-admin
estatio-security-module-seed-fixture/estatio-admin_-has_-estatio-superuser-role                                                             : EXEC org.estatio.fixture.security.userrole.EstatioAdmin_Has_EstatioSuperuserRole
estatio-security-module-seed-fixture/estatio-admin_-has_-estatio-superuser-role/estatio-superuser                                           : estatio-superuser
estatio-security-module-seed-fixture/estatio-admin_-has_-togglz-admin-role                                                                  : EXEC org.estatio.fixture.security.userrole.EstatioAdmin_Has_TogglzAdminRole
estatio-security-module-seed-fixture/estatio-admin_-has_-togglz-admin-role/isis-module-togglz-admin                                         : isis-module-togglz-admin
estatio-security-module-seed-fixture/estatio-admin_-has_-isis-security-module-admin-role                                                    : EXEC org.estatio.fixture.security.userrole.EstatioAdmin_Has_IsisSecurityModuleAdminRole
estatio-security-module-seed-fixture/estatio-admin_-has_-isis-security-module-admin-role/isis-module-security-admin                         : isis-module-security-admin
estatio-security-module-seed-fixture/estatio-user_-has_-estatio-poweruser-role                                                              : EXEC org.estatio.fixture.security.userrole.EstatioUser_Has_EstatioPoweruserRole
estatio-security-module-seed-fixture/estatio-user_-has_-estatio-poweruser-role/isis-module-security-regular-user                            : isis-module-security-regular-user
estatio-security-module-seed-fixture/estatio-user_-has_-isis-security-module-regular-role                                                   : EXEC org.estatio.fixture.security.userrole.EstatioUser_Has_IsisSecurityModuleRegularRole
estatio-security-module-seed-fixture/estatio-user_-has_-isis-security-module-regular-role/isis-module-security-regular-user                 : isis-module-security-regular-user
estatio-security-module-seed-fixture/estatio-user-in-france_-has_-isis-security-module-regular-role                                         : EXEC org.estatio.fixture.security.userrole.EstatioUserInFrance_Has_IsisSecurityModuleRegularRole
estatio-security-module-seed-fixture/estatio-user-in-france_-has_-isis-security-module-regular-role/isis-module-security-regular-user       : isis-module-security-regular-user
estatio-security-module-seed-fixture/estatio-user-in-great-britain                                                                          : SKIP org.estatio.fixture.security.users.EstatioUserInGreatBritain
estatio-security-module-seed-fixture/estatio-user-in-italy_-has_-isis-security-module-regular-role                                          : EXEC org.estatio.fixture.security.userrole.EstatioUserInItaly_Has_IsisSecurityModuleRegularRole
estatio-security-module-seed-fixture/estatio-user-in-italy_-has_-isis-security-module-regular-role/isis-module-security-regular-user        : isis-module-security-regular-user
estatio-security-module-seed-fixture/estatio-user-in-netherlands_-has_-isis-security-module-regular-role                                    : EXEC org.estatio.fixture.security.userrole.EstatioUserInNetherlands_Has_IsisSecurityModuleRegularRole
estatio-security-module-seed-fixture/estatio-user-in-netherlands_-has_-isis-security-module-regular-role/isis-module-security-regular-user  : isis-module-security-regular-user
estatio-security-module-seed-fixture/estatio-user-in-sweden_-has_-isis-security-module-regular-role                                         : EXEC org.estatio.fixture.security.userrole.EstatioUserInSweden_Has_IsisSecurityModuleRegularRole
estatio-security-module-seed-fixture/estatio-user-in-sweden_-has_-isis-security-module-regular-role/isis-module-security-regular-user       : isis-module-security-regular-user
09:51:14,591 [EmailServiceDefault           ] NOT configured
09:51:15,971 [IsisWicketApplication         ] DebugDiskDataStore registered; access via ~/wicket/internal/debug/diskDataStore
09:51:15,971 [IsisWicketApplication         ] DebugDiskDataStore: eg, http://localhost:8080/wicket/wicket/internal/debug/diskDataStore
09:51:15,971 [IsisWicketApplication         ] storeSettings.inmemoryCacheSize        : 0
09:51:15,971 [IsisWicketApplication         ] storeSettings.asynchronousQueueCapacity: 100
09:51:15,971 [IsisWicketApplication         ] storeSettings.maxSizePerSession        : 10M
09:51:15,971 [IsisWicketApplication         ] storeSettings.fileStoreFolder          : C:\Users\Dan\AppData\Local\Temp\jetty-0.0.0.0-8080-webapp-_-any-88896119029572098.dir
09:51:15,971 [ThreadPoolSupport             ] join'ing 6 tasks: waited 0 milliseconds 
********************************************************************
*** WARNING: Wicket is running in DEVELOPMENT mode.              ***
***                               ^^^^^^^^^^^                    ***
*** Do NOT deploy to your live server(s) without changing this.  ***
*** See Application#getConfigurationType() for more information. ***
********************************************************************
09:51:15,979 [WebApplication                ] [WicketFilter] Started Wicket version 7.6.0 in DEVELOPMENT mode
09:51:16,122 [3de8f619                      ] jolokia-agent: No access restrictor found at classpath:/jolokia-access.xml, access to all MBeans is allowed
09:51:16,257 [3de8f619                      ] QuartzInitializer: Quartz Initializer Servlet loaded, initializing Scheduler...
09:51:16,313 [StdSchedulerFactory           ] Using default implementation for ThreadExecutor
09:51:16,334 [SchedulerSignalerImpl         ] Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
09:51:16,334 [QuartzScheduler               ] Quartz Scheduler v.2.2.1 created.
09:51:16,335 [XMLSchedulingDataProcessorPlugin] Registering Quartz Job Initialization Plug-in.
09:51:16,339 [RAMJobStore                   ] RAMJobStore initialized.
09:51:16,340 [QuartzScheduler               ] Scheduler meta-data: Quartz Scheduler (v2.2.1) 'SchedulerQuartzConfigXml' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 1 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

09:51:16,340 [StdSchedulerFactory           ] Quartz scheduler 'SchedulerQuartzConfigXml' initialized from the specified file : 'org/estatio/webapp/webinf/quartz.properties' from the class resource path.
09:51:16,340 [StdSchedulerFactory           ] Quartz scheduler version: 2.2.1
09:51:16,350 [XMLSchedulingDataProcessor    ] Parsing XML file: org/estatio/webapp/webinf/quartz-config.xml with systemId: org/estatio/webapp/webinf/quartz-config.xml
09:51:16,397 [XMLSchedulingDataProcessor    ] Adding 1 jobs, 1 triggers.
09:51:16,397 [XMLSchedulingDataProcessor    ] Adding job: DemoApp.RunBackgroundJobs
09:51:16,400 [QuartzScheduler               ] Scheduler SchedulerQuartzConfigXml_$_NON_CLUSTERED started.
09:51:16,400 [3de8f619                      ] QuartzInitializer: Scheduler has been started...
09:51:16,400 [3de8f619                      ] QuartzInitializer: Storing the Quartz Scheduler Factory in the servlet context at key: org.quartz.impl.StdSchedulerFactory.KEY
09:51:16,400 [ContextHandler                ] Started o.e.j.w.WebAppContext@3de8f619{/,file:///C:/bitbucket/incodehq/estatio-ecp/estatioapp/webapp/src/main/webapp/,AVAILABLE}{src/main/webapp}
09:51:16,426 [AbstractConnector             ] Started ServerConnector@17d677da{HTTP/1.1,[http/1.1]}{0.0.0.0:8080}
09:51:16,426 [Server                        ] Started @72321ms
09:51:16,426 [WebServer                     ] Started the application in 70684ms
09:56:12,304 [ClassCryptFactory             ] using encryption/decryption object org.apache.wicket.util.crypt.SunJceCrypt@45d509b9
09:56:17,200 [Datastore                     ] Column dbo.Invoice.status should not allow nulls but does. You can prevent nulls by specifying ""allows-null"" as ""false"" for the <field> in the MetaData
09:56:17,200 [Datastore                     ] Column dbo.Invoice.status should not allow nulls but does. You can prevent nulls by specifying ""allows-null"" as ""false"" for the <field> in the MetaData
09:56:24,527 [RequestCycleExtra             ] ********************************
09:56:24,529 [RequestCycleExtra             ] Handling the following exception
java.lang.RuntimeException: java.util.ConcurrentModificationException
	at org.apache.isis.core.metamodel.adapter.mgr.AdapterManager$ConcurrencyChecking.executeWithConcurrencyCheckingDisabled(AdapterManager.java:90)
	at org.apache.isis.viewer.wicket.ui.actionresponse.ActionResultResponseType.toEntityPage(ActionResultResponseType.java:159)
	at org.apache.isis.viewer.wicket.ui.actionresponse.ActionResultResponseType.access$200(ActionResultResponseType.java:46)
	at org.apache.isis.viewer.wicket.ui.actionresponse.ActionResultResponseType$1.interpretResult(ActionResultResponseType.java:51)
	at org.apache.isis.viewer.wicket.ui.actionresponse.ActionResultResponseType.determineAndInterpretResult(ActionResultResponseType.java:178)
	at org.apache.isis.viewer.wicket.ui.components.actions.ActionParametersFormExecutor.redirectTo(ActionParametersFormExecutor.java:53)
	at org.apache.isis.viewer.wicket.ui.panels.FormExecutorAbstract.executeAndProcessResults(FormExecutorAbstract.java:140)
	at org.apache.isis.viewer.wicket.ui.components.actions.ActionParametersPanel.buildGuiForNoParameters(ActionParametersPanel.java:160)
	at org.apache.isis.viewer.wicket.ui.components.actions.ActionParametersPanel.buildGui(ActionParametersPanel.java:101)
	at org.apache.isis.viewer.wicket.ui.components.actions.ActionParametersPanel.onInitialize(ActionParametersPanel.java:88)
	at org.apache.wicket.Component.fireInitialize(Component.java:878)
	at org.apache.wicket.MarkupContainer$3.component(MarkupContainer.java:1087)
	at org.apache.wicket.MarkupContainer$3.component(MarkupContainer.java:1083)
	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:144)
	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:162)
	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:123)
	at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:192)
	at org.apache.wicket.MarkupContainer.visitChildren(MarkupContainer.java:983)
	at org.apache.wicket.MarkupContainer.internalInitialize(MarkupContainer.java:1082)
	at org.apache.wicket.Page.isPageStateless(Page.java:465)
	at org.apache.wicket.request.handler.render.WebPageRenderer.isPageStateless(WebPageRenderer.java:287)
	at org.apache.wicket.request.handler.render.WebPageRenderer.shouldRenderPageAndWriteResponse(WebPageRenderer.java:329)
	at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:193)
	at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:175)
	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:895)
	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:265)
	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:222)
	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:293)
	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:261)
	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:203)
	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:284)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.togglz.servlet.TogglzFilter.doFilter(TogglzFilter.java:100)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1621)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1613)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:541)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:190)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1593)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:188)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1239)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:168)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:481)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1562)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:166)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1141)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
	at org.eclipse.jetty.server.Server.handle(Server.java:564)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:279)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:110)
	at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:124)
	at org.eclipse.jetty.util.thread.Invocable.invokePreferred(Invocable.java:122)
	at org.eclipse.jetty.util.thread.strategy.ExecutingExecutionStrategy.invoke(ExecutingExecutionStrategy.java:58)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:201)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:133)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:672)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:590)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.util.ConcurrentModificationException
	at java.util.HashMap$HashIterator.nextNode(HashMap.java:1437)
	at java.util.HashMap$ValueIterator.next(HashMap.java:1466)
	at java.util.AbstractCollection.toArray(AbstractCollection.java:141)
	at java.util.ArrayList.<init>(ArrayList.java:177)
	at org.apache.isis.core.metamodel.facetapi.FacetUtil.getFacets(FacetUtil.java:122)
	at org.apache.isis.core.metamodel.facetapi.FacetHolderImpl.getFacets(FacetHolderImpl.java:104)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectMemberAbstract.getFacets(ObjectMemberAbstract.java:155)
	at org.apache.isis.core.metamodel.facetapi.FacetUtil.addOrReplaceFacet(FacetUtil.java:41)
	at org.apache.isis.core.metamodel.services.grid.GridSystemServiceAbstract$1.visit(GridSystemServiceAbstract.java:348)
	at org.apache.isis.applib.layout.component.GridAbstract.traverseCollections(GridAbstract.java:133)
	at org.apache.isis.applib.layout.grid.bootstrap3.BS3Grid.traverseCols(BS3Grid.java:192)
	at org.apache.isis.applib.layout.grid.bootstrap3.BS3Grid.traverseRows(BS3Grid.java:174)
	at org.apache.isis.applib.layout.grid.bootstrap3.BS3Grid.traverseTabs(BS3Grid.java:237)
	at org.apache.isis.applib.layout.grid.bootstrap3.BS3Grid.traverseTabGroups(BS3Grid.java:223)
	at org.apache.isis.applib.layout.grid.bootstrap3.BS3Grid.traverseCols(BS3Grid.java:189)
	at org.apache.isis.applib.layout.grid.bootstrap3.BS3Grid.traverseRows(BS3Grid.java:174)
	at org.apache.isis.applib.layout.grid.bootstrap3.BS3Grid.visit(BS3Grid.java:163)
	at org.apache.isis.core.metamodel.services.grid.GridSystemServiceAbstract.overwriteFacets(GridSystemServiceAbstract.java:216)
	at org.apache.isis.core.metamodel.services.grid.GridSystemServiceAbstract.normalize(GridSystemServiceAbstract.java:169)
	at org.apache.isis.core.metamodel.services.grid.GridServiceDefault.normalize(GridServiceDefault.java:102)
	at org.apache.isis.core.metamodel.facets.object.grid.GridFacetDefault.load(GridFacetDefault.java:75)
	at org.apache.isis.core.metamodel.facets.object.grid.GridFacetDefault.getGrid(GridFacetDefault.java:65)
	at org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage.buildPage(EntityPage.java:162)
	at org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage.<init>(EntityPage.java:115)
	at org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage.<init>(EntityPage.java:83)
	at org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage.<init>(EntityPage.java:95)
	at org.apache.isis.viewer.wicket.ui.actionresponse.ActionResultResponseType$9.call(ActionResultResponseType.java:162)
	at org.apache.isis.viewer.wicket.ui.actionresponse.ActionResultResponseType$9.call(ActionResultResponseType.java:160)
	at org.apache.isis.core.metamodel.adapter.mgr.AdapterManager$ConcurrencyChecking.executeWithConcurrencyCheckingDisabled(AdapterManager.java:88)
	... 72 more
09:56:24,538 [RequestCycleExtra             ] ********************************

{code}"
ISIS-1645,New Feature,Closed,[WON'T FIX] Integrate Kryo as an alternative technology for view models,"as per discussion at https://lists.apache.org/thread.html/c71a9e277b4cb76ca32f166268e5fb7c2376ed6f5da3fcab0e850b5b@%3Cusers.isis.apache.org%3E

see also

https://github.com/datanucleus/datanucleus-typeconverter-kryo/tree/master/src/main/resources

"
ISIS-1644,Documentation,Closed,Broken Links,"A couple of links into the documentation are broken:
| Source | Link Label | Broken | Existing |
| https://github.com/apache/isis/tree/master/example/application/simpleapp | simpleapp archetype | http://isis.apache.org/guides/ugfun.html#_ugfun_getting-started_simpleapp-archetype | http://isis.apache.org/guides/ugfun/ugfun.html#_ugfun_getting-started_simpleapp-archetype |"
ISIS-1643,Bug,Closed,[DUPLICATE] NPE on SimpleApp about,"This has been fixed somewhere between 1.14.0 and this release.

~~~

The SimpleApp about screen throws an NPE and doesn't show anything under ""Jar Manifest Attributes"". Actually, some information flickers in the browser and can still be inspected, but isn't visible to the user.

The exception starts with:
 java.lang.NullPointerException
 at org.apache.isis.viewer.wicket.ui.panels.PanelAbstract.getAuthenticationSession(PanelAbstract.java:138)
 at org.apache.isis.viewer.wicket.ui.components.header.HeaderPanel$1.userProfileName(HeaderPanel.java:122)
 at org.apache.isis.viewer.wicket.ui.components.header.HeaderPanel.addUserName(HeaderPanel.java:106)
 at org.apache.isis.viewer.wicket.ui.components.header.HeaderPanel.onInitialize(HeaderPanel.java:79)
 at org.apache.wicket.Component.fireInitialize(Component.java:877)
 at org.apache.wicket.MarkupContainer$3.component(MarkupContainer.java:967)
 at org.apache.wicket.MarkupContainer$3.component(MarkupContainer.java:963)
 at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:144)
 at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:162)
 at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:123)
 at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:192)
 at org.apache.wicket.MarkupContainer.visitChildren(MarkupContainer.java:875)
 at org.apache.wicket.MarkupContainer.internalInitialize(MarkupContainer.java:962)
 at org.apache.wicket.Page.internalPrepareForRender(Page.java:238)
 at org.apache.wicket.Component.render(Component.java:2290)
 at org.apache.wicket.Page.renderPage(Page.java:1024)

Complete log is below:
 ===============================================================
 ccox:gymclass curt.cox$ mvn -pl webapp jetty:run
 [INFO] Scanning for projects...
 [INFO] mixin-maven-plugin: Merging Mixins
 [INFO] mixin-maven-plugin: Mixins were merged
 [INFO] 
 [INFO] ------------------------------------------------------------------------
 [INFO] Building SimpleApp Webapp 1.0-SNAPSHOT
 [INFO] ------------------------------------------------------------------------
 [INFO] 
 [INFO] >>> jetty-maven-plugin:9.3.5.v20151012:run (default-cli) > test-compile @ gymclass-webapp >>>
 Downloading: [https://oss.sonatype.org/content/repositories/snapshots/com/danhaywood/apps/gymclass-application/1.0-SNAPSHOT/maven-metadata.xml]
 Downloading: [https://repository.apache.org/content/repositories/snapshots/com/danhaywood/apps/gymclass-application/1.0-SNAPSHOT/maven-metadata.xml]
 Downloading: [https://repository.apache.org/content/repositories/snapshots/com/danhaywood/apps/gymclass/1.0-SNAPSHOT/maven-metadata.xml]
 Downloading: [https://oss.sonatype.org/content/repositories/snapshots/com/danhaywood/apps/gymclass/1.0-SNAPSHOT/maven-metadata.xml]
 Downloading: [https://oss.sonatype.org/content/repositories/snapshots/com/danhaywood/apps/gymclass-module-simple/1.0-SNAPSHOT/maven-metadata.xml]
 Downloading: [https://repository.apache.org/content/repositories/snapshots/com/danhaywood/apps/gymclass-module-simple/1.0-SNAPSHOT/maven-metadata.xml]
 [INFO] 
 [INFO] — buildnumber-maven-plugin:1.4:create (default) @ gymclass-webapp —
 [INFO] Executing: /bin/sh -c cd '/Users/curt.cox/work/isis/gymclass/webapp' && 'git' 'rev-parse' '--verify' 'HEAD'
 [INFO] Working directory: /Users/curt.cox/work/isis/gymclass/webapp
 [INFO] Storing buildNumber: null at timestamp: 1498862942921
 [WARNING] Cannot get the branch information from the git repository: 
 Detecting the current branch failed: fatal: Not a git repository (or any of the parent directories): .git

[INFO] Executing: /bin/sh -c cd '/Users/curt.cox/work/isis/gymclass/webapp' && 'git' 'rev-parse' '--verify' 'HEAD'
 [INFO] Working directory: /Users/curt.cox/work/isis/gymclass/webapp
 [INFO] Storing buildScmBranch: UNKNOWN_BRANCH
 [INFO] 
 [INFO] — build-helper-maven-plugin:1.8:maven-version (default) @ gymclass-webapp —
 [INFO] 
 [INFO] — maven-enforcer-plugin:1.4.1:enforce (validate-enforce) @ gymclass-webapp —
 [INFO] 
 [INFO] — maven-resources-plugin:2.6:resources (default-resources) @ gymclass-webapp —
 [INFO] Using 'UTF-8' encoding to copy filtered resources.
 [INFO] Copying 0 resource
 [INFO] Copying 2 resources
 [INFO] 
 [INFO] — maven-compiler-plugin:3.1:compile (default-compile) @ gymclass-webapp —
 [INFO] Nothing to compile - all classes are up to date
 [INFO] 
 [INFO] — maven-resources-plugin:2.6:testResources (default-testResources) @ gymclass-webapp —
 [INFO] Using 'UTF-8' encoding to copy filtered resources.
 [INFO] skip non existing resourceDirectory /Users/curt.cox/work/isis/gymclass/webapp/src/test/resources
 [INFO] 
 [INFO] — maven-compiler-plugin:3.1:testCompile (default-testCompile) @ gymclass-webapp —
 [INFO] No sources to compile
 [INFO] 
 [INFO] <<< jetty-maven-plugin:9.3.5.v20151012:run (default-cli) < test-compile @ gymclass-webapp <<<
 [INFO] 
 [INFO] 
 [INFO] — jetty-maven-plugin:9.3.5.v20151012:run (default-cli) @ gymclass-webapp —
 [INFO] Configuring Jetty for project: SimpleApp Webapp
 [INFO] webAppSourceDirectory not set. Trying src/main/webapp
 [INFO] Reload Mechanic: automatic
 [INFO] Classes = /Users/curt.cox/work/isis/gymclass/webapp/target/classes
 [INFO] Logging initialized @10524ms
 [INFO] Context path = /
 [INFO] Tmp directory = /Users/curt.cox/work/isis/gymclass/webapp/target/tmp
 [INFO] Web defaults = org/eclipse/jetty/webapp/webdefault.xml
 [INFO] Web overrides = none
 [INFO] web.xml file = [file:///Users/curt.cox/work/isis/gymclass/webapp/src/main/webapp/WEB-INF/web.xml]
 [INFO] Webapp directory = /Users/curt.cox/work/isis/gymclass/webapp/src/main/webapp
 [INFO] jetty-9.3.5.v20151012
 [INFO] Initializing Shiro environment
 INFO - EnvironmentLoader - Starting Shiro environment initialization.
 INFO - AuthorizingRealm - No cache or cacheManager properties have been set. Authorization cache cannot be obtained.
 INFO - IniSecurityManagerFactory - Realms have been explicitly set on the SecurityManager instance - auto-setting of realms will not occur.
 INFO - EnvironmentLoader - Shiro environment initialized in 154 ms.
 INFO - i18n - RESTEASY002225: Deploying javax.ws.rs.core.Application: class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
 INFO - i18n - RESTEASY002200: Adding class resource org.apache.isis.viewer.restfulobjects.server.resources.HomePageResourceServerside from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
 INFO - i18n - RESTEASY002200: Adding class resource org.apache.isis.viewer.restfulobjects.server.resources.DomainTypeResourceServerside from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
 INFO - i18n - RESTEASY002200: Adding class resource org.apache.isis.viewer.restfulobjects.server.resources.UserResourceServerside from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
 INFO - i18n - RESTEASY002200: Adding class resource org.apache.isis.viewer.restfulobjects.server.resources.DomainObjectResourceServerside from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
 INFO - i18n - RESTEASY002200: Adding class resource org.apache.isis.viewer.restfulobjects.server.resources.DomainServiceResourceServerside from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
 INFO - i18n - RESTEASY002200: Adding class resource org.apache.isis.viewer.restfulobjects.server.resources.VersionResourceServerside from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
 INFO - i18n - RESTEASY002200: Adding class resource org.apache.isis.viewer.restfulobjects.server.resources.SwaggerSpecResource from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
 INFO - i18n - RESTEASY002210: Adding provider singleton org.apache.isis.viewer.restfulobjects.server.conneg.RestfulObjectsJaxbWriterForXml from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
 INFO - i18n - RESTEASY002210: Adding provider singleton org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplicationExceptionMapper from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
 INFO - i18n - RESTEASY002210: Adding provider singleton org.apache.isis.viewer.restfulobjects.server.RuntimeExceptionMapper from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
 INFO - i18n - RESTEASY002210: Adding provider singleton org.apache.isis.viewer.restfulobjects.rendering.service.acceptheader.AcceptHeaderServiceForRest$RequestFilter from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
 INFO - i18n - RESTEASY002210: Adding provider singleton org.apache.isis.viewer.restfulobjects.rendering.service.acceptheader.AcceptHeaderServiceForRest$ResponseFilter from Application class org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication
 INFO - WebXmlFile - web.xml: url mapping found for filter with name WicketFilter: [/wicket/*]
 INFO - ptionHandlerInitParameters - priming configuration builder: 1 properties to prime
 INFO - ptionHandlerInitParameters - priming: isis.viewers=wicket,restfulobjects
 INFO - IsisConfigurationDefault - adding isis.viewers = wicket,restfulobjects
 INFO - IsisWebAppBootstrapper - Config override location: No override location configured
 INFO - IsisConfigurationDefault - adding isis.viewers = wicket,restfulobjects
 INFO - Application - [WicketFilter] init: Wicket core library initializer
 INFO - RequestListenerInterface - registered listener interface [RequestListenerInterface name=IBehaviorListener, method=public abstract void org.apache.wicket.behavior.IBehaviorListener.onRequest()]
 INFO - RequestListenerInterface - registered listener interface [RequestListenerInterface name=IFormSubmitListener, method=public abstract void org.apache.wicket.markup.html.form.IFormSubmitListener.onFormSubmitted()]
 INFO - RequestListenerInterface - registered listener interface [RequestListenerInterface name=ILinkListener, method=public abstract void org.apache.wicket.markup.html.link.ILinkListener.onLinkClicked()]
 INFO - RequestListenerInterface - registered listener interface [RequestListenerInterface name=IOnChangeListener, method=public abstract void org.apache.wicket.markup.html.form.IOnChangeListener.onSelectionChanged()]
 INFO - RequestListenerInterface - registered listener interface [RequestListenerInterface name=IRedirectListener, method=public abstract void org.apache.wicket.IRedirectListener.onRedirect()]
 INFO - RequestListenerInterface - registered listener interface [RequestListenerInterface name=IResourceListener, method=public abstract void org.apache.wicket.IResourceListener.onResourceRequested()]
 INFO - Application - [WicketFilter] init: Wicket extensions initializer
 INFO - wicket-webjars - initialize wicket webjars with given settings: WebjarsSettings

{readFromCacheTimeout=3 seconds, resourceStreamProvider=ClassLoader, recentVersionPlaceHolder='current', assetPathCollectors=[de.agilecoders.wicket.webjars.collectors.FileAssetPathCollector@70363885, de.agilecoders.wicket.webjars.collectors.JarAssetPathCollector@1ca6510f, de.agilecoders.wicket.webjars.collectors.VfsAssetPathCollector@15783771], webjarsPackage='META-INF.resources.webjars', webjarsPath='META-INF/resources/webjars', resourcePattern=.*, webjarsPathPattern=/webjars/([^/]*)/([^/]*)/(.*), useCdnResources=false, cdnUrl='//cdn.jsdelivr.net:80'}

INFO - wicket-jquery-selectors - initialize wicket jquery selectors with given settings: de.agilecoders.wicket.jquery.settings.WicketJquerySelectorsSettings@606d165d
 INFO - wicket-jquery-selectors - try to get settings, but WicketJquerySelectors wasn't installed to current application. Fallback to default settings.
 17:49:09,112 [IsisConfigurationBuilder main INFO ] loading properties from isis.properties
 17:49:09,112 [IsisConfigurationDefault main INFO ] adding isis.appManifest = domainapp.application.manifest.DomainAppAppManifest
 17:49:09,118 [IsisConfigurationBuilder main INFO ] loading properties from viewer_wicket.properties
 17:49:09,118 [IsisConfigurationDefault main INFO ] adding isis.viewer.wicket.themes.enabled = bootstrap-theme, Cerulean, Cosmo, Cyborg, Darkly, Flatly, Journal, Lumen, Paper, Readable, Sandstone, Simplex, Slate, Spacelab, Superhero, United, Yeti
 17:49:09,118 [IsisConfigurationDefault main INFO ] adding isis.viewer.wicket.themes.showChooser = true
 17:49:09,118 [IsisConfigurationDefault main INFO ] adding isis.viewer.wicket.maxTitleLengthInStandaloneTables = 0
 17:49:09,118 [IsisConfigurationDefault main INFO ] adding isis.viewer.wicket.maxTitleLengthInParentedTables = 0
 17:49:09,129 [IsisConfigurationBuilder main INFO ] loading properties from viewer_restfulobjects.properties
 17:49:09,129 [IsisConfigurationDefault main INFO ] adding isis.viewer.restfulobjects.RestfulObjectsSpecEventSerializer.baseUrl = [http://localhost:8080/restful/]
 17:49:09,132 [IsisConfigurationBuilder main INFO ] loading properties from persistor.properties
 17:49:09,132 [IsisConfigurationDefault main INFO ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionPassword = *******
 17:49:09,132 [IsisConfigurationDefault main INFO ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionURL = jdbc:hsqldb:mem:test
 17:49:09,132 [IsisConfigurationDefault main INFO ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionUserName = sa
 17:49:09,132 [IsisConfigurationDefault main INFO ] adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionDriverName = org.hsqldb.jdbcDriver
 17:49:09,134 [IsisConfigurationBuilder main INFO ] loading properties from authentication_shiro.properties
 17:49:09,421 [IsisComponentProviderUsingInstallers$InstallerLookup main INFO ] component installer not found; it will not be available: org.apache.isis.core.security.authentication.BypassAuthenticationManagerInstaller
 17:49:09,423 [IsisComponentProviderUsingInstallers$InstallerLookup main INFO ] component installer not found; it will not be available: org.apache.isis.core.security.authorization.BypassAuthorizationManagerInstaller
 17:49:09,425 [IsisConfigurationDefault main INFO ] adding isis.authentication = shiro
 17:49:09,427 [IsisConfigurationDefault main INFO ] adding isis.authorization = shiro
 17:49:09,428 [IsisConfigurationDefault main INFO ] overwriting isis.appManifest=domainapp.application.manifest.DomainAppAppManifest (previous value was domainapp.application.manifest.DomainAppAppManifest)
 17:49:09,582 [Reflections main INFO ] Reflections took 136 ms to scan 8 urls, producing 300 keys and 1382 values 
 17:49:09,639 [IsisConfigurationDefault main INFO ] adding isis.services.ServicesInstallerFromAnnotation.packagePrefix = domainapp.modules.simple.dom,domainapp.application.fixture,domainapp.application.services
 17:49:09,639 [IsisConfigurationDefault main INFO ] adding isis.persistor.datanucleus.RegisterEntities.packagePrefix = domainapp.modules.simple.dom,domainapp.application.fixture,domainapp.application.services
 17:49:09,640 [IsisConfigurationDefault main INFO ] adding isis.services = 
 17:49:09,640 [IsisConfigurationDefault main INFO ] adding isis.persistor.datanucleus.impl.datanucleus.cache.level2.type = none
 17:49:09,640 [IsisConfigurationDefault main INFO ] adding isis.reflector.facet.domainObjectAnnotation.updatingLifecycleEvent.postForDefault = false
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.reflector.facet.domainObjectAnnotation.removingLifecycleEvent.postForDefault = false
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.services.injector.setPrefix = false
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.reflector.validator.serviceActionsOnly = true
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.persistor.datanucleus.impl.datanucleus.schema.autoCreateAll = true
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.reflector.facet.domainObjectAnnotation.createdLifecycleEvent.postForDefault = false
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.persistor.disableConcurrencyChecking = false
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.reflector.validator.mixinsOnly = true
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.reflector.validator.explicitObjectType = true
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.reflector.facet.domainObjectAnnotation.updatedLifecycleEvent.postForDefault = false
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.persistor.datanucleus.impl.datanucleus.schema.validateTables = true
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.persistor.datanucleus.impl.datanucleus.persistenceByReachabilityAtCommit = false
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.value.format.date = dd-MM-yyyy
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.reflector.facet.domainObjectAnnotation.loadedLifecycleEvent.postForDefault = false
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.persistor.datanucleus.impl.datanucleus.cache.level2.mode = ENABLE_SELECTIVE
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.reflector.validator.noParamsOnly = true
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.objects.editing = false
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.reflector.facet.domainObjectAnnotation.persistingLifecycleEvent.postForDefault = false
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.reflector.facet.cssClassFa.patterns = new.*:fa-plus,add.*:fa-plus-square,create.*:fa-plus,update.*:fa-edit,change.*:fa-edit,remove.*:fa-minus-square,move.*:fa-exchange,first.*:fa-star,find.*:fa-search,lookup.*:fa-search,clear.*:fa-remove,previous.*:fa-step-backward,next.*:fa-step-forward,list.*:fa-list, all.*:fa-list, download.*:fa-download, upload.*:fa-upload, execute.*:fa-bolt, run.*:fa-bolt, calculate.*:fa-calculator, verify.*:fa-check-circle, refresh.*:fa-refresh, install.*:fa-wrench
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.reflector.validator.allowDeprecated = false
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.reflector.facet.domainObjectAnnotation.persistedLifecycleEvent.postForDefault = false
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.persistor.datanucleus.impl.datanucleus.schema.validateConstraints = true
 17:49:09,641 [IsisConfigurationDefault main INFO ] adding isis.reflector.facet.cssClass.patterns = delete.*:btn-danger
 17:49:09,642 [IsisConfigurationDefault main INFO ] adding isis.persistor.datanucleus.impl.datanucleus.identifier.case = MixedCase
 17:49:09,644 [ServicesInstallerFromConfigurationAndAnnotation main INFO ] installing org.apache.isis.core.runtime.services.ServicesInstallerFromConfigurationAndAnnotation
 17:49:09,727 [IsisConfigurationDefault main INFO ] adding isis.fixtures = 
 17:49:09,728 [IsisSessionFactoryBuilder main INFO ] initialising Isis System
 17:49:09,728 [IsisSessionFactoryBuilder main INFO ] working directory: /Users/curt.cox/work/isis/gymclass/.
 17:49:09,728 [IsisSessionFactoryBuilder main INFO ] resource stream source: chain [context loader classpath, current class' classpath, servlet context ('/WEB-INF')]
 17:49:10,668 [PersistenceSessionFactory main INFO ] did *not* find config properties to use JNDI datasource; will use JDBC
 17:49:11,198 [Schema main DEBUG] Column """"DELETEME1498862951194"".""UNUSED"""" added to internal representation of table.
 17:49:11,201 [Schema main DEBUG] Creating table ""DELETEME1498862951194""
 17:49:11,203 [Schema main DEBUG] CREATE TABLE ""DELETEME1498862951194""
 (
 ""UNUSED"" INTEGER NOT NULL
 )
 17:49:11,204 [Schema main DEBUG] Execution Time = 1 ms
 17:49:11,212 [Schema main DEBUG] Dropping table ""DELETEME1498862951194""
 17:49:11,212 [Schema main DEBUG] DROP TABLE ""DELETEME1498862951194""
 17:49:11,213 [Schema main DEBUG] Execution Time = 1 ms
 17:49:11,550 [Schema main DEBUG] Column """"DELETEME1498862951550"".""UNUSED"""" added to internal representation of table.
 17:49:11,551 [Schema main DEBUG] Creating table ""DELETEME1498862951550""
 17:49:11,551 [Schema main DEBUG] CREATE TABLE ""DELETEME1498862951550""
 (
 ""UNUSED"" INTEGER NOT NULL
 )
 17:49:11,551 [Schema main DEBUG] Execution Time = 0 ms
 17:49:11,553 [Schema main DEBUG] Dropping table ""DELETEME1498862951550""
 17:49:11,553 [Schema main DEBUG] DROP TABLE ""DELETEME1498862951550""
 17:49:11,553 [Schema main DEBUG] Execution Time = 0 ms
 17:49:11,640 [Schema main DEBUG] Column """"simple"".""SimpleObject"".""id"""" added to internal representation of table.
 17:49:11,640 [Schema main DEBUG] Field [DATASTORE_ID] -> Column(s) [""simple"".""SimpleObject"".""id""] using mapping of type ""org.datanucleus.store.rdbms.mapping.java.DatastoreIdMapping"" (org.datanucleus.store.rdbms.mapping.datastore.BigIntRDBMSMapping)
 17:49:11,642 [Schema main DEBUG] Table ""simple"".""SimpleObject"" will manage the persistence of the fields for class domainapp.modules.simple.dom.impl.SimpleObject (inheritance strategy=""new-table"") 
 17:49:11,643 [Schema main DEBUG] Column """"simple"".""SimpleObject"".""name"""" added to internal representation of table.
 17:49:11,644 [Schema main DEBUG] Field [domainapp.modules.simple.dom.impl.SimpleObject.name] -> Column(s) [""simple"".""SimpleObject"".""name""] using mapping of type ""org.datanucleus.store.rdbms.mapping.java.StringMapping"" (org.datanucleus.store.rdbms.mapping.datastore.VarCharRDBMSMapping)
 17:49:11,645 [Schema main DEBUG] Column """"simple"".""SimpleObject"".""notes"""" added to internal representation of table.
 17:49:11,645 [Schema main DEBUG] Field [domainapp.modules.simple.dom.impl.SimpleObject.notes] -> Column(s) [""simple"".""SimpleObject"".""notes""] using mapping of type ""org.datanucleus.store.rdbms.mapping.java.StringMapping"" (org.datanucleus.store.rdbms.mapping.datastore.VarCharRDBMSMapping)
 17:49:11,646 [Schema main DEBUG] Column """"simple"".""SimpleObject"".""version"""" added to internal representation of table.
 17:49:11,647 [Schema main DEBUG] Field [VERSION] -> Column(s) [""simple"".""SimpleObject"".""version""] using mapping of type ""org.datanucleus.store.rdbms.mapping.java.VersionTimestampMapping"" (org.datanucleus.store.rdbms.mapping.datastore.TimestampRDBMSMapping)
 17:49:11,647 [Schema main DEBUG] Table/View ""simple"".""SimpleObject"" has been initialised
 17:49:11,648 [Schema main DEBUG] Schema Transaction started with connection ""org.datanucleus.store.rdbms.datasource.dbcp.PoolingDataSource$PoolGuardConnectionWrapper@600e2000"" with isolation ""serializable""
 17:49:11,651 [Schema main DEBUG] Check of existence of ""simple"".""SimpleObject"" returned no table
 17:49:11,651 [Schema main DEBUG] Creating table ""simple"".""SimpleObject""
 17:49:11,652 [Schema main DEBUG] CREATE TABLE ""simple"".""SimpleObject""
 (
 ""id"" BIGINT GENERATED BY DEFAULT AS IDENTITY,
 ""name"" VARCHAR(40) NOT NULL,
 ""notes"" VARCHAR(4000) NULL,
 ""version"" TIMESTAMP NOT NULL,
 CONSTRAINT ""SimpleObject_PK"" PRIMARY KEY (""id"")
 )
 17:49:11,653 [Schema main DEBUG] Execution Time = 0 ms
 17:49:11,656 [Schema main DEBUG] Creating candidate key ""SimpleObject_name_UNQ"" in catalog """" schema """"simple""""
 17:49:11,656 [Schema main DEBUG] ALTER TABLE ""simple"".""SimpleObject"" ADD CONSTRAINT ""SimpleObject_name_UNQ"" UNIQUE (""name"")
 17:49:11,657 [Schema main DEBUG] Execution Time = 1 ms
 17:49:11,657 [Schema main DEBUG] Schema Transaction committing with connection ""org.datanucleus.store.rdbms.datasource.dbcp.PoolingDataSource$PoolGuardConnectionWrapper@600e2000""
 17:49:11,657 [Schema main DEBUG] Schema Transaction closing with connection ""org.datanucleus.store.rdbms.datasource.dbcp.PoolingDataSource$PoolGuardConnectionWrapper@600e2000""
 17:49:11,737 [EmailServiceDefault main WARN ] NOT configured
 17:49:11,857 [ThreadPoolSupport main INFO ] join'ing 6 tasks: waited 0 milliseconds 
 17:49:11,860 [WebApplication main INFO ] [WicketFilter] Started Wicket version 6.20.0 in DEVELOPMENT mode
 ********************************************************************
 * 
 ** 
 *** WARNING: Wicket is running in DEVELOPMENT mode. ***
 *** ^^^^^^^^^^^ ***
 *** Do NOT deploy to your live server(s) without changing this. ***
 *** See Application#getConfigurationType() for more information. ***
 ********************************************************************
 Jun 30, 2017 5:49:11 PM org.webjars.servlet.WebjarsServlet init
 INFO: WebjarsServlet cache enabled: true
 Jun 30, 2017 5:49:11 PM org.webjars.servlet.WebjarsServlet init
 INFO: WebjarsServlet initialization completed
 [INFO] Started o.e.j.m.p.JettyWebAppContext@2aa7399c \{/,[file:///Users/curt.cox/work/isis/gymclass/webapp/src/main/webapp/, jar:file:///Users/curt.cox/.m2/repository/org/webjars/bootstrap/3.3.6/bootstrap-3.3.6.jar!/META-INF/resources, jar:file:///Users/curt.cox/.m2/repository/org/webjars/bower/summernote/0.7.0/summernote-0.7.0.jar!/META-INF/resources, jar:file:///Users/curt.cox/.m2/repository/org/webjars/animate.css/3.2.5/animate.css-3.2.5.jar!/META-INF/resources, jar:file:///Users/curt.cox/.m2/repository/org/webjars/momentjs/2.10.3/momentjs-2.10.3.jar!/META-INF/resources, jar:file:///Users/curt.cox/.m2/repository/org/webjars/Eonasdan-bootstrap-datetimepicker/4.15.35/Eonasdan-bootstrap-datetimepicker-4.15.35.jar!/META-INF/resources, jar:file:///Users/curt.cox/.m2/repository/org/webjars/swagger-ui/2.1.3/swagger-ui-2.1.3.jar!/META-INF/resources, jar:file:///Users/curt.cox/.m2/repository/org/webjars/jquery-ui/1.11.4/jquery-ui-1.11.4.jar!/META-INF/resources, jar:file:///Users/curt.cox/.m2/repository/org/webjars/select2/3.5.2/select2-3.5.2.jar!/META-INF/resources, jar:file:///Users/curt.cox/.m2/repository/org/webjars/jquery/1.11.1/jquery-1.11.1.jar!/META-INF/resources, jar:file:///Users/curt.cox/.m2/repository/org/webjars/font-awesome/4.4.0/font-awesome-4.4.0.jar!/META-INF/resources, jar:file:///Users/curt.cox/.m2/repository/org/webjars/modernizr/2.8.3/modernizr-2.8.3.jar!/META-INF/resources],AVAILABLE} \{file:///Users/curt.cox/work/isis/gymclass/webapp/src/main/webapp/}
[INFO] Started ServerConnector@6cf971d0
{HTTP/1.1,[http/1.1]} \{0.0.0.0:8080}
[INFO] Started @16610ms
 [INFO] Started Jetty Server
 17:51:25,311 [ClassCryptFactory qtp108049354-33 INFO ] using encryption/decryption object org.apache.wicket.util.crypt.SunJceCrypt@2cc31f9
 17:56:56,415 [PropertiesFactory qtp108049354-30 INFO ] Loading properties files from [file:/Users/curt.cox/work/isis/gymclass/webapp/target/classes/domainapp/webapp/DomainApplication.properties|file://users/curt.cox/work/isis/gymclass/webapp/target/classes/domainapp/webapp/DomainApplication.properties] with loader org.apache.wicket.resource.IsoPropertiesFilePropertiesLoader@69159670
 17:56:56,479 [PropertiesFactory qtp108049354-30 INFO ] Loading properties files from jar:[file:/Users/curt.cox/.m2/repository/org/apache/wicket/wicket-core/6.20.0/wicket-core-6.20.0.jar!/org/apache/wicket/Application.properties|file://users/curt.cox/.m2/repository/org/apache/wicket/wicket-core/6.20.0/wicket-core-6.20.0.jar!/org/apache/wicket/Application.properties] with loader org.apache.wicket.resource.IsoPropertiesFilePropertiesLoader@69159670
 17:56:56,490 [PropertiesFactory qtp108049354-30 INFO ] Loading properties files from jar:[file:/Users/curt.cox/.m2/repository/org/apache/isis/viewer/isis-viewer-wicket-ui/1.14.0/isis-viewer-wicket-ui-1.14.0.jar!/org/apache/isis/viewer/wicket/ui/pages/login/WicketSignInPage.properties|file://users/curt.cox/.m2/repository/org/apache/isis/viewer/isis-viewer-wicket-ui/1.14.0/isis-viewer-wicket-ui-1.14.0.jar!/org/apache/isis/viewer/wicket/ui/pages/login/WicketSignInPage.properties] with loader org.apache.wicket.resource.IsoPropertiesFilePropertiesLoader@69159670
 17:56:56,503 [PropertiesFactory qtp108049354-30 INFO ] Loading properties files from jar:[file:/Users/curt.cox/.m2/repository/org/apache/isis/viewer/isis-viewer-wicket-ui/1.14.0/isis-viewer-wicket-ui-1.14.0.jar!/org/apache/isis/viewer/wicket/ui/pages/accmngt/AccountManagementPageAbstract.properties|file://users/curt.cox/.m2/repository/org/apache/isis/viewer/isis-viewer-wicket-ui/1.14.0/isis-viewer-wicket-ui-1.14.0.jar!/org/apache/isis/viewer/wicket/ui/pages/accmngt/AccountManagementPageAbstract.properties] with loader org.apache.wicket.resource.IsoPropertiesFilePropertiesLoader@69159670
 17:56:57,133 [PropertiesFactory qtp108049354-30 INFO ] Loading properties files from jar:[file:/Users/curt.cox/.m2/repository/org/apache/wicket/wicket-extensions/6.20.0/wicket-extensions-6.20.0.jar!/org/apache/wicket/extensions/Initializer.properties|file://users/curt.cox/.m2/repository/org/apache/wicket/wicket-extensions/6.20.0/wicket-extensions-6.20.0.jar!/org/apache/wicket/extensions/Initializer.properties] with loader org.apache.wicket.resource.IsoPropertiesFilePropertiesLoader@69159670
 17:57:04,957 [Native qtp108049354-34 DEBUG] SELECT 'domainapp.modules.simple.dom.impl.SimpleObject' AS ""NUCLEUS_TYPE"",""A0"".""name"",""A0"".""notes"",""A0"".""id"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0""
 17:57:05,144 [PropertiesFactory qtp108049354-47 INFO ] Loading properties files from jar:[file:/Users/curt.cox/.m2/repository/org/apache/isis/viewer/isis-viewer-wicket-ui/1.14.0/isis-viewer-wicket-ui-1.14.0.jar!/org/apache/isis/viewer/wicket/ui/pages/PageAbstract.properties|file://users/curt.cox/.m2/repository/org/apache/isis/viewer/isis-viewer-wicket-ui/1.14.0/isis-viewer-wicket-ui-1.14.0.jar!/org/apache/isis/viewer/wicket/ui/pages/PageAbstract.properties] with loader org.apache.wicket.resource.IsoPropertiesFilePropertiesLoader@69159670
 17:57:05,210 [PropertiesFactory qtp108049354-47 INFO ] Loading properties files from jar:[file:/Users/curt.cox/.m2/repository/org/wicketstuff/wicketstuff-select2/6.20.0/wicketstuff-select2-6.20.0.jar!/org/wicketstuff/select2/AbstractSelect2Choice.utf8.properties|file://users/curt.cox/.m2/repository/org/wicketstuff/wicketstuff-select2/6.20.0/wicketstuff-select2-6.20.0.jar!/org/wicketstuff/select2/AbstractSelect2Choice.utf8.properties] with loader org.apache.wicket.resource.UtfPropertiesFilePropertiesLoader@4ea6ef9
 17:57:05,299 [Native qtp108049354-47 DEBUG] SELECT 'domainapp.modules.simple.dom.impl.SimpleObject' AS ""NUCLEUS_TYPE"",""A0"".""name"",""A0"".""notes"",""A0"".""id"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0""
 17:57:05,304 [Native qtp108049354-47 DEBUG] SELECT 'domainapp.modules.simple.dom.impl.SimpleObject' AS ""NUCLEUS_TYPE"",""A0"".""name"",""A0"".""notes"",""A0"".""id"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0""
 17:57:11,569 [Native qtp108049354-33 DEBUG] SELECT 'domainapp.modules.simple.dom.impl.SimpleObject' AS ""NUCLEUS_TYPE"",""A0"".""name"",""A0"".""notes"",""A0"".""id"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0""
 17:57:13,762 [Native qtp108049354-30 DEBUG] SELECT 'domainapp.modules.simple.dom.impl.SimpleObject' AS ""NUCLEUS_TYPE"",""A0"".""name"",""A0"".""notes"",""A0"".""id"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0""
 17:57:13,774 [Native qtp108049354-30 DEBUG] SELECT 'domainapp.modules.simple.dom.impl.SimpleObject' AS ""NUCLEUS_TYPE"",""A0"".""name"",""A0"".""notes"",""A0"".""id"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0""
 17:57:13,775 [Native qtp108049354-30 DEBUG] SELECT 'domainapp.modules.simple.dom.impl.SimpleObject' AS ""NUCLEUS_TYPE"",""A0"".""name"",""A0"".""notes"",""A0"".""id"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0""
 17:57:24,304 [PropertiesFactory qtp108049354-55 INFO ] Loading properties files from jar:[file:/Users/curt.cox/.m2/repository/org/apache/isis/viewer/isis-viewer-wicket-ui/1.14.0/isis-viewer-wicket-ui-1.14.0.jar!/org/apache/isis/viewer/wicket/ui/components/actions/ActionParametersFormPanel.properties|file://users/curt.cox/.m2/repository/org/apache/isis/viewer/isis-viewer-wicket-ui/1.14.0/isis-viewer-wicket-ui-1.14.0.jar!/org/apache/isis/viewer/wicket/ui/components/actions/ActionParametersFormPanel.properties] with loader org.apache.wicket.resource.IsoPropertiesFilePropertiesLoader@69159670
 17:57:36,724 [Native qtp108049354-47 DEBUG] INSERT INTO ""simple"".""SimpleObject"" (""name"",""notes"",""version"") VALUES (<'Spork'>,<null>,<2017-06-30 17:57:36.723>)
 17:57:36,810 [Native qtp108049354-51 DEBUG] SELECT ""A0"".""name"",""A0"".""notes"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0"" WHERE ""A0"".""id"" = <0>
 17:57:57,441 [Native qtp108049354-33 DEBUG] SELECT ""A0"".""name"",""A0"".""notes"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0"" WHERE ""A0"".""id"" = <0>
 17:58:11,858 [Native qtp108049354-30 DEBUG] SELECT ""A0"".""name"",""A0"".""notes"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0"" WHERE ""A0"".""id"" = <0>
 17:58:12,011 [Native qtp108049354-55 DEBUG] SELECT ""A0"".""name"",""A0"".""notes"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0"" WHERE ""A0"".""id"" = <0>
 17:58:12,028 [Native qtp108049354-55 DEBUG] UPDATE ""simple"".""SimpleObject"" SET ""notes""=<'Both spoon and fork'>, ""version""=<2017-06-30 17:58:12.028> WHERE ""id""=<0>
 17:58:12,049 [Native qtp108049354-52 DEBUG] SELECT ""A0"".""name"",""A0"".""notes"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0"" WHERE ""A0"".""id"" = <0>
 17:59:01,684 [Native qtp108049354-51 DEBUG] SELECT ""A0"".""name"",""A0"".""notes"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0"" WHERE ""A0"".""id"" = <0>
 17:59:03,445 [Native qtp108049354-30 DEBUG] SELECT ""A0"".""name"",""A0"".""notes"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0"" WHERE ""A0"".""id"" = <0>
 17:59:03,472 [Native qtp108049354-34 DEBUG] SELECT ""A0"".""name"",""A0"".""notes"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0"" WHERE ""A0"".""id"" = <0>
 18:01:24,827 [RequestCycleExtra qtp108049354-56 WARN ] ********************************
 18:01:24,828 [RequestCycleExtra qtp108049354-56 WARN ] Handling the following exception
 java.lang.NullPointerException
 at org.apache.isis.viewer.wicket.ui.panels.PanelAbstract.getAuthenticationSession(PanelAbstract.java:138)
 at org.apache.isis.viewer.wicket.ui.components.header.HeaderPanel$1.userProfileName(HeaderPanel.java:122)
 at org.apache.isis.viewer.wicket.ui.components.header.HeaderPanel.addUserName(HeaderPanel.java:106)
 at org.apache.isis.viewer.wicket.ui.components.header.HeaderPanel.onInitialize(HeaderPanel.java:79)
 at org.apache.wicket.Component.fireInitialize(Component.java:877)
 at org.apache.wicket.MarkupContainer$3.component(MarkupContainer.java:967)
 at org.apache.wicket.MarkupContainer$3.component(MarkupContainer.java:963)
 at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:144)
 at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:162)
 at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:123)
 at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:192)
 at org.apache.wicket.MarkupContainer.visitChildren(MarkupContainer.java:875)
 at org.apache.wicket.MarkupContainer.internalInitialize(MarkupContainer.java:962)
 at org.apache.wicket.Page.internalPrepareForRender(Page.java:238)
 at org.apache.wicket.Component.render(Component.java:2290)
 at org.apache.wicket.Page.renderPage(Page.java:1024)
 at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:139)
 at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:229)
 at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:175)
 at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:890)
 at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
 at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:261)
 at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:218)
 at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:289)
 at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:259)
 at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:201)
 at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:282)
 at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)
 at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
 at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)
 at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
 at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
 at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
 at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
 at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
 at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
 at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
 at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)
 at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:581)
 at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
 at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
 at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)
 at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1158)
 at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:511)
 at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
 at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1090)
 at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
 at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:213)
 at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:109)
 at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:119)
 at org.eclipse.jetty.server.Server.handle(Server.java:517)
 at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:306)
 at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:242)
 at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:261)
 at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)
 at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:75)
 at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceAndRun(ExecuteProduceConsume.java:213)
 at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:147)
 at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:654)
 at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:572)
 at java.lang.Thread.run(Thread.java:745)
 18:01:24,834 [RequestCycleExtra qtp108049354-56 WARN ] ********************************
 18:01:24,834 [WebRequestCycleForIsis qtp108049354-56 WARN ] Unable to obtain exceptionRecognizers (no session), will be treated as unrecognized exception
 java.lang.NullPointerException
 at org.apache.isis.viewer.wicket.ui.panels.PanelAbstract.getAuthenticationSession(PanelAbstract.java:138)
 at org.apache.isis.viewer.wicket.ui.components.header.HeaderPanel$1.userProfileName(HeaderPanel.java:122)
 at org.apache.isis.viewer.wicket.ui.components.header.HeaderPanel.addUserName(HeaderPanel.java:106)
 at org.apache.isis.viewer.wicket.ui.components.header.HeaderPanel.onInitialize(HeaderPanel.java:79)
 at org.apache.wicket.Component.fireInitialize(Component.java:877)
 at org.apache.wicket.MarkupContainer$3.component(MarkupContainer.java:967)
 at org.apache.wicket.MarkupContainer$3.component(MarkupContainer.java:963)
 at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:144)
 at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:162)
 at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:123)
 at org.apache.wicket.util.visit.Visits.visitChildren(Visits.java:192)
 at org.apache.wicket.MarkupContainer.visitChildren(MarkupContainer.java:875)
 at org.apache.wicket.MarkupContainer.internalInitialize(MarkupContainer.java:962)
 at org.apache.wicket.Page.internalPrepareForRender(Page.java:238)
 at org.apache.wicket.Component.render(Component.java:2290)
 at org.apache.wicket.Page.renderPage(Page.java:1024)
 at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:139)
 at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:229)
 at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:175)
 at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:890)
 at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
 at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:261)
 at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:218)
 at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:289)
 at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:259)
 at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:201)
 at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:282)
 at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)
 at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
 at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)
 at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
 at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
 at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
 at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
 at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
 at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
 at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
 at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)
 at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:581)
 at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
 at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
 at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)
 at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1158)
 at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:511)
 at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
 at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1090)
 at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
 at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:213)
 at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:109)
 at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:119)
 at org.eclipse.jetty.server.Server.handle(Server.java:517)
 at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:306)
 at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:242)
 at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:261)
 at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)
 at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:75)
 at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceAndRun(ExecuteProduceConsume.java:213)
 at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:147)
 at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:654)
 at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:572)
 at java.lang.Thread.run(Thread.java:745)
 18:01:32,750 [ShiroAuthenticatorOrAuthorizor qtp108049354-39 INFO ] Incorrect credentials for user: sven
 18:01:40,629 [Native qtp108049354-34 DEBUG] SELECT 'domainapp.modules.simple.dom.impl.SimpleObject' AS ""NUCLEUS_TYPE"",""A0"".""name"",""A0"".""notes"",""A0"".""id"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0""
 18:01:40,646 [Native qtp108049354-51 DEBUG] SELECT 'domainapp.modules.simple.dom.impl.SimpleObject' AS ""NUCLEUS_TYPE"",""A0"".""name"",""A0"".""notes"",""A0"".""id"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0""
 18:01:40,647 [Native qtp108049354-51 DEBUG] SELECT 'domainapp.modules.simple.dom.impl.SimpleObject' AS ""NUCLEUS_TYPE"",""A0"".""name"",""A0"".""notes"",""A0"".""id"",""A0"".""version"" FROM ""simple"".""SimpleObject"" ""A0"""
ISIS-1642,Bug,Closed,Refactor breadcrumb panel to remove memory leak,"Rather than caching EntityModels, instead cache Bookmarks"
ISIS-1641,New Feature,Closed,"Allow the Wicket debug bar to be optionally shown, even in non-prototyping mode.",
ISIS-1640,New Feature,Closed,Allow bookmarks and breadcrumb panels to be hidden.,"This is, in part, to track down memory leaks ... each of these holds onto a collection of EntityModel, and an EntityModel, it seems, can consume a lot of memory under certain circumstances (investigating use of pdfjsviewer with blob bytes)"
ISIS-1639,Improvement,Open,Extend semantics of RO spec and RO viewer for 202 (Accepted).,as per https://stackoverflow.com/questions/44386779/apache-isis-set-http-response
ISIS-1638,Improvement,Closed,Better error message diagnostic to explain why cannot invoke an action that returns a Blob (downloadable) in the background.,https://stackoverflow.com/questions/44425554/commandexecutein-background-throws-a-not-an-encodable-value-error
ISIS-1637,Improvement,Closed,[WON'T FIX] Non-JAXB view models do not support editable properties,"this is the case irrespective of whether editing is disabled globally using the isis.objects.editing=false)

background:

see https://stackoverflow.com/questions/44569302/apache-isis-propertyediting-editing-enabled-doesnt-work-for-viewmodels

analysis:

@Property(editing=ENABLED)
this installs:
DisabledFacetForPropertyAnnotationInvertedSemantics[interaction=Disabling,type=DisabledFacet,when=Always; where =Everywhere]

then see @DomainObject(nature=VIEW_MODEL)
DisabledFacetOnPropertyDerivedFromRecreatableObject[interaction=Disabling,type=DisabledFacet,when=Always; where =Anywhere]
this overwrites:

        final Facet existingFacet = getFacet(facetType);
        if (existingFacet == null || existingFacet.isNoop()) {
            facetsByClass.put(facetType, facet);
            return;
        }
        if (!facet.alwaysReplace()) {
            return;
        }
        if (facet.isDerived() && !existingFacet.isDerived()) {  << doesn't return here, for example
            return;
        }
        facet.setUnderlyingFacet(existingFacet);
        facetsByClass.put(facetType, facet);
        
then at the class level earlier would also have installed ImmutableFacet because of configuration property (if global property to disable editing) 
because of that, see:
DisabledFacetOnPropertyDerivedFromImmutable[interaction=Disabling,type=DisabledFacet,when=Always; where =Anywhere]
this overwrites once more.
"
ISIS-1636,Improvement,Closed,Support for Java 8 Time API,"ISIS should support domain object properties of type

* java.time.LocalDate
* java.time.LocalDateTime
* java.time.OffsetDateTime

Sooner or later the new Java 8 time API will conquer the developers minds and those using ISIS will demand ISIS built-in support for these basic types.

Note: JDO support for the types listed above is already there (via plugin). So the persistence part of the problem is solved, only the UI part is missing.
"
ISIS-1635,Improvement,Closed,Upgrade dependency to resteasy,"org.codehaus.jackson brings in some vulnerabilities:
!Dependency-Check.png|thumbnail!
{code}
[INFO] |  +- org.apache.isis.core:isis-core-viewer-restfulobjects-server:jar:1.14.0:compile
[INFO] |  |  +- org.apache.isis.core:isis-core-viewer-restfulobjects-rendering:jar:1.14.0:compile
[INFO] |  |  |  +- org.jboss.resteasy:resteasy-jaxb-provider:jar:3.0.14.Final:compile
[INFO] |  |  |  |  +- com.sun.xml.bind:jaxb-impl:jar:2.2.7:compile
[INFO] |  |  |  |  |  +- com.sun.xml.bind:jaxb-core:jar:2.2.7:compile
[INFO] |  |  |  |  |  |  +- javax.xml.bind:jaxb-api:jar:2.2.7:compile
[INFO] |  |  |  |  |  |  \- com.sun.istack:istack-commons-runtime:jar:2.16:compile
[INFO] |  |  |  |  |  \- com.sun.xml.fastinfoset:FastInfoset:jar:1.2.12:compile
[INFO] |  |  |  |  |     \- javax.xml.bind:jsr173_api:jar:1.0:compile
[INFO] |  |  |  |  \- org.jboss.logging:jboss-logging:jar:3.1.4.GA:compile
[INFO] |  |  |  +- org.jboss.resteasy:resteasy-jackson-provider:jar:3.0.14.Final:compile
[INFO] |  |  |  |  +- org.codehaus.jackson:jackson-core-asl:jar:1.9.12:compile
[INFO] |  |  |  |  +- org.codehaus.jackson:jackson-mapper-asl:jar:1.9.12:compile
[INFO] |  |  |  |  +- org.codehaus.jackson:jackson-jaxrs:jar:1.9.12:compile
[INFO] |  |  |  |  \- org.codehaus.jackson:jackson-xc:jar:1.9.12:compile
{code}

Please upgrade to 3.1.3Final if feasible:
{code}
<dependency>
    <groupId>org.jboss.resteasy</groupId>
    <artifactId>resteasy-jaxb-provider</artifactId>
    <version>3.1.3.Final</version>
</dependency>
<dependency>
    <groupId>org.jboss.resteasy</groupId>
    <artifactId>resteasy-jackson-provider</artifactId>
    <version>3.1.3.Final</version>
</dependency>

{code}"
ISIS-1634,New Feature,Resolved,Move paraname8 into core.,
ISIS-1633,New Feature,Closed,"Allow properties to be ""edited"" using an action (ie using multiple parameters)","eg to support name, address and so on.

Design I've come up with is:

{code|language=java}
    @Property(editing = Editing.DISABLED)
    public String getName() { ... }

    @MemberOrder(named=""name"", sequence=""1"")
    @ActionLayout(promptStyle=INLINE_AS_IF_EDIT)
    public ReferenceObject editName(
            @Nullable @ParameterLayout(named = ""First name"") String firstName,
            @ParameterLayout(named = ""Last name"") 
             String lastName)  {
        setName(firstName + "" "" + lastName);
        return this
    }

    public String default0EditName() {
        return ...
    }
    public String default1EditName() {
        return ...
    }
{code}

"
ISIS-1632,New Feature,Closed,Support meta annotations for @Property/@Collection/@Action + @XxxLayout,
ISIS-1631,Bug,Closed,jdoqlFromClause validation error with multi-level inheritance,"1) I have 3 domain objects with *multi-level* inheritance (in the same package): A, B, C
{code}
@DomainObject(objectType = ""A"", editing = Editing.ENABLED)
public abstract class A

@DomainObject(objectType = ""B"", editing = Editing.ENABLED)
public class B extends A

@DomainObject(objectType = ""C"", editing = Editing.ENABLED)
public class C extends B
{code}
2) class A has the following JDOQL query:
{code}
@Queries({
        @Query(
                name = ""getById"",
                value = ""SELECT ""
                        + ""FROM com.home.test.A ""
                        + ""WHERE id == :id"")
      })
{code}
3) When I turned on the validation:
{code}
isis.reflector.validator.jdoqlFromClause=true
{code}
I've got the error:
{code}
java.lang.AssertionError: Metamodel is invalid: 
com.home.test.C: error in JDOQL query, class name after FROM clause should be same as class name on which annotated, or one of its supertypes (JDOQL : SELECT FROM com.home.test.A WHERE id == :id)
{code}
4)If I make *one-level* inheritance:
{code}
@DomainObject(objectType = ""A"", editing = Editing.ENABLED)
public abstract class A

@DomainObject(objectType = ""B"", editing = Editing.ENABLED)
public class B extends A

@DomainObject(objectType = ""C"", editing = Editing.ENABLED)
public class C extends A
{code}
The validation passes OK."
ISIS-1630,Improvement,Closed,view models with inline prompts don't show which fields are mandatory or not.,
ISIS-1629,Improvement,Closed,[WON'T FIX] Handle dynamic visibility of list of properties rendered,I'm not sure I know what this means.
ISIS-1628,Improvement,Closed,Mixins requires method to be overridden in subclass.,"Necessary to override the method itself in the subclass, else
 [https://github.com/apache/isis/blob/69b4859f27ce857e9af75b7d1ef0ae7b42e5cc2c/core/wrapper/src/main/java/org/apache/isis/core/wrapper/handlers/DomainObjectInvocationHandler.java#L297]

does not find the actual ObjectActionMixedIn (the mixin's ObjectActionDefault does not match)"
ISIS-1627,Improvement,Closed,Error handling for axon event bus,TODO: need to document possible change in behaviour in migration notes.
ISIS-1626,Bug,Closed,Confirmation Dialog not shown on no-parameter Menu Actions,"No-Parameter Menu Actions annotated with any of the 'ARE_YOU_SURE' semantics will not produce the expected confirmation dialog when you click on the corresponding menu item.

{code:title=SimpleObjectMenu.java|borderStyle=solid}
@Action(semantics = SemanticsOf.NON_IDEMPOTENT_ARE_YOU_SURE) 
public List<SimpleObject> test() {
        return simpleObjectRepository.listAll();
}
{code}

Steps to reproduce: 
Take the simple-app artifact 1.14 and add the test snipped from above to the SimpleObjectMenu.
"
ISIS-1625,Bug,Closed,Tooltips do not show up on Menu Actions (using the describedAs feature),"Menu Actions annotated with ActionLayout.describedAs =.. will not produce a tooltip when you mouse-over the corresponding menu item.

{code:title=SimpleObjectMenu.java|borderStyle=solid}
@ActionLayout(describedAs=""Create a new object."")
public SimpleObject create(..){
..
}
{code}

Steps to reproduce: 
Take the simple-app artifact 1.14 and add an ActionLayout annotation like above to the SimpleObjectMenu.
"
ISIS-1624,Bug,Resolved,"[DUPLICATE] swagger service should return its ""regions"" alphabetically, so rendered sensibly in swagger-ui",
ISIS-1623,New Feature,Closed,"Enhance @MustSatisfy Specification API, pass in the current object as context",
ISIS-1622,Improvement,Closed,"Refactor ActionModel so that #load does NOT invoke the aciton, and then reinstate the Wicket DebugBar's InspectorPanel",
ISIS-1621,New Feature,Closed,Promote HsqlDbManager from simpleapp archetype to applib.,
ISIS-1620,Improvement,Closed,[WON'T FIX] Metamodel exception if choices specified incorrectly,"currently the framework just fails ""too fast"" and throws an exception as soon as the issue is detected.  instead it should collate the problem and report along with others (as for other metamodel invalid exceptions).

To reproduce in kitchensink app:
{code}

    @Action(semantics=SemanticsOf.IDEMPOTENT, publishing = Publishing.ENABLED)
    public TextObject updateSomeStringOptionalWithMultiChoices(
            // @Nullable
            @ParameterLayout(named = ""Choose some string(s)"")
            final List<String> strings) {
        final String asStr = SeparatorUtil.asStr(strings);
        setSomeStringOptionalWithMultiChoices(asStr);
        return this;
    }

    public List<String> choices0UpdateSomeStringOptionalWithMultiChoices() {
        return choicesUpdateSomeStringOptionalWithMultiChoices();
    }

    public List<String> choicesUpdateSomeStringOptionalWithMultiChoices() {
        return Lists.newArrayList(""a"", ""ab"", ""abcd"", ""abcdefgh"", ""abcdefghijklmnop"", ""abcdefghijklmnopqrstuvwxyz"");
    }
{code}

will throw an exception when encountered
{code}
	at org.apache.wicket.Application.initApplication(Application.java:953)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:429)
	... 20 more
Caused by: org.apache.isis.core.metamodel.exceptions.MetaModelException: class org.isisaddons.app.kitchensink.dom.text.TextObject uses both old and new choices syntax - must use one or other
	at org.apache.isis.core.metamodel.facets.param.choices.methodnum.ActionParameterChoicesFacetViaMethodFactory.attachChoicesFacetForParametersIfChoicesNumMethodIsFound(ActionParameterChoicesFacetViaMethodFactory.java:92)
	at org.apache.isis.core.metamodel.facets.param.choices.methodnum.ActionParameterChoicesFacetViaMethodFactory.process(ActionParameterChoicesFacetViaMethodFactory.java:65)
	at org.apache.isis.core.metamodel.specloader.facetprocessor.FacetProcessor.process(FacetProcessor.java:315)
	at org.apache.isis.core.metamodel.specloader.specimpl.FacetedMethodsBuilder.createActionFacetedMethod(FacetedMethodsBuilder.java:489)
	at org.apache.isis.core.metamodel.specloader.specimpl.FacetedMethodsBuilder.findActionFacetedMethod(FacetedMethodsBuilder.java:475)
	at org.apache.isis.core.metamodel.specloader.specimpl.FacetedMethodsBuilder.findActionFacetedMethods(FacetedMethodsBuilder.java:454)
	at org.apache.isis.core.metamodel.specloader.specimpl.FacetedMethodsBuilder.findActionFacetedMethods(FacetedMethodsBuilder.java:433)
	at org.apache.isis.core.metamodel.specloader.specimpl.FacetedMethodsBuilder.getActionFacetedMethods(FacetedMethodsBuilder.java:409)
{code}"
ISIS-1619,Bug,Closed,Blob/Clob Action results are cached no matter what,"If you click an Action that returns a Blob (download), the client receives a HTTP response header with an entry Pragma: ""cache"".

If the Blob is dynamically changing with every request, the client will not see this changes. (As long as the request url stays the same.)

Expected behavior would be (at least for this code snippet) to produce a new result with each invocation. 

{code:title=SimpleObjectMenu.java|borderStyle=solid}
@Action(semantics=SemanticsOf.NON_IDEMPOTENT)
public Blob download() {
	return new Blob(""blob"", ""application/json"",
              (""{\""now\"" : \""""+new java.util.Date()+""\""}"").getBytes());
}
{code}

But it does not!

Steps to reproduce: 
Take the simple-app artifact 1.14 and add above snippet to the SimpleObjectMenu.
Consecutive calls of the download action will not be updated. Instead the client/browser provides cached data from an earlier request."
ISIS-1618,Bug,Closed,Action Button with Confirmation Dialog ignores second shot,"Click on any action button (that has a confirmation dialog) and cancel the dialog. The immediate next click on the button does nothing (will not fire a click event). Click again and the confirmation dialog pops up as intended.

This is a confusing behavior.

Steps to reproduce: Take the simple-app artifact 1.14 and play with the SimpleObject's delete button.

"
ISIS-1617,New Feature,Closed,"Add support for the Wicket debug bar, for better diagnostics on session size etc",
ISIS-1616,New Feature,Closed,"Support URLs as a link  /  ""As-is"" HTML rendering","Reuse Kevin's work, https://github.com/kev-m/isis-wicket-url/"
ISIS-1615,Bug,Closed,Tooltip for Actions not always shown ... @ActionLayout.describedAs,"Regarding ActionLayout annotation, the text specified with the 'describedAs' feature will sometimes not show up.

Reason: bootstrap (on the client-side) will modify the DOM such that HTML links will no longer work as intended. (ISIS Actions/Buttons are HTML links.)

Details: 
1) Server sends ...
   <li title=""described as""><a ... /></li>

2) bootstrap makes changes (adds the 'title' attribute, where there was non provided by the server)
   <li title=""described as""><a title="""" ... /></li>

3) now when we mouse-over the link, no tooltip is shown

---
For a possible solution see:
http://stackoverflow.com/questions/27235776/can-i-still-use-the-title-attribute-on-bootstrap-popovers

"
ISIS-1614,Improvement,Closed,Improve responsive design of header,Should collapse secondary and tertiary menus properly
ISIS-1613,Improvement,Closed,"On action invoke/property edit, don't reload page, just repaint changed components (and allow unchanged components to opt out).",
ISIS-1612,Bug,Closed,[WON'T FIX] Extend the programming model so that mixins can have multiple actions,"I see this as a hybrid of a contributed service and a mixin.
I quite like the idea of calling these ""responsibilities"", eg

{code}
@Responsibility
public class Customer_orders {

    private final Customer customer;

    public List<Order> getOrders() { ... }

    public Customer addOrder(...) { ... }

    public Customer removeOrder(...) { ... }

}
{code}
"
ISIS-1611,Improvement,Closed,Allow framework services to be overridden without having to remember to set @DomainService#menuOrder to a lower value.,"As per http://isis.apache.org/guides/ugbtb/ugbtb.html#_ugbtb_hints-and-tips_replacing-default-service-implementations

"
ISIS-1610,Bug,Closed,Unable to use space bar to toggle checkboxes.,Important to fix now have ability to tab onto checkboxes (gain focus) with the inline prompt stuff
ISIS-1609,Bug,Closed,@Property(editing=ENABLED) not working for some JAXB view model properties.,"Tracked down the issue to RecreatableObjectFacetForXmlRootElementAnnotation being installed, and then DisabledFacetOn{Property|Collection}DerivedFromRecreatableObject being installed even if the RecreatableObjectFacet sometimes returns null (for JAXB elements, and if implements ViewModelFacet.Cloneable).

Solution: rather than rely on ViewModelFacet#isCloneable(Object), which works at the object level, instead introduce a new ViewModelFacet#inferImmutable(), which acts at the class level, and from this be able to figure out if the DisabledFacet thus installed has inverted semantics."
ISIS-1608,Bug,Closed,"Error ""ConcurrentModificationException"" during startup","Hi,

I've upgraded our current application to Apache ISIS 1.14.0 running on Apache Tomcat 8.5.6 and after that I receive on one environment consistently this error:

{code}
2017-04-28 16:25:08,305 [IsisWicketApplication localhost-startStop-1 ERROR]  Failed to initialize
com.google.inject.ProvisionException: Unable to provision, see the following errors:

1) Error in custom provider, java.lang.RuntimeException: An error occurred while executing code in a temporary session
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
  while locating org.apache.isis.core.runtime.system.session.IsisSessionFactory
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.isisSessionFactory(IsisWicketApplication.java:139)
  while locating domainapp.webapp.A1FulfilllmentApplication

1 error
        at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:482)
        at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:67)
        at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:984)
        at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:284)
        at domainapp.webapp.A1FulfilllmentApplication.init(A1FulfilllmentApplication.java:75)
        at org.apache.wicket.Application.initApplication(Application.java:823)
        at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:427)
        at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
        at org.apache.catalina.core.ApplicationFilterConfig.initFilter(ApplicationFilterConfig.java:271)
        at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:260)
        at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:105)
        at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4572)
        at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5215)
        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:724)
        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:700)
        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:734)
        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:952)
        at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1823)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
        at java.util.concurrent.FutureTask.run(FutureTask.java:266)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.RuntimeException: An error occurred while executing code in a temporary session
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:355)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:319)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:306)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactoryBuilder.buildSessionFactory(IsisSessionFactoryBuilder.java:201)
        at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:118)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at com.google.inject.internal.ProviderMethod$ReflectionProviderMethod.doProvision(ProviderMethod.java:299)
        at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:172)
        at com.google.inject.internal.ProviderInternalFactory.provision(ProviderInternalFactory.java:81)
        at com.google.inject.internal.InternalFactoryToInitializableAdapter.provision(InternalFactoryToInitializableAdapter.java:53)
        at com.google.inject.internal.ProviderInternalFactory.circularGet(ProviderInternalFactory.java:61)
        at com.google.inject.internal.InternalFactoryToInitializableAdapter.get(InternalFactoryToInitializableAdapter.java:45)
        at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)
        at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
        at com.google.inject.internal.SingletonScope$1.get(SingletonScope.java:145)
        at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:41)
        at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:54)
        at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:132)
        at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:93)
        at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:80)
        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1092)
        at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:80)
        at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:62)
        ... 22 more
Caused by: java.util.ConcurrentModificationException
        at java.util.HashMap$HashIterator.nextNode(HashMap.java:1437)
        at java.util.HashMap$ValueIterator.next(HashMap.java:1466)
        at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1042)
        at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorVisiting.validate(MetaModelValidatorVisiting.java:46)
        at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorComposite.validate(MetaModelValidatorComposite.java:60)
        at org.apache.isis.core.metamodel.specloader.SpecificationLoader.validate(SpecificationLoader.java:261)
        at org.apache.isis.core.metamodel.specloader.SpecificationLoader.validateAndAssert(SpecificationLoader.java:251)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactoryBuilder$1.run(IsisSessionFactoryBuilder.java:206)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory$1.call(IsisSessionFactory.java:322)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory$1.call(IsisSessionFactory.java:319)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:353)
        ... 48 more
2017-04-28 16:25:08,322 [ThreadPoolSupport    localhost-startStop-1 INFO ]  join'ing 6 tasks: waited 0 milliseconds
2017-04-28 16:25:08,322 [WicketFilter         localhost-startStop-1 ERROR]  The initialization of an application with name 'WicketFilter' has failed.
com.google.inject.ProvisionException: Unable to provision, see the following errors:

1) Error in custom provider, java.lang.RuntimeException: An error occurred while executing code in a temporary session
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
  while locating org.apache.isis.core.runtime.system.session.IsisSessionFactory
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.isisSessionFactory(IsisWicketApplication.java:139)
  while locating domainapp.webapp.A1FulfilllmentApplication

1 error
        at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:482)
        at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:67)
        at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:984)
        at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:284)
        at domainapp.webapp.A1FulfilllmentApplication.init(A1FulfilllmentApplication.java:75)
        at org.apache.wicket.Application.initApplication(Application.java:823)
        at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:427)
        at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
        at org.apache.catalina.core.ApplicationFilterConfig.initFilter(ApplicationFilterConfig.java:271)
        at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:260)
        at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:105)
        at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4572)
        at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5215)
        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:724)
        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:700)
        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:734)
        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:952)
        at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1823)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
        at java.util.concurrent.FutureTask.run(FutureTask.java:266)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.RuntimeException: An error occurred while executing code in a temporary session
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:355)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:319)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:306)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactoryBuilder.buildSessionFactory(IsisSessionFactoryBuilder.java:201)
        at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:118)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at com.google.inject.internal.ProviderMethod$ReflectionProviderMethod.doProvision(ProviderMethod.java:299)
        at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:172)
        at com.google.inject.internal.ProviderInternalFactory.provision(ProviderInternalFactory.java:81)
        at com.google.inject.internal.InternalFactoryToInitializableAdapter.provision(InternalFactoryToInitializableAdapter.java:53)
        at com.google.inject.internal.ProviderInternalFactory.circularGet(ProviderInternalFactory.java:61)
        at com.google.inject.internal.InternalFactoryToInitializableAdapter.get(InternalFactoryToInitializableAdapter.java:45)
        at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)
        at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
        at com.google.inject.internal.SingletonScope$1.get(SingletonScope.java:145)
        at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:41)
        at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:54)
        at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:132)
        at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:93)
        at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:80)
        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1092)
        at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:80)
        at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:62)
        ... 22 more
Caused by: java.util.ConcurrentModificationException
        at java.util.HashMap$HashIterator.nextNode(HashMap.java:1437)
        at java.util.HashMap$ValueIterator.next(HashMap.java:1466)
        at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1042)
        at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorVisiting.validate(MetaModelValidatorVisiting.java:46)
        at org.apache.isis.core.metamodel.specloader.validator.MetaModelValidatorComposite.validate(MetaModelValidatorComposite.java:60)
        at org.apache.isis.core.metamodel.specloader.SpecificationLoader.validate(SpecificationLoader.java:261)
        at org.apache.isis.core.metamodel.specloader.SpecificationLoader.validateAndAssert(SpecificationLoader.java:251)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactoryBuilder$1.run(IsisSessionFactoryBuilder.java:206)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory$1.call(IsisSessionFactory.java:322)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory$1.call(IsisSessionFactory.java:319)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:353)
        ... 48 more
{code}

On another environment I receive it sometimes. I haven't found any difference for these environments.

Both environments have configured JNDI datasource via Tomcat JDBC Pool.

Thanks & Regards Timothy"
ISIS-1607,Bug,Closed,"Swagger HTML doesn't load correctly, missing webjars","Noted in 1.15.0-SNAPSHOT, haven't checked 1.14.0"
ISIS-1606,Bug,Closed,"Running with bypass authenticator seems to be failing, not looking up class from its 'bypass' alias","Noted in 1.15.0-SNAPSHOT, haven't checked 1.14.0"
ISIS-1605,Bug,Closed,When entering / editing LocalDate in UI on Viewmodel the current date is taken instead of entered date,On Jaxb viewmodel for LocalDate always the current date is taken instead of the edited / entered value through Wicket UI.
ISIS-1604,Wish,Closed,"Extend support for SVG (3 additional dependencies, it seems)","Currently SVG images can be used:
* as Logo in the upper left corner (Wicket Menubar)
* on the Login Page (login.html)
* as favicon (""image/svg+xml"", cf. [ISIS-1115])

SVGs are not displayed  
* on the welcome page

SVGs can be attached as Blobs, but they are displayed as bitmaps (by means of the Batik rasterizer) and do not scale. The rasterizer (of course) can not deal with animations (cf. attachment).

See: https://lists.apache.org/thread.html/68f16dd0306a8101c1cde06e5e6309b8d1b81b388a1f59e123cfc2f3@%3Cusers.isis.apache.org%3E

{code}
		<dependency>
			<groupId>com.twelvemonkeys.imageio</groupId>
			<artifactId>imageio-batik</artifactId> <!-- svg -->
			<version>3.3.2</version>
		</dependency>
		<dependency>
			<groupId>com.twelvemonkeys.imageio</groupId>
			<artifactId>imageio-batik</artifactId> <!-- svg -->
			<version>3.3.2</version>
			<type>test-jar</type>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.xmlgraphics</groupId>
			<artifactId>batik-transcoder</artifactId>
			<version>1.8</version>
		</dependency>
{code}"
ISIS-1603,New Feature,Closed,Inline prompts for property edits and action invocations.,"Pretty much there.

Still need to support boolean properties inline prompts"
ISIS-1602,Bug,Closed,Handle mixins without any NotContributedFacet (assume is contributed as action),
ISIS-1601,Bug,Closed,[SUPERCEDED] Collection pojos (of view model) added to internal maps with incorrect Oid.,"Not certain if this has any real consequences, but certainly causes a pollution of the maps and is an error.

~~~~~~~~

This is superceded in 2.0.0-M2, because the maps have been removed."
ISIS-1600,Bug,Closed,Autocomplete repositories not being used/detected when using an action with a collection parameter,"If an action has a collection parameter, the introspection phase of the build fails with the following message, regardless if there is a autoCompleteRepository defined:

{code}
[ERROR] Collection action parameter found without supporting choices or autoComplete facet.  Class: org.example.path.MyClass action: Action Name parameter 0
{code}"
ISIS-1599,Bug,Closed,"""Set"" interface does not work as an action parameter's collection  type","When using a Set<MyClass> as a parameter for an action -> it throws an exception when using that action. The same works correctly when using List<MyClass>.

{quote}
...
 java.lang.IllegalArgumentException
argument type mismatch
sun.reflect.NativeMethodAccessorImpl#invoke0(null:-2)
sun.reflect.NativeMethodAccessorImpl#invoke(null:-1)
sun.reflect.DelegatingMethodAccessorImpl#invoke(null:-1)
java.lang.reflect.Method#invoke(null:-1)
org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract#invokeMethodElseFromCache(ActionInvocationFacetForDomainEventAbstract.java:408)
org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$2#execute(ActionInvocationFacetForDomainEventAbstract.java:262)
org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract$2#execute(ActionInvocationFacetForDomainEventAbstract.java:223)
org.apache.isis.applib.services.iactn.Interaction#executeInternal(Interaction.java:173)
org.apache.isis.applib.services.iactn.Interaction#execute(Interaction.java:143) 
...
{quote}"
ISIS-1598,New Feature,Open,Extend RO API to handle pagination parameter,"as per https://lists.apache.org/thread.html/9e663076e7af01a7cbc625a0046b62c13d533fb89df1f395f5078457@%3Cusers.isis.apache.org%3E

{code}
We are mostly using Restful Objects. 
We were able to do this type of pagination on Action, by modifying the ""ObjectActionArgHelper.java"" to populate the pagination details.

On method: public List<ObjectAdapter> parseAndValidateArguments(final JsonRepresentation arguments) {...}

// Handle page parameters
if (paramSpec.getCorrespondingClass() == Pageable.class
&& argRepr != null
/*&& argRepr.mapHas(""value"")
&& !argRepr.isNull(""value"")*/) {
/*final JsonRepresentation token = argRepr.getRepresentation(""value"");

final String tokenAsString = token.asString();*/

final PageRequest pageRequest;

if (argRepr.getString(""sort"") != null) {
final String[] split = argRepr.getString(""sort"").split("": "");
final Sort.Direction dir = Sort.Direction.fromStringOrNull(split[1]);
pageRequest = new PageRequest(Integer.parseInt(argRepr.getString(""pageNumber"")),
Integer.parseInt(argRepr.getString(""pageSize"")),
new Sort(dir, split[0]));
} else {
pageRequest = new PageRequest(Integer.parseInt(argRepr.getString(""pageNumber"")),
Integer.parseInt(argRepr.getString(""pageSize"")));
}


if (pageRequest != null) {
// Encode pageable. This shall be deserialized later on.
final ObjectAdapter adapter = getPersistenceSession().adapterFor(pageRequest);
final EncodableFacet encodableFacet = paramSpec.getFacet(EncodableFacet.class);
argRepr = JsonRepresentation.newMap();
argRepr.mapPut(""value"", encodableFacet.toEncodedString(adapter));
} else {
// No file for given token; throw error
final String reason = ""There is something wrong with your page parameters."";
argRepr.mapPut(""invalidReason"", reason);
throw new IllegalArgumentException(reason);
}
}


What we are thinking for the implementation:

METHOD 1: Modify the existing metamodels.

1. On ""ObjectCollectionReprRenderer.java"" [1], we are thinking that we can insert Pageable arguments to this line
2. On "" ObjectAssociation.java"" [2], we might end up changing this line as well to accept Pageable parameter. 


METHOD 2: Create new metamodels which extends the existing metamodels.

As mention, we are able to do this on Actions. And our intent to do this as well on Collections.

We might as well asks for your suggestion on how to do this Dan or if there are any better implementation for this one.


[1] https://github.com/apache/isis/blob/master/core/viewer-restfulobjects-rendering/src/main/java/org/apache/isis/viewer/restfulobjects/rendering/domainobjects/ObjectCollectionReprRenderer.java#L84
[2] https://github.com/apache/isis/blob/master/core/metamodel/src/main/java/org/apache/isis/core/metamodel/spec/feature/ObjectAssociation.java#L67 

Thanks and best regards,
Arjun Gica Manipes

{code}"
ISIS-1597,Bug,Closed,review the buildnumber plugin in the simpleapp archetype,"Not certain it's actually needed.

Patrick raised the following on the mailing list:

I run into problems when executing 'mvn validate' with
simpleapp-archetype version 1.14.0 by following the documentation

The new mojo:buildnumber-mave-plugin generates the error message:
""Cannot get the revision information from the scm repository""

Obviously this error makes sense as I was not connected to any scm
during validation. To pass validation without connection to an scm, I
added the plugin parameter <revisionOnScmFailure> to the pom.xml in the
webapp directory (See my plugin configuration below). This seems to work
well so far.

Anyway I couldn't find any hint for that problem in the apache isis
documentation.

             <plugin>
                 <groupId>org.codehaus.mojo</groupId>
<artifactId>buildnumber-maven-plugin</artifactId>
                 <version>1.4</version>
                 ...
                 <configuration>
<revisionOnScmFailure>true</revisionOnScmFailure>
                 </configuration>
             </plugin>

Cheers
"
ISIS-1596,Bug,Closed,Parameter translations broken ?,"from mailing list:

I just upgrade isis framework from 1.13.0 to 1.14.0, then find all parameters do not load i18n msgstr. But menu translation works well.

"
ISIS-1595,Bug,Closed,Configuration property for JDOQL VARIABLES clause mismatch,"The [migration notes for 1.14.0|http://isis.apache.org/migration-notes.html#_migration-notes_1.13.0-to-1.14.0] states that the configuration property to check for JDOQL {{VARIABLES}} class name validity is:

{{isis.reflector.validator.jdoqlVariablesClause}} 

However, the [corresponding facet factory|https://github.com/apache/isis/blob/master/core/metamodel/src/main/java/org/apache/isis/objectstore/jdo/metamodel/facets/object/query/JdoQueryAnnotationFacetFactory.java] defines the property differently:

{{public static final String ISIS_REFLECTOR_VALIDATOR_JDOQL_VARIABLES_CLAUSE_KEY = ""isis.reflector.validator.variablesFromClause"";}}

I would argue that the documentation's version is better, since the factory version is rather ambiguous with respect to the property that defines JDOQL {{FROM}} clause validation. I will raise a PR that changes the constant to match the documentation."
ISIS-1594,Improvement,Closed,Provide an 'edit' button on the isis documentation,
ISIS-1593,Bug,Closed,[DUPLICATE] Tooltip for disabled menu items does not render properly,
ISIS-1592,Improvement,Closed,"Extend XSD for command and interaction events, show logicalMemberIdentifier as well as memberIdentifier","for mixins, the ""memberIdentifier"" is the physical name of the method of the mixin.  (Ditto contributed actions)

Instead, the logicalMemberIdentifier would be objectType#memberId where objectType is the contributed-to object's type."
ISIS-1591,Bug,Closed,[WON'T FIX] isis-maven-plugin validate goal is not thread-safe,"Running validate on two modules concurrently (eg mvn clean install -T1C...) causes an exception

workaround is to run in serial mode."
ISIS-1590,Improvement,Closed,Performance issue: don't call Clause#getValueOf() with ApplicationFeatureId,"as per this thread 

https://lists.apache.org/thread.html/9d41eb339cba3b703c64d18c9bac1a705abef24169e28147e55d100d@%3Cusers.isis.apache.org%3E"
ISIS-1589,Improvement,Closed,Allow layout to be loaded from either .layout.xml or .layout.fallback.xml (so that library modules can provide a default layout for their entities using XML).,"... because the consuming app might want to also use .layout.xml to define some other layout (eg taking into account mixins etc).

Suggestion is to extend the GridLayoutService so that it searches for Xxx.layoutFallback.xml as well as (but only after Xxx.layout.xml).

Thus, the addons would provide a .layoutFallback.xml rather than a regular .layout.xml."
ISIS-1588,Improvement,Closed,Extend support for dependent choices for dates,"eg
{code}
public Occupancy newOccupancy(
            final @Parameter(optionality = Optionality.OPTIONAL) LocalDate startDate,
            final Unit unit) {
        Occupancy occupancy = occupancyRepository.newOccupancy(this, unit, startDate);
        occupancies.add(occupancy);
        return occupancy;
    }

    public List<Unit> choices1NewOccupancy(final LocalDate startDate) {
        Property property = getProperty();
        if (property != null) {
            return unitRepository.findByPropertyAndActiveOnDate(property, startDate);
        } else {
            return unitRepository.findByActiveOnDate(startDate);
        }
    }
{code}"
ISIS-1587,Improvement,Closed,"Extend explicitObjectType"" checking to also take in view models.",but exclude JAXB DTOs.
ISIS-1586,Improvement,Closed,Rationalize the way that service instances are referenced by RO vs rest of the framework,"The URLs in Restful Objects viewer are derived from ServiceUtil.id(...), which evaluates the getId() method of the service class, otherwise falls back to the simpleName of the class.

Meanwhile in the metamodel itself - ie the ObjectSpecId, as used in the first part of the objectType and bookmarks - is always simply the fully-qualified class name.

In the Wicket viewer (unlike entities) this FQCN doesn't normally manifests as a URL, though it can be seen for bookmarked actions.  It can also be seen for published interactions, as the target object.

To rationalize things:
* introduce a new @DomainService#serviceType (analogous to @DomainObject#objectType
* use the value of this serviceType if present
* otherwise fallback to getId()
* otherwise fallback to the fully qualified class name.

This final fallback is a slight change in default behaviour for any apps just using the RO viewer - its default would have been just the simple class name of the service.  The workaround is to add either serviceType or getId() explicitly.



"
ISIS-1585,New Feature,Closed,"Allow objects in parented collections to be selected, automatically passed as defaults for collection parameter of associated actions.  Also infer choices for both scalar and collection parameters.","This in effect deprecates the concept of bulk actions... instead use a view model as a wrapper around a collection returned by an action.

~~~~
 Currently we have the concept of a ""bulk"" action; this is one that operates only on a standalone collection of objects (ie as returned by an action invocation). When one or bulk actions are defined, then the viewer renders the bulk actions' buttons above the collection.

There's an example in the todoapp [1]. Run the app with the ToDoAppAppManifestWithFixtures, then run ToDos > Not Yet Complete. You'll see [2], with ""Not Yet Completed"" as one of the actions. This is because of the code in [3], by way of @Action(invokeOn=OBJECT_AND_COLLECTION) [4]

There are however some restrictions to this:
 * bulk actions cannot take parameters
 * it isn't possible to invoke actions on parented collections, only on standalone collections.

In 1.14.0-SNAPSHOT I recently added support for actions that accept collections as parameters. This hasn't yet been released, but will be the ""headline"" feature in 1.14.0. Building on that I see an opportunity to build upon it to (a) lift both restrictions and (b) remove some code from the framework.

So, my idea is:
 * add the ability to have selections on parented collections too
 * for actions that are ""associated"" with a parented collection and that have a collection parameter taking the type of that list, have the framework automatically use the selected objects as the argument values.
 * we deprecate the whole concept of bulk actions (ie @Action#invokeOn=...) to remove in the future. Instead, the replacement would simply be a parented collection of a view model.

We currently associate actions with collections using @MemberOrder(...); or this can be done using the .layout.xml file. So the coding model would be something like:
{code:java}
public class ToDoAppDashboard {   // our existing view model for the home page

    public List<ToDoItem> getNotYetCompleted() { ... }    // our parented collection

    @MemberOrder(named=""notYetCompleted"", sequence=""1"")
    public ToDoAppDashboard markAsCompleted(
                                                    List<ToDoItem> items,
                                                    boolean automaticallyDelete) {     // an additional parameter, just to demonstrate the point
        ...
    }
}
{code}
and ideally this is all that would be needed. The user would select items using checkboxes on the ""notYetCompleted"" collection, and the would be able to invoke the ""markAsCompleted"" action with the first parameter already populated/defaulted.

Under the covers, the selected items would correspond to a DefaultedFacet for the parameter, and there would be a DisabledFacet on the entire action if no objects has been selected.

I can see several steps to implement this. As well as the actual UI changes to the Wicket viewer (CollectionAsContentsTable or something like that), there will also be some metamodel stuff to add in, ie new FacetFactories.

The support we currently have for lists of objects as parameters requires that there's a ChoicesFacet for the parameter type. So initially the framework would need to generate this facet behind the scenes; it's implementation would be equivalent to:
{code:java}
     public List<ToDoItem> choices0MarkAsCompleted() { return getNotYetCompleted(); }
{code}
For the actual selected items, I am thinking it would be useful to introduce an internal domain service for use by the framework, called something like SelectedItemService. You'll see that the framework has a whole bunch defined in the metamodel module [5], and a bunch more in the runtime module [6]. (Many of these are also exposed as formal API in the applib [7], but not all; see also [8]).

Anyway, so SelectedItemService (annotated with @RequestScoped, ""obviously"") could be a way to provide the list of items currently selected. The generated DefaultedFacet would be equivalent to:
{code:java}
    public List<ToDoItem> default0MarkAsCompleted() { return selectedItemService.selectedFor(this, ""notYetCompleted""); }
{code}
As I say, these choices and defaults methods wouldn't actually be written by the developer, I'm just writing them here to explain what the framework would do automatically.

Other thoughts:
 * if the action takes only a single list of parameters, then there should be no prompt, simply invoke the action.

 * as a refinement, rather than (in the action prompt) render the actual list of selected items in a multi-select field, the Wicket viewer could instead just render an unmodifiable label, eg: ""5 items selected"". This would be a matter of having a new ComponentFactory for the parameter/property that takes precedence over multi-select for those cases when the parameter has been defaulted from the selection.

 * we might need an additional annotation/attribute to handle the edge case of an action that takes two or more lists of parameters of the same type (in which case there would be ambiguity as to which it should contribute to).. But as a simplification, in such a case probably ok to automatically default just the first such list.

[1] [https://github.com/isisaddons/isis-app-todoapp]
 [2] [http://imgur.com/a/YnhQT]
 [3] [https://github.com/isisaddons/isis-app-todoapp/blob/master/dom/src/main/java/todoapp/dom/todoitem/ToDoItem.java#L331]
 [4] [http://isis.apache.org/guides/rgant.html#_rgant-Action_invokeOn]
 [5] [https://github.com/apache/isis/tree/master/core/metamodel/src/main/java/org/apache/isis/core/metamodel/services]
 [6] [https://github.com/apache/isis/tree/master/core/runtime/src/main/java/org/apache/isis/core/runtime/services] 
 [7] [https://github.com/apache/isis/tree/master/core/applib/src/main/java/org/apache/isis/applib/services]
 [8] [http://isis.apache.org/guides/rgfis.html]"
ISIS-1584,Improvement,Closed,Metamodel validation to flag for any contributed services (rather than mixins),stepping stone to deprecating contributed services completely.
ISIS-1583,Improvement,Closed,[NOT A PROBLEM] Metamodel validation for @DomainObject(autoCompleteRepository=...),"Can either fail-fast if not found, or auto-load."
ISIS-1582,Improvement,Closed,Extend 'explicitObjectType' checking to domain services,"For robustness.  

So can enforce that an objectType is specified explicitly for domai service

isis.reflector.validator.explicitObjectType=true|false

Can reuse the existing checking, and generalize to apply not just to entities but also to domain services.

* Only needs to apply to services that have at least one action on them.

* to avoid too much ""noise"", for now ignore NatureOfService.DOMAIN"
ISIS-1581,Improvement,Closed,MetaModel validator should (if configured) check that an object type has been explicitly specified.,
ISIS-1580,Improvement,Closed,Should throw a metamodel validation exception if JDOQL FROM clause or VARIABLES clause invalid.,"In JDOQL, the 

""FROM com.mycompany.myapp.SomeClass ""

should be the same as the class on which it is annotated.

Also, the 

""VARIABLES com.mycompany.myapp.SomeOtherClass"" should be the same as some other class that is @PersistenceCapable."
ISIS-1579,Bug,Closed,Asciidoc Template/Stylesheet issues,"Couple of things I noticed

1. When viewing the ISIS website on a mobile device (or browser with narrow width) the ""nav"" items collapse to be replaced by the 3 horizontal lines icon. This is presumably intended to then show a dropdown of the ""nav"" items. But it doesn't do anything seemingly. 
My experience of asciidoc templates is very limited so can't tell you what is wrong (though was investigating writing a DN variant and hit the same problem, so would be interested in the solution!), and you seem to have used Deltaspike as a starting point for yours (theirs also has the same problem). A site that does give the three horizontal lines, and subsequent dropdown is http://vertx.io/docs/vertx-core/java/  in case its of use.

2. Table headings are shown with white text on a light grey background, hence virtually unreadable. For example 
https://isis.apache.org/guides/rgcfg.html#2.-deployment-types
Setting th.tableblock background-color and color should fix that."
ISIS-1578,Bug,Closed,Should throw a metamodel validation exception if a disable or hide method has any params.,Noted for a mixin within Estatio (Invoice_invoice#disable(...))
ISIS-1577,Bug,Closed,The transactionId within a command XML does not correspond with the transactionId of the command's metadata.,"To reproduce, using Estatio-ECP

- Invoice > Calculate ... choose OXF-MEDIAX-002

- Activity > Recent Changes to inspect the command.

The command and corresponding published event are both persisted and associated with the same xactn Id.  But the xactn Id of the command's XML is different.

This is probably because there are two xactns for commands.... really, there should in the happy case be only one xactn, with a 2nd xactn created if there was a probably executing thecommand.

"
ISIS-1576,Bug,Closed,[NOT A PROBLEM] Command for action that throws an exception does not flag that it failed.,"that is, the exception flag is not being set, the stacktrace is not being captured.

One way to reproduce: 
- run Estatio-ECP, 
  - but comment out DocFragmentData#InvoiceDescription_DemoGbr so this info is missing.

- Invoices > Calculate, select OXF-MEDIAX-002
- on resultant InvoiceRun, select the Invoice just created
- Approve the invoice
  - creates a command, and corresponding published interaction event
- attempt to Invoice the invoice
  - throws an exception
  - the command is persisted ... but does not indicate it failed
  - there is no corresponding published interaction event.
"
ISIS-1575,Bug,Closed,Problems with download page,"The download page has some problems.

1) none of the links for the archetypes work

2) links to hashes and sigs should use https

3) the gpg command to verify sigs is incomplete; it needs to be

gpg –verify isis-1.13.2-source-release.zip.asc isis-1.13.2-source-release.zip

i.e. both the sig and the binary file are needed."
ISIS-1574,Bug,Closed,Throws exception if layout.xml references unknown property.,"{code}
Caused by: java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:171)
	... 48 more
Caused by: org.apache.isis.core.metamodel.spec.ObjectSpecificationException: No association called 'notes' in 'Doc Fragment'
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectSpecificationAbstract.getAssociation(ObjectSpecificationAbstract.java:684)
	at org.apache.isis.viewer.wicket.ui.components.entity.fieldset.PropertyGroup$2.apply(PropertyGroup.java:109)
	at org.apache.isis.viewer.wicket.ui.components.entity.fieldset.PropertyGroup$2.apply(PropertyGroup.java:106)
	at com.google.common.collect.Iterators$8.transform(Iterators.java:817)
	at com.google.common.collect.TransformedIterator.next(TransformedIterator.java:48)
	at com.google.common.collect.Iterators$7.computeNext(Iterators.java:674)
	at com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:143)
	at com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:138)
	at com.google.common.collect.ImmutableList.copyOf(ImmutableList.java:253)
	at com.google.common.collect.ImmutableList.copyOf(ImmutableList.java:209)
	at com.google.common.collect.FluentIterable.toList(FluentIterable.java:484)
	at org.apache.isis.viewer.wicket.ui.components.entity.fieldset.PropertyGroup.buildGui(PropertyGroup.java:99)
	at org.apache.isis.viewer.wicket.ui.components.entity.fieldset.PropertyGroup.<init>(PropertyGroup.java:74)
	at org.apache.isis.viewer.wicket.ui.components.layout.bs3.col.Col.buildGui(Col.java:243)
	at org.apache.isis.viewer.wicket.ui.components.layout.bs3.col.Col.<init>(Col.java:79)
	at org.apache.isis.viewer.wicket.ui.components.layout.bs3.row.Row.buildGui(Row.java:69)
	at org.apache.isis.viewer.wicket.ui.components.layout.bs3.row.Row.<init>(Row.java:54)
	at org.apache.isis.viewer.wicket.ui.components.layout.bs3.tabs.TabPanel.newRows(TabPanel.java:88)
	at org.apache.isis.viewer.wicket.ui.components.layout.bs3.tabs.TabGroupPanel.tabsFor(TabGroupPanel.java:63)
	at org.apache.isis.viewer.wicket.ui.components.layout.bs3.tabs.TabGroupPanel.<init>(TabGroupPanel.java:89)
	at org.apache.isis.viewer.wicket.ui.components.layout.bs3.col.Col.buildGui(Col.java:212)
	at org.apache.isis.viewer.wicket.ui.components.layout.bs3.col.Col.<init>(Col.java:79)
	at org.apache.isis.viewer.wicket.ui.components.layout.bs3.row.Row.buildGui(Row.java:69)
	at org.apache.isis.viewer.wicket.ui.components.layout.bs3.row.Row.<init>(Row.java:54)
	at org.apache.isis.viewer.wicket.ui.components.layout.bs3.BS3GridPanel.buildGui(BS3GridPanel.java:56)
	at org.apache.isis.viewer.wicket.ui.components.layout.bs3.BS3GridPanel.<init>(BS3GridPanel.java:42)
	at org.apache.isis.viewer.wicket.ui.components.entity.selector.links.EntityLinksSelectorPanelFactory.createComponent(EntityLinksSelectorPanelFactory.java:57)
	at org.apache.isis.viewer.wicket.ui.ComponentFactoryAbstract.createComponent(ComponentFactoryAbstract.java:98)
	at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.createComponent(ComponentFactoryRegistryDefault.java:121)
	at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.addOrReplaceComponent(ComponentFactoryRegistryDefault.java:106)
	at org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addComponent(PageAbstract.java:346)
	at org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addChildComponents(PageAbstract.java:341)
	at org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage.buildPage(EntityPage.java:195)
	at org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage.<init>(EntityPage.java:114)
	at org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage.<init>(EntityPage.java:82)
	at org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage.<init>(EntityPage.java:63)
	... 53 more
{code}"
ISIS-1573,Bug,Closed,ISIS_OPTS incorrectly ignores values that have an '=' sign in them.,"meaning that a string such as:

isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionURL=jdbc:sqlserver://HALCHILLBLAST;instance=.;databaseName=estatio

is incorrectly ignored"
ISIS-1572,Bug,Closed,RestfulObjects viewer - Service members empty,"_Sometimes_ the members section of the response to http://localhost:9090/restful/services/Applications/ is empty - sometimes it is not:


{code|language=javascript}
{
  ""links"" : [ {
    ""rel"" : ""self"",
    ""href"" : ""http://localhost:9090/restful/services/Applications"",
    ""method"" : ""GET"",
    ""type"" : ""application/json;profile=\""urn:org.restfulobjects:repr-types/object\"""",
    ""title"" : ""Applications""
  }, {
    ""rel"" : ""describedby"",
    ""href"" : ""http://localhost:9090/restful/domain-types/ife.dep.Applications"",
    ""method"" : ""GET"",
    ""type"" : ""application/json;profile=\""urn:org.restfulobjects:repr-types/domain-type\""""
  }, {
    ""rel"" : ""up"",
    ""href"" : ""http://localhost:9090/restful/services"",
    ""method"" : ""GET"",
    ""type"" : ""application/json;profile=\""urn:org.restfulobjects:repr-types/list\""""
  } ],
  ""extensions"" : {
    ""oid"" : ""ife.dep.Applications:1"",
    ""isService"" : true,
    ""isPersistent"" : true
  },
  ""title"" : ""Applications"",
  ""serviceId"" : ""Applications"",
  ""members"" : { }
}
{code}

After some time the app was  accessed via the wicket viewer. It first delivered the homepage and then I invoked the listAll operation via the respective menu item.
Invoking  http://localhost:9090/restful/services/Applications/ afterwards showed the expected response including the members.

In another case there was a difference between:
* http://localhost:9090/restful/services/Applications/ (with members) and
* http://localhost:9090/restful/services/Applications (without members)

In yet another case both URL's delivered a result without 'members' filled, even after the 'workaround' described above.

https://github.com/joerg-rade/isis-app-todoapp shows the same behavior:
* http://localhost:8888/restful/services/todo.ToDoItems/ whereas
* http://localhost:8888/restful/domain-types/todoapp.dom.todoitem.ToDoItems shows the members
"
ISIS-1571,Bug,Closed,Should throw metamodel validation error if omit choices or autoComplete for parameter collection type.,"The current implementation of collection parameters (as per ISIS-785) requires that a choices or autoComplete facet is required for the parameter.

This ticket is to check this requirement early using a metamodel validator."
ISIS-1570,Bug,Closed,CSS spacing incorrect for action buttons placed below when there are also action placed to right,see kitchensink for examples
ISIS-1569,New Feature,Closed,Automated testing tool to replay commands against a copy of prod,"eg obtain copy of prod from a month ago
 then for all commands since then, replay (simulating the current user and time for each)
 finally, compare resultant database with current prod, and list out differences in data.

could also use for performance testing, perhaps.

 

~~~

most of the implementation is in the Incode Platform, command and command-replay modules.

Changes in Isis to support this are:
 * CommandWithDto sub-interface of Command
 * @Action(commandDtoProcessor=...)
 * @Property(commandDtoProcessor=...)
 * implementations of ContentMappingServiceForCommandDto and ContentMappingServiceForCommandsDto
 * CommandDtoProcessorService SPI as used by the former to allow the CommandDto to be enhanced
 * extensions to cmd.xsd for userdata and commands
 * factored new superclass CommandExecutionAbstract from BackgroundCommandExecution, subclassed by new quartz job when replay is enabled

  

 "
ISIS-1568,New Feature,Closed,"[WON'T FIX] Automated testing tool to act as a webcrawler, clicking on all links and assert that the page is rendered correctly.","This is probably an Isis addon.

My idea is that it would use Selenium in some way or another, leveraging docker as a means to deploy the webapp and phantomjs.

https://hub.docker.com/r/wernight/phantomjs/"
ISIS-1567,Improvement,Closed,Replace jetty-uber with jetty-servlet and jetty-webapp,"private email between mwhesse and danhaywood

mwhesse wrote:

It seems the sources for the jetty-all uber-jar are not published anymore, which also makes debugging quite painful.
Here is a thread talking about this
https://bugs.eclipse.org/bugs/show_bug.cgi?id=472640

Anyways... sad but true. Should we change the jetty-all dependency in the webserver? 


danhaywood wrote:

Yes, seems like we probably should visit this and do something different.  Probably best to stay on jetty, but just use the correct dependencies.  Perhaps you could raise a ticket?  (and PR, if you have time).
"
ISIS-1566,Bug,Closed,Allow datanucleus.ConnectionPasswordDecrypter to be used to decrypt password.,as per http://www.datanucleus.org/products/accessplatform_4_1/persistence_properties.html#ConnectionPasswordDecrypter
ISIS-1565,Bug,Closed,Fixes @MemberOrder so that the 4 default mixin actions are automatically associated with the 3 default mixin properties,"Specifically, 

Object_xxx and Persistable_xxx mixins 

should be associated, via @MemberOrder, with the

Persistable_datanucleusIdLong

property."
ISIS-1564,Bug,Closed,"Attempt to invoke no-arg bookmarked action, throws stacktraceexception.","to reproduce:

- run up simpleapp archetype for 1.13.2.
- invoke SimpleObjects > listAll (so added to bookmarks)
- then try to click on the bookmark

Will get this stack trace:

{code}
Stack trace:
org.apache.wicket.WicketRuntimeException
Unable to create page from class org.apache.isis.viewer.wicket.ui.pages.actionprompt.ActionPromptPage. Class does not have a visible default constructor.
org.apache.wicket.session.DefaultPageFactory#newPage(DefaultPageFactory.java:80)
org.apache.wicket.session.DefaultPageFactory#newPage(DefaultPageFactory.java:103)
org.apache.wicket.DefaultMapperContext#newPageInstance(DefaultMapperContext.java:137)
org.apache.wicket.core.request.handler.PageProvider#resolvePageInstance(PageProvider.java:268)
org.apache.wicket.core.request.handler.PageProvider#getPageInstance(PageProvider.java:166)
org.apache.wicket.request.handler.render.PageRenderer#getPage(PageRenderer.java:78)
org.apache.wicket.request.handler.render.WebPageRenderer#renderPage(WebPageRenderer.java:117)
org.apache.wicket.request.handler.render.WebPageRenderer#respond(WebPageRenderer.java:229)
org.apache.wicket.core.request.handler.RenderPageRequestHandler#respond(RenderPageRequestHandler.java:175)
org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:890)
org.apache.wicket.request.RequestHandlerStack#execute(RequestHandlerStack.java:64)
org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:261)
org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:218)
org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:289)
org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:259)
org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:201)
org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:282)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1668)
org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter#doFilter(IsisLogOnExceptionFilter.java:52)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1668)
org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1668)
org.eclipse.jetty.servlet.ServletHandler#doHandle(ServletHandler.java:581)
org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:143)
org.eclipse.jetty.security.SecurityHandler#handle(SecurityHandler.java:548)
org.eclipse.jetty.server.session.SessionHandler#doHandle(SessionHandler.java:226)
org.eclipse.jetty.server.handler.ContextHandler#doHandle(ContextHandler.java:1158)
org.eclipse.jetty.servlet.ServletHandler#doScope(ServletHandler.java:511)
org.eclipse.jetty.server.session.SessionHandler#doScope(SessionHandler.java:185)
org.eclipse.jetty.server.handler.ContextHandler#doScope(ContextHandler.java:1090)
org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:141)
org.eclipse.jetty.server.handler.ContextHandlerCollection#handle(ContextHandlerCollection.java:213)
org.eclipse.jetty.server.handler.HandlerCollection#handle(HandlerCollection.java:109)
org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:119)
org.eclipse.jetty.server.Server#handle(Server.java:517)
org.eclipse.jetty.server.HttpChannel#handle(HttpChannel.java:306)
org.eclipse.jetty.server.HttpConnection#onFillable(HttpConnection.java:242)
org.eclipse.jetty.io.AbstractConnection$ReadCallback#succeeded(AbstractConnection.java:261)
org.eclipse.jetty.io.FillInterest#fillable(FillInterest.java:95)
org.eclipse.jetty.io.SelectChannelEndPoint$2#run(SelectChannelEndPoint.java:75)
org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#produceAndRun(ExecuteProduceConsume.java:213)
org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#run(ExecuteProduceConsume.java:147)
org.eclipse.jetty.util.thread.QueuedThreadPool#runJob(QueuedThreadPool.java:654)
org.eclipse.jetty.util.thread.QueuedThreadPool$3#run(QueuedThreadPool.java:572)
java.lang.Thread#run(Thread.java:745)
Caused by:
java.lang.NoSuchMethodException
org.apache.isis.viewer.wicket.ui.pages.actionprompt.ActionPromptPage.<init>()
java.lang.Class#getConstructor0(Class.java:3082)
java.lang.Class#getDeclaredConstructor(Class.java:2178)
org.apache.wicket.session.DefaultPageFactory#newPage(DefaultPageFactory.java:65)
org.apache.wicket.session.DefaultPageFactory#newPage(DefaultPageFactory.java:103)
org.apache.wicket.DefaultMapperContext#newPageInstance(DefaultMapperContext.java:137)
org.apache.wicket.core.request.handler.PageProvider#resolvePageInstance(PageProvider.java:268)
org.apache.wicket.core.request.handler.PageProvider#getPageInstance(PageProvider.java:166)
org.apache.wicket.request.handler.render.PageRenderer#getPage(PageRenderer.java:78)
org.apache.wicket.request.handler.render.WebPageRenderer#renderPage(WebPageRenderer.java:117)
org.apache.wicket.request.handler.render.WebPageRenderer#respond(WebPageRenderer.java:229)
org.apache.wicket.core.request.handler.RenderPageRequestHandler#respond(RenderPageRequestHandler.java:175)
org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:890)
org.apache.wicket.request.RequestHandlerStack#execute(RequestHandlerStack.java:64)
org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:261)
org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:218)
org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:289)
org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:259)
org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:201)
org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:282)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1668)
org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter#doFilter(IsisLogOnExceptionFilter.java:52)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1668)
org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1668)
org.eclipse.jetty.servlet.ServletHandler#doHandle(ServletHandler.java:581)
org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:143)
org.eclipse.jetty.security.SecurityHandler#handle(SecurityHandler.java:548)
org.eclipse.jetty.server.session.SessionHandler#doHandle(SessionHandler.java:226)
org.eclipse.jetty.server.handler.ContextHandler#doHandle(ContextHandler.java:1158)
org.eclipse.jetty.servlet.ServletHandler#doScope(ServletHandler.java:511)
org.eclipse.jetty.server.session.SessionHandler#doScope(SessionHandler.java:185)
org.eclipse.jetty.server.handler.ContextHandler#doScope(ContextHandler.java:1090)
org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:141)
org.eclipse.jetty.server.handler.ContextHandlerCollection#handle(ContextHandlerCollection.java:213)
org.eclipse.jetty.server.handler.HandlerCollection#handle(HandlerCollection.java:109)
org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:119)
org.eclipse.jetty.server.Server#handle(Server.java:517)
org.eclipse.jetty.server.HttpChannel#handle(HttpChannel.java:306)
org.eclipse.jetty.server.HttpConnection#onFillable(HttpConnection.java:242)
org.eclipse.jetty.io.AbstractConnection$ReadCallback#succeeded(AbstractConnection.java:261)
org.eclipse.jetty.io.FillInterest#fillable(FillInterest.java:95)
org.eclipse.jetty.io.SelectChannelEndPoint$2#run(SelectChannelEndPoint.java:75)
org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#produceAndRun(ExecuteProduceConsume.java:213)
org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#run(ExecuteProduceConsume.java:147)
org.eclipse.jetty.util.thread.QueuedThreadPool#runJob(QueuedThreadPool.java:654)
org.eclipse.jetty.util.thread.QueuedThreadPool$3#run(QueuedThreadPool.java:572)
java.lang.Thread#run(Thread.java:745)
{code}"
ISIS-1563,Improvement,Closed,Remove support in Memento (internal class) for transient (JDO) entities,"This is a legacy from days gone by, but there is no longer any needed to handle this.  Instead, just fail-fast if attempt to create a Memento for a domain entity that is not yet persistent."
ISIS-1562,Improvement,Closed,Metamodel exception if @DomainObject(ENTITY) missing when @PersistenceCapable or @Entity,"Metamodel validator if forget to annotate...

 

Also, RepositoryService#persist(...) is a no-op if the domain object passed in is not an entity; this should probably fail-fast.

This was originally prompted by an obscure message being thrown in Memento#updateFieldsAndResolveState(...), as the result of an entity being treated as transient, because (a) the @PersistenceCapable annotation was accidentally omitted, and (b) a call to RepositoryService#persist(...) just did nothing.

So, this ticket would be a fail-fast for that scenario.
{code:java}
    private void updateFieldsAndResolveState(final ObjectAdapter objectAdapter, final Data data) {
        
        boolean dataIsTransient = data.getOid().isTransient();
        
        if (!dataIsTransient) {
           ...
        } else if (objectAdapter.isTransient() && dataIsTransient) {
           ...
            
        } else if (objectAdapter.isParentedCollection()) {
           ...
            
        } else {

           // THIS IS THE BRANCH THAT'S TRIGGERED IF @PersistenceCapable IS ACCIDENTALLY OMITTED.

            final ObjectData od = (ObjectData) data;
            if (od.containsField()) {
                throw new IsisException(""Resolve state (for "" + objectAdapter + "") inconsistent with fact that data exists for fields"");
            }
        }
    }
{code}"
ISIS-1561,Task,Closed,Release 1.14.0,
ISIS-1560,Task,Closed,Release 1.13.2.1 archetype,
ISIS-1559,Improvement,Closed,Remove the mixins from the simpleapp archetype - adds too much boilerplate,
ISIS-1558,Improvement,Closed,Extend simpleapp archetype to also build docker images,
ISIS-1557,Improvement,Closed,"Enhance EmailServiceDefault, to optionally throw exception if fail, and optionally allow overrides","Currently EmailServiceDefault simply logs any exceptions and returns a simple true/false to indicate if a failure.  It would be better if it could instead throw an exception.

Also, for testing it would be useful to allow the email to be ""diverted"" to some override location.  That way, the entire setup of smtp server etc can be tested, but with the assurance that the email won't be sent out to some customer accidentally."
ISIS-1556,Bug,Closed,Fixes bug in simpleapp archetype with fixture script menu (recreate),
ISIS-1555,Improvement,Closed,"DomainChangeJdoAbstract (super of command, audit etc) shouldn't throw exception if target class is unknown.",... this can happen if the code base has been refactored and a target bookmark string no longer resolves to a known type.
ISIS-1554,Improvement,Closed,"Prevent double click on buttons (which can cause applications to throw an error, eg concurrency exception)",
ISIS-1553,Improvement,Closed,"If in prototyping mode, shouldn't have to keep logging in when restart (rememberMe should activate)","This is due to the 'rememberMe.encryptionKey' - if not set then a random UUID is used, meaning that any cookie becomes invalid on restart.

This is appropriate behaviour for production, but is annoying when prototyping.

Therefore, just use a fixed value if not in production."
ISIS-1552,Improvement,Closed,"Use 'readonly' rather than 'disabled' tag, in compliance with w3c spec (Firefox and Chrome 54+)","as per ML

https://lists.apache.org/thread.html/354ff5bb35c3dd60fbe643f824951c9665aa7546d79562cf15e014f7@%3Cusers.isis.apache.org%3E

see also the spec:

https://www.w3.org/TR/2014/REC-html5-20141028/forms.html#the-readonly-attribute"
ISIS-1551,Bug,Closed,Problems with startup under certain circumstances,"This is a follow-up for ISIS-1525 after using 1.13.1 version the error is less frequent than before and I still don't have a reliable way of reproducing it.

from our log:
{code}
2016-12-02 12:39:02,205 [IsisWicketApplication http-nio-18080-exec-1 ERROR]  Failed to initialize
com.google.inject.ProvisionException: Unable to provision, see the following errors:

1) Error in custom provider, java.util.ConcurrentModificationException
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
  while locating org.apache.isis.core.runtime.system.session.IsisSessionFactory
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.isisSessionFactory(IsisWicketApplication.java:138)
  while locating domainapp.webapp.A1FulfilllmentApplication

1 error
        at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:482)
        at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:67)
        at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:984)
        at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:279)
        at domainapp.webapp.A1FulfilllmentApplication.init(A1FulfilllmentApplication.java:73)
        at org.apache.wicket.Application.initApplication(Application.java:823)
        at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:427)
        at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
        at org.apache.catalina.core.ApplicationFilterConfig.initFilter(ApplicationFilterConfig.java:271)
        at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:260)
        at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:105)
        at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4572)
        at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5215)
        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:724)
        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:700)
        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:734)
        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:952)
        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:473)
        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1617)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:300)
        at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
        at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:801)
        at org.apache.catalina.manager.ManagerServlet.check(ManagerServlet.java:1483)
        at org.apache.catalina.manager.ManagerServlet.deploy(ManagerServlet.java:731)
        at org.apache.catalina.manager.ManagerServlet.doPut(ManagerServlet.java:424)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:651)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:729)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
        at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
        at org.apache.catalina.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:108)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:185)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:108)
        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:589)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)
        at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:620)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:349)
        at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:784)
        at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
        at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:802)
        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1410)
        at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
        at java.lang.Thread.run(Thread.java:745)
Caused by: java.util.ConcurrentModificationException
        at java.util.HashMap$HashIterator.nextNode(HashMap.java:1437)
        at java.util.HashMap$ValueIterator.next(HashMap.java:1466)
        at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1042)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory.constructServices(IsisSessionFactory.java:157)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactoryBuilder.buildSessionFactory(IsisSessionFactoryBuilder.java:204)
        at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:118)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at com.google.inject.internal.ProviderMethod$ReflectionProviderMethod.doProvision(ProviderMethod.java:299)
        at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:172)
        at com.google.inject.internal.ProviderInternalFactory.provision(ProviderInternalFactory.java:81)
        at com.google.inject.internal.InternalFactoryToInitializableAdapter.provision(InternalFactoryToInitializableAdapter.java:53)
        at com.google.inject.internal.ProviderInternalFactory.circularGet(ProviderInternalFactory.java:61)
        at com.google.inject.internal.InternalFactoryToInitializableAdapter.get(InternalFactoryToInitializableAdapter.java:45)
        at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)
        at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
        at com.google.inject.internal.SingletonScope$1.get(SingletonScope.java:145)
        at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:41)
        at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:54)
        at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:132)
        at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:93)
        at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:80)
        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1092)
        at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:80)
        at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:62)
        ... 55 more
2016-12-02 12:39:02,221 [ThreadPoolSupport    http-nio-18080-exec-1 INFO ]  join'ing 6 tasks: waited 0 milliseconds
2016-12-02 12:39:02,221 [WicketFilter         http-nio-18080-exec-1 ERROR]  The initialization of an application with name 'WicketFilter' has failed.
com.google.inject.ProvisionException: Unable to provision, see the following errors:

1) Error in custom provider, java.util.ConcurrentModificationException
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
  while locating org.apache.isis.core.runtime.system.session.IsisSessionFactory
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.isisSessionFactory(IsisWicketApplication.java:138)
  while locating domainapp.webapp.A1FulfilllmentApplication

1 error
        at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:482)
        at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:67)
        at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:984)
        at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:279)
        at domainapp.webapp.A1FulfilllmentApplication.init(A1FulfilllmentApplication.java:73)
        at org.apache.wicket.Application.initApplication(Application.java:823)
        at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:427)
        at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
        at org.apache.catalina.core.ApplicationFilterConfig.initFilter(ApplicationFilterConfig.java:271)
        at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:260)
        at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:105)
        at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4572)
        at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5215)
        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:724)
        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:700)
        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:734)
        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:952)
        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:473)
        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1617)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:300)
        at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
        at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:801)
        at org.apache.catalina.manager.ManagerServlet.check(ManagerServlet.java:1483)
        at org.apache.catalina.manager.ManagerServlet.deploy(ManagerServlet.java:731)
        at org.apache.catalina.manager.ManagerServlet.doPut(ManagerServlet.java:424)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:651)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:729)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
        at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
        at org.apache.catalina.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:108)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:185)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:108)
        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:589)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)
        at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:620)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:349)
        at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:784)
        at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
        at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:802)
        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1410)
        at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
        at java.lang.Thread.run(Thread.java:745)
Caused by: java.util.ConcurrentModificationException
        at java.util.HashMap$HashIterator.nextNode(HashMap.java:1437)
        at java.util.HashMap$ValueIterator.next(HashMap.java:1466)
        at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1042)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory.constructServices(IsisSessionFactory.java:157)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactoryBuilder.buildSessionFactory(IsisSessionFactoryBuilder.java:204)
        at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:118)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at com.google.inject.internal.ProviderMethod$ReflectionProviderMethod.doProvision(ProviderMethod.java:299)
        at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:172)
        at com.google.inject.internal.ProviderInternalFactory.provision(ProviderInternalFactory.java:81)
        at com.google.inject.internal.InternalFactoryToInitializableAdapter.provision(InternalFactoryToInitializableAdapter.java:53)
        at com.google.inject.internal.ProviderInternalFactory.circularGet(ProviderInternalFactory.java:61)
        at com.google.inject.internal.InternalFactoryToInitializableAdapter.get(InternalFactoryToInitializableAdapter.java:45)
        at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)
        at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
        at com.google.inject.internal.SingletonScope$1.get(SingletonScope.java:145)
        at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:41)
        at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:54)
        at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:132)
        at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:93)
        at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:80)
        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1092)
        at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:80)
        at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:62)
        ... 55 more
2016-12-02 12:39:02,235 [Application          http-nio-18080-exec-1 INFO ]  [WicketFilter] destroy: Wicket core library initializer
2016-12-02 12:39:02,235 [Application          http-nio-18080-exec-1 INFO ]  [WicketFilter] destroy: Wicket extensions initializer
{code}

This time the problem comes from this line
{code:java}
for (final ObjectSpecification objSpec : servicesInjector.getSpecificationLoader().allSpecifications()) {
{code}
of IsisSessionFactory.constructServices()

it is refered in the stack trace:
{code}
 at org.apache.isis.core.runtime.system.session.IsisSessionFactory.constructServices(IsisSessionFactory.java:157)
{code}

Thanks & Regards Timothy"
ISIS-1550,Improvement,Closed,Remove metamodel validation that insists on at least one @PersistenceCapable class.,"As per JdoMetaModelValidator:

{code}
                if(!found) {
                    validationFailures.add(""No @PersistenceCapable entities found. "" +
                            ""(Are the entities referenced by the registered services? "" + 
                            ""are all services registered? "" + 
                            ""did the DataNucleus enhancer run?)"");
                }
{code}

because it's perfectly valid to have an Isis app with no persisted entities, just view models.
"
ISIS-1549,Improvement,Closed,[DUPLICATE] Speed up bootstrapping by doing classpath discovery in parallel.,"I noticed that the org.reflections library (as used by ClassDiscoveryUsingReflections service) can take an optional ExecutorService.

So, for multi-core machines, this could shave a few seconds off startup time,"
ISIS-1548,Improvement,Closed,"Allow @Mixin annotation to specify the method name to use (instead of '$$') meaning to infer the mixin name from the mixin type.  Also, allow '$' to be used as separator of the mixin type.","The current mixin conventions gives rise to code such as:

{code}
mixin(Invoice._approve.class, invoice).$$();
{code}

where:

{code}
public class Invoice {
    ...
    @Mixin
    public static class _approve {
        ...
        public Invoice $$() { ... }
    }
}
{code}

We'd like it instead to read:    

{code}
mixin(Invoice.Approve.class, invoice).exec();
{code}

ie:

* change ""$$"" to ""exec"" (or any other verb)
* not require the leading ""_"" in the mixin name
* allow the class to be capitalized

Suggestion is:

{code}
public class Invoice {
    ...
    @Mixin(method=""exec"")
    public static class Approve {
        public void exec() { ... }
    }
}
{code}

or (if using `@DomainObject`)

{code}
public class Invoice {
    ...
    @DomainObject(nature=MIXIN, mixinMethod=""exec"")
    public static class Approve {
        public void exec() { ... }
    }
}
{code}
"
ISIS-1547,Improvement,Closed,"[DUPLICATE] Cannot select text in (latest version of) Chrome, due to 'disabled' rather than 'readonly'","suggestion from Martin to use CSS.

https://lists.apache.org/thread.html/34499ec5b20658b01329f7866e27f2601b4aba95630ef0f0dd577590@%3Cusers.isis.apache.org%3E
"
ISIS-1546,Improvement,Closed,Reduce logging (don't show stack traces) for invalid user/pass attempts,don't log exceptions if user mistypes their password
ISIS-1545,Bug,Closed,QueryResultsCache can sometimes result in throwing an exception if not properly initialized when fixtures being installed.,"The fix is to refactor QueryResultsCache.Control so that uses AbstractSubscriber, ie is initialized early on."
ISIS-1544,Bug,Closed,[DUPLICATE] Double clicking an OK button raises an exception,"Double clicking an OK button always raises an exception:

org.apache.wicket.core.request.handler.ListenerInvocationNotAllowedExceptionBehavior rejected interface invocation. Component: [AjaxButton [Component id = okButton]] Behavior: org.apache.wicket.ajax.markup.html.form.AjaxButton$1@2070e2d3 Listener: [RequestListenerInterface name=IBehaviorListener, method=public abstract void org.apache.wicket.behavior.IBehaviorListener.onRequest()] org.apache.wicket.RequestListenerInterface#invoke(RequestListenerInterface.java:237)
org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler#invokeListener(ListenerInterfaceRequestHandler.java:250)
org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler#respond(ListenerInterfaceRequestHandler.java:236)
org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:890)
org.apache.wicket.request.RequestHandlerStack#execute(RequestHandlerStack.java:64)
org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:261)
org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:218)
org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:289)
org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:259)
org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:201)
org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:282)
org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:241)
org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:208)
org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:241)
org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:208)
org.apache.catalina.core.StandardWrapperValve#invoke(StandardWrapperValve.java:220)
org.apache.catalina.core.StandardContextValve#invoke(StandardContextValve.java:122)
org.apache.catalina.authenticator.AuthenticatorBase#invoke(AuthenticatorBase.java:503)
org.apache.catalina.core.StandardHostValve#invoke(StandardHostValve.java:170)
org.apache.catalina.valves.ErrorReportValve#invoke(ErrorReportValve.java:103)
org.apache.catalina.valves.AccessLogValve#invoke(AccessLogValve.java:950)
org.apache.catalina.core.StandardEngineValve#invoke(StandardEngineValve.java:116)
org.apache.catalina.connector.CoyoteAdapter#service(CoyoteAdapter.java:421)
org.apache.coyote.ajp.AjpProcessor#process(AjpProcessor.java:190)
org.apache.coyote.AbstractProtocol$AbstractConnectionHandler#process(AbstractProtocol.java:611)
org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor#run(JIoEndpoint.java:314)
java.util.concurrent.ThreadPoolExecutor#runWorker(ThreadPoolExecutor.java:1142)
java.util.concurrent.ThreadPoolExecutor$Worker#run(ThreadPoolExecutor.java:617)
org.apache.tomcat.util.threads.TaskThread$WrappingRunnable#run(TaskThread.java:61)
    java.lang.Thread#run(Thread.java:745) "
ISIS-1543,Improvement,Closed,IsisConfigurationBuilder should obfuscate password when logged.,
ISIS-1542,New Feature,Closed,Update simpleapp application/archetype to provide access to HSQL DB Manager (via their Swing UI) when running in-memory,just a nice little feature when demo'ing (or to help debug)
ISIS-1541,Bug,Closed,"When no explicit layout xml is available the order of the members is set to incorrect, ignoring other facets","When no explicit layout xml is available the order of the members is set to incorrect, ignoring other facets (couldn't influence the order of the members in a table even with a non-Default TableOrderService)

The fix is in the order of member id in the GirdSystemService.

"
ISIS-1540,Task,Closed,Release tasks for 1.13.2,
ISIS-1539,New Feature,Closed,[WON'T FIX] Incorporate isisaddons' command module as part of Isis core.,
ISIS-1538,Improvement,Closed,Rework simpleapp archetype so that is more modular.,
ISIS-1537,Improvement,Closed,Wrapper factory doesn't seem to handle disable$$ (and perhaps hide$$) in subtype of $$ for a mixin.,"eg
incode document module, integration testing of T_createAndAttachDocumentAndScheduleRender


It also seems to be necessary to pass in a non-null arg, even though validation checks are done after disablement checks."
ISIS-1536,Improvement,Closed,BackgroundService should fail-fast if there is no BackgroundCommandService implementation available to persist the command.,
ISIS-1535,Improvement,Closed,MetaModel CSV should not list mixins as types.,
ISIS-1534,Improvement,Closed,Allow modules (as per AppManifest) to define transitive dependencie.,
ISIS-1533,Bug,Closed,"Fix edit icon offset for boolean, referencem blob, clob and multilinestring panels",
ISIS-1532,Documentation,Closed,Move DN OS cfg props to DN OS guide,
ISIS-1531,Bug,Closed,Possible memory leak,"[The stacktrace below is old, from an earlier version.  Still think there are issues though]

Jan 07, 2013 5:25:58 PM org.apache.catalina.core.StandardContext startInternal
SEVERE: Error filterStart
Jan 07, 2013 5:25:58 PM org.apache.catalina.core.StandardContext startInternal
SEVERE: Context [/app-webapp-0.0.1-SNAPSHOT] startup failed due to previous errors
Jan 07, 2013 5:25:58 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/app-webapp-0.0.1-SNAPSHOT] appears to have started a thread named [com.google.inject.internal.util.$Finalizer] but has failed to stop it. This is very likely to create a memory leak.
Jan 07, 2013 5:25:58 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/app-webapp-0.0.1-SNAPSHOT] appears to have started a thread named [DefaultQuartzScheduler_Worker-1] but has failed to stop it. This is very likely to create a memory leak.
Jan 07, 2013 5:25:58 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/app-webapp-0.0.1-SNAPSHOT] appears to have started a thread named [DefaultQuartzScheduler_Worker-2] but has failed to stop it. This is very likely to create a memory leak.
Jan 07, 2013 5:25:58 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/app-webapp-0.0.1-SNAPSHOT] appears to have started a thread named [DefaultQuartzScheduler_Worker-3] but has failed to stop it. This is very likely to create a memory leak.
Jan 07, 2013 5:25:58 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/app-webapp-0.0.1-SNAPSHOT] appears to have started a thread named [DefaultQuartzScheduler_Worker-4] but has failed to stop it. This is very likely to create a memory leak.
Jan 07, 2013 5:25:58 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/app-webapp-0.0.1-SNAPSHOT] appears to have started a thread named [DefaultQuartzScheduler_Worker-5] but has failed to stop it. This is very likely to create a memory leak.
Jan 07, 2013 5:25:58 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/app-webapp-0.0.1-SNAPSHOT] appears to have started a thread named [DefaultQuartzScheduler_Worker-6] but has failed to stop it. This is very likely to create a memory leak.
Jan 07, 2013 5:25:58 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/app-webapp-0.0.1-SNAPSHOT] appears to have started a thread named [DefaultQuartzScheduler_Worker-7] but has failed to stop it. This is very likely to create a memory leak.
Jan 07, 2013 5:25:58 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/app-webapp-0.0.1-SNAPSHOT] appears to have started a thread named [DefaultQuartzScheduler_Worker-8] but has failed to stop it. This is very likely to create a memory leak.
Jan 07, 2013 5:25:58 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/app-webapp-0.0.1-SNAPSHOT] appears to have started a thread named [DefaultQuartzScheduler_Worker-9] but has failed to stop it. This is very likely to create a memory leak.
Jan 07, 2013 5:25:58 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/app-webapp-0.0.1-SNAPSHOT] appears to have started a thread named [DefaultQuartzScheduler_Worker-10] but has failed to stop it. This is very likely to create a memory leak.
Jan 07, 2013 5:25:58 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/app-webapp-0.0.1-SNAPSHOT] appears to have started a thread named [Timer-1] but has failed to stop it. This is very likely to create a memory leak.
Jan 07, 2013 5:25:58 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/app-webapp-0.0.1-SNAPSHOT] appears to have started a thread named [DefaultQuartzScheduler_QuartzSchedulerThread] but has failed to stop it. This is very likely to create a memory leak.
Jan 07, 2013 5:25:58 PM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [/app-webapp-0.0.1-SNAPSHOT] created a ThreadLocal with key of type [com.google.inject.internal.InjectorImpl$1] (value [com.google.inject.internal.InjectorImpl$1@54ea55f0]) and a value of type [java.lang.Object[]] (value [[Ljava.lang.Object;@64b02b1d]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.

"
ISIS-1530,Wish,Open,"[Wish] Introduce @CollectionLayout(title=SHOW|HIDE, ...) similarly for @ActionLayout and @DomainObjectLayout","Introduce @CollectionLayout(title=SHOW|HIDE, ...) for parented collections, and @ActionLayout(titleInCollection=SHOW|HIDE, ...) for actions returning collections (ignored otherwise).  Could also have @DomainObjectLayout(titleInCollection=SHOW|HIDE, ...) as a fallback"
ISIS-1529,New Feature,Closed,"TableColumnOrderService, to allow column order to be fine-tuned (or columns suppressed)",
ISIS-1528,Improvement,Closed,"Rename isis-viewer-wicket artifacts to isis-core-viewer-wicket, for consistency with other core modules.",
ISIS-1527,Improvement,Resolved,"Make overlays consistent for editable properties, with general fix for Firefox",
ISIS-1526,Bug,Closed,WebServer --port option not working,"see mailing list thread

https://lists.apache.org/thread.html/df764dfb6c499440700003a2afa44617ede8dbbaddabb4d433891cc3@%3Cusers.isis.apache.org%3E"
ISIS-1525,Bug,Resolved,Problems with startup under certain circumstances,"see mailing list thread

https://lists.apache.org/thread.html/e468c2e6d12172402e65c3158aca1758d564cef4a1ca6b8027e5b0ef@%3Cusers.isis.apache.org%3E


Has anyone observed problems with running version 1.13.0?  We upgraded a while ago and a bit after that we saw sometimes this error when redeploying our application on tomcat: 

{code}
2016-10-14 14:29:21,690 [IsisWicketApplication http-nio-18080-exec-103 ERROR] Failed to initialize com.google.inject.ProvisionException: Unable to provision, see the following errors:  1) Error in custom provider, java.util.ConcurrentModificationException at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109) at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109) while locating org.apache.isis.core.runtime.system.session.IsisSessionFactory for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.isisSessionFactory(IsisWicketApplication.java:138) while locating domainapp.webapp.A1FulfilllmentApplication  1 error at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:482) at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:67) at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:984) at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:279) at domainapp.webapp.A1FulfilllmentApplication.init(A1FulfilllmentApplication.java:73) at org.apache.wicket.Application.initApplication(Application.java:823) at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:427) at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351) at org.apache.catalina.core.ApplicationFilterConfig.initFilter(ApplicationFilterConfig.java:279) at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:260) at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:105) at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4561) at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5204) at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:152) at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:726) at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:702) at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:734) at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:952) at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:473) at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1617) at sun.reflect.GeneratedMethodAccessor3189.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:300) at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819) at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:801) at org.apache.catalina.manager.ManagerServlet.check(ManagerServlet.java:1483) at org.apache.catalina.manager.ManagerServlet.deploy(ManagerServlet.java:731) at org.apache.catalina.manager.ManagerServlet.doPut(ManagerServlet.java:424) at javax.servlet.http.HttpServlet.service(HttpServlet.java:651) at javax.servlet.http.HttpServlet.service(HttpServlet.java:729) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) at org.apache.catalina.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:108) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198) at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:108) at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:632) at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140) at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79) at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:620) at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87) at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:349) at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:1110) at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:785) at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1425) at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) at java.lang.Thread.run(Thread.java:745) 
{code}

Caused by: 
{code}
java.util.ConcurrentModificationException at java.util.HashMap$HashIterator.nextNode(HashMap.java:1437) at java.util.HashMap$ValueIterator.next(HashMap.java:1466) at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1042) at org.apache.isis.core.runtime.system.session.IsisSessionFactory.constructServices(IsisSessionFactory.java:151) at org.apache.isis.core.runtime.system.session.IsisSessionFactoryBuilder.buildSessionFactory(IsisSessionFactoryBuilder.java:204) at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:118) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at com.google.inject.internal.ProviderMethod$ReflectionProviderMethod.doProvision(ProviderMethod.java:299) at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:172) at com.google.inject.internal.ProviderInternalFactory.provision(ProviderInternalFactory.java:81) at com.google.inject.internal.InternalFactoryToInitializableAdapter.provision(InternalFactoryToInitializableAdapter.java:53) at com.google.inject.internal.ProviderInternalFactory.circularGet(ProviderInternalFactory.java:61) at com.google.inject.internal.InternalFactoryToInitializableAdapter.get(InternalFactoryToInitializableAdapter.java:45) at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46) at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103) at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40) at com.google.inject.internal.SingletonScope$1.get(SingletonScope.java:145) at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:41) at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:54) at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:132) at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:93) at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:80) at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1092) at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:80) at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:62) ... 54 more 2016-10-14 14:29:21,703 [ThreadPoolSupport http-nio-18080-exec-103 INFO ] join'ing 6 tasks: waited 1 milliseconds 2016-10-14 14:29:21,703 [WicketFilter http-nio-18080-exec-103 ERROR] The initialization of an application with name 'WicketFilter' has failed. com.google.inject.ProvisionException: Unable to provision, see the following errors:  1) Error in custom provider, java.util.ConcurrentModificationException at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109) at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109) while locating org.apache.isis.core.runtime.system.session.IsisSessionFactory for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.isisSessionFactory(IsisWicketApplication.java:138) while locating domainapp.webapp.A1FulfilllmentApplication  1 error at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:482) at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:67) at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:984) at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:279) at domainapp.webapp.A1FulfilllmentApplication.init(A1FulfilllmentApplication.java:73) at org.apache.wicket.Application.initApplication(Application.java:823) at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:427) at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351) at org.apache.catalina.core.ApplicationFilterConfig.initFilter(ApplicationFilterConfig.java:279) at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:260) at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:105) at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4561) at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5204) at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:152) at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:726) at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:702) at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:734) at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:952) at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:473) at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1617) at sun.reflect.GeneratedMethodAccessor3189.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:300) at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819) at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:801) at org.apache.catalina.manager.ManagerServlet.check(ManagerServlet.java:1483) at org.apache.catalina.manager.ManagerServlet.deploy(ManagerServlet.java:731) at org.apache.catalina.manager.ManagerServlet.doPut(ManagerServlet.java:424) at javax.servlet.http.HttpServlet.service(HttpServlet.java:651) at javax.servlet.http.HttpServlet.service(HttpServlet.java:729) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) at org.apache.catalina.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:108) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198) at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:108) at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:632) at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140) at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79) at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:620) at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87) at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:349) at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:1110) at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:785) at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1425) at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) at java.lang.Thread.run(Thread.java:745) Caused by: java.util.ConcurrentModificationException at java.util.HashMap$HashIterator.nextNode(HashMap.java:1437) at java.util.HashMap$ValueIterator.next(HashMap.java:1466) at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1042) at org.apache.isis.core.runtime.system.session.IsisSessionFactory.constructServices(IsisSessionFactory.java:151) at org.apache.isis.core.runtime.system.session.IsisSessionFactoryBuilder.buildSessionFactory(IsisSessionFactoryBuilder.java:204) at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:118) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at com.google.inject.internal.ProviderMethod$ReflectionProviderMethod.doProvision(ProviderMethod.java:299) at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:172) at com.google.inject.internal.ProviderInternalFactory.provision(ProviderInternalFactory.java:81) at com.google.inject.internal.InternalFactoryToInitializableAdapter.provision(InternalFactoryToInitializableAdapter.java:53) at com.google.inject.internal.ProviderInternalFactory.circularGet(ProviderInternalFactory.java:61) at com.google.inject.internal.InternalFactoryToInitializableAdapter.get(InternalFactoryToInitializableAdapter.java:45) at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46) at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103) at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40) at com.google.inject.internal.SingletonScope$1.get(SingletonScope.java:145) at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:41) at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:54) at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:132) at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:93) at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:80) at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1092) at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:80) at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:62) ... 54 more 2016-10-14 14:29:21,720 [Application http-nio-18080-exec-103 INFO ] [WicketFilter] destroy: Wicket core library initializer 2016-10-14 14:29:21,720 [Application http-nio-18080-exec-103 INFO ] [WicketFilter] destroy: Wicket extensions initializer
{code}

After this the application seems to shutdown, if I executed shutdown command for tomcat it isn't successful and the process hangs, only option is to kill it. Normally the shutdown command works perfectly! Only option is to wait some time and suddenly it starts normally.   We observe a similar error sometimes during integration tests. The only message is: 

{code}
java.lang.RuntimeException: java.util.ConcurrentModificationException Caused by: java.util.ConcurrentModificationException And after that:  java.lang.RuntimeException: org.apache.isis.core.commons.exceptions.IsisException: SessionFactory already set up  Caused by: org.apache.isis.core.commons.exceptions.IsisException: SessionFactory already set up  
{code}

Solution is to start the build again then it works most of the time.  Has anyone an idea?  

"
ISIS-1524,Bug,Closed,Dates not showing in view model,"see mailing list thread started by Steve Cameron

https://lists.apache.org/thread.html/8da5312cbc0daf406bfa24af18024089d47b7ca5f591002b8447dde9@%3Cusers.isis.apache.org%3E


and also example app put together by [~jcvanderwal]"
ISIS-1523,Improvement,Closed,"Upgrade wicket-bootstrap and related, and revert ISIS-1520",the upgraded version of Martin's wicket-bootstrap should result in Amelia being excluded.
ISIS-1522,Improvement,Resolved,Remove unused field declarations,
ISIS-1521,Task,Closed,Release activities for 1.15.0 ,
ISIS-1520,Bug,Resolved,Amelia template is broken,"It seems like all the resources are served, but for some reason the pages is not styled at all.

"
ISIS-1519,Improvement,Resolved,"Deprecate JdoColumnLength in applib, instead define types",
ISIS-1518,Improvement,Resolved,Hide and replace certain UI fragments,"I'd like to have the ability to disable/hide and even replace certain elements from the wicket viewer.

For example ability to hide bookmarks panel through configs.
Ability to hide breadcrumbs, Powered By section and Theme chooser.
Also as a consequence, if I'm able to hide those elements, it would be good if I'm able to replace the whole footer with a custom one.

I saw how to replace UI components, but couln't  see a way to replace footer elements.

"
ISIS-1517,Bug,Closed,Typo on home page,At the bottom of http://isis.apache.org/ there is --> sign. Seems to me like something left from a merge.
ISIS-1516,Bug,Resolved,Typo on home page,At the bottom of http://isis.apache.org/ there is --> sign. Seems to me like something left from a merge.
ISIS-1515,Bug,Resolved,BackgroundCommandExecution can NPE if it attempts to invoke an action on an object that no longer exists.,"This is the stack trace that occurs in the main body:

{code}
org.apache.isis.core.runtime.persistence.ObjectNotFoundException: Object not found in store with oid estatioCommunications.Communication:24
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadPojo(PersistenceSession.java:974)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.recreatePojo(PersistenceSession.java:1633)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.adapterFor(PersistenceSession.java:1576)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.adapterFor(PersistenceSession.java:1536)
	at org.apache.isis.core.runtime.sessiontemplate.AbstractIsisSessionTemplate.adapterFor(AbstractIsisSessionTemplate.java:108)
	at org.apache.isis.core.runtime.sessiontemplate.AbstractIsisSessionTemplate.adapterFor(AbstractIsisSessionTemplate.java:104)
	at org.apache.isis.core.runtime.sessiontemplate.AbstractIsisSessionTemplate.adapterFor(AbstractIsisSessionTemplate.java:99)
	at org.apache.isis.core.runtime.services.background.BackgroundCommandExecution.targetAdapterFor(BackgroundCommandExecution.java:331)
	at org.apache.isis.core.runtime.services.background.BackgroundCommandExecution$2.execute(BackgroundCommandExecution.java:177)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:144)
	at org.apache.isis.core.runtime.services.background.BackgroundCommandExecution.execute(BackgroundCommandExecution.java:111)
	at org.apache.isis.core.runtime.services.background.BackgroundCommandExecution.doExecute(BackgroundCommandExecution.java:95)
	at org.apache.isis.core.runtime.sessiontemplate.AbstractIsisSessionTemplate.execute(AbstractIsisSessionTemplate.java:42)
	at org.isisaddons.module.quartz.dom.jobs.RunBackgroundCommandsJob.execute(RunBackgroundCommandsJob.java:46)
	at org.quartz.core.JobRunShell.run(JobRunShell.java:202)
	at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)
Caused by: javax.jdo.JDOObjectNotFoundException: No such database row
FailedObject:24[OID]org.incode.module.communications.dom.impl.comms.Communication
NestedThrowables:
org.datanucleus.exceptions.NucleusObjectNotFoundException: No such database row
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:564)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1728)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1741)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.loadPojo(PersistenceSession.java:963)
	... 15 more
Caused by: org.datanucleus.exceptions.NucleusObjectNotFoundException: No such database row
	at org.datanucleus.store.rdbms.request.FetchRequest.execute(FetchRequest.java:347)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.fetchObject(RDBMSPersistenceHandler.java:319)
	at org.datanucleus.state.AbstractStateManager.loadFieldsFromDatastore(AbstractStateManager.java:1147)
	at org.datanucleus.state.StateManagerImpl.validate(StateManagerImpl.java:4297)
	at org.datanucleus.ExecutionContextImpl.findObject(ExecutionContextImpl.java:3621)
	at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1723)
{code}

Then, we get an NPE in the BackgroundCommandExecution after the execption is caught:

{code}
final Interaction.Execution priorExecution = backgroundInteraction.getPriorExecution();
                backgroundCommand.setCompletedAt(priorExecution.getCompletedAt());
{code}

because priorExecution is null.  This results in:

{code}
java.lang.NullPointerException
	at org.apache.isis.core.runtime.services.background.BackgroundCommandExecution$2.execute(BackgroundCommandExecution.java:234)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:144)
	at org.apache.isis.core.runtime.services.background.BackgroundCommandExecution.execute(BackgroundCommandExecution.java:111)
	at org.apache.isis.core.runtime.services.background.BackgroundCommandExecution.doExecute(BackgroundCommandExecution.java:95)
	at org.apache.isis.core.runtime.sessiontemplate.AbstractIsisSessionTemplate.execute(AbstractIsisSessionTemplate.java:42)
	at org.isisaddons.module.quartz.dom.jobs.RunBackgroundCommandsJob.execute(RunBackgroundCommandsJob.java:46)
	at org.quartz.core.JobRunShell.run(JobRunShell.java:202)
	at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)
{code}
"
ISIS-1514,Improvement,Resolved,Hide the calendar hint on the date time (users tend to click on it),
ISIS-1513,Wish,Open,"[Wish] If query-only action, then grant ability to execute even if only have viewing access.",
ISIS-1512,Improvement,Closed,"MetaModelValidator should detect domain services that have collections, and fail-fast.","this issue arose because attempting to download the metamodel.csv threw an exception when it encountered an invalid class (specifically, EstatioFakeDataService):

{code}
@DomainService(nature = NatureOfService.DOMAIN)
public class EstatioFakeDataService {

    static Random random;
    static {
        random = new Random(System.currentTimeMillis());
    }

    Faker2 faker2;
    @PostConstruct
    public void init() {
        faker2 = new Faker2(random);
    }

    @Inject
    private ClockService clockService;

    @Inject
    private DomainObjectContainer container;

    private RandomService randomService;

    private final Values values;
    private final Collections collections;
    private final Dates dates;
    private final Periods periods;

    public EstatioFakeDataService() {

        randomService = new RandomService(random);

        this.values = new Values();
        this.collections = new Collections();
        this.dates = new Dates();
        this.periods = new Periods();

    }

    @Programmatic
    public PhoneNumber phoneNumber() {
        return faker2.phoneNumber();
    }

    @Programmatic
    public Options options() {
        return faker2.options();
    }

    @Programmatic
    public Internet internet() {
        return faker2.internet();
    }

    @Programmatic
    public Code code() {
        return faker2.code();
    }

    @Programmatic
    public Business business() {
        return faker2.business();
    }

    @Programmatic
    public Address address() {
        return faker2.address();
    }

    @Programmatic
    public Name name() {
        return faker2.name();
    }

    @Programmatic
    public Lorem lorem() {
        return faker2.lorem();
    }

    public Values values() {
        return values;
    }

    public Collections collections() {
        return collections;
    }

    public Dates dates() {
        return dates;
    }

    public Periods periods() {
        return periods;
    }

    public class Values {

        public String code(final int numChars) {
            final StringBuilder buf = new StringBuilder();
            final char[] chars = ""ABCDEFGHIJKLMNOPQRSTUVWXYZ"".toCharArray();
            for (int i = 0; i < numChars; i++) {
                char c = collections().anElement(chars);
                buf.append(c);
            }
            return buf.toString();
        }

        public int anInt(final int upTo) {
            return randomService.nextInt(upTo);
        }

        public int anInt(final int min, final int max) {
            return min + randomService.nextInt(max-min);
        }

        public int aDouble(final int upTo) {
            return randomService.nextInt(upTo);
        }

        public boolean aCoinFlip() {
            return randomService.nextDouble() < 0.5;
        }

        public boolean aDiceRollOf6() {
            return anInt(6) == 5;
        }

    }

    public class Collections  {

        public <E extends Enum<E>> E anEnum(final Class<E> enumType) {
            final E[] enumConstants = enumType.getEnumConstants();
            return enumConstants[values().anInt(enumConstants.length)];
        }

        public <T> T aBounded(final Class<T> cls) {
            final List<T> list = container.allInstances(cls);
            return anElement(list);
        }

        public <T> T anElement(final List<T> list) {
            final int randomIdx = values().anInt(list.size());
            return list.get(randomIdx);
        }

        public char anElement(final char[] elements) {
            final int randomIdx = values().anInt(elements.length);
            return elements[randomIdx];
        }

        public byte anElement(final byte[] elements) {
            final int randomIdx = values().anInt(elements.length);
            return elements[randomIdx];
        }

        public short anElement(final short[] elements) {
            final int randomIdx = values().anInt(elements.length);
            return elements[randomIdx];
        }

        public int anElement(final int[] elements) {
            final int randomIdx = values().anInt(elements.length);
            return elements[randomIdx];
        }

        public long anElement(final long[] elements) {
            final int randomIdx = values().anInt(elements.length);
            return elements[randomIdx];
        }

        public float anElement(final float[] elements) {
            final int randomIdx = values().anInt(elements.length);
            return elements[randomIdx];
        }

        public double anElement(final double[] elements) {
            final int randomIdx = values().anInt(elements.length);
            return elements[randomIdx];
        }

        public boolean anElement(final boolean[] elements) {
            final int randomIdx = values().anInt(elements.length);
            return elements[randomIdx];
        }

        public <T> T anElement(final T[] elements) {
            final int randomIdx = values().anInt(elements.length);
            return elements[randomIdx];
        }
    }


    public class Dates {

        public LocalDate around(final Period period) {
            final LocalDate now = clockService.now();
            return values().aCoinFlip() ? before(period): after(period);
        }

        public LocalDate before(final Period period) {
            final LocalDate now = clockService.now();
            return now.minus(period);
        }

        public LocalDate after(final Period period) {
            final LocalDate now = clockService.now();
            return now.plus(period);
        }

    }

    public class Periods {

        public Period days(final int minDays, final int maxDays) {
            return Period.days(values().anInt(minDays, maxDays));
        }

        public Period daysUpTo(final int maxDays) {
            return days(0, maxDays);
        }

        public Period months(final int minMonths, final int maxMonths) {
            return Period.months(values().anInt(minMonths, maxMonths));
        }

        public Period monthsUpTo(final int months) {
            return months(0, months);
        }

        public Period years(final int minYears, final int maxYears) {
            return Period.years(values().anInt(minYears, maxYears));
        }

        public Period yearsUpTo(final int years) {
            return years(0, years);
        }

    }
}
{code}"
ISIS-1511,Bug,Closed,[WON'T FIX] bootlint error when attempting to view an object with no perms,
ISIS-1510,New Feature,Resolved,Improve support for docker containers by allowing isis configuration properties to be overridden using either system properties or an ISIS_OPT environment variable,"to be picked up from within the webapp's bootstrapping, ie IsisConfigurationBuilder#addDefaultResourcesAndPrimers()

Ths is called by IsisWicketApplication (or by IsisWebAppBootstrapper if only RO viewer in use)."
ISIS-1509,Wish,Open,[Wish] Extending Action Dialogs: new kind of Support Action to contribute to Action Parameters,"Factory Methods should be able to be identified as that.

It could be useful, for example, when executing any action.

For any param of any type, Apache Isis could offer the option to create a new instance by executing an action that both return that type and has been identified as a Factory Method.

An example of defining a Factory Method could be:
{code:java}
class Concert {

    @Action(factoryMethod=true)
    public Concert someAction() {
          return new Concert();
    }
}
{code}

from ISIS-1993:

{code:java}
@Property(createRepository=Supplier.Repository.class, createAction=""create"")
@Getter @Setter Party supplier;{code}
and
{code:java}
public IncomingInvoice edit(
    @Parameter(createRepository=Supplier.Repository.class, createAction=""create"")
    Party supplier,
    ...
) {
   ...
}{code}
 

to invoke a nominated action ""in-situ"".

This could be bound to a keystroke, eg ""F3""
"
ISIS-1508,Improvement,Resolved,The integration test framework should be more resilient to badly behaved tests that leave the transaction incomplete,"Most notably, it's possible for a test to fail an assertion, meaning that the test method is exited, while there are still pending SQL statements to be flushed.  

The current clean up processing (in the IsisTransactionRule) just does a close session, and the first thing that does is close the current transaction if any, by (attempting to commit).  However, if that commit in turn throws an exception, then remaining close tran/close session functionality is skipped. The net result is that the transaction is left incomplete (transactionLevel=1) with the currentTransaction in a state of MUST_ABORT.

Every subsequent test, when it attempts to start its own transaction, immediately finds there's already a MUST_ABORT transaction in place, and fails immediately.

The net effect is that, once one test has failed in this way, then all other tests in the test suite will also fail.

The fix is just to do the clean up more robustly in IsisTransactionRule."
ISIS-1507,Improvement,Resolved,QueryResultsCache should be disabled while fixture scripts are running.,"... because otherwise it's possible to get cache misses solely because reference data hasn't yet been installed.

To implement this, introduce a couple of new ""system events"" advertising that fixtures are being installed / have been installed, and have the QueryResultsCache listen in on those."
ISIS-1506,Bug,Closed,tomcat shutdown - threads in PARK state,"Hi Dan,

Today I monitored threads created within our application while running on tomcat 8.5.3x64 because of an issue in my code.

While doing that I noticed that there were two threads called Thread-7 and Thread-8 (name was stable during a lot of starts but only on the first start) that I wasn't able to find in my code so I debugged a bit deeper and found that they were created in org.apache.isis.core.runtime.threadpool.ThreadPoolSupport:76 during start-up.

After that they are going to state PARK and reside even when undeploying the application from tomcat.

I haven't looked much at your code but I believe you should call shutdown on the ThreadPoolExecutor that you are using once you are finished or in PreDestroy situation. At least I had a very similar issue in my application and shutdown() solved it.

Please find attached a screenshot of IntelliJ view during debug, the screenshot of VisualVM and the catalina log from tomcat complaining about these two threads."
ISIS-1505,Improvement,Resolved,"MetaModelService should return an unknown enum rather than throw exception, eg if passed an java.lang.Object.class.",
ISIS-1504,Improvement,Closed,Metamodel validator should check that all classes annotated as view models are instantiable (are not member inner classes),
ISIS-1503,Improvement,Closed,Allow security checking be disabled when running via SudoService.,"... to provide the ability to run fixture scripts that use the wrapper factory from contexts where there is no current user, in particular during UserRegistration.

The AuthenticationSessionProvider (internal) service should also report the current user/roles (as well as UserService)"
ISIS-1502,Bug,Resolved,"Error handling of invalid domain object not strong enough, causing infinite loop in endTransaction.","The situation being an error in toString() throwing an InvocationTargetException, as part of the processing of ChangedObjectsService in the preCommit().

Although this preCommit() code catches RuntimeExceptions, the InvocationTargetException thrown is actually an Exception (even though not in any throws clause).

What therefore happened was that the catch block in endTransaction did not fire, and was then caught a layer further out (in WebRequestCycleForIsis), which incorrectly created a new transaction but with the current transaction's state / transaction manager's transactionLevel in invalid states.

The net effect was a transaction with the current transaction still in progress, but with transactionLevel = 0.  A subsequent endTransaction took the transactionLevel to -1, then resulting in the infinite loop.

Fixes are:
1. catch Exception rather than just RuntimeException in endTransaction
2. also change the order in which transactionLevel is decremented, so that it is only done after the preCommit stuff has completed ok
3. in the place where we throw an exception if transactionLevel is found to be -1, then also ensure that the state of the current transaction is set appropriately.

All of these have been implemented (and any is sufficient to prevent the infinite loop).

In addition, further logging to detect when there is an invalid end state of transactionLevel and transaction state has been added.




Original root cause that was not caught in endTransaction :

{code}
Caused by:
java.lang.reflect.InvocationTargetException
sun.reflect.GeneratedMethodAccessor367#invoke(null:-1)
sun.reflect.DelegatingMethodAccessorImpl#invoke(DelegatingMethodAccessorImpl.java:43)
java.lang.reflect.Method#invoke(Method.java:498)
org.apache.isis.core.runtime.services.ServiceInstantiator$2#invoke(ServiceInstantiator.java:219)
org.apache.isis.core.runtime.services.changes.ChangedObjectsServiceInternal_$$_jvst301_6#getChangedObjectProperties(ChangedObjectsServiceInternal_$$_jvst301_6.java:-1)
org.apache.isis.core.runtime.services.auditing.AuditingServiceInternal#audit(AuditingServiceInternal.java:79)
org.apache.isis.core.runtime.system.transaction.IsisTransaction#preCommit(IsisTransaction.java:424)
org.apache.isis.core.runtime.system.transaction.IsisTransactionManager#endTransaction(IsisTransactionManager.java:363)
org.apache.isis.viewer.wicket.viewer.integration.wicket.WebRequestCycleForIsis#onRequestHandlerExecuted(WebRequestCycleForIsis.java:129)

Caused by:
java.lang.IllegalArgumentException
No such method ' getSent' or 'isSent'
org.apache.isis.applib.util.Clause#getValueOf(ObjectContracts.java:372)
org.apache.isis.applib.util.ObjectContracts#asString(ObjectContracts.java:282)
org.apache.isis.applib.util.ObjectContracts#toStringOf(ObjectContracts.java:276)
org.apache.isis.applib.util.ObjectContracts#toStringOf(ObjectContracts.java:270)
org.apache.isis.applib.util.ObjectContracts#toString(ObjectContracts.java:127)
org.incode.module.communications.dom.impl.comms.Communication#toString(Communication.java:324)
org.apache.isis.core.runtime.services.changes.ChangedObjectsServiceInternal#asString(ChangedObjectsServiceInternal.java:292)
org.apache.isis.core.runtime.services.changes.PreAndPostValues#setPost(PreAndPostValues.java:90)
org.apache.isis.core.runtime.services.changes.ChangedObjectsServiceInternal#capturePostValuesAndDrain(ChangedObjectsServiceInternal.java:241)
org.apache.isis.core.runtime.services.changes.ChangedObjectsServiceInternal#getChangedObjectProperties(ChangedObjectsServiceInternal.java:222)

Caused by:
java.lang.NoSuchMethodException
org.incode.module.communications.dom.impl.comms.Communication.getSent()
java.lang.Class#getMethod(Class.java:1786)
org.apache.isis.applib.util.Clause#getValueOf(ObjectContracts.java:364)
org.apache.isis.applib.util.ObjectContracts#asString(ObjectContracts.java:282)
org.apache.isis.applib.util.ObjectContracts#toStringOf(ObjectContracts.java:276)
org.apache.isis.applib.util.ObjectContracts#toStringOf(ObjectContracts.java:270)
org.apache.isis.applib.util.ObjectContracts#toString(ObjectContracts.java:127)
org.incode.module.communications.dom.impl.comms.Communication#toString(Communication.java:324)
org.apache.isis.core.runtime.services.changes.ChangedObjectsServiceInternal#asString(ChangedObjectsServiceInternal.java:292)
{code}"
ISIS-1501,Improvement,Closed,MetaModel validator for mixin that doesn't have a public constructor with a single parameter,Currently this programming error results in an NPE with facet factory.
ISIS-1500,New Feature,Closed,"[DUPLICATE] ReplayService, to directly execute a previously persisted command","perhaps using something like this...

... https://gist.github.com/danhaywood/5b3a106ee7c06a53cc33d76f88a04c75

would need to decide:
(a) is this to act on Command (in which case CommandJdo is impl), or
(b) should this perhaps act on CommandDto?
(c) does it just create a new command/interaction, or somehow correlated?"
ISIS-1499,Improvement,Resolved,"Improve BookmarkService to be able to ""lookup"" domain services, so that can schedule background commands against a service.",
ISIS-1498,Bug,Resolved,BackgroundCommandExecution does not handle exceptions correctly.,"Seen two separate issues.

First, when there was a mismatch in arguments to parameters (see ISIS-1497), this resulted in an NPE in this line of the catch block:

{code}
Exception unused = backgroundInteraction.getPriorExecution().getThrew();
{code}

specifically, getPriorExecution() returned null.

Then, when I worked around that issue so that the action could be invoked but when executed threw an exception, resulted in an NPE in this line of the catch block:

{code}
backgroundInteraction.getCurrentExecution().setThrew(e);
{code}

Here, getCurrentExecution() returned null."
ISIS-1497,Bug,Resolved,AbstractIsisSessionTemplate does not lookup adapter for OidDtos correctly.,"the OidDto is treated as a domain object, resulting in a transient PojoAdapter wrapping it.

Instead, it should be handled similarly to adapterFor(RootOid)."
ISIS-1496,Bug,Closed,A domainobject annotated with @DomainObject(auditing = Auditing.DISABLED) is audited nonetheless,https://github.com/isisaddons/isis-module-audit/issues/4
ISIS-1495,Improvement,Resolved,"Extend SessionLoggingService.CausedBy enum, so can mark as complete any log entries that are still shown as ongoing when app (re)starts","For example,  if the server crashes then any in-flight sessions will never be closed off.  We would like service implementations to automatically close thes e off, but to record the fact using a different enum.

Suggest the CausedBy enum is extended to:

- USER
- SESSION_EXPLORATION
- RESTART    // this is the new one."
ISIS-1494,Bug,Resolved,EmailNotificationServiceDefault does not use overriding implementations of EmailService,EmailNotificationServiceDefault:175 is hard coded to use EmailServiceDefault.  This doesn't allow an overriding implementation of the EmailService interface to be used.
ISIS-1493,Bug,Resolved,Sorting of records with null values is not working correctly,"If sorting tables on columns containing null values, the records with null values always appear first. Also after reversing sort order."
ISIS-1492,Improvement,Resolved,Adding css-class to object forms,By adding the css class of an object to the EntityPage it will be possible to style certain items on an object form depending of the state of the object.
ISIS-1491,Improvement,Resolved,Changed all occurrences of allowNulls and allowsNulls in the docs to,
ISIS-1490,Bug,Resolved,Fix 'svg' suffix in ImageResourceCacheClassPath,
ISIS-1489,Improvement,Closed,Rename @Property(notPersisted=...) to @Property(mementoSerialization=...),"In which case, the attribute should be deprecated, and a new @Property(notAudited=true) be introduced to replace it.



It's used by:
- ChangedObjectServiceInternal to determine if a property has changed; marking it as notPersisted means this functionality is skipped.
- Memento (which you almost certainly don't use, I think is only used in anger by the Wicket viewer).

It used to be used by the object persistor for persistence-by-reachability (if notPersisted then don't follow the graph), but I *think* that responsibility is now entirely that of JDO/DN.


"
ISIS-1488,Improvement,Closed,"For auditing, Blobs and Clobs should be automatically ignored (also ISIS-1489)","At the moment the work-around is to annotate with @Property(notPersisted=true).

See also ISIS-1489 re: the naming of this attribute."
ISIS-1487,New Feature,Closed,"[WON'T FIX] Extend the framework's metamodel to be able to render List<Map<String,Object>>","To support this dynamic requirement, the framework (as currently architected) would need to build an ObjectSpecification based on the Map instances being rendered, whose structure is inferred from the members of that Map. 

I could imagine it would be possible to do, but would require some work within the SpecificationLoader.  For example, perhaps the special-case handling here [2] could be extended to return a MapSpecification that handles the dynamic stuff... the issue though is that it would need to be told about a particular Map to look into.  It would be hacky, but maybe putting the Map in question onto a ThreadLocal would suffice.  

[2] https://github.com/apache/isis/blob/master/core/metamodel/src/main/java/org/apache/isis/core/metamodel/specloader/SpecificationLoader.java#L401

"
ISIS-1486,Bug,Closed,three-way Boolean checkbox doesn't seem to be rendering correctly (shows as two-way only),"this for a mandatory parameter, defined as java.lang.Boolean, with the intent being that the end-user must select.

"
ISIS-1485,Bug,Closed,MessageService#informUser(...) doesn't seem to be raising an alert for an action returning a Blob,"{code}
@Action(semantcs = SAFE)
public Blob $$() {
    messageService.informUser(""Not yet implemented"");
    return null;
}
{code}"
ISIS-1484,Wish,Reopened,"[Wish] Extend @Parameter, specify a class to obtain the default, choices, autoComplete. ","{code}
public void updateName(
    @Parameter(defaultOf=""Foo"")  // if can specify an Object???
    @ParameterLayout(named = ""New name"")
    final String name) {

    setName(newName);
}
{code}

or a more elaborate (over-complicated?) design:

eg:
{code}
public void updateName(
    @Parameter(defaultFrom=ParameterDefaultFromProperty.class
    @ParameterLayout(named = ""New name"")
    final String name) {

    setName(newName);
}
{code}

where (part of the applib):
{code}
public interface ParameterDefaulter {
    Object defaultFor(Object domainObject, String actionName, String parameterName);
} 
{code}

and the applib also provides a default implementation:

{code}
public class ParameterDefaultFromProperty implements ParametedDefaulter { ... }
{code}

that uses an injected service (from core.runtime) to look up the parameter value from the corresponding property of the object."
ISIS-1483,Bug,Resolved,Tiny bug in the SimpleObjectTest unit test as generated by the simpleapp.,"the code compiles from the cmd line, but relies on the datanucleus enhancer to create a no-arg constructor... in certain circumstances will get a compile error if imported into an IDE (eg IntelliJ )"
ISIS-1482,Bug,Resolved,"Occasional(?) exception in i18n PoWriter, looks like a concurrent access problem","Did not manifest in the UI, but present as a stacktrace (below).

This SO article [http://stackoverflow.com/questions/37048084/is-this-null-pointer-exception-in-treemap-due-to-concurrent-access] suggests concurrent exception.

Fix probably to introduce the 'synchronized' keyword at some judicious point.

stacktrace:
{code}
00:05:59,617 [RequestCycleExtra             ] ********************************
00:05:59,617 [RequestCycleExtra             ] Handling the following exception
org.apache.wicket.WicketRuntimeException: Exception in rendering component: [MessageContainer [Component id = _message_5]]
	at org.apache.wicket.Component.internalRenderComponent(Component.java:2560)
	at org.apache.wicket.MarkupContainer.onRender(MarkupContainer.java:1496)
	at org.apache.wicket.Component.internalRender(Component.java:2366)
	at org.apache.wicket.Component.render(Component.java:2294)
	at org.apache.wicket.MarkupContainer.renderNext(MarkupContainer.java:1392)
	at org.apache.wicket.MarkupContainer.renderAll(MarkupContainer.java:1557)
	at org.apache.wicket.MarkupContainer.renderComponentTagBody(MarkupContainer.java:1532)
	at org.apache.wicket.MarkupContainer.onComponentTagBody(MarkupContainer.java:1487)
	at org.apache.wicket.markup.html.panel.DefaultMarkupSourcingStrategy.onComponentTagBody(DefaultMarkupSourcingStrategy.java:71)
	at org.apache.wicket.Component.internalRenderComponent(Component.java:2536)
	at org.apache.wicket.MarkupContainer.onRender(MarkupContainer.java:1496)
	at org.apache.wicket.Component.internalRender(Component.java:2366)
	at org.apache.wicket.Component.render(Component.java:2294)
	at org.apache.wicket.MarkupContainer.renderNext(MarkupContainer.java:1392)
	at org.apache.wicket.MarkupContainer.renderAll(MarkupContainer.java:1557)
	at org.apache.wicket.MarkupContainer.renderComponentTagBody(MarkupContainer.java:1532)
	at org.apache.wicket.MarkupContainer.onComponentTagBody(MarkupContainer.java:1487)
	at org.apache.wicket.markup.html.form.Form.onComponentTagBody(Form.java:1743)
	at org.apache.wicket.markup.html.panel.DefaultMarkupSourcingStrategy.onComponentTagBody(DefaultMarkupSourcingStrategy.java:71)
	at org.apache.wicket.Component.internalRenderComponent(Component.java:2536)
	at org.apache.wicket.MarkupContainer.onRender(MarkupContainer.java:1496)
	at org.apache.wicket.Component.internalRender(Component.java:2366)
	at org.apache.wicket.Component.render(Component.java:2294)
	at org.apache.wicket.MarkupContainer.renderNext(MarkupContainer.java:1392)
	at org.apache.wicket.MarkupContainer.renderAll(MarkupContainer.java:1557)
	at org.apache.wicket.MarkupContainer.renderComponentTagBody(MarkupContainer.java:1532)
	at org.apache.wicket.MarkupContainer.renderAssociatedMarkup(MarkupContainer.java:689)
	at org.apache.wicket.markup.html.panel.AssociatedMarkupSourcingStrategy.renderAssociatedMarkup(AssociatedMarkupSourcingStrategy.java:76)
	at org.apache.wicket.markup.html.panel.PanelMarkupSourcingStrategy.onComponentTagBody(PanelMarkupSourcingStrategy.java:112)
	at org.apache.wicket.Component.internalRenderComponent(Component.java:2536)
	at org.apache.wicket.MarkupContainer.onRender(MarkupContainer.java:1496)
	at org.apache.wicket.Component.internalRender(Component.java:2366)
	at org.apache.wicket.Component.render(Component.java:2294)
	at org.apache.wicket.MarkupContainer.renderNext(MarkupContainer.java:1392)
	at org.apache.wicket.MarkupContainer.renderAll(MarkupContainer.java:1557)
	at org.apache.wicket.MarkupContainer.renderComponentTagBody(MarkupContainer.java:1532)
	at org.apache.wicket.MarkupContainer.onComponentTagBody(MarkupContainer.java:1487)
	at org.apache.wicket.markup.html.panel.DefaultMarkupSourcingStrategy.onComponentTagBody(DefaultMarkupSourcingStrategy.java:71)
	at org.apache.wicket.Component.internalRenderComponent(Component.java:2536)
	at org.apache.wicket.MarkupContainer.onRender(MarkupContainer.java:1496)
	at org.apache.wicket.Component.internalRender(Component.java:2366)
	at org.apache.wicket.Component.render(Component.java:2294)
	at org.apache.wicket.MarkupContainer.renderNext(MarkupContainer.java:1392)
	at org.apache.wicket.MarkupContainer.renderAll(MarkupContainer.java:1557)
	at org.apache.wicket.MarkupContainer.renderComponentTagBody(MarkupContainer.java:1532)
	at org.apache.wicket.MarkupContainer.onComponentTagBody(MarkupContainer.java:1487)
	at org.apache.wicket.markup.html.panel.DefaultMarkupSourcingStrategy.onComponentTagBody(DefaultMarkupSourcingStrategy.java:71)
	at org.apache.wicket.Component.internalRenderComponent(Component.java:2536)
	at org.apache.wicket.MarkupContainer.onRender(MarkupContainer.java:1496)
	at org.apache.wicket.Component.internalRender(Component.java:2366)
	at org.apache.wicket.Component.render(Component.java:2294)
	at org.apache.wicket.MarkupContainer.renderNext(MarkupContainer.java:1392)
	at org.apache.wicket.MarkupContainer.renderAll(MarkupContainer.java:1557)
	at org.apache.wicket.Page.onRender(Page.java:887)
	at org.apache.wicket.markup.html.WebPage.onRender(WebPage.java:143)
	at org.apache.wicket.Component.internalRender(Component.java:2366)
	at org.apache.wicket.Component.render(Component.java:2294)
	at org.apache.wicket.Page.renderPage(Page.java:1024)
	at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:139)
	at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:229)
	at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:175)
	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:890)
	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:261)
	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:218)
	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:289)
	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:259)
	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:201)
	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:282)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)
	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:581)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1158)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:511)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1090)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:119)
	at org.eclipse.jetty.server.Server.handle(Server.java:517)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:308)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:242)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:261)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)
	at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:75)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceAndRun(ExecuteProduceConsume.java:213)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:147)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:654)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:572)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.RuntimeException: An error occurred while executing code in a temporary session
	at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:349)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:327)
	at org.apache.isis.viewer.wicket.viewer.integration.wicket.LocalizerForIsis.translate(LocalizerForIsis.java:75)
	at org.apache.isis.viewer.wicket.viewer.integration.wicket.LocalizerForIsis.getString(LocalizerForIsis.java:62)
	at org.apache.wicket.Localizer.getString(Localizer.java:201)
	at org.apache.wicket.Localizer.getString(Localizer.java:150)
	at org.apache.wicket.markup.resolver.WicketMessageResolver$MessageContainer.onComponentTagBody(WicketMessageResolver.java:203)
	at org.apache.wicket.markup.html.panel.DefaultMarkupSourcingStrategy.onComponentTagBody(DefaultMarkupSourcingStrategy.java:71)
	at org.apache.wicket.Component.internalRenderComponent(Component.java:2536)
	... 100 more
Caused by: java.lang.NullPointerException
	at java.util.TreeMap.rotateLeft(TreeMap.java:2224)
	at java.util.TreeMap.fixAfterInsertion(TreeMap.java:2291)
	at java.util.TreeMap.put(TreeMap.java:582)
	at org.apache.isis.core.runtime.services.i18n.po.PoWriter.blockFor(PoWriter.java:143)
	at org.apache.isis.core.runtime.services.i18n.po.PoWriter.translate(PoWriter.java:120)
	at org.apache.isis.core.runtime.services.i18n.po.TranslationServicePo.translate(TranslationServicePo.java:103)
	at org.apache.isis.viewer.wicket.viewer.integration.wicket.LocalizerForIsis.translate(LocalizerForIsis.java:144)
	at org.apache.isis.viewer.wicket.viewer.integration.wicket.LocalizerForIsis.access$000(LocalizerForIsis.java:45)
	at org.apache.isis.viewer.wicket.viewer.integration.wicket.LocalizerForIsis$1.call(LocalizerForIsis.java:78)
	at org.apache.isis.viewer.wicket.viewer.integration.wicket.LocalizerForIsis$1.call(LocalizerForIsis.java:75)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:347)
	... 108 more
{code}"
ISIS-1481,Bug,Resolved,Duplicate PK exception for SessoinLogEntry (isisaddons implementation of SessionLoggingService) due to race condition.,"for example:
{code}
java.sql.BatchUpdateException: Violation of PRIMARY KEY constraint 'SessionLogEntry_PK'. Cannot insert duplicate key in object 'isissessionlogger.SessionLogEntry'. The duplicate key value is (1379530416).
        at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)
        at org.datanucleus.api.jdo.JDOPersistenceManager.flush(JDOPersistenceManager.java:2070)
        at org.apache.isis.core.runtime.system.persistence.PersistenceSession.executeCommands(PersistenceSession.java:1255)
        at org.apache.isis.core.runtime.system.persistence.PersistenceSession.execute(PersistenceSession.java:1247)
        at org.apache.isis.core.runtime.system.transaction.IsisTransaction.doFlush(IsisTransaction.java:378)
        at org.apache.isis.core.runtime.system.transaction.IsisTransaction.preCommit(IsisTransaction.java:419)
        at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.endTransaction(IsisTransactionManager.java:344)
        at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:145)
        at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:133)
        at org.apache.isis.core.runtime.system.persistence.PersistenceSession.makePersistentInTransaction(PersistenceSession.java:1102)
        at org.apache.isis.core.runtime.services.persistsession.PersistenceSessionServiceInternalDefault.makePersistent(PersistenceSessionServiceInternalDefault.java:83)
        at org.apache.isis.core.metamodel.services.repository.RepositoryServiceInternalDefault.persist(RepositoryServiceInternalDefault.java:96)
        at org.apache.isis.core.metamodel.services.container.DomainObjectContainerDefault.persistIfNotAlready(DomainObjectContainerDefault.java:365)
        at org.apache.isis.applib.AbstractContainedObject.persistIfNotAlready(AbstractContainedObject.java:574)
        at org.isisaddons.module.sessionlogger.dom.SessionLoggingServiceDefault.log(SessionLoggingServiceDefault.java:42)
        at org.apache.isis.viewer.wicket.viewer.integration.wicket.AuthenticatedWebSessionForIsis$1.run(AuthenticatedWebSessionForIsis.java:180)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory$1.call(IsisSessionFactory.java:316)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory$1.call(IsisSessionFactory.java:313)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:347)
        ... 60 more

{code}

||sessionId||causedBy||loginTimestamp||logoutTimestamp||user||
|1379530416|NULL|2016-09-07 10:14:47.5690000|NULL|enicoletti@ecp.loc|


Here's some more:


{code}
11:46:37,702 [WebRequestCycleForIsis        ] Unable to obtain exceptionRecognizers (no session), will be treated as unrecognized exception
org.apache.wicket.protocol.http.PageExpiredException: Page with id '8' has expired.
11:48:11,808 [PersistenceSession            ] close: failed to close JDO persistenceManager; continuing to avoid memory leakage
07-Sep-2016 11:48:09.973 WARNING [ContainerBackgroundProcessor[StandardEngine[Catalina]]] org.apache.catalina.core.StandardContext.backgroundProcess Exception processing manager org.apache.catalina.session.StandardManager[/estatioprod] background process
 java.lang.IllegalStateException: No service of type class org.apache.isis.applib.services.command.CommandContext is available on this
        at org.apache.isis.core.runtime.services.ServiceInstantiator$2.invoke(ServiceInstantiator.java:217)
        at org.apache.isis.applib.services.command.CommandContext_$$_jvst9b7_2.getCommand(CommandContext_$$_jvst9b7_2.java)
        at org.apache.isis.core.runtime.system.persistence.PersistenceSession.completeCommandFromInteractionAndClearDomainEvents(PersistenceSession.java:483)
        at org.apache.isis.core.runtime.system.persistence.PersistenceSession.close(PersistenceSession.java:414)
        at org.apache.isis.core.runtime.system.session.IsisSession.close(IsisSession.java:69)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory.closeSession(IsisSessionFactory.java:263)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:354)
        at org.apache.isis.core.runtime.system.session.IsisSessionFactory.doInSession(IsisSessionFactory.java:327)
        at org.apache.isis.viewer.wicket.viewer.integration.wicket.AuthenticatedWebSessionForIsis.getSessionLoggingService(AuthenticatedWebSessionForIsis.java:187)
        at org.apache.isis.viewer.wicket.viewer.integration.wicket.AuthenticatedWebSessionForIsis.log(AuthenticatedWebSessionForIsis.java:173)
        at org.apache.isis.viewer.wicket.viewer.integration.wicket.AuthenticatedWebSessionForIsis.onInvalidate(AuthenticatedWebSessionForIsis.java:120)
        at org.apache.wicket.session.HttpSessionStore$SessionBindingListener.valueUnbound(HttpSessionStore.java:471)
        at org.apache.catalina.session.StandardSession.removeAttributeInternal(StandardSession.java:1838)
        at org.apache.catalina.session.StandardSession.expire(StandardSession.java:891)
        at org.apache.catalina.session.StandardSession.isValid(StandardSession.java:694)
        at org.apache.catalina.session.ManagerBase.processExpires(ManagerBase.java:666)
        at org.apache.catalina.session.ManagerBase.backgroundProcess(ManagerBase.java:651)
        at org.apache.catalina.core.StandardContext.backgroundProcess(StandardContext.java:5625)
        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1377)
        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1381)
        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1381)
        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1349)
        at java.lang.Thread.run(Thread.java:745)
{code}
"
ISIS-1480,Bug,Resolved,"LocalDateTime property on different tabs, encoding exception","when switch between different tabs

org.apache.isis.applib.adapters.EncodingException
java.lang.IllegalArgumentException: Invalid format: ""20160901T075820.484"" is too short
org.apache.isis.core.metamodel.facets.value.datetimejodalocal.JodaLocalDateTimeValueSemanticsProvider#doRestore(JodaLocalDateTimeValueSemanticsProvider.java:246)
org.apache.isis.core.metamodel.facets.value.datetimejodalocal.JodaLocalDateTimeValueSemanticsProvider#doRestore(JodaLocalDateTimeValueSemanticsProvider.java:45)
org.apache.isis.core.metamodel.facets.object.value.vsp.ValueSemanticsProviderAndFacetAbstract#fromEncodedString(ValueSemanticsProviderAndFacetAbstract.java:275)
org.apache.isis.core.metamodel.facets.object.encodeable.encoder.EncodableFacetUsingEncoderDecoder#fromEncodedString(EncodableFacetUsingEncoderDecoder.java:60)
"
ISIS-1479,Wish,Closed,DataNucleus data type mapping for streams (to support direct upload of large BLOBs),"from http://markmail.org/message/64xcc7twcxdrhfqj

> With respect to the storage of the BLOBs themselves, I don't think (at
> least I couldn't find) any datatype mapping to be able to map from a stream
> (obtained from ServletInputStream) into a JDO entity, ie to avoid the
> creation of the BLOB in-memory.  If it *were* possible, then I don't think
> Isis would care; just map the property as @Programmatic and Isis would
> ignore it.  Perhaps Andy might be able to chip in on this?

java.io.File is currently the only java field type with a mapping that is streamable. See
http://www.datanucleus.org/products/accessplatform_5_0/jdo/types.html#Other_Types

Somebody could take existing code used for that type and contribute a mapping for some other java type.
https://github.com/datanucleus/datanucleus-rdbms/blob/master/src/main/java/org/datanucleus/store/rdbms/mapping/datastore/BinaryStreamRDBMSMapping.java
"
ISIS-1478,Bug,Closed,Setting Editing.ENABLED does not seem to override configuration property set to disabled.,
ISIS-1477,Bug,Resolved,Background command execution of commands with 0 parameters causes an NPE,"as per http://markmail.org/message/cgxbb4twcsmfrzfh

The easiest fix is probably just to add a null check in BackgroundCommandExecution.
"
ISIS-1476,Improvement,Resolved,"Transaction interface: Expose ""clearAbortCause"" for don't pick up handled persistence Exceptions","That way we avoid casting from ""Transaction"" to ""IsisTransaction"", and can support use cases that properly handle the Exception without further consequences.

For example, creating an idempotent action that first tries to create an object and, if an SQLIntegrityConstraintViolationException occurs, return the previously persisted entity, avoiding one SELECT on massive bulk actions.

{code}
 // {{ addMessage (action)
    @Action(semantics=SemanticsOf.IDEMPOTENT)
    public Message addMessageIdempotent(
	    final String receiptHandle, final String notificationId,
	    final Clob xmlContent, final String notificationType, 
	    final DateTime publishTime, final String payloadVersion) {
	Notification unprocessedNotification = null;

	try {
	    unprocessedMessage = this.wrap(this).createMessage(receiptHandle,
		    notificationId, amazonMarketplace, xmlContent,
		    notificationType, publishTime, payloadVersion, sellerId);
	} catch (final JDODataStoreException e) {
	    if (Iterables.filter(Throwables.getCausalChain(e),
		    SQLIntegrityConstraintViolationException.class) != null) {

		((IsisTransaction) this.transactionService.currentTransaction())
			.clearAbortCause();

		unprocessedMessage = this.wrap(this).findByReceiptHandle(
			receiptHandle);
	    } else {
		throw e;
	    }
	}

	return unprocessedMessage;

    }

    // }}
{code}


If published in the ""Transaction"" interface, the casting can be avoided, being simply:

{code}
		this.transactionService.currentTransaction()
			.clearAbortCause();
{code}
"
ISIS-1475,Bug,Resolved,Application name not set,The application name is an empty string so the title-element of the login page is empty (several password managers use this title).
ISIS-1474,Bug,Resolved,Cannot use custom implementation of authenticationmanager (ShiroWithOAuth2AuthenticationManagerInstaller),"Good Evening apache isis team,

	Im still new here so I'll try my best to explain the issue that I have found. I found a potential bug when I was updating our application
to the latest apache isis version to 1.13.0 and found this error. It's regarding the shiro authentication/authorization manager installer. It
seems it is looking for a constructor but couldn't trace and couldn't see as to why this happens. here is the stacktrace: 

{quote}	
18:15:53,891  [IsisWicketApplication main       ERROR]  Failed to initialize
com.google.inject.ProvisionException: Guice provision errors:

1) Error in custom provider, org.apache.isis.core.commons.factory.InstanceCreationException: Could not instantiate an object of class 'c.organization.isis.addons.oauth2.app.authentication.ShiroWithOAuth2AuthenticationManagerInstaller'; c.organization.isis.addons.oauth2.app.authentication.ShiroWithOAuth2AuthenticationManagerInstaller
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:109)
  while locating org.apache.isis.core.runtime.system.session.IsisSessionFactory
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.isisSessionFactory(IsisWicketApplication.java:138)
  while locating c.organization.iaoy.boot.webapp.IaoyApplication

1 error
	at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:451)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:65)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:279)
	at c.s.iaoy.boot.webapp.IaoyApplication.init(IaoyApplication.java:63)
	at org.apache.wicket.Application.initApplication(Application.java:823)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:427)
	at org.apache.wicket.protocol.http.WicketServlet.init(WicketServlet.java:271)
	at javax.servlet.GenericServlet.init(GenericServlet.java:244)
	at org.eclipse.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:626)
	at org.eclipse.jetty.servlet.ServletHolder.initialize(ServletHolder.java:405)
	at org.eclipse.jetty.servlet.ServletHandler.initialize(ServletHandler.java:875)
	at org.eclipse.jetty.servlet.ServletContextHandler.startContext(ServletContextHandler.java:346)
	at org.eclipse.jetty.webapp.WebAppContext.startWebapp(WebAppContext.java:1379)
	at org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1341)
	at org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:772)
	at org.eclipse.jetty.servlet.ServletContextHandler.doStart(ServletContextHandler.java:259)
	at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:517)
	at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:68)
	at org.eclipse.jetty.util.component.ContainerLifeCycle.start(ContainerLifeCycle.java:132)
	at org.eclipse.jetty.server.Server.start(Server.java:405)
	at org.eclipse.jetty.util.component.ContainerLifeCycle.doStart(ContainerLifeCycle.java:106)
	at org.eclipse.jetty.server.handler.AbstractHandler.doStart(AbstractHandler.java:61)
	at org.eclipse.jetty.server.Server.doStart(Server.java:372)
	at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:68)
	at org.apache.isis.core.webserver.WebServer.start(WebServer.java:179)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:131)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:98)
	at org.apache.isis.WebServer.main(WebServer.java:25)
Caused by: org.apache.isis.core.commons.factory.InstanceCreationException: Could not instantiate an object of class 'c.organization.isis.addons.oauth2.app.authentication.ShiroWithOAuth2AuthenticationManagerInstaller'; c.organization.isis.addons.oauth2.app.authentication.ShiroWithOAuth2AuthenticationManagerInstaller
	at org.apache.isis.core.commons.factory.InstanceUtil.createInstance(InstanceUtil.java:141)
	at org.apache.isis.core.commons.factory.InstanceUtil.createInstance(InstanceUtil.java:103)
	at org.apache.isis.core.commons.factory.InstanceUtil.createInstance(InstanceUtil.java:34)
	at org.apache.isis.core.runtime.systemusinginstallers.IsisComponentProviderUsingInstallers$InstallerLookup.getInstaller(IsisComponentProviderUsingInstallers.java:218)
	at org.apache.isis.core.runtime.systemusinginstallers.IsisComponentProviderUsingInstallers$InstallerLookup.getInstaller(IsisComponentProviderUsingInstallers.java:212)
	at org.apache.isis.core.runtime.systemusinginstallers.IsisComponentProviderUsingInstallers$InstallerLookup.getInstaller(IsisComponentProviderUsingInstallers.java:235)
	at org.apache.isis.core.runtime.systemusinginstallers.IsisComponentProviderUsingInstallers$InstallerLookup.authenticationManagerInstaller(IsisComponentProviderUsingInstallers.java:187)
	at org.apache.isis.core.runtime.systemusinginstallers.IsisComponentProviderUsingInstallers.lookupAuthenticationManager(IsisComponentProviderUsingInstallers.java:102)
	at org.apache.isis.core.runtime.systemusinginstallers.IsisComponentProviderUsingInstallers.<init>(IsisComponentProviderUsingInstallers.java:63)
	at org.apache.isis.core.runtime.systemusinginstallers.IsisComponentProviderUsingInstallers.<init>(IsisComponentProviderUsingInstallers.java:54)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSessionFactory(IsisInjectModule.java:111)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	... 27 more
Caused by: java.lang.InstantiationException: c.organiztion.isis.addons.oauth2.app.authentication.ShiroWithOAuth2AuthenticationManagerInstaller
	at java.lang.Class.newInstance(Class.java:427)
	at org.apache.isis.core.commons.factory.InstanceUtil.createInstance(InstanceUtil.java:125)
	... 55 more
Caused by: java.lang.NoSuchMethodException: c.organization.isis.addons.oauth2.app.authentication.ShiroWithOAuth2AuthenticationManagerInstaller.<init>()
	at java.lang.Class.getConstructor0(Class.java:3082)
	at java.lang.Class.newInstance(Class.java:412)
	... 56 more
{quote}	
	
	What I did was updating ShiroWithOauth2AuthenticationManagerInstaller, since in the new version, the constructor required
to have an isis configuration. Looked up in github and saw this commit ISIS-1406 which I can only think it's related to this.	

	I hope this trace helps and my english too. :)"
ISIS-1473,Wish,Open,[Wish] Inline edit for mutable collections with filtering,"Ability to allow inline mutable collections allowing filters.  This would allow the users to edit collections in the same grid shown in the Viewer, and also filter data using multiple types of filters.

Mutable collections might include:
- Row selection to identify which row to edit.
- Move around the properties within a collection either using the TAB key or using the mouse to position in a specific property.
- Properties with multiple allowed values or with foreign lookup shown as a drop down selection list. Ideally, if multiple values are allowed (1:N), multi-selection might be allowed.
- Existing values in a cell should be auto selected when the user reaches the cell, to facilitate replacing the existing value by just keying in the new value.
- Allow creation of new elements in the collection by adding a row. Multiple rows could be added by reaching the end of a row and keying in the TAB key, and also by selecting a blank space by the end of the collection grid.
- Ability to define in the meta data of the collection which properties are editable in this grid.
- Ability to define in the meta data if the user is allowed to add rows in this collection.

Filters:
- Associate default filters to domain entities of the domain model.
- Associate default filters to collections, ideally by inheriting filters from the domain entities they are composed of.
- Ability to define the type of filter (GUI widget), like drop down list, type ahead lists, combo box, radio button, range slider, date pick, date range slider.

So default filters would be shown automatically in the UI, either in a stand alone displayed entity, or on top of the collection.

Ability to override filters for specific views.
"
ISIS-1472,Bug,Resolved,"Any attempts to schedule a background job via the RO viewer fail, due to incomplete state.  (In fact: actions with commands cannot be invoked via RO viewer).","The issue is that regular commands are not being persisted, at all, under the RO viewer.  

This is because I've made it the responsibility of the viewer to get hold of the current Command (using CommandContext#getCommand()) and to update the ""Executor"" of the Command to be ""USER"".  This is done by the Wicket viewer.  And, similarly, in BackgroundCommandExecution adapter the Executor gets set to ""BACKGROUND"".

But in the RO viewer I've not updated this field, so it remains set to its default, ""OTHER"".  This then causes the initialization of the Command (when the initial action is invoked) to be skipped, resulting in no memberIdentifier.

So, the fix is just for RO viewer to set this field in DomainObjectResourceServerside and DomainServiceResourceServerside.
"
ISIS-1471,New Feature,Closed,Integrate Flyway or Liquibase or something similar,"from Kambiz:

Hi,

in our non-Isis projects, we use FlyWay [1] for DB migrations and I
would like to integrate it into our Isis workflow. The simplest path to
do so would be a DomainService with a PostConstruct annotated init
method:

@PostConstruct
public void init(final Map<String, String> properties) {
    Flyway flyway = new Flyway();

    // Point it to the database
    String jdbcUrl = properties.get(""isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionURL"");
    String user = properties.get(""isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionUserName"");
    String password = properties.get(""isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionPassword"");

    flyway.setDataSource(jdbcUrl, user, password);
    flyway.setLocations(""classpath:db/migrations"");
    // Start the migration
    flyway.migrate();
}


but this isn't a viable solution, as IsisSessionFactoryBuilder's
buildSessionFactory() method initialises the DataNucleus (DN)
PersistenceSessionFactory before the services are constructed [2].

So DN has already found the mismatch between the JDO annotations and the
database before we enter the init method of our DB migration
bootstrap/seed service.

I could contribute a patch, if someone could hint on the preferred way
of implementing the functionality.

Thank you


Kambiz


[1] https://flywaydb.org/

[2] https://github.com/apache/isis/blob/master/core/runtime/src/main/java/org/apache/isis/core/runtime/system/session/IsisSessionFactoryBuilder.java#L184


"
ISIS-1470,Bug,Resolved,Maintenance 1.13.1 umbrella ticket,as a placeholder for any maintenance work...
ISIS-1469,Improvement,Closed,MetaModel validator to detect duplicate schema/table names (read JDO/DN metadata at runtime),"Hi Dan,

Today I came across a situation that might cause unexpected behavior, finding the real cause was not very easy because the situation showed through various errors, here some that I can remember:
-	Datanucleus enhancer failed with a message that there is duplicate signature&name
-	The same error as above but this time shown once the Unit-Tests started
-	“Unique index or primary key violation” in a domain object which name was a duplicate
-	Missing column exception
The really sad thing is that we had already two domain objects with the same name for some builds, the error messages started when I started changing one of them.

We are using autoCreateAll and are specifying table names for some classes as we are working on oracle and facing the limitation of 30 characters:
{code}
@javax.jdo.annotations.PersistenceCapable(schema = JdoConstants.A1FF_SCHEMA_NAME, table = ""STEP_FIND_DSL_PORT_VULL"")
@javax.jdo.annotations.Inheritance(strategy = InheritanceStrategy.NEW_TABLE)
{code}

Therefore I introduced now a test checking for this. Might this be something for Apache ISIS metamodel validation or is that more a thing for Datanucleus?

{code}
import java.util.HashSet;
import java.util.Set;

import javax.jdo.annotations.Inheritance;
import javax.jdo.annotations.InheritanceStrategy;
import javax.jdo.annotations.PersistenceCapable;

import org.junit.Test;
import org.reflections.Reflections;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import a1.oss.FulfillmentAppDomainModule;
import static org.assertj.core.api.Assertions.assertThat;

public class DuplicateDefinitionsTest {

    private final static Logger LOG = LoggerFactory.getLogger(DuplicateDefinitionsTest.class);

    @Test
    public void testTableNames() {
        HashSet<String> tableNames = new HashSet<>();

        final Set<Class<?>> persistentClasses = new Reflections(FulfillmentAppDomainModule.class.getPackage().getName())
                .getTypesAnnotatedWith(PersistenceCapable.class);
        for (Class aClass : persistentClasses) {
            // skip this class if it doesn't result in a separate table
            final Inheritance inheritance = (Inheritance) aClass.getAnnotation(Inheritance.class);
            if (inheritance != null && (InheritanceStrategy.SUBCLASS_TABLE.equals(inheritance.strategy())
                    || InheritanceStrategy.SUPERCLASS_TABLE.equals(inheritance.strategy())))
                continue;

            String tableName = aClass.getSimpleName();
            // if persistent class has annotated tablename
            final PersistenceCapable annotation = (PersistenceCapable) aClass.getAnnotation(PersistenceCapable.class);
            if (annotation != null && !annotation.table().isEmpty()) {
                tableName = annotation.table();
            }

            assertThat(tableNames.add(tableName)).describedAs(""Table '"" + tableName + ""' for class '"" + aClass.getSimpleName() + ""' is already used by another class"")
                    .isEqualTo(true);
        }

        assertThat(tableNames.size()).as(""No persistent tables found!?"").isGreaterThan(0);
    }
}
{code}

Regards Timothy
"
ISIS-1468,Improvement,Closed,Extend TransactionService to include API of TransactionStateProviderInternal.,Rationalization of internal domain services.
ISIS-1467,Improvement,Closed,[INCOMPLETE] Deprecate features/API which are either unused or for which there is a better replacemen,
ISIS-1466,Bug,Closed,Hidden(where=REFERENCES_PARENT) seems to be broken.,
ISIS-1465,Task,Closed,Release activities for 1.16.0,
ISIS-1464,Improvement,Closed,DomainChangeJdoAbstract#openTarget should support looking up view models,"The publishmq Isis addons' PublishedEvent subclasses from this, and we potentially want to capture view models as targets.

Although BookmarkService2#lookup(...) extended the API to allow view models to be recreated, the DomainChangeJdoAbstract class didn't use it.

"
ISIS-1463,Improvement,Closed,A new user has some trouble filling in date field using wicket ui,"While observing new users of an Apache Isis application (wicket UI) it appears that they tend to click the icon on the righthand side of a date field instead of placing the cursor in the input field.

Maybe make the icon clickable as well?"
ISIS-1462,Improvement,Closed,A new user has some trouble navigating to a single item in a collection using wicket ui,"While observing new users of an Apache Isis application (wicket UI) it appears that they tend to click a link in a column of a collection rather then use the icon left when trying to navigate to a single object.

Maybe styling the Icon (for instance by giving it same color as a link) will help? "
ISIS-1461,Bug,Closed,More reliable fix to concurrency exception,"The concurrency exception addressed in 1.12.x has reappeared.

To reproduce:
- https://github.com/danhaywood/ddd-london-20160601
- dev_summer branch
- create Presenter
- click 'Create' (the contributed action to propose a session)
- in the resultant Session, click on the ""Other"" tab (where the Presenter reference lives)
- bam, concurrency exception.

Suggest the fix instead is to postpone the EntityPage#buildGui into the onRender, so that reload all objects on the redirect.  Have considered this in the past but had been able to make it work without resorting to this.
"
ISIS-1460,Improvement,Closed,Position edit link on top of string field.,
ISIS-1459,Improvement,Closed,Add AppManifest.Util class to set up common configuration properties for running in-memory,And then deprecate IsisConfigurationForJdoTests.
ISIS-1458,Bug,Closed,"Possible incomplete auditing for ""non-trivial"" updates","If object modified twice in a transaction, then auditing only picks up changes to first properties modified.

for example, suppose first time an object is modified its properties ""firstName"" and ""lastName"" are updated; then later on suppose that ""cityOfBirth"", ""lastName"" and ""age"" are updated.

The auditing would not report the changes to ""age"" because it quits out of capturing pre-values as soon as ""lastName"" is encountered in the second update."
ISIS-1457,Improvement,Closed,PoWriter shouldn't log on shutdown if there are metamodel validation exceptions,... because otherwise the log can cause the useful metamodel validation exception messages to scroll off the terminal.
ISIS-1456,Improvement,Closed,[WON'T FIX] Replace WithTransactionScope in applib to instead support @TransactionScoped,
ISIS-1455,Improvement,Closed,Improve metamodel invalid exception handling,"At the moment the MMV error handling works only ""by accident"":
- if an validation failure is found then the remaining initialization of authentication manager and persistence is skipped.
- attempting to go to the login causes a null pointer exception
- this exception is caught and then the MMV thrown

This also raises an issue for implementations of - say - the ThemeProvider that want to make database queries, eg via Settings service.  The todoapp does this.

So, instead, we should always do the complete initialization even if there is a metamodel validation exception, but then intercept any such exceptions and route the MmvErrorPage thereafter.
"
ISIS-1454,Bug,Closed,Hints for drop-downs in Wicket viewer not honoured.,
ISIS-1453,Bug,Closed,SessionManagementService#nextSession broken (in 1.13.0-SNAPSHOT),"Calls the incorrect API to start new transaction, resulting in Isis attempting to start the JDO xactn twice."
ISIS-1452,Bug,Closed,Throwing an exception (for -SNAPSHOT) does not abort the transaction.,"This relates to the earlier work in this iteration (1.13.0-SNAPSHOT) for the refactoring for interaction contexts.

The responsibility for aborting the xactn in the case of an exception used to be performed by the transaction facet decorators.  When they were removed, equivalent functionality was not put in its place.

The net result being, throwing an exception still resulted in changes to objects being persisted."
ISIS-1451,Improvement,Closed,SessionManagement#nextSession does not close off the current Interaction's execution graph.,"This is somewhat of a corner case, but if SessionManagementService's nextSession() method is called -- within an action -- then this ought to (somehow) gracefully close off the current interaction in order to set up a new interaction."
ISIS-1450,Improvement,Closed,Enabling Wicket viewer's rememberMe.suppress does not seem to work.,"If the configuration property is not set (ie not suppressed) then the 'rememberMe' checkbox is shown.  With this settings things are fine; the session is remembered if the user leaves the checkbox as set, or is not remembered if the user explicitly unchecks the checkbox.

If the configuration property is set (ie to suppress), then - as expected - the checkbox is not shown.  However, the session then seems to be automatically remembered always."
ISIS-1449,Improvement,Closed,Rename 'isis.viewer.wicket.suppressRememberMe' to 'isis.viewer.wicket.rememberMe.suppress',"... because, per ISIS-1256, we also now have other configuration properties prefixed 'isis.viewer.wicket.rememberMe'"
ISIS-1448,Improvement,Closed,"Reinstate component factory for collections, so that they can be easily substituted.",The ability to easily swap out collections functionality was lost in 1.12.x (with the layout XML stuff).  This is to reinstate it.
ISIS-1447,Improvement,Closed,Avoid possible race-condition resulting in 500 errors under the Restful Objects viewer,"As per http://markmail.org/message/hsjljwgkhhrzxbrm

Instead, auto-logout if find that session is already authenticated.

In case this new approach introduces more problems than it resolves, allow the the current (occasionally broken) behaviour to be re-enabled using a configuration parameter."
ISIS-1446,New Feature,Closed,Extend the Wicket viewer client-side file-open-dialog to allow file extension to be specified.,
ISIS-1445,Improvement,Closed,Tab names (in XML layouts) should be translated via TranslationService,
ISIS-1444,Bug,Closed,Mark applib FixtureScript.Execution methods as @Programmatic to avoid being added to the metamodel,... otherwise these will fail metamodel validation (beginning with clearXxx())
ISIS-1443,Improvement,Closed,Refactor specloader so that specs for domain services are marked as a service from the get-go,"ie pass in through the constructor.

(Our previous design had the ObjectSpecification#markAsService method called later on, so this refactoring removes that method)."
ISIS-1442,Improvement,Closed,Mark some applib classes as @Value in order to reduce size of the metamodel (don't mixin to these).,"Specifically: TranslatableString, Interaction (new in 1.13.0) and ApplicationFeatureId."
ISIS-1441,Improvement,Closed,Remove subclass of AuthenticationManagerStandard in isis-core-runtime.,"Simplifying the codebase; with a small amount of refactoring, can move the classes to isis-core-metamodel and reduce the class hierarchy."
ISIS-1440,Improvement,Closed,[DUPLICATE] Use Fork/Join framework to load specifications in parallel? (speed up bootstrap time on multi-core machines),
ISIS-1439,Improvement,Closed,Handle default methods defined in interfaces (JDK8),"For example, IsisConfigurationDefault service has spliterator() and forEach(), by virtue of implementing Iterator interface."
ISIS-1438,Improvement,Closed,Set up JAXBContext for ChangesDtoUtils and the others in a background thread.,... so that they are ready to use by the time required.
ISIS-1437,Improvement,Closed,Configure slow-running Wicket bootstrapping in separate background threads.,"eg 
{code}
            configureWebJars();
            configureWicketBootstrap();
            configureWicketSelect2();
{code}

These methods are called during {{init()}}, same place that Isis itself is initialized.  So could do a fork/join and ensure complete before exiting the init()."
ISIS-1436,Bug,Closed,"When executing a bulk action on a paginated collection items, chosen items can be ignored unintentionally","When executing a bulk action on paginated collection the action is not executed on all items after choosing 'list all' (in order to undo pagination in UI), 'select all' and then executing the action.

The issue can be reproduced using kitchensink - bulk. (In the attached screenshots extra items in the fixturescript)
"
ISIS-1435,Bug,Closed,Infitinite recursion in updating() callback if it modifies the object,"I'm observing infinite recursion / stack overflow if a domain object has an updating() reserved method that updates the domain object.  This is related, if not identical, to ISIS-1004.

Steps to reproduce:

1.
Checkout the SimpleApp as described on https://isis.apache.org/guides/ugfun.html#_generating_the_app - 
{code}
mvn archetype:generate  \
    -D archetypeGroupId=org.apache.isis.archetype \
    -D archetypeArtifactId=simpleapp-archetype \
    -D archetypeVersion=1.12.2 \
    -D groupId=com.mycompany \
    -D artifactId=myapp \
    -D version=1.0-SNAPSHOT \
    -B
{code}

2.
Open the class:
{code}domainapp.dom.simple.SimpleObject{code}
and add the following code to the bottom:
{code}
public void updating() {
    	System.out.println(""updating()"");
    	// this.name += ""-updating""; // modification directly to field
    	this.setName(this.getName() + ""-updating""); // modification via setter
    }
{code}

3.
Build as described on https://isis.apache.org/guides/ugfun.html#_building_the_app - 
{code}
cd myapp
mvn clean install
{code}

Result:
Stack overflow in {code}domainapp.integtests.tests.modules.simple.SimpleObjectIntegTest$UpdateName{code}"
ISIS-1434,Bug,Closed,"Cookie not cleared after logout, Shiro session remains active","I have some files that I have stored in the resource folder, which I only want to be available for authenticated users. So I have added the following contents to my shiro.ini file:

{code}
[main]
authc.loginUrl = /wicket/signin
 
[urls]
/dist/** = authc
{code}

When I am not authenticated, retrieving a page from that folder correctly brings me to Wicket. After logging in, the resource becomes available. However, when I log out, either through the TertiaryActionsPanel in Wicket, or using the logout call from the UserResource, it seems that my cookie is not cleared. I am logged out from Wicket, but I can still access the resources (until I clear my cookie on client side).

In this case i'm trying to protect a few resources, which is a kind of ridiculous use case, but I think that this also applies for other servlet filters, which may lead to some unwanted results."
ISIS-1433,New Feature,Closed,New configuration option to allow a minimum/maximum date to be specified for date pickers.,
ISIS-1432,Bug,Closed,"When there is no default for a date parameter, the system is defaulting to the current date, whereas it should be null.",
ISIS-1431,Wish,Open,[Wish] Enhance deep linking to action prompts or action invocation results.,"We can create deep links to domain objects, and we can bookmark action invocations, but we can't do deep links to action invocations.

It would also be nice to have deep links to action prompts. If parameter arguments are supplied, then invoke the action, else render the prompt.  Perhaps also a ""special"" query parameter might be used to support partial completion of arguments, letting the user see the prompt and hit OK for themselves."
ISIS-1430,Improvement,Closed,"Deprecate AuditingService3 and replace with AuditerService, with transactions identified by ...","...by (transactionId,sequence number).

Note that transactionId is misnamed; it is now actually the identifier of an interaction/request."
ISIS-1429,Improvement,Closed,Remove unused code.,
ISIS-1428,Improvement,Closed,Remove unnecessary 'synchronized' modifiers,
ISIS-1427,Improvement,Closed,Simplify bootstrapping code,"simplify and rationalize IsisSystem, IsisContext, IsisSessionFactory, IsisComponentProvider

Also only allow AppManifest to be used to bootstrap integration tests."
ISIS-1426,Improvement,Closed,Remove unused log4j appender classes,
ISIS-1425,Improvement,Closed,Fix support for publishing of wrapper calling programmatically instantiated mixin.,"suppose we have a mixin:

Touchable_touch

whose action ""$$"" is published.

What already works is that this will be published as an action ""touch"" on the mixed-in domain object.

However, if we try to do this programmatically via the WrapperFactory, ie 

{code}
wrapperFactory.wrap(factoryService.mixin(Touchable_touch.class, touchable)).$$();
{code}

then the target that is published is the (transient) mixin object itself, rather than the domain object.

~~~
The fix is therefore to make the wrapper factory's wrapper proxy more intelligent, by invoking on the mixed-in action on the mixed-in domain object, rather than simply on the regular default action of the mixin (transient) object.

If this "
ISIS-1424,Task,Closed,Release activities for v1.12.2,
ISIS-1423,Bug,Closed,TranslationServicePo does not guard against null keys.,
ISIS-1422,Bug,Closed,Autocomplete publishes events to the event bus.,
ISIS-1421,New Feature,Closed,Possible object deadlock when under load.,"For example, running 10 concurrent users.  The issue looks like it might be too much synchronized calls, possible deadlock."
ISIS-1420,New Feature,Closed,"To support dockerization, have any overrides.properties file take precedence over any other config properties","For example, in the following process:

* use mvn (as currently) to create a WAR file, with the pom.xml set up for JDBC drivers of all DB servers we might want to connect to (hsqldb, sql server, postgresql)
* the Docker image should be built from a Dockerfile specifying just Tomcat 8 + Java 8.
* the build process that creates the Docker image should explode the WAR file, and not copy over the WAR. Ideally these files should be read-only
* for externalizing configuration, develop an ENTRYPOINT script that gather up all the command line arguments passed to docker run and copy them into a new WEB-INF/overrides.properties file; Apache Isis will be enhanced to pick this up if present
"
ISIS-1419,Improvement,Closed,Simplify session management handling (IllegalStateException when integ tests complete).,"This exception is the result of stricter exception handling introduced during
ISIS-1414:

{code}
} else {
                        T service = serviceByThread.get();
                        if(service == null) {
                            // shouldn't happen...
                            throw new IllegalStateException(""No service of type "" + cls + "" is available on this "");
                        }
                        final Object proxiedReturn = proxyMethod.invoke(service, args);
                        return proxiedReturn;
{code}

resulting in the following exception when integ tests complete:
{code}
11:03:24,485  [IsisContext          Thread-1   INFO ]  Shutting down thread: main
java.lang.IllegalStateException: No service of type class org.apache.isis.applib.services.command.CommandContext is available on this 
	at org.apache.isis.core.runtime.services.ServiceInstantiator$2.invoke(ServiceInstantiator.java:217)
	at org.apache.isis.applib.services.command.CommandContext_$$_jvst3a6_2.getCommand(CommandContext_$$_jvst3a6_2.java)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.completeCommandFromInteractionAndClearDomainEvents(PersistenceSession.java:489)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.close(PersistenceSession.java:424)
	at org.apache.isis.core.runtime.system.session.IsisSession.close(IsisSession.java:95)
	at org.apache.isis.core.runtime.system.session.IsisSession.closeAll(IsisSession.java:111)
	at org.apache.isis.core.runtime.system.context.IsisContext.shutdownAllThreads(IsisContext.java:601)
	at org.apache.isis.core.runtime.system.context.IsisContext.closeAllSessionsInstance(IsisContext.java:274)
	at org.apache.isis.core.runtime.system.context.IsisContext.closeAllSessions(IsisContext.java:363)
	at org.apache.isis.core.runtime.system.IsisSystem.shutdown(IsisSystem.java:344)
	at org.apache.isis.core.integtestsupport.IsisSystemForTest.shutdown(IsisSystemForTest.java:490)
	at org.apache.isis.core.integtestsupport.IsisSystemForTest.access$100(IsisSystemForTest.java:76)
	at org.apache.isis.core.integtestsupport.IsisSystemForTest$Builder$1.run(IsisSystemForTest.java:302)
{code}"
ISIS-1418,New Feature,Closed,Support @Nullable for parameters and properties,"And deprecate the clumsy @Property(optionality=... and @Parameter(optionalty=...)

Also, needs a MetaModelValidator (see MandatoryFromJdoColumnAnnotationFacetFactory
- compare @Column against @Property(optionality=...)
- compare @Column against @Nullable
- compare @Nullable against @Property(optionality=...)


also, add a similar (new) validator for parameters:
- compare @Nullable against @Parameter(optionality=...)
 "
ISIS-1417,Improvement,Closed,"For faster start-ups, allow any deprecated facets to simply be ignored.","... using a configuration setting, ""isis.reflector.facets.ignoreDeprecated""

The default should be false, in other words that deprecated facets continue to be honoured."
ISIS-1416,Improvement,Closed,"To reduce application bootstrap times, allow set...() and inject...() style of dependency injection to be diabled.","Configuration properties to control:

isis.services.injector.setPrefix   (default is enabled)
isis.services.injector.injectPrefix   (default is DISABLED)"
ISIS-1415,Improvement,Closed,"Reduce app startup times by lazily initializing the ApplicationFeatureRepository, ","In case this change in behaviour causes unexpected regressions, allow the old behaviour to be re-enabled using a configuration property (""isis.services.applicationFeatures.init"")"
ISIS-1414,Bug,Closed,nextTransaction can cause null pointers with the new MetricsService. ,"The reason is that request-scoped services are implemented as transaction services.  Most of the time the scope of a request and the scope of a transacion are one and the same: there is just one transaction per scope.  However, TransactionService#nextTransaction admits for there being multiple transactions per request.

This bug is that the current implementation for RequestScoped does the init/close as part of the Transaction management.  Instead, this should be part of the PersistenceSession#open/close (a PersistenceSession wraps a JDO session, so basically corresponds to the request).
"
ISIS-1413,New Feature,Closed,"Gradle script (and docs) in simpleapp archetype to auto-enhance and for dynamic layouts, also liveReload",liveReload involves a new config property for the wicket viewer
ISIS-1412,Bug,Closed,Actions annotated with SemanticsOf.IDEMPOTENT_ARE_YOU_SURE throw a NullPointerException when invoked through the REST API,"I have an action {{delete()}} annotated with {{@Action(semantics = SemanticsOf.IDEMPOTENT_ARE_YOU_SURE)}}.

This is the resulting stack trace after invoking the action through the REST API:

{code}
{
  ""className"" : ""java.lang.NullPointerException"",
  ""message"" : ""java.lang.NullPointerException"",
  ""stackTrace"" : [ ""org.apache.isis.viewer.restfulobjects.rendering.domainobjects.AbstractObjectMemberReprRenderer.addLinkFor(AbstractObjectMemberReprRenderer.java:219)"", ""org.apache.isis.viewer.restfulobjects.rendering.domainobjects.ObjectActionReprRenderer.addMutatorLinksIfEnabled(ObjectActionReprRenderer.java:97)"", ""org.apache.isis.viewer.restfulobjects.rendering.domainobjects.AbstractObjectMemberReprRenderer.renderMemberContent(AbstractObjectMemberReprRenderer.java:186)"", ""org.apache.isis.viewer.restfulobjects.rendering.domainobjects.ObjectActionReprRenderer.render(ObjectActionReprRenderer.java:58)"", ""org.apache.isis.viewer.restfulobjects.rendering.Responses.ofOk(Responses.java:70)"", ""org.apache.isis.viewer.restfulobjects.rendering.Responses.ofOk(Responses.java:41)"", ""org.apache.isis.viewer.restfulobjects.rendering.service.conneg.ContentNegotiationServiceForRestfulObjectsV1_0.buildResponse(ContentNegotiationServiceForRestfulObjectsV1_0.java:193)"", ""org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationServiceContentNegotiator$4.apply(RepresentationServiceContentNegotiator.java:137)"", ""org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationServiceContentNegotiator$4.apply(RepresentationServiceContentNegotiator.java:134)"", ""org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationServiceContentNegotiator.buildResponse(RepresentationServiceContentNegotiator.java:195)"", ""org.apache.isis.viewer.restfulobjects.rendering.service.RepresentationServiceContentNegotiator.actionPrompt(RepresentationServiceContentNegotiator.java:134)"", ""org.apache.isis.viewer.restfulobjects.server.resources.DomainResourceHelper.actionPrompt(DomainResourceHelper.java:296)"", ""org.apache.isis.viewer.restfulobjects.server.resources.DomainObjectResourceServerside.actionPrompt(DomainObjectResourceServerside.java:417)"", ""sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)"", ""sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)"", ""sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)"", ""java.lang.reflect.Method.invoke(Method.java:497)"", ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:139)"", ""org.jboss.resteasy.core.ResourceMethodInvoker.invokeOnTarget(ResourceMethodInvoker.java:295)"", ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:249)"", ""org.jboss.resteasy.core.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:236)"", ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:395)"", ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:202)"", ""org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:221)"", ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:56)"", ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:51)"", ""javax.servlet.http.HttpServlet.service(HttpServlet.java:668)"", ""org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:821)"", ""org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1685)"", ""org.apache.isis.viewer.restfulobjects.server.webapp.IsisTransactionFilterForRestfulObjects.doFilter(IsisTransactionFilterForRestfulObjects.java:46)"", ""org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)"", ""org.apache.isis.core.webapp.IsisSessionFilter.doFilter(IsisSessionFilter.java:341)"", ""org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)"", ""org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)"", ""org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)"", ""org.togglz.servlet.TogglzFilter.doFilter(TogglzFilter.java:100)"", ""org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)"", ""org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)"", ""org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)"", ""org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)"", ""org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)"", ""org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)"", ""org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)"", ""org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)"", ""org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)"", ""org.ebaysf.web.cors.CORSFilter.handleNonCORS(CORSFilter.java:438)"", ""org.ebaysf.web.cors.CORSFilter.doFilter(CORSFilter.java:173)"", ""org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)"", ""org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:581)"", ""org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)"", ""org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)"", ""org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)"", ""org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1158)"", ""org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:511)"", ""org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)"", ""org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1090)"", ""org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)"", ""org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:119)"", ""org.eclipse.jetty.server.Server.handle(Server.java:517)"", ""org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:308)"", ""org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:242)"", ""org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:261)"", ""org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)"", ""org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:75)"", ""org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceAndRun(ExecuteProduceConsume.java:213)"", ""org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:147)"", ""org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:654)"", ""org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:572)"", ""java.lang.Thread.run(Thread.java:745)"" ],
  ""causedBy"" : null
}
{code}

Without the ARE_YOU_SURE semantics, the action can be invoked as expected."
ISIS-1411,Improvement,Closed,Refactoring - simplify PersistenceSession.,
ISIS-1410,Improvement,Closed,Minor performance improvements/refactorings (no functional change),
ISIS-1409,Improvement,Closed,Simplify RuntimeContext (internal bootstrapping),
ISIS-1408,Improvement,Closed,Simplify InstallerLookup and IsisComponentProvider (internal bootstrapping),
ISIS-1407,Improvement,Closed,Refactor SpecificationLoader into an internal domain service.,
ISIS-1406,Improvement,Closed,Refactor IsisConfigurationDefault and the metamodel.ConfigurationService into an internal domain service,"Moving towards CDI-style injection, removing our home-grown stuff."
ISIS-1405,Bug,Closed,Refactor DeploymentCategoryProvider into an internal domain service.,
ISIS-1404,Improvement,Closed,Refactor AuthenticationSessionProvider as an internal domain service.,
ISIS-1403,Improvement,Closed,[WON'T FIX] Suggest  changed the web.xml to newer Servlet Deployment Descriptor - version 3.1 and added absolute-ordering element,"as raised in comment on ISIS-1358... 

Hi Jörg, I tried out your proposal but stil without success. After googling I've found next issue with similar problem https://issues.apache.org/jira/browse/AMQ-6154
Then I've changed the web.xml to newer Servlet Deployment Descriptor - version 3.1 and added absolute-ordering element. After that, I've redeployed war to Tomcat 8.0.33 and simpleapp works now fine!
@Dan Haywood: maybe this should be adapted in simpleapp archetype as well?
<web-app id=""WebApp_ID""  xmlns=""http://xmlns.jcp.org/xml/ns/javaee""
         xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""
         xsi:schemaLocation=""http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd""
         version=""3.1"">

    <absolute-ordering/>"
ISIS-1402,Bug,Closed,Remove the Debuggable interface.,Legacy code that is not used by any of the current viewers.
ISIS-1401,Bug,Closed,NPE when wrapping call to FixtureScripts#runFixtureScript for a newly instantiated FixtureScript ,"The FixtureScripts#runFixtureScript action is marked as ""Prototyping"", and basically there's no need to invoke it wrapped, but perhaps is relevant for other use cases.

When executing something like:
this.wrap(this.fixtureScripts).runFixtureScript(
		    new MyFixtureScript(), null);

A NullPointerException is thrown, as for the execution on DomainObjectInvokationHandler#handleActionMethod requires to create an adapter for the contributee (line 590):
[java]
contributeeAdapter = adapterFor(contributed);
[/java]

As the MyFixtureScript is a ViewModel, this will be delegated to FixtureScript#viewModelMemento() which in fact will contain:

[java]
    @Programmatic
    @Override
    public String viewModelMemento() {
        return fixtureScripts.mementoFor(this);
    }
[/java]

Being ""fixtureScripts"" null.

Not sure how to solve this, as basically the FixtureScript requires to be injected before executing it.
As perhaps this will be the only method that can potentially been invoked before the FixtureScript being wrapped on the ""FixtureScripts"" service, an easy solution would be to check if the ""fixtureScript"" variable is null and, in that case, inject its own instance on this same method.
"
ISIS-1400,Bug,Closed,bulk-only actions are shown on object forms,
ISIS-1399,New Feature,Closed,"MetricsService to capture within InteractionContext, for profiling.",
ISIS-1398,Improvement,Closed,Refactor PropertySetterFacet to follow the pattern for ActionInvocationFacet.,In particular with respect to setting up commands.
ISIS-1397,Improvement,Closed,Generalize ActionInvocationMemento to also capture property modifications.  Rename to MemberInteractionMemento.,
ISIS-1396,Bug,Closed,Some elements on an entity page can be rendered against stale data.,"In the contactapp (github.com/incodehq/contactapp), if edit a ContactGroup, then the Country title/icon are shown as null.  This seems to be because they are being rendered against a stale version of the ContactGroup, ie after the JDO transaction has completed.

Two different fixes.

The first would seem to be to move the stuff that builds the EntityPage component hierarchy out of the EntityPage constructor and into the EntityPage's onBeforeRender() method.

This works, but does solve the underlying issue.  Talking with martin-g, he says this ought not to be necessary and pointed to a possible issue with the EntityModel (impl of LoadableDetachableModel).

Further investigation shows that this is indeed where the issue is.  EntityModel holds a lazily-populated cache of ScalarModels, keyed by property(Id).  This is not cleared down on detach, meaning that a subsequent rendering of the property containing the reference to the country is using a stale ObjectAdapter (never detached) that refers to a pojo that was reset at the end of the preceding transaction.

"
ISIS-1395,Improvement,Closed,"[WON'T FIX] Bulk actions button is shown for a collection, even if not in table view (eg showing collection as a map)",Perhaps the collection components should have an API as to whether they support the concept of selectable (ie checkboxes or equivalent mechanism).  Only show bulk action button for those that do.
ISIS-1394,Improvement,Closed,Suppress fieldset banner (name) if only one fieldset in tab (to reduce page real estate usage).,"If there is only 1 fieldset in tab, and the name of the tab == name of the fieldset (or, perhaps, if either is missing/empty string), and also if there are no actions associated with the fieldset (ie on the panel), then suppress the fieldset banner"
ISIS-1393,Bug,Closed,Maven swagger goal failed: No Session opened for this thread,"In addition to ISIS-1315, there seems to be another problem not related to action contributions.

As described in http://markmail.org/message/n33avio7bu6ynsi2:

I have the same error with 1.12.1 (cf. stack trace below) while running
in my integration test module and using the real AppManifest as
suggested in ISIS-1295 [1] (although I had to comment out the security
module temporarily because it led to another error) .

I am trying to debug it and it seems like the session is already closed
by the time IsisContext.getPersistenceSession is called in below stack.

{code}
[ERROR] Failed to execute goal org.apache.isis.tool:isis-maven-plugin:1.12.1:swagger (default) on project message-service-integration: Execution default of goal org.apache.isis.tool:isis-maven-plugin:1.12.1:swagger failed: No Session opened for this thread -> [Help 1]
org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.apache.isis.tool:isis-maven-plugin:1.12.1:swagger (default) on project message-service-integration: Execution default of goal org.apache.isis.tool:isis-maven-plugin:1.12.1:swagger failed: No Session opened for this thread
	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:224)
	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:116)
	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:80)
	at org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder.build(SingleThreadedBuilder.java:51)
	at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:120)
	at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:347)
	at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:154)
	at org.apache.maven.cli.MavenCli.execute(MavenCli.java:582)
	at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:214)
	at org.apache.maven.cli.MavenCli.main(MavenCli.java:158)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:289)
	at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:229)
	at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:415)
	at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:356)
Caused by: org.apache.maven.plugin.PluginExecutionException: Execution default of goal org.apache.isis.tool:isis-maven-plugin:1.12.1:swagger failed: No Session opened for this thread
	at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:143)
	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:208)
	... 19 more
Caused by: java.lang.IllegalStateException: No Session opened for this thread
	at org.apache.isis.core.runtime.system.context.IsisContext.getSession(IsisContext.java:455)
	at org.apache.isis.core.runtime.system.context.IsisContext.getPersistenceSession(IsisContext.java:483)
	at org.apache.isis.core.runtime.persistence.internal.RuntimeContextFromSession.getPersistenceSession(RuntimeContextFromSession.java:268)
	at org.apache.isis.core.runtime.persistence.internal.RuntimeContextFromSession.access$000(RuntimeContextFromSession.java:61)
	at org.apache.isis.core.runtime.persistence.internal.RuntimeContextFromSession$2.adapterFor(RuntimeContextFromSession.java:102)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionContributee.getServiceAdapter(ObjectActionContributee.java:328)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionContributee.getParameters(ObjectActionContributee.java:140)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionDefault.getParameterTypes(ObjectActionDefault.java:209)
	at org.apache.isis.core.metamodel.services.swagger.internal.ClassExcluder.exclude(ClassExcluder.java:44)
	at org.apache.isis.core.metamodel.services.swagger.internal.Util$2.accept(Util.java:145)
	at org.apache.isis.core.metamodel.services.swagger.internal.Util$2.accept(Util.java:142)
	at org.apache.isis.applib.filter.Filters$6.apply(Filters.java:101)
	at com.google.common.collect.Iterators$7.computeNext(Iterators.java:675)
	at com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:143)
	at com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:138)
	at com.google.common.collect.Iterators.addAll(Iterators.java:364)
	at com.google.common.collect.Lists.newArrayList(Lists.java:162)
	at com.google.common.collect.Collections2$FilteredCollection.toArray(Collections2.java:215)
	at java.util.ArrayList.addAll(ArrayList.java:577)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectSpecificationAbstract.getObjectActions(ObjectSpecificationAbstract.java:766)
	at org.apache.isis.core.metamodel.services.swagger.internal.Util.actionsOf(Util.java:142)
	at org.apache.isis.core.metamodel.services.swagger.internal.Generation.appendObjectPathsAndDefinitions(Generation.java:213)
	at org.apache.isis.core.metamodel.services.swagger.internal.Generation.generate(Generation.java:124)
	at org.apache.isis.core.metamodel.services.swagger.internal.SwaggerSpecGenerator.generate(SwaggerSpecGenerator.java:44)
	at org.apache.isis.core.metamodel.services.swagger.SwaggerServiceDefault.generateSwaggerSpec(SwaggerServiceDefault.java:69)
	at org.apache.isis.tool.mavenplugin.IsisMojoSwagger.writeSwaggerSpec(IsisMojoSwagger.java:120)
	at org.apache.isis.tool.mavenplugin.IsisMojoSwagger.doExecute(IsisMojoSwagger.java:89)
	at org.apache.isis.tool.mavenplugin.IsisMojoAbstract.execute(IsisMojoAbstract.java:68)
	at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:132)
	... 20 more
[DEBUG] finalizing hash of pojos
[ERROR] 
[DEBUG] finalizing persistence session
{code}"
ISIS-1392,Improvement,Closed,Extend RepositoryService with persistAndFlush(...) and removeAndFlush(...) methods,"It will ease life for newcomers, as the “flush()” invokation is needed for DataNucleus to update “mappedBy” collections, for example, when a new element has been added.

For Queries, we’re currently invoking always flush(…) before executing it on the persistence layer, but that’s not the default behavior when setting a property, for example.

So when DN reloads entities collections would not be updated.

Let's see an example (notice the ""this.persistAndFlush(...)"" helper method invocation):

public abstract class Warehouse extends SalesVIPEntity<Marketplace> {

    // {{ ExcludedProducts (Collection)
    @Persistent(mappedBy = ""marketplace"", dependentElement = ""true"")
    private SortedSet<MarketplaceExcludedProduct> excludedProducts = new TreeSet<MarketplaceExcludedProduct>();

    @MemberOrder(sequence = ""1"")
    public SortedSet<MarketplaceExcludedProduct> getExcludedProducts() {
	return this.excludedProducts;
    }

    public void setExcludedProducts(
	    final SortedSet<MarketplaceExcludedProduct> excludedProducts) {
	this.excludedProducts = excludedProducts;
    }

    // }}

    // {{ addExcludedProduct (action)
    @Action(semantics = SemanticsOf.IDEMPOTENT)
    @MemberOrder(sequence = ""1"")
    public MarketplaceExcludedProduct addExcludedProduct(final Product product) {
	MarketplaceExcludedProduct marketplaceExcludedProduct = this
		.findExcludedProduct(product);
	if (marketplaceExcludedProduct == null) {
	    marketplaceExcludedProduct = this.factoryService
		    .instantiate(MarketplaceExcludedProduct.class);
	}

	this.wrap(marketplaceExcludedProduct).setMarketplace(this);
	this.wrap(marketplaceExcludedProduct).setProduct(product);

	this.persistAndFlush(marketplaceExcludedProduct);  <—————————————

	return marketplaceExcludedProduct;
    }

    // }}

    // {{ deleteFromExcludedProducts (action)
    @Action(semantics = SemanticsOf.IDEMPOTENT)
    @MemberOrder(sequence = ""1"")
    public void deleteFromExcludedProducts(final Product product) {
	final MarketplaceExcludedProduct marketplaceExcludedProduct = this
		.findExcludedProduct(product);
	if (marketplaceExcludedProduct != null) {
	    this.repositoryService.remove(marketplaceExcludedProduct);
	    this.flushTransaction();
	}
    }

    // }}

    // {{ findExcludedProduct (action)
    @Action(semantics = SemanticsOf.SAFE)
    @MemberOrder(sequence = ""1"")
    public MarketplaceExcludedProduct findExcludedProduct(final Product product) {
	return this.repositoryService.firstMatch(QueryDefault.create(
		MarketplaceExcludedProduct.class,
		""findByMarketplaceAndProduct"", ""marketplace"", this, ""product"",
		product));
    }

    // }}

    // {{ findAllProductsExcluded (action)
    @Action(semantics = SemanticsOf.SAFE, hidden = Where.EVERYWHERE)
    public Set<Product> findAllProductsExcluded() {

	return this.getExcludedProducts().stream().map(mep -> mep.getProduct())
		.collect(Collectors.toSet());

    }

    // }}
 
}


On the “addExcludedProduct()” action, if the user don’t flush(), in addition to persist(), this test would fail, not containing the given product:

@Test
  	public void addExcludedProduct() {

  	    // given
  	    final AmazonMarketplace amazonMarketplace = this.wrapSkipRules(
  		    this.marketplaceRepository).findOrCreateAmazonMarketplace(
  			    AmazonMarketplaceLocation.FRANCE);
  	    
	    final Product product = this.wrap(this.productRepository)
		    .createProduct(UUID.randomUUID().toString(),
			    UUID.randomUUID().toString());
  	    
  	    // when
  	    this.wrap(amazonMarketplace).addExcludedProduct(product);

  	    // then
  	    Assertions.assertThat(this.wrapSkipRules(amazonMarketplace).findAllProductsExcluded()).contains(product);

  	}
"
ISIS-1391,Improvement,Closed,"Combine MessageBrokerInternalService with MessageService, and...",... thereby change internal usage of MessageBroker to instead use the MessageService.
ISIS-1390,New Feature,Closed,"Provide a default CommandService, to return CommandDefault.",This will simplify implementation wherever the CommandService is looked up.  Currently we require null guards.
ISIS-1389,New Feature,Closed,New InteractionContext service and Interaction to handle the execution of commands.,"Refactoring of Command... this new request-scoped service takes over the responsibilities (out of Command) for the actuall execution of a command (ie action invocation or property modification), to whit:
- start/stop
- result/exception
- graph of nested AbstractDomainEvents

Also, hold the set of dirtied objects.

The final plan here is for this object to aggregate all the state necessary to publish events, ie via PublisherService.

The graph of abstract domain events is intended to support profiling use cases (perhaps optionally enabled)."
ISIS-1388,New Feature,Closed,Introduce @PropertyLayout(columnOrder=...) to make order of properties (when shown in tables) more predictable.  ,"At the moment it can be hard to predict, because the BS3Grid is traversed by type, eg:

{code}

    private void traverseCols(final Grid.Visitor visitor, final BS3Row bs3Row) {
        final BS3Grid.Visitor bs3Visitor = asBs3Visitor(visitor);
        final List<BS3RowContent> cols = bs3Row.getCols();
        for (BS3RowContent rowContent : Lists.newArrayList(cols)) {
            rowContent.setOwner(bs3Row);
            if(rowContent instanceof BS3Col) {
                final BS3Col bs3Col = (BS3Col) rowContent;
                bs3Visitor.preVisit(bs3Col);
                bs3Visitor.visit(bs3Col);
                traverseDomainObject(bs3Col, visitor);
                traverseTabGroups(bs3Col, visitor);
                traverseActions(bs3Col, visitor);
                traverseFieldSets(bs3Col, visitor);
                traverseCollections(bs3Col, visitor);
                traverseRows(bs3Col, visitor);
                bs3Visitor.postVisit(bs3Col);
            } else if (rowContent instanceof BS3ClearFix) {
                final BS3ClearFix bs3ClearFix = (BS3ClearFix) rowContent;
                bs3Visitor.visit(bs3ClearFix);
            } else {
                throw new IllegalStateException(
                        ""Unrecognized implementation of BS3RowContent, "" + rowContent);
            }
        }
    }
{code}

Instead, if it were traversed by element order, then the ordering of properties would be more predictable."
ISIS-1387,Improvement,Closed,Ensure that generated bs3 layout XML files include a suitable namespace prefix.,"ie ""bs3:"" and ""cpt:"", rather than ""ns1:"", ""ns2:"" etc"
ISIS-1386,Improvement,Closed,"Ensure that generated aim, cmd or common memento XML include a suitable namespace prefix.","Rather than ""ns1:"", ""ns2"" etc."
ISIS-1385,New Feature,Closed,"Improve DomainChangeJdoAbstract (superclass of commands, audits etc) so cannot ""open"" target object if a domain service.",Depends upon ISIS-1385
ISIS-1384,New Feature,Closed,"Extend MetaModelService to indicate what ""sort of"" object a given domain type represents.","For example, entity, view model, service etc.

"
ISIS-1383,Bug,Closed,Missing component factory class names in Wicket HTML,"After upgrading from Apache Isis 1.11.1 to 1.12.1 (skipping 1.12.0) I am missing the class names of the component factories in the html of the Wicket viewer. This information is quite useful for extending or creating new Wicket
components."
ISIS-1382,Bug,Closed,Cancel buttons disappeared on modal dialogs,After upgrading from Apache Isis 1.11.1 to 1.12.1 the cancel buttons don't show up on modal dialogs any more.
ISIS-1381,New Feature,Closed,Extend ActionInvocationMementoDto (XSD) to apply to bulk actions (a list of targets and perhaps list of mixins).,
ISIS-1380,New Feature,Closed,"ActionInvocationMementoDTO to capture stacktrace, if any, when an action is invoked.",
ISIS-1379,New Feature,Closed,ActionInvocationMementoDto (XSD) should hold subactions.,"This would be useful for profiling, but should be switched off by default."
ISIS-1378,New Feature,Closed,ActionInvocationMementoDTO (XSD) returned object also indicates its type (same as parameters),
ISIS-1377,New Feature,Closed,"ActionInvocationMementoDto (XSD) with majorVersion and minorVersion, so that each instance identifies the ""logical"" version of the schema with which it is compatible.",(We adopted this approach for Estatio canonical DTOs).
ISIS-1376,New Feature,Closed,ActionInvocationMementoDto (XSD) to capture end time of each action invocation.,useful for profiling
ISIS-1375,New Feature,Closed,extend BackgroundCommandService to be able to invoke mixed-in actions.,
ISIS-1374,New Feature,Closed,extend BackgroundCommandService to be able to invoke mixed-in actions.,
ISIS-1373,New Feature,Closed,Have isis-core-applib depend upon isis-core-schema,"... rather than the other way around, as currently.

Move any functionality currently in core-schema that depends on applib, into applib.  (Don't change any packages, to avoid breakages).
"
ISIS-1372,New Feature,Closed,Change BackgroundCommandService to work with new Command DTO,The new Command DTO (ISIS-1371) will require changes to BackgroundCommandService implementations.
ISIS-1371,Improvement,Closed,ActionInvocationMementoDto (XSD) to capture the mixed-in object (if any).,cf ISIS-1343 for ActionDomainEvent
ISIS-1370,New Feature,Closed,New PublisherService to simplify and replace PublishingService.,"Most PublishingService implementations (to date) only require the metadata (action invocation or domain object identity) to publish their events; the notion of the payload (to eagerly assemble information for the downstream subscribers) seems less useful.

This ticket is therefore to deprecate the PublishingService#publish(EventMetadata, EventPayload), and replace with PublishingService2#publish(EventMetadata).

This also means that @DomainObject#publishingPayloadFactory() and @Action#publishingPayloadFactory() attributes are deprecated.

~~~
In its place, will have a new PublisherService with a simplified API.

"
ISIS-1369,Improvement,Closed,Add missing tests for AppFeature,"The implementation was copied over from the (non-ASF) isis-module-security in ISIS-1292, but the corresponding tests were not."
ISIS-1368,New Feature,Closed,The (new) PublisherService API should provide the ability to republish (action) commands.,"See ISIS-1370 relating to the creation of a new PublisherService.  (There are two many changes from PublishingService to sensibly have this as a refinement).

Specifically, the new PublisherService SPI should define:

{code}
    /**
     * To support implementations that allow the republishing of commands, eg onto an JMS message bus.
     */
    @Programmatic
    void republish(final ActionInvocationMementoDto aim);
{code}
"
ISIS-1367,Improvement,Closed,Extend MetaModelService to expose the nature of a domain service.  Have DomainObjectContainer#isViewModel(...) delegate to it.,"{code}
public interface MetaModelService

   @Programmatic
    public Nature natureOf(Class<?> cls);

   /**
    * convenience; just calls {@link #natureOf(Class)} for the class of the provided object.
    */
   @Programmatic
    public Nature natureOf(Object obj);

    ...
}
{code}"
ISIS-1366,Improvement,Closed,Add svg image suffix support (PR #38),
ISIS-1365,Improvement,Closed,DomainObjectContainerDefault should delegate to RepositoryService (and others) where possible.,See also ISIS-1367 to extend MetaModelService so that DomainObjectContainer#isViewModel(...) can delegate to it.
ISIS-1364,Improvement,Closed,Improve Asciidoc and Javadoc for migrating from DomainObjectContainer#persist() to RepositoryService#persist(),"DomainObjectContainer#persist() has been deprecated and RepositoryService#persist() might be used instead.

But current RepositoryService#persist() implementation does not throw an exception if the Domain Object is already persistent, so its behavior is different from the current DomainObjectContainer#persist() one.
In fact, is identical to DomainObjectContainer#persistIfNotAlready(), which has also been moved to RepositoryService#persistIfNotAlready()

Improve Asciidoc migration notes and documentation, and also Javadoc on DomainObjectContainer.

"
ISIS-1363,Bug,Closed,"ConfigurationServiceMenu is defined under the prototyping menu, but is not restricted to prototyping.  Suggest place under the tertiary menu instead.",
ISIS-1362,Task,Closed,1.12.1 release activities,
ISIS-1361,Improvement,Closed,View model that changes two domain objects only has one of them updated.,"The relevant code being:
{code}
    @Action
    public Compare2 swap() {
        final Colour leftFavoriteColour = getLeftFavoriteColour();
        final Boolean leftFlag = getLeftFlag();

        final Colour rightFavoriteColour = getRightFavoriteColour();
        final Boolean rightFlag = getRightFlag();

        final SimpleObject left = getLeft();
        final SimpleObject right = getRight();

        left.setFavoriteColour(rightFavoriteColour);
        left.setFlag(rightFlag);

        right.setFavoriteColour(leftFavoriteColour);
        right.setFlag(leftFlag);

        transactionService.flushTransaction();

        return this;
    }
{code}

I'm seeing that the first object modified (""left"") is updated, but the second is not.

Tracing through the Isis and JDO code, it seems that the left object is dirtied, and then this is flushed when the right object is subsequently modified, because - by default - JDO will flush a first object once a second object starts to be modified; see http://www.datanucleus.org/products/datanucleus/jdo/transactions.html and ""datanucleus.datastoreTransactionFlushLimit"" property; to whit: ""represents the number of dirty objects before a flush is performed. This defaults to 1""

So the action finishes with the ""right"" object still dirtied, so far as JDO is concerned, but not yet flushed.

The reason that JDO doesn't flush is that  the new auto-clone functionality for JAXB view models means that we end up creating a new view model, and this new view model causes the PersistentEntityAdapter.class that in turn calls BookmarkService#lookup, which in turn calls Isis' PersistenceSession and finally JDO's PersistenceManager#refresh(...).  This ends up trampling over the state of the ""right"" domain object.

The fix is to extend BookmarkService's API to provide an option as to whether to overwrite or to merely lookup an object.  To avoid breakage with existing applications that might rely on the current behaviour, the default will be to overwrite."
ISIS-1360,Question,Closed,Declarative Invariants,"I think that one aspect of the amplification concept Apache ISIS provides might be to allow some degree of declarative business rules / invariants. There is an interesting open source project (1) that allows a Java application to define declarative business rules / invariant you might want to fork.
 
The difference between some other business rules engines (say RETE compliant) is that most business rules engines focus on conditional business rules or decision business rules only, and work outside the application scope, as an external API returning results that you must incorporate into your code with even more code. This one´s focus (ABL) is transactional business rules, which work through the persistence manager (Hibernate´s JPA in this case), so you don´t need to call any rules to be triggered, rules are automatically triggered when you persist data. Thus, it lets you use the previous values before saving and after saving to trigger rules (update inventory with new value of received quantity - old value of received quantity + old value of inventory).
 
In summary, it provides:
•        Declarative rules, like: 
o   InvoiceItem.amount = InvoiceItem.quantity * InvoiceItem.unitPrice * (1 + VAT / 100)
o   Invoice.amount = sum(InvoiceItem.amount) if InvoiceItem.status != “deleted”
o   account balance = sum(invoice.amount) if status = “due
•        Automatic sequencing of the rules. This is really great, because instead of sequenced lines of code, you create independent rules, which you can maintain and change completely separate from all other rules. You can even have a rules manager and document each rule.
•        Automatic execution of the rules every time you do an insert, update or delete to any of those entity objects. Any change executes the rules properly. If a new rule implies altering the sequence of the execution of rules, this happens automatically and seamlessly. 
•        Extensibility (create your own rules). Create a new weightedAverage () rule. 
•        Documentation. You can document your rules, associate rules to topic or groups, like use cases where they come from.
 
 
(1)    http://www.automatedbusinesslogic.com/
"
ISIS-1359,Improvement,Closed,Action annotated as autoCompleteAction cannot be annotated with @Programmatic. This should be possible.,"For instance:
{code}
@DomainObject(
autoCompleteRepository = Currencies.class, autoCompleteAction = ""autoComplete"")
public class Currency ....
{code}

Then in Currencies class:
{code}
@Programmatic
 public List<Currency> autoComplete(...) ..
{code}
causes a NPE"
ISIS-1358,Bug,Closed,Simpleapp created from archetype and packaged to war fails when deploying to Tomcat,"Steps to reproduce:
* Created simpleapp from archetype (Version 1.12.0)
* Execute mvn clean package
* Take the file \webapp\target\simpleapp.war and deploy to tomcat thru e.g. manager UI (http://localhost:8080/manager/html) 


Attached the catalina.log
"
ISIS-1357,Improvement,Closed,Update dependency from guava-19.0.20150826 to guava-19.0,"My artifactory cannot find this specific guava version, the dependency update to latest guava release would help"
ISIS-1356,Improvement,Closed,Install a BulkFacet even if @Action( invokeOn=OBJECTS_ONLY),"This then allows the ActionInvocationContext domain service to be used more broadly, eg in a custom implementation of RoutingService."
ISIS-1355,Bug,Closed,concurrency exception after property edit when attempting to render...,"eg add following additional property to the simpleapp:

{code}
    @Column(allowsNull = ""false"")
    @Property(
    )
    private boolean flag;
    public boolean isFlag() {
        return flag;
    }
    public void setFlag(final boolean flag) {
        this.flag = flag;
    }
{code}

"
ISIS-1354,Improvement,Closed,Wicket viewer should have a pluggable SPI service instead of AccountConfirmationMap,
ISIS-1353,Dependency upgrade,Closed,Upgrade minor dependencies.,"as per http://isis.apache.org/guides/cgcom.html#_update_dependency_versions

{code}
mvn versions:display-dependency-updates > /tmp/foo
grep ""\->"" /tmp/foo | /bin/sort -u
{code}

returns

{code}
[INFO]                                                   1.7.1 -> 1.7.2-alpha-1
[INFO]                                             3.0.14.Final -> 3.0.16.Final
[INFO]                                       9.3.6.v20151106 -> 9.3.8.v20160314
[INFO]                                   1.0.0.Final -> 1.0.1.Alpha1-jbosswscxf
[INFO]   com.fasterxml.jackson.core:jackson-annotations ........ 2.6.4 -> 2.7.3
[INFO]   com.fasterxml.jackson.core:jackson-core ............... 2.6.4 -> 2.7.3
[INFO]   com.fasterxml.jackson.core:jackson-databind ........... 2.6.4 -> 2.7.3
[INFO]   com.google.code.gson:gson ............................... 2.5 -> 2.6.2
[INFO]   com.sun.mail:javax.mail ............................... 1.5.2 -> 1.5.5
[INFO]   com.thoughtworks.xstream:xstream ...................... 1.4.8 -> 1.4.9
[INFO]   commons-httpclient:commons-httpclient .......... 3.1 -> 3.1-jbossorg-1
[INFO]   commons-logging:commons-logging ........... 1.2 -> 99.0-does-not-exist
[INFO]   de.agilecoders.wicket.webjars:wicket-webjars .......... 0.4.8 -> 0.5.3
[INFO]   de.agilecoders.wicket:wicket-bootstrap-core ......... 0.9.15 -> 0.10.6
[INFO]   de.agilecoders.wicket:wicket-bootstrap-extensions ... 0.9.15 -> 0.10.6
[INFO]   de.agilecoders.wicket:wicket-bootstrap-themes ....... 0.9.15 -> 0.10.6
[INFO]   dom4j:dom4j ................................. 1.6.1 -> 20040902.021138
[INFO]   io.swagger:swagger-core ............................... 1.5.5 -> 1.5.8
[INFO]   joda-time:joda-time ................................... 2.9.1 -> 2.9.3
[INFO]   net.ftlines.wicket-source:wicket-source ............. 6.0.0.8 -> 7.0.0
[INFO]   org.apache.maven.plugin-tools:maven-plugin-annotations .... 3.2 -> 3.4
[INFO]   org.apache.maven:maven-artifact ....................... 3.0.5 -> 3.3.9
[INFO]   org.apache.maven:maven-compat ......................... 3.0.5 -> 3.3.9
[INFO]   org.apache.maven:maven-core ........................... 3.0.5 -> 3.3.9
[INFO]   org.apache.maven:maven-model .......................... 3.0.5 -> 3.3.9
[INFO]   org.apache.maven:maven-model-builder .................. 3.0.5 -> 3.3.9
[INFO]   org.apache.maven:maven-plugin-api ..................... 3.0.5 -> 3.3.9
[INFO]   org.apache.maven:maven-settings ....................... 3.0.5 -> 3.3.9
[INFO]   org.apache.shiro:shiro-core ........................... 1.2.3 -> 1.2.4
[INFO]   org.apache.shiro:shiro-web ............................ 1.2.3 -> 1.2.4
[INFO]   org.apache.wicket:wicket ............................. 6.20.0 -> 7.2.0
[INFO]   org.apache.wicket:wicket-auth-roles .................. 6.20.0 -> 7.2.0
[INFO]   org.apache.wicket:wicket-core ........................ 6.20.0 -> 7.2.0
[INFO]   org.apache.wicket:wicket-datetime .................... 6.20.0 -> 7.2.0
[INFO]   org.apache.wicket:wicket-extensions .................. 6.20.0 -> 7.2.0
[INFO]   org.apache.wicket:wicket-guice ....................... 6.20.0 -> 7.2.0
[INFO]   org.apache.wicket:wicket-request ..................... 6.20.0 -> 7.2.0
[INFO]   org.apache.wicket:wicket-util ........................ 6.20.0 -> 7.2.0
[INFO]   org.axonframework:axon-core ............................. 2.4 -> 2.4.4
[INFO]   org.codehaus.plexus:plexus-container-default ............ 1.5.5 -> 1.6
[INFO]   org.codehaus.plexus:plexus-utils ....................... 2.1 -> 3.0.22
[INFO]   org.datanucleus:datanucleus-api-jdo ................ 4.1.1 -> 5.0.0-m2
[INFO]   org.datanucleus:datanucleus-core ................... 4.1.7 -> 5.0.0-m2
[INFO]   org.datanucleus:datanucleus-jdo-query .............. 4.0.5 -> 5.0.0-m2
[INFO]   org.datanucleus:datanucleus-jodatime ....... 4.1.0-release -> 5.0.0-m1
[INFO]   org.datanucleus:datanucleus-rdbms .................. 4.1.9 -> 5.0.0-m2
[INFO]   org.easymock:easymock ................................... 2.5.2 -> 3.4
[INFO]   org.hsqldb:hsqldb ..................................... 2.3.1 -> 2.3.3
[INFO]   org.jboss.resteasy:resteasy-jaxrs ....... 3.0.14.Final -> 3.0.16.Final
[INFO]   org.jmock:jmock ....................................... 2.6.0 -> 2.8.2
[INFO]   org.jmock:jmock-junit4 ................................ 2.6.0 -> 2.8.2
[INFO]   org.slf4j:jcl-over-slf4j ............................ 1.7.13 -> 1.7.20
[INFO]   org.slf4j:slf4j-api ................................. 1.7.13 -> 1.7.20
[INFO]   org.slf4j:slf4j-log4j12 ............................. 1.7.13 -> 1.7.20
[INFO]   org.sonatype.plexus:plexus-sec-dispatcher ................. 1.3 -> 1.4
[INFO]   org.webjars:select2 ................................. 3.5.2 -> 4.0.0-2
[INFO]   org.webjars:swagger-ui ............................. 2.1.3 -> 2.1.8-M1
[INFO]   org.webjars:webjars-servlet-2.x ........................... 1.4 -> 1.5
[INFO]   org.wicketstuff:wicketstuff-select2 .................. 6.20.0 -> 7.2.0
{code}"
ISIS-1352,Improvement,Closed,collapse IsisSystemFactoryThatUsesInstallers up to IsisSystemFactory,"There is only a single implementation of this interface.

Might also make sense to remove IsisInjectModule and google guice, the current design is probably over-engineered and the stack traces are difficult to diagnose."
ISIS-1351,Improvement,Closed,Extend ConfigurationService to list all configuration properties in a view model.,Any password properties should be automatically masked.
ISIS-1350,Improvement,Closed,Refactor/simplify ExceptionRecognitionService to follow chain-of-responsibility pattern.,To exploit the fact that we can inject List<ExceptionRecognizerService>
ISIS-1349,Bug,Closed,"ExceptionRecognizers not supported in RO, eg if create duplicate row then get a 500",
ISIS-1348,Bug,Closed,Bug with SoapEndpointPublishingRule when multiple endpoints.,
ISIS-1347,Bug,Closed,Missing annotation in SimpleObject,
ISIS-1346,Bug,Closed,ActionInvocationContext isn't populated properly,In ObjectActionContributee
ISIS-1345,Improvement,Closed,[WON'T FIX] Remove the PersistenceSession#executeWithTransaction(...),"In similar vein to previous ticket, pretty sure these aren't needed.

 

 "
ISIS-1344,Improvement,Closed,Remove the *Transaction facets,Pretty sure they aren't needed.
ISIS-1343,Improvement,Closed,"Properly handle domain events from mixins, exposing the underlying ""mixedIn"" domain object.","Following on from ISIS-1340, this is to properly expose the mixin on the ActionDomainEvent, and to have it set correctly by the XxxMixin impl.

Think that this is also required for property and collection mixins, also."
ISIS-1342,Bug,Closed,The metamodel validation error page doesn't reliably render itself if there are errors.,
ISIS-1341,Bug,Closed,Restful Objects viewer should perform a flush transaction before generating representations.,"For example, SimpleObjects > create, the representation has the transient ids.

The workaround is to add:

{code}
transactionService.flushTransaction();
{code}

in the action itself."
ISIS-1340,Bug,Closed,Rebuild metamodel mixin action isn't working reliably,"The issue is the HideMixinsForHomePage, which has the code:

{code}
@Subscribe
    public void on(Object_rebuildMetamodel.ActionDomainEvent ev) {        final List<Object> arguments = ev.getArguments();
        if(arguments.get(0) instanceof HomePageViewModel) {
            ev.hide();
        }
}
{code}

This was written in the belief (mistaken) that the mixin is set as the 0th argument.  In fact, this is true for hide and disable, but is empty for validate.

The short term fix is to add a guard to only perform the veto on the ""HIDE"" phase.

The longer term fix involves reworking the way in which events from mixins surface the mixedIn event... it isn't really correct to make the mixin available as an argument; unlike contributed actions, it is a separate thing altogether (to whit: the argument to the mixin's constructor).

Since this has been broken for a while (since 1.10), propose patching for 1.12.0, and doing a proper fix in 1.13.0."
ISIS-1339,Improvement,Closed,Simplify/unify session and xactn management for Wicket viewer and RO viewer,"Move the responsibility for session management / xactn mgmt out into a filter, and remove corresponding functionality within Wicket viewer's RequestCycle.


~~~
in a little more detail:


move bootstrapping out of IsisWicketApplication and into IsisWebAppBootstrapper

- by filters (pick up from ServletRequest)
  - replace by binding IsisSessionFactory
  - final IsisSystem system = (IsisSystem) servletContext.getAttribute(WebAppConstants.ISIS_SYSTEM_KEY);

- from RO viewer (pick up from ServletRequest)

- from at least some of the Wicket viewer (top-level application stuff, WebRequestCycle etc,... pick up from ServletRequest)


~~~
also:
remove WebAppConstants.HTTP_SESSION_LOGGED_ON_PREVIOUSLY_USING_LOGON_FIXTURE_KEY and LogonFixture, since not currently supported and no-one has missed it.

"
ISIS-1338,Improvement,Closed,Extend ResourceServlet and simpleapp archetype for SVG image type.,
ISIS-1337,Improvement,Closed,[WON'T FIX] Facet factory to automatically create UI events based on JAXB @XmlRootElement.,"Currently it's necessary to have to annotate the JAXB view model with @DomainObjectLayout() (as a minimum).

This ticket is to replicate the current facet factory and have it work against the JAXB @XmlRootElement annotation instead."
ISIS-1336,Bug,Closed,config param typo... titleEvent should be titleUiEvent.,"docs say 

isis.reflector.facet.domainObjectLayoutAnnotation.titleUiEvent.postForDefault

but code says

isis.reflector.facet.domainObjectLayoutAnnotation.titleEvent.postForDefault


the code should be changed as per docs."
ISIS-1335,Task,Closed,Release activities for v1.13.0,Miscellaneous release activities for 1.12.0 release.
ISIS-1334,New Feature,Closed,[DUPLICATE] Create standalone JAR of an Isis app,"Being able to have a standalone jar (eg java -jar xxx.jar), which I can see would be useful for microservice type deployments.

using assembly plugin and our current org.apache.isis.WebServer does not quite work, since our bootstrapping code assumes that config files can be read as files rather than in the classpath."
ISIS-1333,Improvement,Closed,Remove self-host profile from the archetype,"The self-host feature isn't much used, and just constitutes an additional testing / increased chance of regression issues/regressions.

I've raised ISIS-1334 for the separate ticket of being able to have a standalone jar (eg java -jar xxx.jar), which I can see would be useful for microservice type deployments."
ISIS-1332,Improvement,Closed,"Factor out a HintStore service, so that this is pluggable.","Following on from ISIS-993 and related tickets, the Wicket viewer now caches quite a lot of info in the user's session (see EntityModel).  This might be a scalability issue for some apps running on Isis.

To counteract this, the idea is to pull out an overridable HintStore service that can use some other implementation, or implement an MRU/LRU cache, or simply ignore hints altogether"
ISIS-1331,Improvement,Closed,"If return a google guava collection from an autoComplete or choices, then throws exception due to unsupported classes.","For example, this seemingly innocuous code:

{code}
    public List<SimpleObject> autoComplete(@MinLength(2) String search) {
        return
                    FluentIterable.from(listAll())
                    .filter(new Predicate<SimpleObject>() {
                        @Override public boolean apply(@Nullable final SimpleObject object) {
                            return object.getName().contains(search);
                        }
                    })
                    .toList();
    }
{code}

will fail.  to make it work, the developer needs to copy to an ArrayList, eg:

{code}
    public List<SimpleObject> autoComplete(@MinLength(2) String search) {
        return
                Lists.newArrayList(
                    FluentIterable.from(listAll())
                    .filter(new Predicate<SimpleObject>() {
                        @Override public boolean apply(@Nullable final SimpleObject object) {
                            return object.getName().contains(search);
                        }
                    })
                    .toList()
                );
    }
{code}

One possible solution is for the framework to do this automatically, for List, Set, Collection."
ISIS-1330,Improvement,Closed,Add CSS classes for table cells and for collections to make it easier to fine tune pages using CSS.,"Specifically:

* on entity page, include the entity fully qualified class name in an outer div (in CSS safe form), to allow the entire page to be scoped (currently does the simple name only)

* (already there) for parented collections, include the collection name in an outer div, to allow the table to be targetted

* similarly, for standalone collections, include the fully qualified action Id (in CSS-safe form) so can be targetted.

* for th and td in tables, add the property name.  This then allows this column to be targeted, eg to set the width or to hide using display:none;

* for both parented and standalone collections, include the class name of the entities being rendered in the table (in CSS safe form).  This then allows all occurrences of that rendered type to be adjusted, eg to colour their icon.


""CSS safe form"" means replace any '.' with '-'"
ISIS-1329,Improvement,Closed,"Extend hint support for ""show all""",
ISIS-1328,Bug,Closed,Bookmark hints are not being honoured,
ISIS-1327,Improvement,Closed,Change the view mode of the select2 (value drop down) to be a simple text field.,To avoid the unpleasant rendering we currently have.
ISIS-1326,New Feature,Closed,"Add a link to a ""quotes"" page on the main website.",
ISIS-1325,New Feature,Closed,New SessionManagementService,"To facilitate large fixture scripts that load a lot of data, which would otherwise blow up the heap by trying to perform all their work in a single session."
ISIS-1324,Improvement,Closed,Allow multiple different views of same collection in a layout,
ISIS-1323,Improvement,Closed,"Deprecate @CollectionLayout#renderType, since is duplicated by ...","... by @CollectionLayout#defaultView (set to ""table"")."
ISIS-1322,Improvement,Closed,Mixins not exposing the mixedin object in events (for subscribers to veto).,
ISIS-1321,Improvement,Closed,Extend MetaModel service to allow CSV of metamodel to be downloaded.,"This functionality is currently part of the devutils isisaddons module, however that module will become mostly obsolete due to ISIS-993 (XML layouts); this ticket is to move the remaining functionality in that module back into the core framework also."
ISIS-1320,Improvement,Closed,Move ContentMappingService to applib (and simplify),"Currently this SPI service uses internal classes.  There is no real reason for this; it could be defined in the regular applib.

The only impact is to bring in a dependency on javax.ws.rs (JAX-RS 2.0 API), for the MediaType class."
ISIS-1319,Bug,Closed,Input dialog for action label for mandatory parameter not shown when the parameter is an view model,"We have an action method with two mandatory parameters, the first one is a viewmodel with autoCompleteXXX and second one an Enum.

Problem: the sign for mandatory parameter on label (*-suffix) is shown only on second label - see attached screenshot 

{code}
 public DslPortCompatibilityCheckResult dslPortCompatibilityCheck(
            @Parameter(optionality = Optionality.MANDATORY) @ParameterLayout(named = ""DSL Port"") DslPort dslPort,
            @Parameter(optionality = Optionality.MANDATORY) @ParameterLayout(named = ""Technology"") DslTechnology desiredTechnology) throws PlanningException {

{code}

Dialog behavior is OK."
ISIS-1318,Bug,Closed,contributed actions/mixins breaks publishing; also flush any pending actions to be published as the result of doing a wrapped action via the WrapperFactory,
ISIS-1317,New Feature,Closed,Allow single domain object class to be invalidated through a mixin.,"This feature is useful because the new layout support (ISIS-993) - because of the way it pushes derives facets from the grid layout - can sometimes leave ""stale"" metadata if the grid is changed.

For example, if an action is moved from a fieldset to some other area such as a column, then the action will appear more than once.  That is because the action in its original location causes facets to be derived on the corresponding ObjectAction, and these aren't removed.  Meanwhile, when the column to which the action layout is moved is rendered, it doesn't use facets, simply renders what's defined directly the grid.

In the grander scheme of things this sort of thing isn't that big a deal, but it would be nice to invalidate the Isis metamodel (ObjectSpecification) from within the UI to get to a ""clean slate""."
ISIS-1316,New Feature,Closed,"Using autocomplete more as proposal, and override it with the manually entered one","Sometimes it would be helpful to use autocomplete more as proposal for final value, so that we still can override the proposal and set the value which is not proposed thru autocomplete.

Given an e.g. String action paramter A with e.g. MinLength 3
When user types into field A the value 'bbbb'
And the autocomplete on parameter A could show two possible values e.g. bbbb1' and 'bbbb2'
And when user decides to use the value he typed 'bbbb' and not the proposed one
Then the action parameter A has value 'bbbb'
"
ISIS-1315,Bug,Closed,"Can't generate swagger specs, where actions are contributed.","as per http://isis.markmail.org/thread/gn3ijffsxhnslphn

The issue is that the metamodel cannot be properly created without a session."
ISIS-1314,Bug,Closed,Filename parameter label missing for DTO mixins,
ISIS-1313,New Feature,Closed,Enhancement to xsd goal of the isis-maven-plugin to ignore/include the Isis common schemas.,"Currently these are always generated, but generally would not be required."
ISIS-1312,Improvement,Closed,Improve JaxbServiceDefault#xsd(...) to correctly reference the Isis common schema imports.,"Currently the XSD includes an import such as:

<xs:import .. schemaLocation=""http://isis.apache.org/schema/common"">

whereas instead it should be:

<xs:import .. schemaLocation=""http://isis.apache.org/schema/common/common.xsd"">
"
ISIS-1311,Bug,Closed,Mixins for Persistable metadata causes exception when rendering.,"one (or both) of these causes issue (this in the github.com/incodehq/contactapp)

{code}
@Mixin
public class Persistable_id {

    private final Persistable persistable;

    public Persistable_id(Persistable persistable) {
        this.persistable = persistable;
    }

    @MemberOrder(name = ""Metadata"", sequence = ""1"")
    @Action(semantics = SemanticsOf.SAFE)
    @ActionLayout(contributed = Contributed.AS_ASSOCIATION)
    @PropertyLayout()
    public Object $$() {
        final Object objectId = JDOHelper.getObjectId(persistable);
        if(objectId instanceof DatastoreId) {
            final DatastoreId datastoreId = (DatastoreId) objectId;
            return datastoreId.getKeyAsObject();
        }
        return null;
    }

    public boolean hide$$() {
        return $$() == null;
    }


}
{code}


and/or

{code}
@Mixin .. 
public class Persistable_version {

    private final Persistable persistable;

    public Persistable_version(Persistable persistable) {
        this.persistable = persistable;
    }

    @MemberOrder(name = ""Metadata"", sequence = ""2"")
    @Action(semantics = SemanticsOf.SAFE)
    @ActionLayout(contributed = Contributed.AS_ASSOCIATION)
    @PropertyLayout()
    public Object $$() {
        return JDOHelper.getVersion(persistable);
    }
    public boolean hide$$() {
        return $$() == null;
    }

}
{code}

"
ISIS-1310,Bug,Closed,DomainObjectContainter#titleOf(..) does not resolve @Title annotated on private field,"DomainObjectContainter#titleOf(..) does not resolve @Title annotated on a private field.

As a workaround you can use the title() method to provide a title."
ISIS-1309,Bug,Closed,"Disabled no-arg ""are you sure"" actions still show the prompt to be shown..",
ISIS-1308,Bug,Closed,[DUPLICATE] Swagger UI does not load json if not running as ROOT.war webapp.,
ISIS-1307,Wish,Open,[Wish] Integrating User Help Documentation,"At the moment there is the @PropertyLayout#describedAs() attribute for providing help 'hints' to users. I am wondering if there could be added a more detailed help information being provide to a user pressing F1 key?

More specifically to design a mechanism for help documentation to be navigated to (into) from the Isis Wicket viewer interface in a context sensitive way.

Broadening this further still, maybe there is a good way to keep user documentation embedded within the Java domain object class files and to generate formatted user help documents in a similar way that Javadoc is generated? 

I've done a little research on this approach but cannot find an example of where this has been done, but to my mind it seems natural as a Naked Objects way to do it. 

"
ISIS-1306,Wish,Closed,[Wish] Enable graph visualisation in Wicket Viewer,"Would be nice to have possibility to visualize graphs with. e.g http://graphviz.org/ or maybe with http://visjs.org/


"
ISIS-1305,Bug,Closed,"For collections contributed from mixins, the name is empty (presumably null or """")","This seems to be a regression; in 1.10.0 it was working.

This is for the ""$$"" action for a mixin called XXX_yyy, where the name of the contributed collection is meant to be ""yyy"", eg:

{code}
@Mixin
public class SimpleObject_others extends AbstractSubscriber{

    private final SimpleObject simpleObject;

    public SimpleObject_others(final SimpleObject simpleObject) {
        this.simpleObject = simpleObject;
    }

    @Action(semantics = SemanticsOf.SAFE)
    @ActionLayout(contributed = Contributed.AS_ASSOCIATION)
    @CollectionLayout(defaultView = ""table"")
    public List<SimpleObject> $$() {
        return simpleObjects.listAll();
    }

    @Inject
    SimpleObjects simpleObjects;
}
{code}"
ISIS-1304,Bug,Closed,Table column with icon and title is not left aligned,See screenshot
ISIS-1303,Wish,Open,[Project Rename] Rename the project to better describe its values and purpose,"In the past there have been a couple of discussions regarding renaming the project, the reason generally cited being the potential embarrassment of sharing a name with the jihadist militant group [1] currently prominent in the headlines.  After due discussion on the mailing lists the prevailing view has been to retain our name: ""we were here first"".  

Until now I've concurred with that view also... after all, I originally came up with the name ""Isis"", originally based on the name of the Thames as it flows through Oxford [2] (many of the original authors of the framework live within Oxfordshire, UK).

Separately to that discussion, we have the issue of marketing.  Originally we marketed ourselves as a framework implementing the ""naked objects"" pattern [3]; the original name of the framework (prior to Apache) was of course the Naked Objects Framework.  However, this pattern is either not well-known or is misunderstood (only a low proportion of developers that encounter the idea immediately ""get it"").  The crudity of the original user interfaces didn't help.  And the name also, of course, can cause embarrassment in some cultures.

Then, when domain-driven design [4] came along as a movement, that seemed an obvious platform upon which to position the framework: we obviously share the core belief that the domain is the most important bit of the system.  However - and I still find this surprising - despite attempts otherwise we haven't really made too much of an impression in that community.  The fact that the DDD community got massively sidetracked for a while by the CQRS pattern is perhaps part of it.   I also often detect the view that DDD should imply not using a framework.  The irony of course is that in rejecting framework such developers actually have to write more infrastructure code vs business domain code.

Also, the fit is perhaps not all that good after all.  In the DDD community I don't see anyone talking about modules... one of the named patterns, and a major focus of our framework, but missing from DDD talks.  Instead they get side-tracked talking only about aggregate roots or bounded contexts; all well and good, but over-emphasised).

[Aside: Indeed, I raised the topic of modules with Eric Evans himself (in person), and he agreed there was little emphasis.  When I described our framework's use of domain events to hook modules together (along with vetoing behaviour we support) he admitted it was a new approach/pattern to him...]

Anyway, so DDD - which looked so promising - hasn't delivered.  They might come around to us one day, but it's probably time to define our own individual space.  Also, in the same way that everyone takes agile development for granted as the ""de facto"", we ought to simply take DDD for granted too... ""of course you will be doing DDD, but are you doing it well?""

What we need to better market the framework is some other pattern or concept or hook, and become known as the framework that best supports that idea.  There are several candidates:
- hexagonal architecture (also called ports and adapters, or the onion architecture, and related to the clean architecture)
- don't repeat yourself principle
- aspect oriented programming (naked objects pattern is really the recognition that UI presentation is a cross-cutting concern)
- the general concept of modularity
- DCI (data/context/interactions).
- ""clean"" ""pure"" ""essential"" pojo programming model
- agile, lean
- breaking down barriers between IT and business

Of these, I think that hexagonal architecture looks the best fit; it is well regarded as a concept among the ""cognoscenti"", but there are surprisingly no open source frameworks out there (at least in the Java space) that position themselves as being the natural choice.

Therefore, I think a name - and appropriate short tag line - based around this idea of hexagonal architecture should be considered.

Candidate names:
- hex  (might hit trademark issues)
- hexagon
- hexagn  (deliberately mis-spelled)
- hxg  (omitting vowels, but could stand for hexagonal, extensible, generic)
- hx (too short?)

some made up words
- hexag (partial word)
- hexadom (sounds like a dinosaur?)
- mhodex (an anagram of hex and mod)

A common usage of hexagons is in bee hives, so:
- honeycomb (the outer hexagon is the BC, the inner hexagons are modules)
- comb (abbreviating it)

picking up on the DRY principle, we have deserts (might have trademark issues):
- sahara
- kalahari
- gobi

Or, we could go a different way altogether.  Some random ideas:
- meld (mind-meld, joining together)
- sweetheart (because we love it)
- neuron (too bland?)
- razor (trademark issues?)
- razr (trademark issues?)

Any new name must pass the ASF naming procedures, documented in [5].  Of these, the most significant is not conflicting with any existing US trademarks.  However, it's also work checking out what google says for any potential name.  For example, if googling for ""Apache Hex"" (which I quite like), the first entry is for ""Apache Hex Nipple"".

In terms of tag lines, our current is ""Domain Driven Applications, Quickly"".  Instead of that, ideas we've been brainstorming off-line are:

- ""own your code""  (custom software is a profit centre, not a cost centre)
- ""be responsible, own your code""  (more imperative, assertive)
- ""stay dry"" or ""keep dry"" (alluding to the DRY principle)
- ""simple, but no simpler""
- ""don't be square"" (a great joke on hexagons)

We also had other some joke straplines; these are *not* to be taken seriously but I can't resist including them here:

- ""not for hipsters"" (we've noticed how we appeal to those developers who've been around the block; we include ourselves in that descriptoin)
- ""please shave"" (hipster joke)
- ""shave before use"" (hipster joke)
- ""come back when you're ready""
- ""one day you'll see
- ""monkey see, monkey do"" (my favorite expression)

OK, that's it.  Please comment on this ticket, and add your own ideas.  If you have name suggestions, also use [5] to check if they are likely to pass US trademarks.

Thx


[1] https://en.wikipedia.org/wiki/Islamic_State_of_Iraq_and_the_Levant
[2] https://en.wikipedia.org/wiki/The_Isis
[3] https://en.wikipedia.org/wiki/Naked_objects
[4] https://en.wikipedia.org/wiki/Domain-driven_design
[5] http://www.apache.org/foundation/marks/naming"
ISIS-1302,Sub-task,Closed,[WONT FIX] Use bundled JARs instead of plain ones,For possible strategies see Managing 'OSGi Transitive Dependencies' [http://web.ist.utl.pt/ist162500/?p=1].
ISIS-1301,Wish,Closed,[WONT FIX] Support OSGi Containers,"Currently the war artifact contains all jars the application depends on.

* Repackeging these unchanged jars over and over takes some time (in my case this is at par with compiling dom). 
* The footprint of the war when redeploying it over thin connections requires more bandwidth. 
* Supporting OSGi containers would have the addional benefit that only changed artifacts would have to exchanged in the running container. Production systems could benefit from the possibility of the OSGi lifecycle, ie. replacing artifacts without downtime.

This will involve multiple steps, eg.

* Using more bundled versions of dependencies (where available - Wicket, DataNucleus, Jetty already are bundled)
* Building a bundled war (wab)
* Making isis libs conform to OSGi's class loader requirements
* Bridging the OSGi ServiceRegistry to use its Servies as DomainServices
tbc ..."
ISIS-1300,Improvement,Closed,"Allow the enablement of the WicketSource plugin to be configurable, and disabled by default",Because it is slow and of limited utility.
ISIS-1299,Improvement,Closed,@ViewModel and @XmlRootElement view models should automatically support isCloneable.,"per http://isis.markmail.org/thread/qfexzpfknnue2rnr

QN: Is there another way to automagically implement clone for view models? We are currently using MementoService with
DomainObjectContainer#newViewModelInstance based on the not-yet-released isis-wicket-wizard module.


ANS: At the moment the RecreateableObjectFacet impl for @ViewModel and also @XmlRootElement (1.11.0) return false for isCloneable(), but my thinking is that these could probably transparently support cloning.
"
ISIS-1298,Improvement,Closed,Fix deprecated annotation use for ViewModel.Cloneable#clone,"see http://markmail.org/message/jj546ucy3t4tibiw

Change from @Hidden to @Programmatic."
ISIS-1297,New Feature,Resolved,Integrate with Keycloak,"As suggested on the Apache Isis mailing list.

http://markmail.org/message/6jwghlmyravuxfbx

There are several approaches ...

As described in our security guide [1] Apache Isis has a pluggable API for
both authentication and authorization, so at the lowest level one could
take implement either/both of these plugin points.
Apache Isis has two integrations, one for Shiro and one called ""bypass""
(which basically disables security).  So one could ignore Apache Isis'
Shiro integration and implement everything yourself.

However, it would probably make more sense to build
upon the Isis Add-ons security module [2], which builds upon the Shiro
integration by providing an implementation of a Shiro Realm.  This is
described in [3].  In fact, I would suggest that keycloak would be used as
a delegate realm within the Isis addons' security module.

In other words, the design that we could use is:

        Apache Isis -> Shiro -> Isis addons security realm -> Isis addons
delegate realm

This last realm would be implemented using Keycloak.

The documentation in the security module [4] and [5] might also help to
explain this.

Note that this design would use Keycloak for authentication (validate
credentials and lookup roles), with the security module taking
responsibility for authorization. 

[1] http://isis.apache.org/guides/ugsec.html
[2] https://github.com/isisaddons/isis-module-security
[3]
http://isis.apache.org/guides/ugsec.html#_ugsec_shiro-isisaddons-security-module-realm
[4] https://github.com/isisaddons/isis-module-security#application-users
[5]
https://github.com/isisaddons/isis-module-security#shiro-configuration-shiroini
"
ISIS-1296,Bug,Closed,Release 1.11.1,"1.11.0 was released using Java 8 JDK method calls

the archetype also missed eclipse .launch files and there is an error in the class names of the JDOQL strings in SimpleObject."
ISIS-1295,Improvement,Closed,"Run integration tests using thread-local, to allow ""complete"" tests that also exercise, eg Quartz jobs.",see http://isis.markmail.org/thread/7mxfrssnx5gs2av7
ISIS-1294,New Feature,Closed,[WON'T FIX] Support Spring.Data like repositories with automatic implemenation of methods such as findByName or findByStartDateAndStatus,
ISIS-1293,New Feature,Closed,"[DUPLICATE] when in prototype mode, have a mechanism to temporarily hide the prototyping menus ... eg for taking screenshots",eg could live on the about page.
ISIS-1292,New Feature,Closed,"Extend MetaModel service to surface packages, classes etc (as used by the security module).",
ISIS-1291,New Feature,Closed,Define new DTO (XSD) as the memento for Command#setMemento,"A command is NOT an action invocation, it is an INTENTION to invoke an action.  Generally that intention is carried out immediately, hence a foreground command.  Sometimes though it is carried out in the background, so is a deferred intention.

What this implies is that a command should not contain details of the action's results.  (If that information is available from reified ActionDomainEvents, then they can be contributed/mixed in)

A command should cope with the concept of being invoked on more than one object, ie having a list of targets.  nb: this implies that our current terminology of ""bulk actions"" is actually wrong, we ought to be talking about ""bulk commands"".

We can envisage (at least) two different user intentions when performing a bulk command:
a) perform the operation on as many as possible, or
b) perform the operation on all of them, or none at all.

The former suggests that each action is wrapped in its own command: the user intends to operate on each object, one after the other.  The latter suggests that all the actions live in a single command.

Dan's view is that a command is one:one with a (DB) transaction.

~~~

the original version of this ticket was to change the Command#setMemento to use the ActionInvocationMementoDto.  However, that now seems to be incorrect:
- an AimDto is a record of an action being invoked (past tense, if you will), not the intention to invoke an action
  - as such an AimDto holds a return value, but that is strictly irrelevant to a Command
- an AimDto relates only to a single target, whereas a Command could have multiple targets (""perform this action on all of em, or none of em"")

So, instead, this ticket is to define a new XSD just as the reified form of Commands.  It needs to be able to handle mxins, and bulk actions.  It *shouldn't* have action results.

~~~
Note that this will also require some data migration scripts for anyone that has used this feature.

"
ISIS-1290,New Feature,Closed,[WON'T FIX] Docker image to support skinny war deployments (dev environment),"[https://builds.apache.org/view/I/view/Isis/job/Isis%20v2%20milestones%20and%20RCs%20+%20docker/]

still need to test properly; missing h2.jar file when attempt to deploy helloworld.

~~~~~~~~~~

 "
ISIS-1289,Improvement,Closed,"[WON'T FIX] for JAXB view models, implement member ordering from the @XmlType#propOrder attribute and other semantics.",also to support other constraints (e.g min or max length of xs:string types).
ISIS-1288,Dependency upgrade,Closed,Update (minor) dependencies,
ISIS-1287,Task,Closed,Release activities for v1.12.0,Miscellaneous release activities for 1.12.0 release.
ISIS-1286,Improvement,Closed,"Extend the RoutingService to provide more information, eg a context","so is passed a Context object, containing:
- the object that was invoked on
- whether this object is now deleted
- breadcrumb trail of previously visited objects.
- the home page, if any

"
ISIS-1285,Improvement,Closed,[WON'T FIX] Provide the capability to disable the browser's back button/,"In the Estatio app (and presumably many others, too), when the user deletes an object then they are shown the ""no results"" page.

What we have observed the user then do is to press the back button.  This navigates them to the object just deleted; because it has been deleted, the Wicket viewer shows them an error page. 

With the RoutingService (introduced in 1.11.0) we have the opportunity to route the user to some other ""more useful"" object, eg the parent of the deleted object, or some other object recently visited, or the home page.

Even so, if the user does press the back button, they would still see the same message.

This ticket is therefore to provide an optional capability to have the back button disabled.  Think it should be optional because not everyone (every programmer) will agree that back buttons should be disabled and in any case for some use cases, eg in read-only app, a back button is probably a good thing."
ISIS-1284,Bug,Closed,Cannot render property with compile-time type of Object but returning a value type (eg joda DateTime).,"Was: ""Unable to find component with id 'entityIconAndTitle'""

https://github.com/joerg-rade/myapp110

see also mailing list thread: http://isis.markmail.org/thread/32umudzsj3p7x7tr


"
ISIS-1283,Bug,Closed,"SAFE_AND_CACHEABLE semantics caches incorrectly, works for domain services (stateless) but not for domain entities (where stateful target determines result)","From Oscar, on mailing list:

I’m experiencing a bad behavior using SAFE_AND_CACHEABLE actions implemented on Domain Entities.

As current QueryResultsCache implementation has as its Key the calling class, instead of the concrete domain entity that has invoked it, it will return the cached result when invoking the same action on different domain objects.

For example, I have the following action:

public class Product {

    // {{ findStockForSupplier (action)
    @Action(semantics = SemanticsOf.SAFE_AND_REQUEST_CACHEABLE)
    @ActionLayout(hidden = Where.ANYWHERE)
    @MemberOrder(name = ""supplierTerms"", sequence = ""3"")
    public BigDecimal findStockForSupplier(
            final Supplier supplier) {
        final ProductSupplierTerms productSupplierTerms = this.wrapSkipRules(this).findTermsForSupplier(supplier);
        return productSupplierTerms != null ? productSupplierTerms.getStock() : BigDecimal.ZERO;
    }

}


If I invoke that action over 2 different Products (ie, Product instances) as per:

final ProductSupplierTerms productSupplierTerms1 = this.wrapSkipRules(product1).findTermsForSupplier(supplier);

final ProductSupplierTerms productSupplierTerms2 = this.wrapSkipRules(product2).findTermsForSupplier(supplier);


For the second invocation it will return the cached result, as only the class is considered on the QueryResultsCache and not the instance “identity”, and both “product1” and “product2” are Product instances.


As all Domain Entities implement the Comparable interface, perhaps it might be considered.

Until now, I didn’t noticed this because I always used the QueryResultsCache for Domain Services, and they have only 1 instance in production.

But it’s not the same when the SAFE_AND_CACHEABLE actions are implemented on Domain Entities.


Perhaps the solution would be to simply change the QueryResultsCache.Key implementation to accept an Object instead of a Class, using the “Comparable” interface if implemented to differentiate between objects (for Domain Objects), and the “equal” operator when not present (for Services)?"
ISIS-1282,New Feature,Closed,Extend @ActionLayout annotation with a routeTo attribute.,"This would extend the work started in ISIS-666 (the RoutingService), and extended in ISIS-1286, the idea being to allow the routing strategy to be defined at a more fine-grained level with the action, rather than globally in a service.

Suggest a new attribute ""routeTo()"" attribute on @ActionLayout, eg:

@ActionLayout(
   routeTo=RouteToThis.class
)
public void foo() { ... }

where:

public class RouteToThis implements ActionRouter {
     public boolean canRoute(Object original);
     public Object route(Object original);
}

If present then the RoutingService would instantiate and delegate to this router object.


Note that the attribute is on @ActionLayout rather than @Action because this is a UI concern only."
ISIS-1281,New Feature,Closed,Provide a programming API (probably via domain events) to allow object visibility to be vetoed.,"Probably a new ObjectDomainEvent, called whenever an object is being interacted with by the user, to allow subscribers to be able to veto visibility.

Basically want to be able to support something equivalent to TenantedAuthorizationFacet (in the isisaddons' security module), but without resorting to facets.

At the end of the day we need a facet (for the subscriber) that is installed on the ObjectSpecification."
ISIS-1280,New Feature,Closed,"Property#projecting attribute: provide redirect hints so that when the user clicks on a rendered link, the viewer instead navigates to some other entity.  (also fixed in ""v1 maintenance"")","This was originally raised as ISIS-666, but that ticket was repurposed and rescoped to be the ability to return a different object when an action is invoked (using the RoutingService SPI service).  That applies on the ""response"".

This ticket could be implemented through a ""RedirectService"" that applies on the ""request"".

Perhaps later on we might introduce annotations to support it also."
ISIS-1279,New Feature,Closed,AcceptHeaderService for application-defined content negotiation.,
ISIS-1278,Bug,Closed,"Title of choices lnks in RO failing, called incorrectly.",
ISIS-1277,Task,Closed,Prepare for JDK 11,"https://github.com/apache/isis/search?utf8=%E2%9C%93&q=setAccessible%28%29 yields 9 hits.

According to [1] this will be a problem with Java 9.

[1] https://jaxenter.de/java-9-release-verschoben-warum-jigsaw-noch-nicht-fertig-ist-31687 "
ISIS-1276,Dependency upgrade,Closed,Update DN to 5.1.x (from DN 4.1.x),"+Update:+ With v2.0.0-M1 'IsisJdoSupport' is provided by 'jdo-datanucleus-x' plugins. Developers may pick the 'dn-4' plugin, if they still need to use 'TypesafeQuery'.

Note that this will break IsisJdoSupport since the TypesafeQuery class is removed. While strictly speaking we ought to bump to Isis v2.0.0 because it is a breaking change, I think in this particular instance we make an exception: my guess is that not may are using that particular API.

[http://www.datanucleus.org/products/accessplatform_5_1/migration.html]"
ISIS-1275,Improvement,Closed,Configuration property for RO viewer to relax Accept header checking.,
ISIS-1274,New Feature,Closed,ContentNegotiationService for simplified representations for custom RO clients,"based on a new Accept header value, specific to org.apache.isis"
ISIS-1273,Improvement,Closed,Enhance RO viewer so that the default RO v1 representations are implemented as a ContentNegotiationService,So that all requests are handled through the same conneg mechanism.
ISIS-1272,New Feature,Closed,"[WON'T FIX[ Facet factory for actions called ""changeXxx"" or ""maintainXxx"" to be positioned to RIGHT, with dropdown.",
ISIS-1271,New Feature,Resolved,[WON'T FIX] DataNucleus NamingProvider to remove some boilerplate.,"By default, adds ""_OID"" as a suffix, necessitating the specification of the explicit name, eg @Column(name=""customer_id""), everywhere."
ISIS-1270,Improvement,Closed,[WON'T FIX] @Pattern annotation should support internationalization,following on from ISIS-1241.
ISIS-1269,Improvement,Closed,Deleting an object from a list can cause NPE when that list is re-rendered.,"For example, in the todoapp the home page displays all the todo items, not yet completed vs completed.

If select ""Buy Milk"" (when not complete) and delete it, then the NPE is thrown.

This is ultimately because the list returned from ToDoItem#delete() is stale:

{code}
    public List<ToDoItem> delete() {

        // obtain title first, because cannot reference object after deleted
        final String title = container.titleOf(this);

        final List<ToDoItem> returnList = actionInvocationContext.isLast() ? toDoItems.notYetComplete() : null;

        container.removeIfNotAlready(this);

        container.informUser(
                TranslatableString.tr(""Deleted {title}"", ""title"", title), this.getClass(), ""delete"");

        return returnList;
    }
{code}

It ought not to return the current object about to be deleted.

Even so, we can handle this application programming error easily enough, by filtering out any null objects.
"
ISIS-1268,New Feature,Closed,Enhance integration tests (and wrapper factory etc) to generate PlantUML sequence transcripts for visualization.,"per mailing list thread: http://markmail.org/message/ey5kgtx6xub7zyo5

The thread originally was motivated by the use case to forward-generate Java classes from a diagram, but also then got onto more general purpose round-tripping tools, plus the idea of generating diagrams from code, ""after the fact""

Also mentioned in that thread is the idea of generating transcripts of tests for sequence diagrams; these would be as a side-effect of running integration tests.  This ticket is for that idea."
ISIS-1267,New Feature,Closed,[WON'T FIX] Enhance isis-maven-plugin to generate UML class diagrams from metamodel,"per mailing list thread: http://markmail.org/message/ey5kgtx6xub7zyo5

There are different use cases here.  The thread originally was motivated by the use case to forward-generate Java classes from a diagram, but also then got onto more general purpose round-tripping tools, plus the idea of generating diagrams from code, ""after the fact""

This ticket is for the latter of these ideas; for rendering, could use:
- www.plantuml.com
  can then visualize using:
   - http://asciidoctor.org/docs/asciidoctor-diagram/
   - https://borisdevnotes.wordpress.com/2013/12/09/xtextplantuml/
- www.umlgraph.org  (has a Maven plugin)
- yUML.me (online)
- fowler's bliki mentions some others http://martinfowler.com/bliki/UmlSketchingTools.html

There are various other tools listed on the thread.  Some of these reverse engineer Java, whereas a better visualization would be of the Isis metamodel (showing contributions/mixins etc).

Anyway, the other tools mentioned on the thread include:
- http://roomodeler.com
- http://www.capableobjects.com
- https://www.eclipse.org/gef/zest/ (also for visualizing diagrams)
- http://vue.tufts.edu/ (visualizing arbitrary diagrams)
- http://www.sparxsystems.com/ (roundtripping, a la TogetherJ)
- http://www.agilej.com  (roundtripping - this is Paul Wells' tool)
- https://www.eclipse.org/papyrus/   (UML, forward generate, reverse generate ... but isn't visualization)
- http://www.andromda.org/
- http://www.ifml.org
"
ISIS-1266,Wish,Open,"[Wish] Expose an Isis metamodel to RDF, SparQL, ""semantic web""","There have been various discussions about RDF and semantic web etc on the users mailing list.  This ticket is just as a placeholder to the fact that there is obviously interest in some sort of integration here.

http://markmail.org/message/uixaxnlsb3rncquo
http://markmail.org/thread/vbuom7npt32r53gv

From Cesar (private email to Dan):

Interestingly, I found out that Apache provides a semantic approach in Java (RDF – SPARQL) through Apache JENA.
https://jena.apache.org/
 
A couple of short introductory videos:
 
RDF Ontology with Apache JENA
https://www.youtube.com/watch?v=N_GpbwMHeMQ
 
SPARQL with Apache Jena
https://www.youtube.com/watch?v=nUdHneViLp4
 "
ISIS-1265,New Feature,Closed,"Support ""old-fashioned"" WYSIWYG editor (rich text) for properties/parameters, eg using Summernote","background thread to this:
http://markmail.org/message/qsp3nhaxu7c7g4s7

In terms of technology, can leverage Wicket-Bootstrap's integration with Summernote could be a good basis:
https://github.com/summernote/summernote
Demo: http://wb-mgrigorov.rhcloud.com/summernote
Demo code:
https://github.com/l0rdn1kk0n/wicket-bootstrap/blob/master/bootstrap-samples/src/main/java/de/agilecoders/wicket/samples/pages/SummernotePage.java

In terms of programming model, either introduce a new value type similar to Blob and Clob (eg RichText) or alternatively extend @Property and @Parameter.

I think I prefer a new value type, and just ""bake it in""."
ISIS-1264,Improvement,Closed,No-arg actions returning Blob/Clob but whose return type is simply java.lang.Object throw exception.,"For example:
{code}
public Object downloadThis() {
    return new Clob(...);
}
{code}

there are two possible workarounds; either:

a) return Clob (or Blob) instead of Object
{code}
public Clob downloadThis() {
    return new Clob(...);
}
{code}

b) make the action take one or more args (not be a no-arg):
{code}
public Object downloadThis(String filename) {
    return new Clob(...);
}
{code}

~~~
In more detail:

The ActionLinkFactoryAbstract class has a utility method determineDeferredBehaviour that figures out from the actionModel whether this is an action with no args and returning either a Clob/Blob or a URL (that also requires special handling).  It has to do so by looking at the action signature, ie the compile-time return type.  If the action matches, we get back an AjaxDeferredBehaviour callback handler, and this is what is used to handle the ajax request if the action's link is subsequently clicked.

If the action doesn't conform to this, then we just get a regular AbstractAjaxDefaultBehaviour.

Later on, though, when we invoke the action (ActionPanel), we use this code:
{code}
            ActionResultResponse resultResponse = ActionResultResponseType.determineAndInterpretResult(this.getActionModel(), target, resultAdapter);
            resultResponse.getHandlingStrategy().handleResults(this, resultResponse);
{code}

which inspects the returned object and figures out the right way to ""return"" it.  In the case of a Blob/Clob the selecting handlingStrategy basically assumes that an AjaxDeferredBehaviour has been set up.  If it wasn't, then everything blows up.

~~~
Don't know how to fix this.  Perhaps Martin has a solution."
ISIS-1263,New Feature,Closed,Support editing/preview using Asciidoctor (perhaps as an Isis addon),"background to this:
- http://markmail.org/message/nph3x7qeydifkw6s

Implementation options:

1. EpicEditor JS library, set up to use Asciidoctor.js as an EpicEditor plugin.  for more info, see https://github.com/OscarGodson/EpicEditor/issues/380

2. Markitup (http://markitup.jaysalvat.com/home/), using https://github.com/lordofthejars/asciidoctor-markitup

In either case, these javascript components would then need converting into a Wicket component, eg to live within wicketstuff.  Then would need to create an Isis component around it.  

~~~
In terms of programming model, could either introduce a new value type, eg Asciidoc, or extend @Property and @Parameter (or should it be @PropertyLayout and @ParameterLayout).  I think I prefer the former, as is more encapsulated.

Or, perhaps reuse Clob, but find a way to provide a hint that the content is asciidoc.
"
ISIS-1262,New Feature,Closed,Provide mixin to allow the JDO metadata to be downloaded for any Persistable.,"For example, if overriding JDO annotations, as per http://isis.apache.org/guides/ug.html#_ug_more-advanced_overriding-jdo-annotations"
ISIS-1261,Improvement,Closed,[WON'T FIX] Provide a mvn -D property (or similar) to allow the .pot translations file either to be generated or not generated as required.,
ISIS-1260,Improvement,Closed,when metamodel validation fails the integ test are executed anyway but all fail because the app is not initialized property,the workaround is to enable metamodel validation for the dom project.
ISIS-1259,Improvement,Closed,"For derived parameter names from nested inner classes, ignore the parent out class","For example, rather than rendering ""Foo$Bar"", should show just ""Bar""."
ISIS-1258,New Feature,Closed,Extend the Isis maven plugin to be able to generate XSD schemas using the JaxbService,"So that these can then be packaged up and used as formal API for consumers, eg of RO API along with ContentMappingService conneg stuff."
ISIS-1257,Improvement,Closed,Allow @Title to be added as an annotation to fields.,
ISIS-1256,Improvement,Closed,Shiro has a vulnerabilty for default rememberMe cookie.  We should work around this somehow,"see https://issues.apache.org/jira/browse/SHIRO-550


Also:

Severity: Important

Vendor:
The Apache Software Foundation

Versions Affected:
1.0.0-incubating - 1.2.4

Description:
A default cipher key is used for the ""remember me"" feature when not
explicitly configured.  A request that included a specially crafted request
parameter could be used to execute arbitrary code or access content that
would otherwise be protected by a security constraint.

Mitigation:
Users should upgrade to 1.2.5 [1],  ensure a secret cipher key is
configured [2], or disable the ""remember me"" feature. [3]

All binaries (.jars) are available in Maven Central already.

References:
[1] http://shiro.apache.org/download.html
[2] http://shiro.apache.org/configuration.html#Configuration-ByteArrayValues
[3] If using a shiro.ini, ""remember me"" can be disabled adding the
following config line in the '[main]' section:
  securityManager.rememberMeManager = null
"
ISIS-1255,Improvement,Closed,Provide configuration property so that domain events set to Xxx.Default are either ignored (like the Noop) or are posted anyway.,"At same time, should then change the UiEvents so that their default is Xxx.Default (like the domain events) rather than Xxx.Noop."
ISIS-1254,Improvement,Closed,Disable action/property/collection events if set to Noop domain events,"Following the pattern introduced in ISIS-1252 for the XxxUiEvents.

Thus, to disable an event being fired for an action, use:

{code}
@Action(domainEvent=ActionDomainEvent.Noop.class)
public void someAction() { ... }
{code}

Note though that to avoid breaking backward compatibility the default for the annotation attribute is still ""ActionDomainEvent.Default.class"", meaning that:

{code}
@Action
public void someAction() { ... }
{code}

*will* (still) cause an event to be fired.

~~~
We will probably make Noop the default in 2.0.
"
ISIS-1253,Bug,Closed,Default title for enums is not friendly name,"eg in todoapp, ToDoItem#demoException(...)"
ISIS-1252,New Feature,Closed,"New TitleUiEvent, IconUiEvent and CssClassUiEvent as a means to allow subscribers to provide a title for domain objects.","We already have @Mixins as a way to pull out behaviour from domain objects (eg entities or view models), but currently the title and the other UI hints must be implemented on the class itself.  This ticket is to allow this UI hints to be contributed via a subscriber."
ISIS-1251,New Feature,Closed,UrlEncodingService as a plugin point for serializing mementos into a URL-friendly string.,"Previously this was hard-coded to use base64 encoding (and this should be retained as the default behaviour).

However, alternative implementations could:
a) use HMAC to encrypt, or
b) return a GUID as a token and hold the state server-side in some sort of ""session cache""
"
ISIS-1250,New Feature,Closed,JaxbService to marshall DTOs to XML.,
ISIS-1249,Improvement,Closed,Annotate AbstractSubscriber with @DomainServiceLayout(menuOrder=...) so that this is picked up by default by all implementations.,
ISIS-1248,New Feature,Closed,[WON'T FIX] Lombok plugin to automatically generate domain event classes.,
ISIS-1247,Bug,Closed,[DUPLICATE] .layout.json file not found if i18n is enabled ... uses the translated name to lookup the file.,
ISIS-1246,Improvement,Closed,Better diagnostics on NPE,"   - java.lang.NullPointerException
   -
   - org.apache.isis.core.runtime.system.persistence.PersistenceSession#ensurePojoAdapterMapConsistent(PersistenceSession.java:1413)
   - org.apache.isis.core.runtime.system.persistence.PersistenceSession#ensureMapsConsistent(PersistenceSession.java:1388)
   - org.apache.isis.core.runtime.system.persistence.PersistenceSession#createCollectionAdapter(PersistenceSession.java:1652)
   - org.apache.isis.core.runtime.system.persistence.PersistenceSession#adapterFor(PersistenceSession.java:1630)


full stack trace:


   - org.apache.wicket.WicketRuntimeException
   - Error attaching this container for rendering: [Item [Component id = 8]]
   - org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1696)
   - org.apache.wicket.Component#onBeforeRender(Component.java:3833)
   - org.apache.wicket.Component#internalBeforeRender(Component.java:949)
   - org.apache.wicket.Component#beforeRender(Component.java:1017)
   - org.apache.wicket.MarkupContainer#onBeforeRenderChildren(MarkupContainer.java:1684)
   - org.apache.wicket.Component#onBeforeRender(Component.java:3833)
   - org.apache.wicket.markup.repeater.AbstractRepeater#onBeforeRender(AbstractRepeater.java:143)
   - org.apache.wicket.Component#internalBeforeRender(Component.java:949)
   ...
   - org.apache.wicket.Component#beforeRender(Component.java:1017)
   - org.apache.wicket.Component#internalPrepareForRender(Component.java:2201)
   - org.apache.wicket.Page#internalPrepareForRender(Page.java:240)
   - org.apache.wicket.Component#render(Component.java:2290)
   - org.apache.wicket.Page#renderPage(Page.java:1024)
   - org.apache.wicket.request.handler.render.WebPageRenderer#renderPage(WebPageRenderer.java:139)
   - org.apache.wicket.request.handler.render.WebPageRenderer#respond(WebPageRenderer.java:229)
   - org.apache.wicket.core.request.handler.RenderPageRequestHandler#respond(RenderPageRequestHandler.java:175)
   - org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:890)
   - org.apache.wicket.request.RequestHandlerStack#execute(RequestHandlerStack.java:64)
   - org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:261)
   - org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:218)
   - org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:289)
   - org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:259)
   - org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:201)
   - org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:282)
   - org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1667)
   - org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter#doFilter(IsisLogOnExceptionFilter.java:52)
   - org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1667)
   - org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
   - org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
   - org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
   - org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
   - org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
   - org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
   - org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
   - org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1667)
   - org.eclipse.jetty.servlet.ServletHandler#doHandle(ServletHandler.java:581)
   - org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:143)
   - org.eclipse.jetty.security.SecurityHandler#handle(SecurityHandler.java:548)
   - org.eclipse.jetty.server.session.SessionHandler#doHandle(SessionHandler.java:226)
   - org.eclipse.jetty.server.handler.ContextHandler#doHandle(ContextHandler.java:1114)
   - org.eclipse.jetty.servlet.ServletHandler#doScope(ServletHandler.java:511)
   - org.eclipse.jetty.server.session.SessionHandler#doScope(SessionHandler.java:185)
   - org.eclipse.jetty.server.handler.ContextHandler#doScope(ContextHandler.java:1048)
   - org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:141)
   - org.eclipse.jetty.server.handler.ContextHandlerCollection#handle(ContextHandlerCollection.java:213)
   - org.eclipse.jetty.server.handler.HandlerCollection#handle(HandlerCollection.java:109)
   - org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:119)
   - org.eclipse.jetty.server.Server#handle(Server.java:517)
   - org.eclipse.jetty.server.HttpChannel#handle(HttpChannel.java:302)
   - org.eclipse.jetty.server.HttpConnection#onFillable(HttpConnection.java:242)
   - org.eclipse.jetty.io.AbstractConnection$ReadCallback#succeeded(AbstractConnection.java:245)
   - org.eclipse.jetty.io.FillInterest#fillable(FillInterest.java:95)
   - org.eclipse.jetty.io.SelectChannelEndPoint$2#run(SelectChannelEndPoint.java:75)
   - org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#produceAndRun(ExecuteProduceConsume.java:213)
   - org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#run(ExecuteProduceConsume.java:147)
   - org.eclipse.jetty.util.thread.QueuedThreadPool#runJob(QueuedThreadPool.java:654)
   - org.eclipse.jetty.util.thread.QueuedThreadPool$3#run(QueuedThreadPool.java:572)
   - java.lang.Thread#run(Thread.java:745)
  -
   - Caused by:
   -
   - java.lang.NullPointerException
   -
   - org.apache.isis.core.runtime.system.persistence.PersistenceSession#ensurePojoAdapterMapConsistent(PersistenceSession.java:1413)
   - org.apache.isis.core.runtime.system.persistence.PersistenceSession#ensureMapsConsistent(PersistenceSession.java:1388)
   - org.apache.isis.core.runtime.system.persistence.PersistenceSession#createCollectionAdapter(PersistenceSession.java:1652)
   - org.apache.isis.core.runtime.system.persistence.PersistenceSession#adapterFor(PersistenceSession.java:1630)
   - org.apache.isis.core.runtime.persistence.internal.RuntimeContextFromSession$2#adapterFor(RuntimeContextFromSession.java:106)
   - org.apache.isis.core.metamodel.specloader.specimpl.OneToManyAssociationDefault#get(OneToManyAssociationDefault.java:166)
   - org.apache.isis.core.runtime.memento.Memento#createAssociationData(Memento.java:130)
   - org.apache.isis.core.runtime.memento.Memento#createObjectData(Memento.java:122)
   - org.apache.isis.core.runtime.memento.Memento#createData(Memento.java:91)
   - org.apache.isis.core.runtime.memento.Memento#<init>(Memento.java:76)
   - org.apache.isis.viewer.wicket.model.mementos.ObjectAdapterMemento#init(ObjectAdapterMemento.java:255)
   - org.apache.isis.viewer.wicket.model.mementos.ObjectAdapterMemento#<init>(ObjectAdapterMemento.java:238)
   - org.apache.isis.viewer.wicket.model.mementos.ObjectAdapterMemento#createOrNull(ObjectAdapterMemento.java:57)
   - org.apache.isis.viewer.wicket.model.models.EntityModel#<init>(EntityModel.java:160)
   - org.apache.isis.viewer.wicket.ui.components.scalars.reference.ReferencePanel#syncWithInput(ReferencePanel.java:237)
   - org.apache.isis.viewer.wicket.ui.components.scalars.reference.ReferencePanel#onBeforeRenderWhenViewMode(ReferencePanel.java:209)
   - org.apache.isis.viewer.wicket.ui.components.scalars.ScalarPanelAbstract#onBeforeRender(ScalarPanelAbstract.java:198)
   - org.apache.wicket.Component#internalBeforeRender(Component.java:949)
   - org.apache.wicket.Component#beforeRender(Component.java:1017)
   ...
   - org.apache.wicket.Component#onBeforeRender(Component.java:3833)
   - org.apache.wicket.Page#onBeforeRender(Page.java:809)
   - org.apache.wicket.Component#internalBeforeRender(Component.java:949)
   - org.apache.wicket.Component#beforeRender(Component.java:1017)
   - org.apache.wicket.Component#internalPrepareForRender(Component.java:2201)
   - org.apache.wicket.Page#internalPrepareForRender(Page.java:240)
   - org.apache.wicket.Component#render(Component.java:2290)
   - org.apache.wicket.Page#renderPage(Page.java:1024)
   - org.apache.wicket.request.handler.render.WebPageRenderer#renderPage(WebPageRenderer.java:139)
   - org.apache.wicket.request.handler.render.WebPageRenderer#respond(WebPageRenderer.java:229)
   - org.apache.wicket.core.request.handler.RenderPageRequestHandler#respond(RenderPageRequestHandler.java:175)
   - org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:890)
   - org.apache.wicket.request.RequestHandlerStack#execute(RequestHandlerStack.java:64)
   - org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:261)
   - org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:218)
   - org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:289)
   - org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:259)
   - org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:201)
   - org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:282)
   - org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1667)
   - org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter#doFilter(IsisLogOnExceptionFilter.java:52)
   - org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1667)
   - org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
   - org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
   - org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
   - org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
   - org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
   - org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
   - org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
   - org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1667)
   - org.eclipse.jetty.servlet.ServletHandler#doHandle(ServletHandler.java:581)
   - org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:143)
   - org.eclipse.jetty.security.SecurityHandler#handle(SecurityHandler.java:548)
   - org.eclipse.jetty.server.session.SessionHandler#doHandle(SessionHandler.java:226)
   - org.eclipse.jetty.server.handler.ContextHandler#doHandle(ContextHandler.java:1114)
   - org.eclipse.jetty.servlet.ServletHandler#doScope(ServletHandler.java:511)
   - org.eclipse.jetty.server.session.SessionHandler#doScope(SessionHandler.java:185)
   - org.eclipse.jetty.server.handler.ContextHandler#doScope(ContextHandler.java:1048)
   - org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:141)
   - org.eclipse.jetty.server.handler.ContextHandlerCollection#handle(ContextHandlerCollection.java:213)
   - org.eclipse.jetty.server.handler.HandlerCollection#handle(HandlerCollection.java:109)
   - org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:119)
   - org.eclipse.jetty.server.Server#handle(Server.java:517)
  - org.eclipse.jetty.server.HttpChannel#handle(HttpChannel.java:302)
  - org.eclipse.jetty.server.HttpConnection#onFillable(HttpConnection.java:242)
   - org.eclipse.jetty.io.AbstractConnection$ReadCallback#succeeded(AbstractConnection.java:245)
   - org.eclipse.jetty.io.FillInterest#fillable(FillInterest.java:95)
   - org.eclipse.jetty.io.SelectChannelEndPoint$2#run(SelectChannelEndPoint.java:75)
   - org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#produceAndRun(ExecuteProduceConsume.java:213)
   - org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume#run(ExecuteProduceConsume.java:147)
   - org.eclipse.jetty.util.thread.QueuedThreadPool#runJob(QueuedThreadPool.java:654)
   - org.eclipse.jetty.util.thread.QueuedThreadPool$3#run(QueuedThreadPool.java:572)
   - java.lang.Thread#run(Thread.java:745)"
ISIS-1245,Improvement,Closed,"During bootstrap, ensure that any @PersistenceCapable entities found on classpath also implement PersistenceCapable interface (ie that the DN enhancer has run).",
ISIS-1244,Bug,Closed,"RO POST to ""objects of type"" resource should return a 201, not a 200.",
ISIS-1243,Task,Closed,Release activities for v1.11.0,Miscellaneous release activities for 1.11.0 release.
ISIS-1242,Bug,Closed,Breadcrumbs broken if change the title.... the drop-down never displays elements,The workaround is to refresh the page.
ISIS-1241,Improvement,Closed,Providing better feedback when RegEx validation does not match pattern,"Currently, when using RegEx validation, the error message could be improved. When the input isn't valid, the following string is shown: ""Doesn't match pattern"". But it doesn't tell you to which pattern the value must match. Therefore I think that adding regexPatternDescription() next to the existing regexPattern() could be an improvement. This way an incorrect pattern can be clarified to a human-being by returning the patternDescription. "
ISIS-1240,Improvement,Closed,Derive icon from service when not provided,"If no iconName method is provided for a service Isis searches for an icon equal to the service name. Additional to this behavior we could extend this  search by stripping off know service suffixes like ""Service, Menu and Repository"". As an example: the ""PersonMenu"" service will use the ""Person"" icon if no icon has been specified.

If annotated as a repository (@DomainService(repositoryFor=...) then that could also be used.




"
ISIS-1239,Improvement,Closed,"For wicket ui, use a cookie or similar to remember the hint from last time.","A nice to have, but would improve usability of fullcalendar2, gmap3 etc."
ISIS-1238,New Feature,Closed,[Validation] Metamodel exception if transient property has @Property(editing=ENABLED),"MetaModel validation

 

for example:

private String firstName=""Anju"";
 @Property(editing=Editing.ENABLED,maxLength=9,notPersisted=true)
 public String getFirstName()

{ return firstName; }

// no setter."
ISIS-1237,Improvement,Closed,Integrate with swagger for REST APIs,"as per Oscar's mail:


You know we're using Wavemaker for the front-end.

Most recent version 7 uses Swagger as the way to document the auto-generated APIs [1], but all JavaScript widgets can be render any JSON representation with limitations detailed in [2], [3].

[1] http://www.wavemaker.com/latest/wavemaker-api-designer-brings-api-driven-development-to-custom-built-enterprise-applications/
[2] http://www.wavemaker.com/learn/topics/studio/integrate/external-services/
[3]
http://www.wavemaker.com/learn/docs/importing-web-services/"
ISIS-1236,Improvement,Open,Extend RO viewer to support the 'simple domain model' as per section 1.25.1 of the RO v1.0 spec,"as raised by Kambiz Darabi darabi@m-creations.com via isis.apache.org :

is Isis capable of supporting the simple domain model as described in
section 1.25.1 of the RO spec?

I ask because of Richard Pawson's answer to my question on github:

https://github.com/SpiroLibraries/Spiro.Modern/issues/2

> I'm afraid this is not going to be straightforward. Either Isis needs
> to support the 'simple' domain model (my strong preference!), or Spiro
> needs to be extended to work with the formal model (a lot of change -
> and, inherently, much more complex than working with the simple
> approach). I have suggested to Dan that in the next version of the RO
> spec that the Simple domain model should be mandatory and the formal
> one an optional extra.

If there is no built-in support, I would be interested in an estimate of
how much effort would be needed to implement that functionality.

Thanks"
ISIS-1235,Improvement,Open,"Enhance RO viewer to support section 34.3 of RO v1.0 spec ((x-ro-page, x-ro-page-size)",
ISIS-1234,Improvement,Open,Enhance RO viewer to support section 34.2 of RO v1.0 spec (x-ro-sort-by),
ISIS-1233,Improvement,Closed,[DUPLICATE] Enhance RO viewer to support section 34 of RO v1.0 spec (table grids),"Has been implemented as part of ISIS-1232 (x-ro-follow-links) and ISIS-1274 (simplified profile)

"
ISIS-1232,Improvement,Closed,Enhance RO viewer to support section 34.4 of RO v1.0 spec (x-ro-follow-links),
ISIS-1231,Improvement,Closed,"Add jdeps to build as optional profile, to verify use of internal JDK jars.","so can run using ""mvn clean install -Djdeps"".

"
ISIS-1230,Improvement,Closed,[WON'T FIX] How use SudoService with fixture scripts that themselves are nested?,"As raised by Oscar:

I’m not sure how to use the SudoService inside a FixtureScript.

I have the following:


public class DemoWithAllRecordsFixture extends FixtureScript {

    public DemoWithAllRecordsFixture() {
        this.withDiscoverability(Discoverability.DISCOVERABLE);
    }

    @Override
    protected void execute(
            final ExecutionContext executionContext) {

        executionContext.executeChild(this, new ExcelInheritedConditionsSNPGenotypeFixture());
        executionContext.executeChild(this, new ExcelDrugsSNPGenotypeFixture());
        executionContext.executeChild(this, new ExcelTraitsSNPGenotypeFixture());

    }

The ExcelInheritedConditionsSNPGenotypeFixture contains many wrapped action invocations, so the following exception is thrown:

Caused by: org.apache.isis.applib.services.wrapper.HiddenException: Reason: Could not locate application user for initialisation. Identifier: com.tellmegen.domain.model.inheritedconditions.InheritedCondition#upsertSNPGenotype(java.lang.Integer,com.tellmegen.domain.model.AppliesToSex,java.lang.String,java.lang.String,com.tellmegen.domain.model.inheritedconditions.InheritedConditionHeredity,com.tellmegen.domain.model.inheritedconditions.InheritedConditionPhenotype,com.tellmegen.domain.model.inheritedconditions.InheritedConditionStatus,java.lang.String,java.lang.String)
	at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.toException(DomainObjectInvocationHandler.java:732)
	at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.notifyListenersAndVetoIfRequired(DomainObjectInvocationHandler.java:700)
	at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.checkVisibility(DomainObjectInvocationHandler.java:682)
	at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.handleActionMethod(DomainObjectInvocationHandler.java:607)
	at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.invoke(DomainObjectInvocationHandler.java:263)
	at org.apache.isis.core.wrapper.proxy.ProxyInstantiatorForJavassist$1.invoke(ProxyInstantiatorForJavassist.java:72)
	at com.tellmegen.domain.model.inheritedconditions.InheritedCondition_$$_jvstcc_7.upsertSNPGenotype(InheritedCondition_$$_jvstcc_7.java)
	at com.tellmegen.domain.model.importing.ImportInheritedConditionSNPGenotype.saveToDatabase(ImportInheritedConditionSNPGenotype.java:244)
	at com.tellmegen.domain.model.importing.ImportInheritedConditionsSNPGenotypeService.importInheritedConditionsSNPGenotypes(ImportInheritedConditionsSNPGenotypeService.java:38)
	at com.tellmegen.fixture.model.inheritedconditionsnpgenotype.ExcelInheritedConditionsSNPGenotypeFixture.execute(ExcelInheritedConditionsSNPGenotypeFixture.java:24)
	at org.apache.isis.applib.fixturescripts.FixtureScript$ExecutionContext.executeChildIfNotAlready(FixtureScript.java:549)
	at org.apache.isis.applib.fixturescripts.FixtureScript$ExecutionContext.executeChildT(FixtureScript.java:528)
	at org.apache.isis.applib.fixturescripts.FixtureScript$ExecutionContext.executeChildT(FixtureScript.java:498)
	at org.apache.isis.applib.fixturescripts.FixtureScript$ExecutionContext.executeChild(FixtureScript.java:487)
	at com.tellmegen.fixture.TellMeGenDemoWithAllRecordsFixture.execute(TellMeGenDemoWithAllRecordsFixture.java:34)


If try to use them inside a SudoService.sudo(…) call I don’t have access to the “executionContext” (it’s private).

So basically, I would need to make the “executionContext” field of FixtureScript “public”, or being able to use SudoService to override the User globally, without needing to use a “Callable” construct.
"
ISIS-1229,Bug,Closed,Calling nextRequest() in an integration test should clear any @RequestScoped services.,"Raised by Oscar:
Related with this, I’m trying to test the following:

   @Test
    public void totalOrRatio() {

        // given
        kit.assignToPerson(account.getAccountOwner());

        this.nextRequest();

        kit.getRegisteredForPerson().setSex(Sex.Man);

….
}

Where the Kit.getRegisteredForPerson() is cached:

    // {{ RegisteredForPerson (property)
    @Property(editing = Editing.DISABLED, notPersisted = true)
    @MemberOrder(sequence = ""1"")
    public Person getRegisteredForPerson() {
        return this.queryResultsCache.execute(new Callable<Person>() {
            @Override
            public Person call() throws Exception {
                return Kit.this.findRegisteredToPerson();
            }
        }, this.getClass(), ""findRegisteredToPerson"");
    }

    // }}


Despite invoking “this.nextRequest()” on the integtest, seems that the cache is still alive (being it a @RequestScoped service).

Would this also need to be improved for testing @RequestScoped services? "
ISIS-1228,Improvement,Closed,Reorganizing/splitting out DomainObjectContainer service.,"Originally this ticket was much narrower in scope, simply to introduce nextTransaction() into fixture scripts.  

This was implemented by adding nextTransaction() to DomainObjectContainer.

From there though I decided that DOC was become too bloated, so split it out into a number of other domain services:
- TransactionService ... for this new method and also flushTransaction

but then eventually also:
- RepositoryService (persist, allMatches, uniqueMatch, firstMatch)
- MessageService  (informUser, warnUser, raiseError)
- ConfigurationService (getProperties etc)
- ServiceRegistry (lookupService, injectServicesInto)

The existing DOC methods have been deprecated, the DOCDefault impl delegates to the new services.

~~~~
The original request for this ticket was raised by Oscar:
When using FixtureScripts, there can be many actions that, on the real world, are execute in different time contexts.

For example, a user creates an Account on the webapp and after that executes different actions.

That’s relevant if using the queryResultsCache service (or the new planned “@Action” annotation extension) because the results previously created (i.e., the Account) might be available on the cache.

So perhaps some mechanism like the nextTransation() method might be also introduced on FixtureScripts.

What do you think?

~~~~~~~
Dan's reply:
Makes sense.

There is a nextTransaction() method in the AbstractIntegTest class, you could see how that is implemented and see if it can be adapted?

Or, another idea is that the framework could run each FixtureScript automatically in a separate transaction; that would be a better simulation of a sequence of user interactions?"
ISIS-1227,Bug,Closed,"in edit mode, when there are validation errors, these are not showing up for the individual properties, instead for the object-level validation.","Need to check if something similar occurs for action parameters (though I think it does not).

This may not be so important if we decide to drop edit mode in 2.0.0.

~~~
see commented out validation in kitchensink's EnumeratedObject:
- validateSomeBooleanWithValidation
- validateSomeBooleanWrapperWithValidation

but in general, any validation will show the issue."
ISIS-1226,Bug,Closed,Drop-down breadcrumbs broken.,"The BreadcrumbModel is held by the session (specifically, the AuthenticatedWebSessionForIsis, subclass of a Wicket session class).

This holds a list of EntityModels.  

The EntityModels are LoadableDetachable, which caches the underlying ObjectAdapter in a transient field.

It seems that the model isn't being serialized/deserialized, and there is no explicit detach, thus on the next request the EntityModel still holds the ObjectAdapter (for the previous PersistenceSession) and which in turn holds the pojo.  From JDO/Datanucleus' perspective, this pojo is not persistent.

As per ISIS-1194 simplificaitons, we now delegate to the pojo to determine whether it is persistent or not; and so JDO/DN reports that this pojo is NOT persistent.

In turn this gives us a """" empty string for the oid str, and things then break.

~~~
The fix is to explicitly detach all the EntityModels of the BreadcrumbModel.  This can be done by hooking into the AuthenticatedWebSessionForIsis#detach() hook.
"
ISIS-1225,Improvement,Closed,[WON'T FIX] Replace select2 with selectize,"This may be required if the upgrade to select2 v4 (ISIS-1224) does not address the issue originally reported in ISIS-1020 (""drop-down window opens top-left of screen"").

details on selectize: https://github.com/wicketstuff/core/tree/master/wicketstuff-selectize-parent

see also ISIS-709 (multi-select).


"
ISIS-1224,Bug,Closed,drop down box (select2) is orphaned and floats top-right under certain circumstances,"This ticket supercedes ISIS-1020 (where the problem was originally reported)

Original screencast to demonstrate in Estatio: https://drive.google.com/file/d/0B2jd2Sl73mDBZ0lqYUhtVjVRamc/view?usp=sharing
This is reproducible in both IE11 and Chrome.

It was hoped that upgrading to select v4 (dependent on Wicket 7 and ISIS-1223) might fix the problem, however it doesn't.

See comments for further details.

"
ISIS-1223,Dependency upgrade,Closed,Upgrade Wicket to 7.x,"to keep up to date, and as a prereq for ISIS-1224.

"
ISIS-1222,Improvement,Closed,Inject services into command objects.,"... to support implementations of CommandService that use subclasses of Command (eg PlaceOrderCommand, ReturnBooksCommand)."
ISIS-1221,Bug,Closed,JSON Format Layouts not recognized with i18n translations in Wicket Viewer,"I am working with Apache Isis Wicket viewer 1.9.0, and I have some form layout json files to define the layout for some domain objects. I also added a translation file (i18n) with some translations. When running the application in the browser, when I am in “writing translations” mode it shows the object form with the layout defined in the json file (ok), but when I switch to “reading translations”, it goes back to the “default” layout, ignoring the layout defined in the json file. 

In regards to those modes, I am referring to the Apache wicket viewer menu which, in prototype mode, has a ""Prototyping"" menu, which has an option ""Switch to Reading Translations"". When you select that option and keep using the application is when it loses the layouts defined in the json layout files."
ISIS-1220,Improvement,Closed,Methods annotated with @Subscribe should automatically be ignored (as per @Programmatic).,
ISIS-1219,New Feature,Closed,"[DUPLICATE?] Extend events to allow subscribers to provide defaults, choices, autoComplete on action parameters.",
ISIS-1218,Improvement,Closed,Allow autoComplete supporting method to return a Collection as well as a List or array.,"Also Set.
"
ISIS-1217,New Feature,Closed,Formatting text inside a text field,"It should be possible to format the text inside a text field using Apache ISIS.
I would like to highlight some words in the text, maybe with different colors/fonts dependent on their tags/meta data/meaning.
Also, it should be possible to right-click a term/word in the text, and then get a (list of) functions, and then it should be possible to select on of these functions.
"
ISIS-1216,Improvement,Closed,Update Wicket Bootstrap to 0.9.13 (once available) as a better fix to the checkbox issue,"see  martin-g's comments on ISIS-1214, specifically:

It seems there is some bug in checkboxx.js ver.1.3.0 (part of Wicket Bootstrap 0.9.12).
The bug affects only the ""two state"" mode of the widget.
Debugging its JS code I've found that the bug is not there if the native UI is used. So I've pushed a commit to master branch with that workaround.
Once Wicket-Bootstrap 0.9.13 is released please merge branch ""ISIS-1214-three-state-checkbox"" to master. It reverts the first change and upgrades jQuery-UI that is used for dragging the modal dialogs.

"
ISIS-1215,New Feature,Closed,New MultipleExecutionStrategy for fixture scripts to use value semantics for determining whether to run a fixture script invoked more than once.,"for fixture scripts, we can currently configure the MultipleExecutionStrategy as either IGNORE or EXECUTE, eg:

{code:java}
    @Override
    public FixtureScriptsSpecification getSpecification() {
        return FixtureScriptsSpecification
                .builder(DomainAppFixtureScriptsSpecificationProvider.class)
                .with(FixtureScripts.MultipleExecutionStrategy.EXECUTE)
                .build();
    }
{code}

The IGNORE is for using fixture scripts that combine both the ""WHAT"" and the ""HOW""  (a la Estatio):

{code:java}
	ec.executeChild(this, new ImportEventsFromSpreadsheet());
	ec.executeChild(this, new ImportPeopleFromSpreadsheet());
{code}

where:

{code:java}
    static class ImportEventsFromSpreadsheet extends CreateUsingSpreadsheet<EventImport> {
        public ImportEventsFromSpreadsheet() {
            super(EventImport.class, ""EventImport.xls"");
        }
    }
    static class ImportPeopleFromSpreadsheet extends CreateUsingSpreadsheet<PeopleImport> {
        public ImportPeopleFromSpreadsheet() {
            super(PeopleImport.class, ""PeopleImportB.xls"");
        }
    }
{code}

The alternative is EXECUTE, which basically switches this behaviour off. That is appropriate for general purpose fixture scripts which take care of the ""HOW"", but where the ""WHAT"" is parameterized,

eg:
{code:java}
    ec.executeChild(this, new CreateUsingSpreadsheet<>(EventImport.class, ""EventImport.xls""));
    ec.executeChild(this, new CreateUsingSpreadsheet<>(PeopleImport.class, ""PeopleImportB.xls""));
{code}

This ticket is to combine both approaches by using value-semantics rather than reference semantics, thus to ignore fixture scripts if invoked multiple times where ""multiple times"" is determine by invoking on equals(...) of the fixture script against all previously invoked fixture scripts.

thus, we would skip a fixture script if
{code:java}
    ec.executeChild(this, new CreateUsingSpreadsheet<>(EventImport.class, ""EventImport.xls""));    

  // would invoke this:
    ec.executeChild(this, new CreateUsingSpreadsheet<>(SomethingElseImport.class, ""SomethingElseImport.xls""));    

   // but would skip this:
    ec.executeChild(this, new CreateUsingSpreadsheet<>(EventImport.class, ""EventImport.xls""));    
{code}"
ISIS-1214,Bug,Closed,Three state checkbox doesn't work ,"The ""two state"" mode of three state checkbox component doesn't work due to a bug in the JS widget."
ISIS-1213,New Feature,Closed,"Provide support for @Mixin domain objects, as a specialized type of contributor (though not a domain service)","For example, rather than a contributed action:

{code:java}
@DomainService(
        nature = NatureOfService.VIEW_CONTRIBUTIONS_ONLY
)
public class CommunicationChannel_updateNotes {
    @Action(
            semantics = SemanticsOf.IDEMPOTENT
    )
    public <T extends CommunicationChannel<T>> CommunicationChannel<T> updateNotes(
            CommunicationChannel<T> communicationChannel,
            @Parameter(optionality = Optionality.OPTIONAL)
            @ParameterLayout(named = ""Notes"", multiLine = 10)
            final String Notes) {
        communicationChannel.setNotes(Notes);
        return communicationChannel;
    }
    public <T extends CommunicationChannel<T>> String default1UpdateNotes(
            CommunicationChannel<T> communicationChannel
            ) {
        return communicationChannel.getNotes();
    }
}
{code}

which requires passing in the contributee to every method, and ensuring that all methods are named correctly, we can instead say:

{code:java}
@DomainObject(
        nature = Nature.MIXIN
)
public class CommunicationChannel_updateNotes {
    private final CommunicationChannel communicationChannel;
    public CommunicationChannel_updateNotes(CommunicationChannel communicationChannel) {
        this.communicationChannel = communicationChannel;
    }
   @Action(
            domainEvent = UpdateNotesEvent.class,
            semantics = SemanticsOf.IDEMPOTENT
    )
    public <T extends CommunicationChannel<T>> CommunicationChannel<T> __(
            @Parameter(optionality = Optionality.OPTIONAL)
            @ParameterLayout(named = ""Notes"", multiLine = 10)
            final String Notes) {
        communicationChannel.setNotes(Notes);
        return communicationChannel;
    }
    public <T extends CommunicationChannel<T>> String default0__() {
        return communicationChannel.getNotes();
    }
}
{code}

where the name of the action is ""_"" meaning instead infer the action name from the name of the mixin class, and where the mixin has a constructor of the object being mixed in.
"
ISIS-1211,Improvement,Closed,"Provide no-arg versions of domain events, to avoid boilerplate in the domain applications themselves.","If the no-arg version is used, then the framework sets up the state using setters instead.

(We already had some setters, marked clearly as ""not API, framework use only"", so this follows that precedent)."
ISIS-1210,New Feature,Closed,"Provide an SPI service for handling exception stack traces, rather than just render to the end-user","Could also provide a default implementation that would use the EmailService - if configured - to send an email to the administrator of the system.

Other custom implementations could do such things as automatically raise a ticket in JIRA or other incident logging system."
ISIS-1209,Improvement,Closed,[WON'T FIX] Perform static analysis of all event subscribers so that we suppress the submission of events if we know that there are no subscribers in that type of event.,"... on the basis that - I think - raising so many events is what is causing the framework to be slower than once it was.

Before doing this ticket we should test this theory first, though.

"
ISIS-1208,Bug,Closed,Can't bootstrap without the wicket viewer (issue with Guice / AppManifest),The default binding for AppManifest is in the Isis wicket-specific module; it should instead be in the default module.
ISIS-1207,Improvement,Closed,Extend concurrency checking support for time-stamp based checks (per JDO's @Version annotation),"Currently Isis automatically performs concurrency checking if JDO's @Version(versionStrategy=VERSION_NUMBER), but not for any other strategy.

This ticket is to extend support for timestamp-based version control, ie to be able to use @Version(versionStrategy=DATE_TIME)


http://www.datanucleus.org/products/datanucleus/jdo/transactions.html#optimistic"
ISIS-1206,Improvement,Open,Update the simpleapp to use javacoco and (possibly) failsafe rather than surefire for integration tests.,see http://blog.ccbill.com/2014/07/code-coverage-with-surefire-and-jacoco.html
ISIS-1205,New Feature,Closed,Support @Inject on List<T> or Collection<T>,Borrowing a feature from Naked Objects.NET.
ISIS-1204,Bug,Closed,The title of certain joda dates (eg LocalDate) is incorrect as per container.titleOf(...),... which results in unprintable characters.
ISIS-1203,Bug,Closed,fixture scripts not found unless using an appManifest,"for apps that haven't been converted to using the appManifest, the code to locate fixture scripts (in ClassDiscoveryServiceUsingReflections) incorrectly returns an empty list."
ISIS-1202,Bug,Closed,Mandatory dropdown field doesn't show asterisk ,"Mandatory dropdown fields don't show an asterisk. When you leave the field empty, a wicket message appears telling you that the field is mandatory. This only happens when you have to select an option from a dropdown list."
ISIS-1201,Bug,Closed,autoComplete support fails validation when using Collection<T> as return type,"When using the autoComplete support method for an action with return type Collection<T> the meta model validation reports an error.
It works, however, when using List instead of Collection.

:

################################################ ISIS METAMODEL VALIDATION ERRORS ################################################################

domainapp.dom.simple.Connections#autoComplete0Create: has prefix autoComplete, is probably a supporting method for a property, collection or action.  If the method is intended to be an action, then rename and use @ActionLayout(named=""..."") or ignore completely using @Programmatic

Please inspect the above messages and correct your domain model.

for this:
...
    //region > create (action)
    public static class CreateDomainEvent extends ActionDomainEvent<Connections> {
        public CreateDomainEvent(final Connections source, final Identifier identifier, final Object... arguments) {
            super(source, identifier, arguments);
        }
    }

    @Action(
            domainEvent = CreateDomainEvent.class
    )
    @MemberOrder(sequence = ""3"")
    public Connection create(
            final @ParameterLayout(named=""System A"") System systemA) {
        final Connection obj = container.newTransientInstance(Connection.class);
        obj.setName(systemA.getName());
        obj.setSystemA(systemA);
        container.persistIfNotAlready(obj);
        return obj;
    }

    public Collection<System> autoComplete0Create(@MinLength(value = 1) final String search) {
    
return systems.listAll();
    }
...
}

while using choices instead of autoComplete works fine:

    public Collection<System> choices0Create() {
    
return systems.listAll();
    }
//    public Collection<System> autoComplete0Create(@MinLength(value = 1) final String search) {
//    return systems.listAll();
//    }
"
ISIS-1200,Improvement,Closed,"[DUPLICATE] Improve support for BDD tests, factoring out domain service to act as context.","move the scenarioExecution functionality (getVar, putVar etc to support BDD cucumber steps) into a separate domain service.

 

done as part of Isis 1.16.0, with fix in this release of ISIS-1820"
ISIS-1199,Documentation,Closed,[WON'T FIX] [DOC] Screencast for how facet factories work,"[ObjectSpecification]->*[ObjectMember]
[ObjectMember]^-[ObjectProperty]
[ObjectMember]^-[ObjectCollection]
[ObjectMember]^-[ObjectAction]
[ObjectAction]->*[ObjectActionParameter]



ObjectSpecification someSpec = ...


NamedFacet f = someSpec.getFacet(NamedFacet.class);
String name = f.getName();


DescriptionFacet df = someSpec.getFacet(DescriptionFacet.class);
String df.getDescription();





hide / disable / validate

""see it""   ""use it""   ""do it""



HidingInteractionAdvisor

@Hidden
@Property(hidden=true)
hideXxx()
security

DisablingInteractionAdvisor

ValidatingInteractionAdvisor

List<ObjectSpec> specs = IsisContext.getSpecificationLoader().allSpecifications();

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


package domainapp.app.facets.forbidden;

import java.util.Arrays;
import java.util.List;

import com.google.common.collect.Lists;

import org.apache.isis.applib.events.ValidityEvent;
import org.apache.isis.core.metamodel.adapter.ObjectAdapter;
import org.apache.isis.core.metamodel.facetapi.FacetAbstract;
import org.apache.isis.core.metamodel.facetapi.FacetHolder;
import org.apache.isis.core.metamodel.interactions.ActionArgumentContext;
import org.apache.isis.core.metamodel.interactions.ValidatingInteractionAdvisor;
import org.apache.isis.core.metamodel.interactions.ValidityContext;
import org.apache.isis.core.metamodel.spec.ObjectSpecification;

public class ForbiddenWordsFacet extends FacetAbstract implements ValidatingInteractionAdvisor {

    private List<String> forbiddenStrings = Lists.newArrayList(Arrays.asList(""Fred"", ""Jones""));

    public ForbiddenWordsFacet(
            final FacetHolder holder) {
        super(ForbiddenWordsFacet.class, holder, Derivation.NOT_DERIVED);
    }

    @Override
    public String invalidates(final ValidityContext<? extends ValidityEvent> ic) {
        if (!(ic instanceof ActionArgumentContext)) {
            return null;
        }
        final ActionArgumentContext actionArgumentContext = (ActionArgumentContext) ic;
        ObjectAdapter proposed = actionArgumentContext.getProposed();
        ObjectSpecification specification = proposed.getSpecification();
        Class<?> correspondingClass = specification.getCorrespondingClass();
        if(java.lang.String.class.isAssignableFrom(correspondingClass)) {
            String proposedStr = (String) proposed.getObject();
            for (String s : forbiddenStrings) {
                if(proposedStr.contains(s)) {
                    return String.format(""Cannot contain '%s'"", s);
                }
            }
        }
        return null;
    }
}

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

package domainapp.app.facets.forbidden;

import org.apache.isis.core.metamodel.facetapi.FacetUtil;
import org.apache.isis.core.metamodel.facetapi.FeatureType;
import org.apache.isis.core.metamodel.facets.FacetFactoryAbstract;
import org.apache.isis.core.metamodel.facets.FacetedMethodParameter;

public class ForbiddenWordsFacetFactory extends FacetFactoryAbstract {

    public ForbiddenWordsFacetFactory() {
        super(FeatureType.PARAMETERS_ONLY);
    }

    @Override
    public void processParams(final ProcessParameterContext processParameterContext) {
        FacetedMethodParameter facetHolder = processParameterContext.getFacetHolder();
        ForbiddenWordsFacet facet = new ForbiddenWordsFacet(facetHolder);
        FacetUtil.addFacet(facet);
    }
}





isis.reflector.facets.include=domainapp.app.facets.forbidden.ForbiddenWordsFacetFactory"
ISIS-1198,Documentation,Open,"FAQ articles  on contributions and also aggregate roots vs ""flat"" pattern","Uses of Contributions.

1. to decouple modules

sub use case (a)

example: Documents can be contributed to multiple entities, eg:
- Party
- Lease

naive implementation (without contributions ... we DON'T want to do this):
- Party#getDocuments()
- Lease#getDocuments()


instead, we want Party to not know that there are documents associcated with it; ditto for Lease etc.

on the other hand Document knows that it contributes to other entities:

simple case: Document knows the actual type of the entities that it contributes to..

.. thus:

class DocumentOnPartyContributions {
    List<Document> getDocuments(Party party) { ... }  // would delegate to the DocumentRepository
}

class DocumentOnLeaseContributions {
    List<Document> getDocuments(Lease lease) { ... }  
}


the consequence of this is that the ""document"" module depends on the other modules (""party"", ""lease"" etc).



sub-usecase (b): using interfaces to invert dependencies

what if instead we are happy for the dependency to go the ""other"" way, eg ""party"" does know about ""document""

... could always go back to the original ""naive"" impl of Party#getDocuments()

... or, could introduce DocumentHolder and have Party implement etc, then use a poly query

NOT REALLY SURE THIS BUYS VERY MUCH AT ALL (other than introducing the notion of a ""DocumentHolder"", however that is equally supported just by having:
public interface DocumentHolder { List<Document> getDocuments(); }

and the naive implementation trivially implements this.


sub-use case (c): 
what if we DON'T want the document module to know about the party, and equally we don't want party to know about documents?

so here, we use poly addons

document --- (document, party)  --- party
document --- (document, lease)  --- lease

                 ^^^
    this tuple is the DocumentLink, and ""table of two halves"" means that there are implementations for each subtype


   document      party      lease
       ^           ^          ^
       --- assembly module -----

    
public interface DocumentLink<T> {
    Document getDocument();
    T getDocumentHolder();
}

the tuple implementations are neither in the document nor the party/lease modules, instead they are in a module that depends on both and ""binds"" them together... it's a module whose responsibility is to assemble the various decoupled modules into a working appication.

@PersistenceCapable(NEW_TABLE)
public abstract class DocumentLinkAbstract<T> implements DocumentLink<T> {
    Document getDocument() { // concrete }
}

@PersistenceCapable(NEW_TABLE)
public class DocumentLinkForParty extends DocumentLinkAbstract<Party> {
    Party getDocumentHolder() { // concrete }
}

per the poly pattern, we need a subscriber for each holder type to manage these tuples...

public class DocumentLinkForPartySubscriptions { ... }


to make this visible in the UI

public class DocumentLinkForPartyContributions {

    List<Document> getDocuments(Party party) { ... } // follows the link to the actual Document
}

there are two ways to ""follow the link"", either:
- server-side, ie a JDO query joining DocumentLinkForParty / DocumentLink / Document
- client-side, ie a JDO query to find all the lnks, then do a Guava transform to obtain corresponding Document (1+N perf)


~~~~~~~~~~~~~~

2. for symmetric relationships where uncertain which ""side"" should own the behaviour


related things to say:
- about whether eg BudgetItem should be exposed at all as its own aggregate root
  - ubiquituous language
  - else, is a Budget and a qualifier (ie Charge, in this case)
- if not exposed, whether to have a BudgetItemRepository (more generally, repositories for leaf objects)
  - depends on the cardinality  (number of instances) of the assocation
    - if small number (<30), then just a regular collection
    - if many, then provide an repository as an internal implementation detail of the aggregate root (Budget)
    
    
flat pattern vs aggregate root
- don't sweat it
- if there's only one route to create the ""leaf"", then, yes, put it onto the root
- but otherwise, no probs in pulling out a contributions service to let the leaf be created from different directions
  - newBudgetItem(Budget, Charge)

- within a single module, if there's only ONE parameter being contributed to, then just inline
  - but if two or more, then pull out as a separate contribution so that the system is flexible and does force context
    - ""problem solver > process follower""

    

"
ISIS-1197,Improvement,Closed,Extend the ContributeeMember internal API so that the devutils addon can report on the which service contributes which members,
ISIS-1196,Wish,Open,[Wish] Invoke action by typing its name (ctrl-shift-A in IntelliJ),
ISIS-1195,Task,Closed,Release activities for v1.10.0,Miscellaneous release activities for 1.10.0 release.
ISIS-1194,Improvement,Closed,"Remove dead code, remove support for @Aggregated, for isDirty/clearDirty/markDirty.","removed ResolveState concept, instead derive state from underlying pojo
- services and view models implicitly always persistent

removed support for manual dirtying of objects:
- isDirty
- clearDirty
- markDirty.

removed support for @Aggregated:
- Any @Aggregated will be picked up by the metamodel validation.  
- attempting to call DomainObjectContainer#newAggregatedInstance(...) will throw an exception.
- ObjectAdapter#isAggregated removed
- @Embedded annotation is no longer picked up as aggregated (is simply ignored)

simplified Oid hierarchy
- RootOid
- ParentedCollectionOid

combined OidGenerator and IdentifierGenerator

simplified PersistenceSession, ObjectStore and other supporting components
- removed ObjectStore, now part of PersistenceSession
- removed PojoAdapterFactory, now part of AdapterManager
- removed PersistAlgorithm, now part of PersistenceSession
- removed FrameworkSynchronizer, now part of PersistenceSession
- IsisLifecycleListener is now request-scoped and a subcomponent of PersistenceSession
- ObjectSpecificationDefault no longer instantiates objects, instead this is done by PersistenceSession (remove CreateObjectContext and ObjectInstantiator)
- all subcomponents call back to PersistenceSession which delegates out as necessary 
- no longer have two impementations
- use the DataNucleus impl always (and remove unnecessary interface)


"
ISIS-1193,Bug,Closed,void actions return 404 Not Found when called through restful viewer,"We have  method with this signature:
@Action(semantics = SemanticsOf.IDEMPOTENT)
    public void putTax(
            final String atPath,
            final String reference,
            final String name,
            final String description,
            final @Parameter(optionality = Optionality.OPTIONAL) String externalReference,
            final BigDecimal ratePercentage,
            final LocalDate rateStartDate,
            final @Parameter(optionality = Optionality.OPTIONAL) String rateExternalReference) {
    ...
}

When putting a valid payload on the endpoint the viewer returns a 404 Not Found. Since the payload is processed correctly expect a 200 OK.  
"
ISIS-1192,Improvement,Closed,[WON'T FIX] Use CDI to wire up Isis components.,
ISIS-1191,Improvement,Closed,Broken links,Fixing some broken links in the asciidoc documentation
ISIS-1190,Bug,Closed,"If an referenced object cannot be loaded (not found in the database), then this should be handled gracefully","ie set the reference to null, rather than a big scary stacktrace."
ISIS-1189,Improvement,Closed,Autocomplete and choices should filter results so that hidden objects are not shown.,"In particular this relates to multi-tenancy support as per Isis addons security module (TenantedAuthorizationFacet). 

A well-designed application should pre-filter, so that only objects that are valid for a user to see are shown in a drop-down.  However, as a fail-safe, the metamodel should automatically filter out any objects to which the user does not have permission.

Note: this is very similar to ISIS-1044."
ISIS-1188,Improvement,Closed,Refactoring/simplifying internals.,IsisSystemAbstract etc.
ISIS-1187,Task,Closed,Mothball the legacy (never documented) integration testing support,"... that defines tests using @Service, @Fixture, @Persistor and similar annotations."
ISIS-1186,Improvement,Closed,Use different classpath scanner to reduce time to boot.,"This was originally raised at ISIS-1182, but the change has been backed out due to subsequent issues.  ISIS-1182 now references the other minor refactorings that were done alongside the original change."
ISIS-1185,Bug,Closed,[CAN'T REPRODUCE] 'Ok' and 'Cancel' buttons in edit mode are both appearing as 'Submit Query',
ISIS-1184,Improvement,Closed,"Auto-inject services into Specification, ie @Property(mustSatisfy=...) etc",
ISIS-1183,Bug,Closed, Copying a property value in view mode doesn't work in Firefox on Windows ,"An input control in view mode cannot have its text selected like other parts of the UI can in Firefox. It has the css cursor:'not-allowed', but no text is highlighted when you click and drag the cursor across it."
ISIS-1182,Improvement,Closed,Refactorings of the management of domain services; slightly simplified classpath scanning.,"Originally this ticket was to use different classpath scanner to reduce time to boot.  However, subsequent issues (eg failing to run under jetty:run) mean that the change has been backed out.

Instead this ticket relates only to the other minor refactorings that were done to clean up the management of domain services; namely that this is held by the ServicesInjectorDefault object throughout, which also performs validation of services.

A new ticket, ISIS-1186, has been raised for the use of the fast-classpath-scanner, if the original issues can be resolved."
ISIS-1181,Bug,Closed,Isis Documentaion - broken link,"There is a broken link under name  ""simpleapp archetype:""  in the main page https://isis.apache.org/

......
Getting started

Start developing your own Apache Isis application using our simpleapp archetype:
..............."
ISIS-1180,Improvement,Closed,Make it possible to declare some object type properties display as values only,"Essentially this is a suggestion to emulate the <select> tag in HTML, where you define as child elements <option> tags, these will have a value and a name, the value is the key, the name is what the user sees in the select list. 

In Isis its sensible to manage these binary objects in the same way as all other persistent entities are, but to display the selected value simply as text and not as a link.

By defining these types using another DomainObject category they can be used via an injected domain service (maybe: @DomainService(nature=NatureOfService.REFERENCE).

A possible further enhancement is to have the capacity for nesting of these types. This would then provide for classification hierarchies to be defined and used. When sending messages to external systems often such systems define catalogues in a hierarchical manner, often provided as XML, building a message requires navigating the hierarchy to find a specific item (leaf node). This suggestion is aimed to provide a means of injesting such XML into Apache Isis, maybe after some simple XSLT transformation.

Such data is usually very static and of small quantity, so it can be loaded once into a singleton and kept in global memory."
ISIS-1179,Bug,Closed,Prevent the defaultXxx(...) being called multiple times when invoke an action.,"Looking into the code, we seem to call reset() - which is the method that utlimately calls the defaultXxx() methods - twice, once when we construct the ScalarModel and then again later when we make a call to clearArgs.

Seems to be easy enough to call it just once."
ISIS-1178,Task,Closed,"Mothball the TCK tests, with a view to replacing them by new tests in the isisaddons isis-app-kitchensink","The TCK tests have been excluded for a while (perhaps in 1.8.0, certainly 1.9.0-SNAPSHOT) because they are too fragile to maintain.

Part of the reason for that is that they use the old in-memory object store.

Having them in the codebase is confusing because there's an expectation that they will pass, eg: this message to http://markmail.org/message/qi23ssz63m7rr57t.

Instead, we should start to rewrite the TCK usingthe isis-app-kitchensink (part of Isis addons)."
ISIS-1177,Bug,Closed,Deserialization using RO applib fails in Jackson library,"It would appear that (as a result of an upgrade to Jackson, in 1.8.0 I think) that it is no longer possible to deserialize directly into our representation classes (eg HomeRepresentation, VersionRepresentation).

Each of these expose a constructor accepting a single org.codehaus.jackson.JsonNode, and Jackson now says it's looking for a default constructor.

See http://markmail.org/message/qi23ssz63m7rr57t.

One possible fix is to deserialize into a JsonNode, and then manually instantiate the representation class manually. 
"
ISIS-1176,New Feature,Closed,Provide the capability to push notification messages to end-users without refreshing (using web sockets or Atmosphere etc).,"For example, if an end-user submits a long-running job, then the action should acknowledge the request.  When the job completes then we should provide a mechanism to notify the user (if they are using the system).

~~~~~~~~
(Jul 2015, Dan):
One likely technology will be web sockets or Atmosphere; Wicket integrates with both.

(Oct 2016, Martin on mailing list suggested):
The simplest way is to use AbstractTimerAjaxBehavior/AjaxSelfUpdatingBehavior. This would do polling,
i.e. every N seconds an Ajax call will be made to check whether there is new data to show.

If you need to do server push, i.e. whenever new data comes to push it immediately to the client then I'd suggest Wicket Native WebSocket instead of Atmosphere. Nowadays all browsers support WebSocket (IE10+ and all others) and almost everyone deploys on web server that support JSR 356 - https://ci.apache.org/projects/wicket/guide/7.x/guide/nativewebsockets.html.
It's usage is as easy as Wicket Ajax.

Another option is Server Send Events (https://github.com/wicketstuff/core/tree/master/wicket-html5-parent/wicket-html5)
demo: https://github.com/wicketstuff/core/tree/master/wicket-html5-parent/wicket-html5-examples/src/main/java/org/wicketstuff/html5/eventsource

~~~~~~~~~~~~

One possible design is a persisted entity to hold the messages, keyed by (username, datetime).  We could then have a service that a completing action could call, to save the message.

This service could check if the user is currently logged on, and if so could notify the user via Atmosphere or similar.

I also think it might be nice if the Wicket UI could provide a way for the user to view the last 5 (say) messages, a bit like a notificatoin center.  I think that Mac does this, and Windows 10 will do,  Thus, if the user is *not* logged on when the job completes, then we can still bring the notification message to their attention when they next log on.

Perhaps this could be added as a button on the footer bar?  And/or the messages could slide in from this footer bar.  (This is the way that the MS Azure portal works, and it's not too unpleasant).

"
ISIS-1175,Bug,Closed,Wicket viewer separators go missing when force refresh page (eg ctrl-R),
ISIS-1174,Bug,Closed,"In RO, posting to the ObjectsOfType resource (section 9) fails.","The code is simply incorrect ... it attempts to parse the JSON as a list, rather than a map."
ISIS-1173,Improvement,Closed,"Split out responsibilities of FixtureScript class so that framework can provide a default implementation, and be configured through an alternative.","As per mailing list discussion, 15~17 July 2015"
ISIS-1172,Bug,Closed,Logo in wicket viewer should be calculated relative to context root,"{code}
bind(String.class).annotatedWith(Names.named(""brandLogoHeader""))
.toInstance(""/images/knife-logo-header.png"");
{code}
doesn't work for me. I had to specify ""/sdm-webapp/images/knife-logo-header.png"".

Tried. using ""images/knife-logo-header.png"" (-)
Compared generated the simple app from the maven archetype and diffed my web.xml against the generated and adopted my web.xml to match my SimpleApplication package name. (-) 

Analysis by Martin:
Wicket automatically calculates the context relative path for plain HTML <img> elements in your markup.
In the current case the <img> element is connected to a Java component, i.e. it has wicket:id attribute, and that's why Wicket doesn't apply any special logic on it.
IMO we should improve Isis to always calculate context relative path for the logo url.

"
ISIS-1171,Improvement,Closed,"If DN autoCreate is missing, don't default to ""true"", instead default to ""false"".","With the current 1.8.0 behaviour, if an application did not specify the ""datanucleus.autoCreateSchema"" property (eg due to a typo), then the framework would default this property to ""true"".   This could result in the target database being modified.

So, instead, we should default this to ""false"", to avoid such accidents. Note that in 1.9.0 the name of this property changes to ""datanucleus.schema.autoCreateAll"", but the intent is the same.

~~~
Also, note that there is similar functionality for validation; ""datanucleus.autoValidateAll"" is defaulted to true if missing.  This behaviour does _not_ need to change as their are no ill side-effects.  NB: in 1.9.0 note that the name of this property changes to ""datanucleus.schema.autoValidateAll"".


"
ISIS-1170,Improvement,Closed,Throw a better exception if an class (through programmer error) has no properties.,"Currently the Wicket viewer will throw an ""unauthorized exception"".  This makes sense when the object has properties (or collections) but the current user is not authorized to view any of them.

However, if the domain programmer has made a mistake and the class itself actually has no properties or collections at all (eg they forgot to add getters) then we should throw a more meaningful exception to help the programmer realize their mistake."
ISIS-1169,Improvement,Closed,"Simplify IsisSessionFilter, make more resilient to possible leakage of IsisSession on thread-local, also allow RO to force a logout","This ticket has been prompted by a report from Nacho [1] about a session being left open.   Note that Nacho's app (working with Oscar Bou) doesn't use the wicket viewer, instead they have their own proprietary viewer based on Wavemaker.

Even so, for normal operation the IsisSessionFilter is used for the Restful Objects API, so this issue could arise more widely.

Nacho suggested a possible small improvement, though he reported that didn't completely fix the issue.  Looking into the code in more detail, it would seem that the issue can arise if the closeSession() is not called somehow, perhaps from an NPE or other RuntimeException being thrown.

Also looking at IsisSessionFilter, it seems that this code is more complex than required; the SessionState enum only ever takes the value of UNDEFINED.  So this can be simplified.

At the same time (mostly for testing this but also since it is overdue) this seems like a good opportunity to introduce the ability to ""logout"" of RO.  After some experimentation, have decided to implement by introducing a new non-standard /user/logout resource to RO, and using redirect and a special query string to tell the IsisSessionFilter to respond with a 401.  It doesn't seem to be possible to do better than this for a pure server-side solution (see eg [2])

I've also decided - belt and braces - to get rid of the fail-fast EXPLICIT_CLOSE policy for SessionClosePolicy and instead always use AUTO_CLOSE.  That way if - for some reason - the session is left open on a thread, then it will be automatically closed the next time that thread is reused.  If my above refactoring is ok then this should never happen, but I'm taking the view that I'd rather the code is resilient to a bug elsewhere (and live with a bit of memory leakage) than to blow up (as it currently does).

[1] http://isis.markmail.org/thread/2dn7tja3r466yd2m
[2] http://stackoverflow.com/questions/233507/how-to-log-out-user-from-web-site-using-basic-authentication"
ISIS-1168,Bug,Closed,Eagerly register entities with DataNucleus objectstore (for Neo4j),"The approach currently used (RegisterEntities to find all domain entities from classpath) does not seem to be working any more, seemingly because there are some (additional?) DN properties that also need to be specified when bootstrapping the DN PersistenceManagerFactory.

This is causing the isisaddons neoapp github.com/isisaddons/isis-app-neoapp) to incorrectly initialize.

see http://www.datanucleus.org/products/datanucleus/jdo/autostart.html

UPDATE: if attempt to eagerly register, then our MetadataListener does not fire for any auto-start entities.  Have therefore reverted to only autoStart if connecting to Neo4j (ie, a hack).

Meantime, I have raised NUCCORE-1328 [1] and NUCCORE-1329 [2]; if first fixed then can go back to eagerly loading metadata for RDBMS, if second fixed then can get rid of Isis' implementation of creating the DB schema object and instead rely on DN.

[1] http://www.datanucleus.org/servlet/jira/browse/NUCCORE-1328 
[2] http://www.datanucleus.org/servlet/jira/browse/NUCCORE-1329 
"
ISIS-1167,New Feature,Closed,NullPrintStream in unittestsupport to reduce the noise of unit tests that log to stdout or stderr,
ISIS-1166,New Feature,Closed,Support for unit testing using SOAP fake servers,eg as used by https://github.com/isisaddons/isis-module-publishmq
ISIS-1165,New Feature,Closed,"""Schema"" module to support integration scenarios.","For now, just a new 'schema' module that defines common XSD and also an XSD for action invocations.  

Eventually (probably not 1.9.0 release) this will evolve into a replacement for the ActionInvocationMemento, as defined by the background service.

To be used by isis addons' isis-module-publishmq for messages (the code in isis-module-publishmq will probably also move into isis core once it's known to be stable)."
ISIS-1164,New Feature,Closed,"For RO viewer content negotiation (via XRoDomainType), if in prototype mode then pretty-print.",And add a configuration property to override one way or the other.
ISIS-1163,Dependency upgrade,Closed,Update Jetty (as used by our IsisWebServer launcher) to 9.x,
ISIS-1162,Improvement,Closed,"For Shiro Realm,Make LDAP attributes as permision generator","Add attribute for permission ldap extraction 

I propose new permisions creation from LDAP attribute
Alternatively, permissions can be extracted from the base itself with the parameter searchUserBase,
the attribute list as userExtractedAttribute and the permission url as permissionByUserAttribute.
The idea is to extract attribute from the user or the group of the user and map directly to permission rule in replacing the string {attribute} by the extracted attribute (can me multiple).
See the sample for group and user attribute and mapping:
ldapRealm.searchUserBase = ou=users,o=mojo
ldapRealm.userObjectClass=inetOrgPerson
ldapRealm.userObjectClass=organizationnalPerson
ldapRealm.groupExtractedAttribute=street,country
ldapRealm.userExtractedAttribute=street,country
ldapRealm.permissionByGroupAttribute=attribute:Folder.{street}:Read,attribute:Portfolio.{country}
ldapRealm.permissionByUserAttribute=attribute:Folder.{street}:Read,attribute:Portfolio.{country}"
ISIS-1161,Improvement,Closed,Allow member group (per @Member(name=...) to be internationalized,
ISIS-1160,Improvement,Closed,Allow RO viewer to consume any media type (HTTP Accept),To better support the new ContentNegotiationService and ContentMappingService.
ISIS-1159,New Feature,Closed,"Make ExceptionRecognizerCompositeForJdoObjectStore into a @DomainService, so automatically registered.","Unlike most services, all registered exception recognizers are consulted whenever an exception is thrown.  It therefore isn't possible to override/ignore a exception recognizer that (as this ticket proposes) has been annotated with @DomainService.

To cater for the (probably rather remote) possibility that these default exception recognizers might need to be disabled, introduce a config property to switch 'em off:

isis.services.ExceptionRecognizerCompositeForJdoObjectStore.disable"
ISIS-1158,Improvement,Closed,Extend o.a.i.applib.spec.Specification to support i18n,
ISIS-1157,Improvement,Closed,Cache safe Actions results by annotating them,"As discussed on the Isis mailing list [1].

Currently, there's service called QueryResultsCache [2] that allows to cache the results of an Action/method invocation.

We want to introduce this capability for Safe Actions by simply annotating them.

Current proposal is to extend the ""SemanticsOf"" annotation param with a new type: SemanticsOf.SAFE_AND_REQUEST_CACHED

A usage example would be:
 
{code}
    @Override
    @Action(semantics = SemanticsOf.SAFE_AND_REQUEST_CACHED)
    public SortedSet<IESG> relevantSnpGenotypes(final IE inputElement,
            final Kit kit) {
        if (kit != null) {
            return kit.findAllAssociatedSNPGenotypesForInputElement(inputElement, AlgorithmImplementation.this.IESGClass);
        } else {
            return Sets.newTreeSet();
        }
    }

{code}


[1] http://mail-archives.apache.org/mod_mbox/isis-users/201505.mbox/%3C575DA9CB-14E6-4DD0-9565-C03C759BD20E@gesconsultor.com%3E

[2] https://isis.apache.org/reference/services/query-results-cache.html

"
ISIS-1156,Improvement,Closed,[WON'T FIX] [DUPLICATE] validate() should be called and enforced when invoking an action.,"See discussion in ISIS-1155.

It ought to be possible to use memento within ActionInvocationFacet. "
ISIS-1155,Bug,Closed,validate() vetoing - requiring rollback via the memento when editing - causes a ConcurrencyException to occur.,"For example, in the isisaddons' todoapp this shows up as an issue if mark an item (with a non-null dueBy) as done, then attempt to modify the dueBy date via edit.  What we see is no message shown, followed then by an invalid concurrency exception.

With the simpleapp it's possible to get a similar behaviour.

~~~
On analysis, there are several issues:
- the concurrency exception is caused by the todo item becoming dirty when the change is applied (prior to being rolled back via Isis' memento); the todo item's adapter's Oid's version is updated as a side-effect of this (the postStore lifecycle callback), and thereafter we see the concurrency exception
- this can in some cases be suppressed (eg for the simpleapp) by performing a rollback of the xactn if the validate() has failed... this should be done anyway
- however in more complex cases (such as todoapp) the updating of the setVersion happens during the ""apply()"" of changes, which will still trigger the subsequent concurrency exception
- the root cause here is that the memento being taken does not also reinstate the version of the target object.
- the wicket viewer's EntityPropertiesForm was not passing through an AjaxRequestTarget for repainting [nb: this may be a red-herring, but fixing this does no harm]

So, to sum up the fixes:
- abort the xactn if validate() vetoes the save
- improve the memento so that version is reinstated
- pass through AjaxRequestTarget

~~~~~~~~

Note that there is a related, not yet tackled issue... namely that validate() isn't enforced for action invocations, only when modifying an object by editing.  Have raised ISIS-1156 for this."
ISIS-1154,Improvement,Closed,Extend ActionDomainEvent and PublishingService's EventMetaData to include info on the action parameter names/types.,"to provide better metadata to PublishingService implementations.

(Specifically this is being driven by Isis addons' isis-module-publishmq)."
ISIS-1153,Improvement,Closed,Upgrade to DN 4.1,"DataNucleus 4.1 is released. The upgrade path to this version is likely a simple change of jar version number. Migration process is listed at
http://www.datanucleus.org/products/accessplatform_4_1/migration.html
and I doubt that any of the 4.0 -> 4.1 items would apply to ISIS.

Note : you WILL need to re-enhance any persistable classes to use this new release (since it makes a very minor change to the bytecode enhancement contract)."
ISIS-1152,Improvement,Closed,"Allow domain services to be registered ""late"" to the event bus","Useful for writing unit tests, where want to ""new"" up a subscriber after the Isis runtime has been bootstrapped.

To minimize regressions in anyone's production code, will hide this behaviour behind a configuration property.  Automatically enable for integ tests, but disable otherwise."
ISIS-1151,Improvement,Closed,Allow the default view of a collection to be set,Currently a collection defaults to the table view. I'd like to be able to set a different view (e.g. the calendar) to default. Perhaps via @CollectionLayout? 
ISIS-1150,Improvement,Closed,Retire the InMemoryObjectStore,"Instead, should just use the DataNucleusObjectStore (configured with in-memory HSQLDB or H2 if required).

One important reason we should remove this objectstore is that the semantics/behaviour on the domain objects differs.  For example, using DN bidirectional associations are automatically managed; this isn't the case with the in-memory objectstore.

Moreover, if an app becomes too big thus the integ tests become too slow, then the developer should modularize and decouple their app such that individual parts can be worked on independently.  Having an in-memory objectstore dissuades the developer from ""doing the right thing""."
ISIS-1149,New Feature,Closed,New ContentNegotiationService and ContentMappingService SPIs for Restful Objects viewer,"The ContentNegotiationService SPI allows multiple implementations to be installed, and each are checked in turn (chain of responsibility pattern).  If any can generate a representation of the result then this is used rather than the default RepresentationService.

The framework provides one default implementation: ContentNegotiationServiceXRoDomainType that handles ""application/...;profile=...;x-ro-domain-type=...""  for either XML or JSON, and for the main representations (object, property, collection, detail, action-result)

As a further sub-SPI, the ContentMappingService is used by the afore-mentioned ContentNegotiationServiceXRoDomainType to attempt to map the result domain object to another object before rendering.  Typically this is to map a domain object to a corresponding DTO.

"
ISIS-1148,New Feature,Closed,Extend DomainObjectContainer to allow services to be looked up,ie service locator as well as dependency injection
ISIS-1147,New Feature,Closed,Provide API in IsisJdoSupport to execute typesafe queries,Using DataNucleus' (proprietary) Q* type-safe classes.
ISIS-1146,Improvement,Closed,Automatically ignore @PostConstruct and @PreDestroy methods from the metamodel.,
ISIS-1145,New Feature,Closed,REST action invocations support limited conneg to JAXB-marshalled DTOs,"invoking any of the action/invoke resources (in the usual fashion) with an Accept header of

""application/xml;profile=urn:org.restfulobjects:repr-types/action-result;x-ro-domain-type=todoapp.dto.module.todoitem.ToDoItemDto""

will check that the returned object is of the specified type, and return it as XML payload.

Otherwise will return a 406.

If there is no Accept header or is ""application/json"", then retain original behaviour."
ISIS-1144,New Feature,Closed,"New ""NatureOfService"" to restrict domain services to be visible in the REST API (Restful Objects viewer) but not in the Wicket viewer.",
ISIS-1143,New Feature,Closed,MetaModelService to provide formal access to certain (restricted) aspects of the Isis metamodel,"... to start with, just lookup/reverse lookup of objectType, ie: @DomainObject(objectType=...) and equivalently."
ISIS-1142,Bug,Closed,FrameworkSynchronizer should handle case of adapter already marked as destroyed,"The FrameworkSynchronizer aims to keep Isis' internal ResolveState in sync with the actual persistence state of the pojos.  (One day we'll get rid of all this, just not yet).

In the meantime, in the postLoad callback, it's possible that the adapter has already been marked as destroyed, eg:
- the object was deleted in an action (ie queued a DestroyCommand
- subscriber on the action performed a post-execute which ran a query
- running the query flushed the command, causing the pojo to be deleted and its adapter to be set to destroyed
- in the commit, DN's clean up of query results causes pending pojos in result set to be resolved, triggering the postLoad callback method for a pojo that was deleted

We should therefore guard for the situation that the adapter is already set to be Destroyed.
"
ISIS-1141,Improvement,Closed,Integration tests should honour isis.reflector.facets.include and isis.reflector.facets.exclude for extending the programming model,
ISIS-1140,Dependency upgrade,Closed,"Now that JDK7 is eol, we should build using Java8; retain source and target compiler level set to 1.7.","ie
- mvn-enforcer-plugin require JDK to be 1.8 (previously was 1.6.0_11)
- mvn-compiler-plugin source and target = 1.7 (unchanged)

"
ISIS-1139,Improvement,Closed,"Make it clear that ObjectContracts.compare() is slow, and should mostly be used for prototyping.",
ISIS-1138,Bug,Closed,Not able to use PropertyDomainEvents for custom value types (eg gmap3's Location),"The issue is that the string representation of the object is not converted into its value type, and thus the constructor cannot be located.

In particular, the code in IsisConverterLocator is not called.

~~~
The workaround is to use a more general class as the event type (eg PropertyDomainEvent) and then do an instanceof in the subscriber.
"
ISIS-1137,Bug,Closed,PermGen errors through WrapperFactory (javassist),"as per Oscar's report on the mailing list, see http://markmail.org/message/ilow6jkg5iuxbzis

Looking at the code, it does seem that we are leaking memory by not holding the ProxyFactory class [1] (we create a new instance each time).

The Javadoc [2] does suggest that these should be cached (it is the deafult).

One subtlety: the ProxyFactory is per class being enhanced.  So we actually need to hold a cache of these.  But at least then we will only get one extra enhanced class in the permgen per type, rather than per instance (as at the moment).

~~~
While we are here, we should probably delete the cglib support, and do some inlining of redundant interfaces.


[1] https://github.com/apache/isis/blob/dec670567ce96fa96fe89c8111c6dbca35b3ed3b/core/wrapper/src/main/java/org/apache/isis/core/wrapper/proxy/ProxyInstantiatorForJavassist.java#L62
[2] http://www.csg.ci.i.u-tokyo.ac.jp/~chiba/javassist/html/javassist/util/proxy/ProxyFactory.html"
ISIS-1136,Improvement,Closed,Use maven-javadoc-plugin with doclet apiviz to generate javadoc with diagrams,see https://code.google.com/p/apiviz/ and http://docs.jboss.org/netty/3.0/api/
ISIS-1135,Bug,Closed,Make a copy of the PojoAdapter and OidAdapter maps for debugging purposes ,As discussed at http://markmail.org/message/fgfb3yxkafamgjs2 the adapter maps should be cloned before iterating over them because it leads to ConcurrentModificationException.
ISIS-1134,Bug,Closed,DN connections leak due to non-closed queries (?!),"My application failed twice with OutOfMemoryError in heap space so I've dumped a .hprof of its memory (jmap -dump:format=b,file=some-file.hprof) and analyzed it with Eclipse MAT (https://eclipse.org/mat/).
It appears that there are many org.datanucleus.store.rdbms.query.JDOQLQuery$2 objects.
JDOQLQuery$2 appears to be ManagedConnectionResourceListener ( https://github.com/datanucleus/datanucleus-rdbms/blob/651c77ff3b2af76ada97d14b537cd41fb0524a0c/src/java/org/datanucleus/store/rdbms/query/JDOQLQuery.java#L740).
The listener is removed only when org.datanucleus.store.query.AbstractQueryResult#close() method is called.

org.apache.isis.objectstore.jdo.datanucleus.persistence.queries.PersistenceQueryFindAllInstancesProcessor#process() does:

{code}
final List<?> pojos = (List<?>) jdoQuery.execute();
return loadAdapters(specification, pojos);
{code}

So it consumes the result and returns ObjectAdapter for each pojo but it doesn't close the Query.
AFAIK open-session-in-view pattern is not used in Isis so the resources should be closed explicitly after usage.
A simple solution is to try/finally this code and close the query but I may miss some detail here.

Related: recently I've profiled the application with Yourkit and it showed that DomainObjectContainer#allMatches() method is slow in one of the use cases. Some quick investigation showed that DomainObjectContainer delegates the work to org.apache.isis.objectstore.jdo.datanucleus.persistence.queries.PersistenceQueryProcessor#process(). It loads the POJOs from the DB, then wraps them in ObjectAdapters, and finally org.apache.isis.core.metamodel.services.container.DomainObjectContainerDefault#allMatches(org.apache.isis.applib.query.Query<T>) unwraps them back to POJOs.
Why this is done?
This solves the issue of ""consume the QueryResult before closing it"" for the memory leak issue but it also adds to the processing time."
ISIS-1133,Improvement,Closed,"Convert website to asciidoctor, hosted in git and published via ASF's svnpubsub","Asciidoctor can be found here [1].

Some reasons for doing this:
- the source code for the website will be in git (rather than svn as currently), and so will be mirrored to github.  Therefore users/contributors can fork our repo and submit pull requests on the docs/website.
- the generated content can be previewed locally; ASF's svnpubsub infrastructure is used only for publishing/hosting the site
  - there are also some doubts about svnpubsub's long-term future, so we should minimize our dependence on it if possible
- the toolchain seems to exist already and is in use by at least one other ASF project - Deltaspike [2] - who have got the toolchain to work.  (Wicket are also experimenting, [3])
- the generated pages are themeable either using Foundation (the default) or using Bootstrap .
- github natively understands asciidoc (.adoc) files, and are enthusiastic supporters (see this article of Scott Chacon, [4])
- there are editors for Asciidoctor, eg [5]
- longer term, it's possible that the docs could be converted into a book, eg using O'Reilly's Atlas platform [6]

Good starting points:
- the DeltaSpike pom.xml's.   They seem to have two separate regions; the top-level site [7a,7b], and a ""documentation"" subfolder [8a,8b]
  - these use the asciidoctor-maven-plugin [9] to convert the .adoc files to .html
  - these use the maven-scm-publish-plugin [10] to update the SVN (do all necessary add/deletes to properly synchronize)
- there are also some useful templates (integrated with mvn site) at [11]
- theming with Bootstrap might be done using any of  [12] or [13a, 13b] (latter is asciidoc not asciidoctor so might require some fiddling around with).


[1] http://asciidoctor.org/
[2] http://deltaspike.apache.org/
[3] https://github.com/dashorst/wicketguide
[4] https://medium.com/@chacon/living-the-future-of-technical-writing-2f368bd0a272
[5] https://github.com/asciidoctor/atom-asciidoc-preview
[6] https://atlas.oreilly.com/
[7a] https://github.com/apache/deltaspike/blob/master/site
[7b] https://github.com/apache/deltaspike/blob/master/site/pom.xml
[8a] https://github.com/apache/deltaspike/tree/master/documentation
[8b] https://github.com/apache/deltaspike/tree/master/documentation/pom.xml
[9] http://asciidoctor.org/docs/asciidoctor-maven-plugin/
[10] https://maven.apache.org/plugins/maven-scm-publish-plugin/
[11] https://github.com/asciidoctor/asciidoctor-maven-examples
[12] https://github.com/nerk/asciidoctor-bs-themes
[13a] https://github.com/llaville/asciidoc-bootstrap-backend
[13b] http://laurent-laville.org/asciidoc/bootstrap/
"
ISIS-1132,Bug,Closed,possible timezone issues when refresh page in Wicket viewer.,"The issue is reproducible in the latest kitchensink demo application which uses Isis 1.8.0.

When a form page is opened and the URL in the browser is like - "".../wicket/entity?15"" and the page is refreshed, following happens:
  - All ""org.joda.time.DateTime"" fields are changed, so they have ""03:00"" at the end. (ex. It was ...00:00 and becomes ...03:00)
  - The splitters in the menus disappear.
I suppose there can be some other issues too.

The URL becomes like "".../wicket/entity?15"" after a form is edited or if you click for example on the ""First DateObject"" menu item in kitchensink app. If the URL is like "".../wicket/entity/DATE:L_0"" it works normally.
"
ISIS-1131,New Feature,Closed,FakeDataService to simplify unit and integration testing.,
ISIS-1130,Improvement,Closed,Add #isEnabled() method to services based on Wicket,"Some **Wicket services used the Application to do their job, e.g. GuiceBeanProvider"" so they cannot be used in integration tests.
Other services depend on RequestCycle being available, e.g. DeepLinkService. Such kind of services cannot be used during application start and/or integration tests.

There are several options:
- return null
- throw exception
- add #isEnabled() method
- ... ?!"
ISIS-1129,New Feature,Closed,SudoService to allow the current user to be temporarily switched (for fixture scripts and integ tests),
ISIS-1128,Bug,Closed,'namedEscaped' is broken when 'named' comes from a translation.po,"I have a property:
{code}
@MemberOrder(sequence = ""070"")
    @Column(allowsNull = ""true"")
    @PropertyLayout(hidden = Where.ALL_TABLES, namedEscaped = false)
    public Boolean getAcceptUsingData() {
        return this.acceptUsingData;
    }
{code}

and a translation:
{code}
#: com.tellmegen.domain.model.kits.Kit#acceptUsingData
msgid ""Accept Using Data""
msgstr ""<a href=\""#\"">Acepta la utilización de sus datos para la investigación</a>""
{code}

It seems 'namedEscaped' has no effect now. "
ISIS-1127,Improvement,Closed,Allow FormGroup component to be able to be used with several sub form components,"At the moment a FormGroup (<div class=""form-group"") could be used only with a single child form component.
It would be good if it could be used with several children form components which share a single <label class=""control-label"">."
ISIS-1126,Improvement,Closed,Improve deserialization logic in RO applib.,
ISIS-1125,Bug,Closed,Spurious WARN messages for translation messages of contributed actions,"We think that Isis is attempting to find translations for non-existent methods...

transcript below from Martin Grigorov while debugging an application...

... was searching for ""Account@findOrderByEmail()""

confused at org.apache.isis.core.metamodel.facets.all.i18n.TranslationFacetFactory#process(org.apache.isis.core.metamodel.facets.ContributeeMemberFacetFactory.ProcessContributeeMemberContext)
final String context = holder.getIdentifier().toClassAndNameIdentityString();
the holder is about Orders#findOrderByEmail()

but in -es.po I have:

#: com.tellmegen.domain.model.accounts.Account#findOrderByEmail()
#: com.tellmegen.domain.model.order.Orders#findOrderByEmail()
msgid ""Find Order By Email""
msgstr ""Encontrar pedido por email""

and final String context = holder.getIdentifier().toClassAndNameIdentityString(); calculates context with Account

the only problem I see is that it logs a WARN
let me see what I have for Orders

it works fine for Orders
so the only problem seems to be that an entry is added to the runtime POT and later Isis dumps a WARN that that there is no translation
but:
1) there is a translation
2) there is no such method in Account
"
ISIS-1124,Improvement,Closed,Add the simple name of the domain entity as a CSS class next to 'entityPage' for easier custom styling,"At the moment EntityPage.html has a <div class=""entityPage""> that demarcates where EntityPage content starts.
It would be nice if it also adds the simple name of the entity class next to 'entityPage' for better CSS selectors"
ISIS-1123,Improvement,Closed,Allow the member group label for properties to be translated.,
ISIS-1122,Improvement,Closed,Security: allow to filter objects in Collections at the core level,"Currently, security filtering for objects in Collections is implemented at the Wicket viewer level.

If implemented at the core level, it might allow to use this capability by all viewers, and also on integration tests.

But there are some restictions in implementation:
- By default, the security filtering must be applied (i.e., when returning them by finders? when invoking it inside a ""wrapped"" call?).
- But there are use cases when the unfiltered collection must be needed at the Domain level (i.e., for validating results among the complete list. I have a use case when, in the context of an authentication session, an existing Kit must be associated with an Account. That Account does not have access to Kits not associated to himself. But for the initial association I must access the unfiltered list)."
ISIS-1121,Improvement,Closed,Integ Tests: allow them to simulate a new Authentication Session,"There are some integration tests where the authentication context used can be relevant (i.e., for testing Application Tenancy configured through the Isis Security Add-on)."
ISIS-1120,Improvement,Closed,Hide the colon separating icon and title in modal window when there is no icon,If an action has no icon then the colon used as a separator between the icon and the title should be hidden too.
ISIS-1119,Bug,Closed,Bi-Directional 1-1 rel. throws MetaModelException if invoking setter with @Persistent(mappedBy=),"I have 2 bi-directional entities with properties defined as:

Entity 1 property:


{code:java}

public class Kit {

    // {{ RegisteredForPerson (property)
    private Person registeredForPerson;

    // Must be updated through the Action !!!
    @Property(editing = Editing.DISABLED)
    @MemberOrder(sequence = ""1"")
    @Column(allowsNull = ""true"")
    public Person getRegisteredForPerson() {
        return this.registeredForPerson;
    }

    public void setRegisteredForPerson(final Person registeredForPerson) {
        this.registeredForPerson = registeredForPerson;
    }

    // }}

}
{code}

Entity 2 property:

{code:java}

public class Person {

    // {{ RegisteredKit (property)
    private Kit registeredKit;

    @MemberOrder(sequence = ""010"")
    @Property(editing = Editing.DISABLED)
    @Column(allowsNull = ""true"")
    @Persistent(mappedBy = ""registeredForPerson"")
    public Kit getRegisteredKit() {
        return this.registeredKit;
    }

    public void setRegisteredKit(final Kit registeredKit) {
        this.registeredKit = registeredKit;
    }

    // }}

}
{code}

As per [1], seems DataNucleus require bi-directional 1-1 relationships to be maintained at both sides by the programmer (they're not automatically managed).

[1] http://www.datanucleus.org/products/datanucleus/jdo/orm/one_to_one.html#bi


So I must set both sides:

{code:java}
            this.setRegisteredKit(kit);

            // A 1-1 bi-directional relationship must be maintained at both
            // sides, as per:
            // http://www.datanucleus.org/products/datanucleus/jdo/orm/one_to_one.html#bi
            kit.setRegisteredForPerson(this);

{code}




But that generates an StackOverflowException, when executing the first setter:

{code:java}
            this.setRegisteredKit(kit);

{code}


Same exception happens also if the setters order is inverted. So it's a matter of executing the setter annotated with @Persistent(mappedBy="""")

{code:java}

            // A 1-1 bi-directional relationship must be maintained at both
            // sides, as per:
            // http://www.datanucleus.org/products/datanucleus/jdo/orm/one_to_one.html#bi
            kit.setRegisteredForPerson(this);

            // Will fail when executing this next setter, now:
            this.setRegisteredKit(kit);

{code}


java.lang.RuntimeException: org.apache.isis.core.metamodel.exceptions.MetaModelException: java.lang.StackOverflowError
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.FrameworkSynchronizer.withLogging(FrameworkSynchronizer.java:337)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.FrameworkSynchronizer.withLogging(FrameworkSynchronizer.java:346)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.FrameworkSynchronizer.preDirtyProcessingFor(FrameworkSynchronizer.java:229)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.IsisLifecycleListener$4.doRun(IsisLifecycleListener.java:111)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.IsisLifecycleListener$RunnableAbstract.run(IsisLifecycleListener.java:206)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.IsisLifecycleListener.withLogging(IsisLifecycleListener.java:185)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.IsisLifecycleListener.preDirty(IsisLifecycleListener.java:107)
	at org.datanucleus.api.jdo.JDOCallbackHandler.preDirty(JDOCallbackHandler.java:262)
	at org.datanucleus.state.JDOStateManager.updateField(JDOStateManager.java:2007)
	at org.datanucleus.state.JDOStateManager.setObjectField(JDOStateManager.java:1935)
	at com.tellmegen.domain.model.accounts.Person.setRegisteredKit(Person.java)
	at com.tellmegen.domain.model.accounts.Person.registerKit(Person.java:161)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.internalInvoke(ActionInvocationFacetForDomainEventAbstract.java:337)
	at org.apache.isis.core.metamodel.facets.actions.action.invocation.ActionInvocationFacetForDomainEventAbstract.invoke(ActionInvocationFacetForDomainEventAbstract.java:189)
	at org.apache.isis.core.runtime.transaction.facets.ActionInvocationFacetWrapTransaction$1.execute(ActionInvocationFacetWrapTransaction.java:57)
	at org.apache.isis.core.runtime.transaction.facets.ActionInvocationFacetWrapTransaction$1.execute(ActionInvocationFacetWrapTransaction.java:1)
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:205)
	at org.apache.isis.core.runtime.transaction.facets.ActionInvocationFacetWrapTransaction.invoke(ActionInvocationFacetWrapTransaction.java:54)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionImpl.execute(ObjectActionImpl.java:367)
	at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.handleActionMethod(DomainObjectInvocationHandler.java:610)
	at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.invoke(DomainObjectInvocationHandler.java:244)
	at org.apache.isis.core.wrapper.proxy.ProxyInstantiatorForJavassist$1.invoke(ProxyInstantiatorForJavassist.java:52)
	at com.tellmegen.domain.model.accounts.Person_$$_jvstef_5.registerKit(Person_$$_jvstef_5.java)
	at com.tellmegen.domain.model.kits.Kit.assignToPerson(Kit.java:163)
	at com.tellmegen.integtests.domain.model.kits.KitTests.tenancy_accountHasAccessToHisKits(KitTests.java:109)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.apache.isis.core.unittestsupport.jmocking.JUnitRuleMockery2$1.evaluate(JUnitRuleMockery2.java:146)
	at org.apache.isis.core.integtestsupport.ExceptionRecognizerTranslate$TranslationStatement.evaluate(ExceptionRecognizerTranslate.java:32)
	at org.apache.isis.core.integtestsupport.IntegrationTestAbstract$IsisTransactionRule$1.evaluate(IntegrationTestAbstract.java:214)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:239)
	at org.junit.rules.RunRules.evaluate(RunRules.java:20)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: org.apache.isis.core.metamodel.exceptions.MetaModelException: java.lang.StackOverflowError
	at org.apache.isis.core.commons.lang.ThrowableExtensions.throwWithinIsisException(ThrowableExtensions.java:60)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:57)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.adapter.ObjectAdapter$InvokeUtils.invoke(ObjectAdapter.java:346)
	at org.apache.isis.core.metamodel.facets.properties.accessor.PropertyAccessorFacetViaAccessor.getProperty(PropertyAccessorFacetViaAccessor.java:73)
	at org.apache.isis.core.metamodel.specloader.specimpl.OneToOneAssociationImpl.get(OneToOneAssociationImpl.java:131)
	at org.apache.isis.core.runtime.system.transaction.IsisTransaction$AdapterAndProperty.getPropertyValue(IsisTransaction.java:1179)
	at org.apache.isis.core.runtime.system.transaction.IsisTransaction$AdapterAndProperty.access$0(IsisTransaction.java:1178)
	at org.apache.isis.core.runtime.system.transaction.IsisTransaction.enlistUpdating(IsisTransaction.java:1332)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.FrameworkSynchronizer$4.run(FrameworkSynchronizer.java:259)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.FrameworkSynchronizer$8.call(FrameworkSynchronizer.java:350)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.FrameworkSynchronizer$8.call(FrameworkSynchronizer.java:1)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.FrameworkSynchronizer.withLogging(FrameworkSynchronizer.java:335)
	... 58 more
Caused by: java.lang.StackOverflowError
	at org.datanucleus.properties.PropertyStore.hasProperty(PropertyStore.java:65)
	at org.datanucleus.ExecutionContextImpl.getBooleanProperty(ExecutionContextImpl.java:868)
	at org.datanucleus.TransactionImpl.getOptimistic(TransactionImpl.java:634)
	at org.datanucleus.api.jdo.state.PersistentNontransactional.transitionReadField(PersistentNontransactional.java:151)
	at org.datanucleus.state.AbstractStateManager.transitionReadField(AbstractStateManager.java:650)
	at org.datanucleus.state.JDOStateManager.isLoaded(JDOStateManager.java:3194)
	at com.tellmegen.domain.model.accounts.Account.getApplicationUser(Account.java)
	at com.tellmegen.domain.model.accounts.Account.jdoGetemail(Account.java:76)
	at com.tellmegen.domain.model.accounts.Account.jdoCopyField(Account.java)
	at com.tellmegen.domain.model.accounts.Account.jdoCopyFields(Account.java)
	at org.datanucleus.state.JDOStateManager.saveFields(JDOStateManager.java:694)
	at org.datanucleus.api.jdo.state.PersistentNontransactional.transitionReadField(PersistentNontransactional.java:154)
	at org.datanucleus.state.AbstractStateManager.transitionReadField(AbstractStateManager.java:650)
	at org.datanucleus.state.JDOStateManager.isLoaded(JDOStateManager.java:3194)
	at com.tellmegen.domain.model.accounts.Account.getApplicationUser(Account.java)
	at com.tellmegen.domain.model.accounts.Account.jdoGetemail(Account.java:76)
	at com.tellmegen.domain.model.accounts.Account.jdoCopyField(Account.java)
	at com.tellmegen.domain.model.accounts.Account.jdoCopyFields(Account.java)
	at org.datanucleus.state.JDOStateManager.saveFields(JDOStateManager.java:694)
	at org.datanucleus.api.jdo.state.PersistentNontransactional.transitionReadField(PersistentNontransactional.java:154)
	at org.datanucleus.state.AbstractStateManager.transitionReadField(AbstractStateManager.java:650)
	at org.datanucleus.state.JDOStateManager.isLoaded(JDOStateManager.java:3194)
	at com.tellmegen.domain.model.accounts.Account.getApplicationUser(Account.java)
	at com.tellmegen.domain.model.accounts.Account.jdoGetemail(Account.java:76)
	at com.tellmegen.domain.model.accounts.Account.jdoCopyField(Account.java)
	at com.tellmegen.domain.model.accounts.Account.jdoCopyFields(Account.java)
	at org.datanucleus.state.JDOStateManager.saveFields(JDOStateManager.java:694)
	at org.datanucleus.api.jdo.state.PersistentNontransactional.transitionReadField(PersistentNontransactional.java:154)
	at org.datanucleus.state.AbstractStateManager.transitionReadField(AbstractStateManager.java:650)
	at org.datanucleus.state.JDOStateManager.isLoaded(JDOStateManager.java:3194)
	at com.tellmegen.domain.model.accounts.Account.getApplicationUser(Account.java)
	at com.tellmegen.domain.model.accounts.Account.jdoGetemail(Account.java:76)
	at com.tellmegen.domain.model.accounts.Account.jdoCopyField(Account.java)
	at com.tellmegen.domain.model.accounts.Account.jdoCopyFields(Account.java)
	at org.datanucleus.state.JDOStateManager.saveFields(JDOStateManager.java:694)"
ISIS-1118,Wish,Open,[Wish] The Wicket viewer autocomplete could also show recently used objects (eg 5 most recent) as the old HTML viewer used to do.,
ISIS-1117,Improvement,Closed,"Allow using ""marker"" view models","From users@ mailing lists: http://markmail.org/message/nbkj3jkbmr6tjghk

I tried to use a ""marker"" view model, i.e. a view model without any
properties.
I need it to trigger instantiation of a custom component(factory).
I thought that I may put all the ""properties"" in the component, so the view
model won't need to have them. It will be just a marker, like marker
interfaces.
This didn't work because of the code at
https://github.com/apache/isis/blob/master/core/viewer-wicket/ui/src/main/java/org/apache/isis/viewer/wicket/ui/pages/entity/EntityPage.java#L124
I will put the properties in the view model to overcome this check.
Is this something that could be relaxed or this check has to stay there for
some other functionality ?

{code}
if(*!specification.isViewModel() && *visibleAssociation.isEmpty()) {
{code}

seems to work fine with marker view model
"
ISIS-1116,Improvement,Closed,Use ResourceModel for labels in Wicket viewer,"Some labels are hardcoded in Wicket components (java and/or markup).
Until there is an integration with the new TranslatableService in Isis it would be nice if these labels are localizable with Wicket's i18n support, i.e. use ResourceModel and wicket:message."
ISIS-1115,Improvement,Closed,Make it possible to set a custom favicon,"It would be nice if it is possible to set a custom favicon for Isis applications.
E.g. by providing Guice beans for the url and the content type.
If there is no url then the component won't be rendered. If the content type is not provided then the browser will have to detect it automatically."
ISIS-1114,Improvement,Closed,Allow to use EmailVerificationUrlService for custom pages too,"At the moment org.apache.isis.viewer.wicket.ui.pages.EmailVerificationUrlService creates confirmation urls only to pages listed at org.apache.isis.viewer.wicket.model.models.PageType.
It would be good if the service could generate urls for custom/application pages too."
ISIS-1113,Improvement,Closed,Vetoing subscribers should be able to provide a translatable reason.,"ie in AbstractDomainEvent, as well as disable(String), there should also be a disable(TranslatableString).  Ditto for validate.

The appropriate facets should check for a translated version of the disabled / invalidate reason first, and translate back using the TranslationService.

If there is no translated version, then the original behaviour (simple string) is should continue to be used instead."
ISIS-1112,Bug,Closed,ExceptionRecognizerComposite cannot self-inject its dependencies,"Since today I've faced this NPE for a second time:


java.lang.NullPointerException
	at org.apache.isis.applib.services.exceprecog.ExceptionRecognizerComposite.injectServicesIfNecessary(ExceptionRecognizerComposite.java:120)
	at org.apache.isis.applib.services.exceprecog.ExceptionRecognizerComposite.recognize(ExceptionRecognizerComposite.java:79)
	at org.apache.isis.viewer.wicket.viewer.integration.wicket.WebRequestCycleForIsis.errorPageFor(WebRequestCycleForIsis.java:184)
	at org.apache.isis.viewer.wicket.viewer.integration.wicket.WebRequestCycleForIsis.errorPageProviderFor(WebRequestCycleForIsis.java:157)
	at org.apache.isis.viewer.wicket.viewer.integration.wicket.WebRequestCycleForIsis.onException(WebRequestCycleForIsis.java:148)

It is because org.apache.isis.applib.services.exceprecog.ExceptionRecognizerComposite#container is null and it is not possible to inject the dependencies of the delegates.
"
ISIS-1111,Bug,Closed,Trying to load an entity with wrong/non-existing OID fails with NullPointerException,org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage#EntityPage(org.apache.wicket.request.mapper.parameter.PageParameters) tries to create an EntityModel out of the available PageParameters but doesn't check whether there is org.apache.isis.viewer.wicket.model.mementos.PageParameterNames#OBJECT_OID in them.
ISIS-1110,Improvement,Closed,Check for available RequestCycle before trying to read the request locale,https://github.com/apache/isis/pull/26/files
ISIS-1109,Improvement,Closed,"Use titleOf(...) for the menu services, so that any translations get picked up.",
ISIS-1108,Improvement,Closed,"Allow informUser, warnUser, raiseError and also exception messages to be translated.","Probably by having overloaded methods etc that return TranslatableString instead of just String, eg

public class RecoverableException {
    public RecoverableException(TranslatableString tr) { ... }

    public TranslatableString getTranslatableMessage() { ... }
}

~~~~

and

public interface DomainObjectContainer {
    public void informUser(TranslatableString tr);
    ...
}

etc
"
ISIS-1107,Improvement,Closed,Register Guice Injector in Wicket before trying to inject the application's dependencies,"https://github.com/apache/isis/blob/master/core/viewer-wicket/impl/src/main/java/org/apache/isis/viewer/wicket/viewer/IsisWicketApplication.java#L255 tries to inject the members/dependencies of IsisWicketApplication before the Injector is registered in Wicket-IOC.
This doesn't allow usage of the new GuiceBeanProvider in the dependencies, because it needs to extract  Guice Injector from the Application threadlocal.
"
ISIS-1106,Improvement,Closed,"Improve translation service to translate all enum constants of all enums, and also capture the title of all services automaticaly all domain services and of all enum constants.",
ISIS-1105,Improvement,Closed,Improvements to the integration testing framework.,"Deprecating some (all?) of the static helper methods relating to scenarioExecution()... should simply inject domain services instead.

~~~
Also (todo): 
- perhaps move the scenarioExecution functionality (getVar, putVar etc to support BDD cucumber steps) into a separate domain service.
"
ISIS-1104,Improvement,Closed,Remove some of the chattiness in the log if there are no translations for a given locale,"Currently if no translation can be found for a given locale then the system generates a lot of WARN messages.

But for some systems i18n may not be important at all.  And for others, we only really want a warning for one of the languages we care to support, and not for others (they can use the fallback, ie ""WEB-INF/translations.po"").

This ticket is to remove the WARN logging in these cases.

~~~
Looking at the implementation, I now see/recall that we have an algorithm (cf ResourceBundles and others) that goes searching for the translation file for a given locale; and if none are found then the fallback translations are used.

So, the warning is logged if there IS a fallback and it doesn't have a translation for a given msgId.

Therefore the fix I'm going with is:
- if the fallback is being used then suppress log WARN messages
- otherwise preserve current behaviour.

This means that:
- systems that do care about i18n requirements for a specific locale (language/country) should include a WEB-INF/translations_XX_yy.po (or just WEB-INF/translations_XX.po)
- those that don't should simply omit it.
- there is no need to fully translate the translations.po file

There was a WARN message if the fallback (transltions.po) file was missing; this is now a simple INFO message instead, the new interpretation being that having no translations.po file is basically the same as having one that has no translations in it."
ISIS-1103,Bug,Closed,Translations service not picking up translated versions of property/collection names,
ISIS-1102,New Feature,Closed,Allow translations service to toggle between read mode and write mode from UI,"To reduce the feedback loop... can start off in write mode, but can switch to read mode to check any translations already obtained etc."
ISIS-1101,Improvement,Closed,Avoid unexpected concurrency exceptions if using a custom page.,"The Wicket viewer uses the redirect-after-post strategy, meaning that after an action is invoked, an EntityModel (wrapping the oid of the entity) is serialized as the content of the next page to show, but the browser is then returned as 30x response.  The browser then reloads the page afresh.

However, the entity model will (normally) encode the oid of the entity before the xactn of the first request has completed; if that entity is modified (as is normally the case) then that oid is stale.

To counteract this the EntityPage page uses the onBeforeRender hook to load the objectAdapter from the EntityModel without concurrency checking.

So far so good.

However, the Wicket viewer also supports custom home pages.  If these are rendered for the resultant entity then this hook is not called, resulting in a concurrency check exception.

This ticket is therefore for the component factories (that render the object after the redirect) to load the entity without concurrent checking; this will allow them to work even if embedded in custom pages."
ISIS-1100,Improvement,Closed,Improve algorithm for flushing transaction and similarly in capturing post values (for auditing) on transaction preCommit,"The algorithm currently is to execute all queued PersistenceCommands (corresponding to container.persist() or container.remove()) in order.  However, if the isis-module-audit module is configured, then, if an object execute a transaction flush (as the result of obtaining a pre- value) this can result in executing the same command all over.

In the particular case I investigated it resulted in double processing of a delete command; on the second time around I got ""cannot read from deleted object"" even though was ostensibly in the ""preDelete"" callback.

The required fix is a minor change to the way in which the command list are queued to ensure that both (a) each command is executed precisely once while (b) still allowing for additional commands to be added to the end of the command list should that occur.

~~~~
There is also a very similar issue in the way in which the changedObjectProperties are iterated over during preCommit; it's possible that this collection might be added to while obtaining the post values of all objects.
"
ISIS-1099,Improvement,Closed,Make it possible to use images loaded from the classpath in email templates,"To be able to use images in email templates EmailServiceDefault should use 
- ImageHtmlEmail instead of HtmlEmail
- a DataSourceResolver

"
ISIS-1098,Improvement,Closed,Arbitrary metadata for @XxxLayout annotations.,"ie make ability to support requirements such as ISIS-1095 into formal API

 

arguably it should be @PropertyLayout and @ParameterLayout annotations that we extend, rather than @Property and @Parameter
 ... depends on how ""intrinsic"" to the domain this hint is.

Opinions?"
ISIS-1097,Bug,Closed,"Suspicion that Isis may be leaving DB connections open under certain circumstances, leading to instability","Report from the field:

Users reporting that the app was slow. We've seen some active sessions in Tomcat that didn't correspond to any user, but also 3 database connections on PostgreSQL  that were ""IN TRANSACTION"" for a long time. 

Killing the Tomcat and database sessions the correct speed has been recovered 

~~~~
One monitoring option to consider (open source with commercial support) is hyperic, 

* http://sourceforge.net/projects/hyperic-hq/

* https://my.vmware.com/web/vmware/details?downloadGroup=VRHQ_584_OSS&productId=378

"
ISIS-1096,New Feature,Closed,Derive the object type from the schema and table of @PersistenceCapable (but ensure backward compatibility is preserved).,"The algorithm should be:

1. @DomainObject(objectType = ...)
2. @ObjectType(...)
3. @PersistenceCapable(schema=..., table=...)
4. use the default fully qualified class name.

This ticket is all about introducing (3).  The inferred objecttype should be:
schemaname.TableName, where schemaname is lowercased.

If schema is not present, then should ignore.

~~~
In addition, to support any legacy serialized data that uses the fully qualified class name, the resolution of objects by object type should first lookup the object type by its specified name, else fallback to looking up as if FQN.

eg suppose have:
{code}
package com.mycompany.myapp
@DomainObject(objectType=""CUS"")
public class Customer { ... }
{code}

then the serialized form of this is ""CUS:1"", but Isis should also resolve this object if ""com.mycompany.myapp.Customer:1"" is provided instead."
ISIS-1095,Improvement,Closed,"Make it possible to show the datepicker in a ""birthdate"" mode","Add an additional constructor to org.apache.isis.viewer.wicket.ui.components.scalars.datepicker.TextFieldWithDatePicker that allows to use custom DateTimeConfig.

The improvement won't be available for temporal properties in Isis because there is no facet for this.
The improvement will be useful for applications using TextFieldWithDatePicker in custom components (e.g. for view models)."
ISIS-1094,Improvement,Closed,"[WON'T FIX] Enhance the password field widget to show ""strength"" meter","At least it might require (example:
* length >= 8.
* at least 1 number.
* at least 1 capital letter.
* at least 1 small letter.
* distinct from email.

See sample implementation at [1]; see also [2]

Ideally, the security add-on might enforce it, and being able to validate it. But for avoiding introducing REST calls or similar solutions, perhaps its better to simply implement it in JavaScript as in the example.

[1]1 http://www.the-art-of-web.com/javascript/validate-password/

[2] http://bootsnipp.com/snippets/featured/password-strength-meter

"
ISIS-1093,Improvement,Closed,Integrate Wicket's i18n requirements with Isis' TranslationPoService.,"Currently Wicket's i18n support (via property files) is not associated with Isis' new TranslationService.

This ticket is to integrate them somehow so that the developer has only the translations.po file to maintain.

use https://github.com/apache/wicket/blob/master/wicket-core/src/main/java/org/apache/wicket/Localizer.java

see also https://cwiki.apache.org/confluence/display/WICKET/Everything+about+Wicket+internationalization
"
ISIS-1092,Improvement,Closed,Add OWASP Dependency Check maven plugin,"It automatically evaluates all included dependencies in order to find known vulnerabilities.


See: https://www.owasp.org/index.php/OWASP_Dependency_CheckAdd OWASP Dependency Check maven plugin"
ISIS-1091,Improvement,Closed,"Simplify the format of bookmark, remove prefix (CUS:L_123 -> CUS:123)","To avoid complication, preserve backward compatibility with existing format (eg CUS:L_2 still resolves ok).

In other words, the format of bookmarks (URIs) as generated *from now on* is simplified, but any existing should keep working."
ISIS-1090,Improvement,Closed,Deprecate IntegrationTestAbstract#runScript (static method),There's no longer any need for this; can simply use an injected FixtureScripts service.
ISIS-1089,Bug,Closed,Should cascade state of tracing printstream to child fixture scripts,
ISIS-1088,Improvement,Closed,Lazily discover fixture scripts,"In the current implementation the FixtureScripts domain service is searching and instantiating for all implementations of FixtureScript (under a particular package) on its @PostConstruct. Although cached, this (seems to be) called multiple times.

So, instead, should lazily build only if/when required."
ISIS-1087,Improvement,Closed,"Restful Objects viewer's ""services"" representation should show only domain services on the menu","ie nature=VIEW_MENU_ONLY or VIEW_MENU_AND_CONTRIBUTIONS.

Those whose nature=CONTRIBUTIONS or nature=DOMAIN should be excluded."
ISIS-1086,Task,Closed,Upgrade yuicompressor-maven-plugin to 1.5.1,"Building isis leads to :
{code}
The plugin net.alchim31.maven:yuicompressor-maven-plugin:1.5.0 requires Maven version 3.1.1
{code}"
ISIS-1085,Improvement,Closed,Add cssClassFa to DomainObjectLayout,"* @CssClassFa is deprecated but is able to decorate DomainObjects with font awesome icons.
* this feature does not work reliably (in my app it works with 11 out 13 classes).
* @DomainObjectLayout does not support cssClassFa currently

# add attribute to @DomainObjectLayout, move/copy implementation
# eventually fix bug
# eventually remove deprecated annotation"
ISIS-1084,Improvement,Closed,Reduce PoReader messages in the log,When a translation isn't available (because not needed) a warn message is logged every time a translation isn't found. I propose to lower to Info level to avoid polluting the log on production systems.
ISIS-1083,Improvement,Closed,Resetting dependent choice,"As discussed on the Isis users list:
============================================

Seems reasonable.  Would you like to provide a pull request?  [1]



[1] http://isis.apache.org/contributors/contributing.html

On 2 March 2015 at 16:20, Erik de Hair <e.dehair@pocos.nl> wrote:

> Hi Dan,
>
>
> On 03/02/2015 03:35 PM, Dan Haywood wrote:
>
>> Is there any use of setting the selected option to the first item of the
>> choices? It seems a bit strange from the user's perspective.
>>
>>
>> The rationale, IIRC, is that if the current value is not valid in the new
>> set of choices --- if(!curr.containedIn(choiceMementos))  --- then we set
>> the dependent choice to one of the valid set available as a convenience.
>>
>> I suppose, strictly speaking, that this should only be done if the
>> dependent parameter is mandatory; otherwise a user might want to leave it
>> as null.
>>
> I think, even when the parameter is mandatory, this should be handled by
> validation. It would be even better to set it to null because the user is
> forced to choose an option and would otherwise possibly submit a selected
> value the user didn't want to set (and didn't see it changing).
>
>>
>>  I can reset it in my code but maybe this scenario isn't desirable for any
>>> Isis application.
>>>
>>>
>>>  (Without trying it out for myself), I'm trying to think as to how you'd
>> do
>> that ...  in the defaultNXxx() method, I am guessing?
>>
>>  By copying the ReferencePanel-class to my app  Just to try if it
> works when setting it to null.
>
>>
>> Cheers
>> Dan
>>
>>
"
ISIS-1082,Improvement,Closed,Documentation fixes,"Original text of this ticket moved to ISIS-1721, since this ticket was incorrectly used as the target of commits for unrelated documentation fixes."
ISIS-1081,Improvement,Closed,Make it possible to lookup Guice beans in Isis domain services,"I have a use case where I need to send an email notification after creating a domain entity.
I was confused that EmailService is a Guice bean only so I've created a bridge domain service that looks up beans from Guice injector.

Now I see that I don't really need the bridge. I'll push it in a branch. If we find it useful then we could merge it later."
ISIS-1080,Improvement,Closed,Misc. bootstrap refinements.,
ISIS-1079,Bug,Closed,FixtureScript#defaultParam should actually default the property on the fixture script...,"... rather than merely returning the default value.

In addition, should support isXxx() for booleans."
ISIS-1078,Improvement,Closed,Wrapper factory should check visibility/usability/validity for contributed members also,"... which is to say, invoking a service action against non-null args (one of which is a contributee) should invoke ""through"" the contributed member (at least so far as enforcing the see it/use it/do it business rules are concerned).

"
ISIS-1077,Improvement,Closed,Use the provided 'cssClass' for action menu items,"At the moment only 'cssClassFa' is used by ServiceActionsPanel and TertiaryActionsPanel.
It would be useful if 'cssClass' is used too. It should be applied on the anchor HTML element used as a link for the action. "
ISIS-1076,Bug,Closed,MetaModelValidation error page (MmvPage) is no longer shown...,"Somewhere in 1.8.0-SNAPSHOT we've broken the MmvErrorPage.

It works fine in 1.8.0.

If I run my app with metamodel validation errors, then (rather than being directed to the MmvErrorPage) I get through to 

http://localhost:8080/wicket/wicket/bookmarkable/org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage

then, because the guice injector stuff in IsisWicketApplication never would have completed (ObjectReflectorDefault#init having thrown an exceptoin) I get an NPE because there is no PageClassRegistry.

So for some reason we're not detecting the fact that there were MMV errors anymore, and are blithely attempting to continue onto the login.

{code}
Unexpected RuntimeException

Last cause: null
WicketMessage: Can't instantiate page using constructor 'public org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage(org.apache.wicket.request.mapper.parameter.PageParameters)' and argument ''. An exception has been thrown during construction!

Stacktrace

Root cause:

java.lang.NullPointerException
     at org.apache.isis.viewer.wicket.ui.pages.accmngt.AccountManagementPageAbstract.<init>(AccountManagementPageAbstract.java:102)
     at org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage.<init>(WicketSignInPage.java:51)
     at org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage.<init>(WicketSignInPage.java:47)
     at java.lang.reflect.Constructor.newInstance(Constructor.java:526)
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:171)
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:76)
     at org.apache.wicket.DefaultMapperContext.newPageInstance(DefaultMapperContext.java:133)
     at org.apache.wicket.core.request.handler.PageProvider.resolvePageInstance(PageProvider.java:268)
     at org.apache.wicket.core.request.handler.PageProvider.getPageInstance(PageProvider.java:166)
     at org.apache.wicket.request.handler.render.PageRenderer.getPage(PageRenderer.java:78)
     at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:107)
     at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:228)
     at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:175)
     at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:862)
     at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
     at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:261)
     at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:218)
     at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:289)
     at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:259)
     at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:201)
     at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:282)
     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
     at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
     at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
     at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
     at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
     at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
     at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
     at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
     at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
     at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)
     at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
     at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
     at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)
     at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)
     at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
     at org.mortbay.jetty.Server.handle(Server.java:326)
     at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
     at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)
     at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)
     at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
     at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
     at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)
     at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)

Complete stack:

org.apache.wicket.WicketRuntimeException: Can't instantiate page using constructor 'public org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage(org.apache.wicket.request.mapper.parameter.PageParameters)' and argument ''. An exception has been thrown during construction!
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:194)
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:76)
     at org.apache.wicket.DefaultMapperContext.newPageInstance(DefaultMapperContext.java:133)
     at org.apache.wicket.core.request.handler.PageProvider.resolvePageInstance(PageProvider.java:268)
     at org.apache.wicket.core.request.handler.PageProvider.getPageInstance(PageProvider.java:166)
     at org.apache.wicket.request.handler.render.PageRenderer.getPage(PageRenderer.java:78)
     at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:107)
     at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:228)
     at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:175)
     at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:862)
     at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
     at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:261)
     at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:218)
     at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:289)
     at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:259)

java.lang.reflect.InvocationTargetException
     at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
     at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
     at java.lang.reflect.Constructor.newInstance(Constructor.java:526)
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:171)
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:76)
     at org.apache.wicket.DefaultMapperContext.newPageInstance(DefaultMapperContext.java:133)
     at org.apache.wicket.core.request.handler.PageProvider.resolvePageInstance(PageProvider.java:268)
     at org.apache.wicket.core.request.handler.PageProvider.getPageInstance(PageProvider.java:166)
     at org.apache.wicket.request.handler.render.PageRenderer.getPage(PageRenderer.java:78)
     at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:107)
     at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:228)
     at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:175)
     at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:862)
     at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
     at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:261)
     at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:218)
     at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:289)
     at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:259)
{code}


"
ISIS-1075,Bug,Closed,RO viewer's version resource always returns a 420 (method failure),"The reason being that a bit of code to support testing of a 420 status response code (when an ""X-Fail"" header is set) is always being triggered.
"
ISIS-1074,Bug,Closed,"For SessionLoggingService, causedBy only meaningful for sessions that have been logged out...",... so should be set to null if SessionLoggingService.Type = LOGIN.
ISIS-1073,Bug,Closed,Action domain event for contributed actions should provide the contributee as an argument.,...so that the subscriber can interact with (or at least look at) the contributee.
ISIS-1072,Bug,Closed,"When editing, if property validation vetoes the save, then not handled correctly.","For example, in isis-app-todoapp, there is a (silly) rule that a completed item should have a null dueBy, however the complete() action does not actually clear this property.

So, can do:
- complete item
- edit object, change description
- hit OK to save

then nothing seems to happen.

If hit ""OK"" again, then get a concurrency exception, eg:

Another user has just changed this data: todoapp-admin attempted to update TODO:L_2, however this object has since been modified by todoapp-admin [8 vs 7]

and a stack trace
{code}
org.apache.wicket.WicketRuntimeException: Exception 'todoapp-admin  attempted to update TODO:L_2, however this object has since been modified by todoapp-admin [8 vs 7]' occurred during validation org.apache.isis.viewer.wicket.ui.components.scalars.ScalarPanelTextFieldAbstract$1 on component 46:theme:entity:entity-0:entityPropertiesAndCollections:entityProperties:leftColumn:memberGroup:1:properties:1:property:scalarTypeContainer:scalarIfRegular:scalarValueContainer:scalarValue
	at org.apache.wicket.markup.html.form.FormComponent.validateValidators(FormComponent.java:1535)
	at org.apache.wicket.markup.html.form.FormComponent.validate(FormComponent.java:1146)
	at org.apache.wicket.markup.html.form.Form$18.validate(Form.java:1898)
	at org.apache.wicket.markup.html.form.Form$ValidationVisitor.component(Form.java:176)
	at org.apache.wicket.markup.html.form.Form$ValidationVisitor.component(Form.java:160)
	at org.apache.wicket.util.visit.Visits.visitPostOrderHelper(Visits.java:274)
	at org.apache.wicket.util.visit.Visits.visitPostOrderHelper(Visits.java:262)
	at org.apache.wicket.util.visit.Visits.visitPostOrderHelper(Visits.java:262)
	at org.apache.wicket.util.visit.Visits.visitPostOrderHelper(Visits.java:262)
	at org.apache.wicket.util.visit.Visits.visitPostOrderHelper(Visits.java:262)
	at org.apache.wicket.util.visit.Visits.visitPostOrderHelper(Visits.java:262)
	at org.apache.wicket.util.visit.Visits.visitPostOrderHelper(Visits.java:262)
	at org.apache.wicket.util.visit.Visits.visitPostOrderHelper(Visits.java:262)
	at org.apache.wicket.util.visit.Visits.visitPostOrderHelper(Visits.java:262)
	at org.apache.wicket.util.visit.Visits.visitPostOrderHelper(Visits.java:262)
	at org.apache.wicket.util.visit.Visits.visitPostOrderHelper(Visits.java:262)
	at org.apache.wicket.util.visit.Visits.visitPostOrder(Visits.java:245)
	at org.apache.wicket.markup.html.form.FormComponent.visitFormComponentsPostOrder(FormComponent.java:389)
	at org.apache.wicket.markup.html.form.Form.visitFormComponentsPostOrder(Form.java:1106)
	at org.apache.wicket.markup.html.form.Form.validateComponents(Form.java:1890)
	at org.apache.wicket.markup.html.form.Form.validate(Form.java:1832)
	at org.apache.wicket.markup.html.form.Form.process(Form.java:907)
	at org.apache.isis.viewer.wicket.ui.panels.FormAbstract.process(FormAbstract.java:87)
	at org.apache.wicket.markup.html.form.Form.onFormSubmitted(Form.java:770)
	at org.apache.wicket.ajax.form.AjaxFormSubmitBehavior.onEvent(AjaxFormSubmitBehavior.java:159)
	at org.apache.wicket.ajax.AjaxEventBehavior.respond(AjaxEventBehavior.java:124)
	at org.apache.wicket.ajax.AbstractDefaultAjaxBehavior.onRequest(AbstractDefaultAjaxBehavior.java:633)
	at sun.reflect.GeneratedMethodAccessor213.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.wicket.RequestListenerInterface.internalInvoke(RequestListenerInterface.java:258)
	at org.apache.wicket.RequestListenerInterface.invoke(RequestListenerInterface.java:241)
	at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.invokeListener(ListenerInterfaceRequestHandler.java:250)
	at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.respond(ListenerInterfaceRequestHandler.java:236)
	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:862)
	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:261)
	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:218)
	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:289)
	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:259)
	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:201)
	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:282)
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
	at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)
	at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
	at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
	at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)
	at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)
	at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
	at org.mortbay.jetty.Server.handle(Server.java:326)
	at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
	at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:945)
	at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:756)
	at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
	at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
	at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)
	at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
Caused by: org.apache.isis.core.metamodel.adapter.version.ConcurrencyException: todoapp-admin  attempted to update TODO:L_2, however this object has since been modified by todoapp-admin [8 vs 7]
	at org.apache.isis.core.runtime.persistence.adaptermanager.AdapterManagerDefault.adapterFor(AdapterManagerDefault.java:343)
	at org.apache.isis.viewer.wicket.model.mementos.ObjectAdapterMemento$Type$2.recreateAdapter(ObjectAdapterMemento.java:112)
	at org.apache.isis.viewer.wicket.model.mementos.ObjectAdapterMemento$Type.getAdapter(ObjectAdapterMemento.java:183)
	at org.apache.isis.viewer.wicket.model.mementos.ObjectAdapterMemento.getObjectAdapter(ObjectAdapterMemento.java:280)
	at org.apache.isis.viewer.wicket.model.models.ScalarModel$Kind$1.validate(ScalarModel.java:133)
	at org.apache.isis.viewer.wicket.model.models.ScalarModel.validate(ScalarModel.java:590)
	at org.apache.isis.viewer.wicket.ui.components.scalars.ScalarPanelTextFieldAbstract$1.validate(ScalarPanelTextFieldAbstract.java:188)
	at org.apache.wicket.markup.html.form.FormComponent.validateValidators(FormComponent.java:1524)
	... 66 more
12:18:51,061  [RequestCycleExtra    1265898221@qtp-993887491-2 WARN ]  ********************************
{code}

"
ISIS-1071,New Feature,Closed,Provide new HasUsername interface in applib (analogous to HasTransactionId) so that various addon services can contribute to it.,"For example, if the isisaddons sessionlogger's SessionLogEntry (trivially) implements the interface, then the isisaddons commands module can contribute by displaying the 10 most recent commands for that user."
ISIS-1070,Improvement,Closed,Add header and handle double quotes in translations.pot file ,"Some translation services are more picky about the format of the .pot file than others. I encountered two issues when trying a different service:

1. Add compliant header
More about headers in this paper [1]  and the gettext documentation [2]. I've successfully managed to upload a .pot file to a translation service by adding this header: 
{code}
msgid """"
msgstr """"
""Project-Id-Version: \n""
""POT-Creation-Date: 2015-03-04 12:52+0100\n""
""MIME-Version: 1.0\n""
""Content-Type: text/plain; charset=UTF-8\n""
""Content-Transfer-Encoding: 8bit\n""
""Plural-Forms: nplurals=2; plural=n != 1;\n""
{code}

2. Escape quotes

Some services can't deal with quotes in the translatable string:
{code}
msgid ""<a href=""#"">Accept using your data for research</a>""
{code}
One could argue that is this particular example the html should not be exposed to the translator but it's imaginable that quotes are used in strings that are presented to the user.

Escaping with a backslash allowed me to upload the .pot file: 
{code}
msgid ""<a href=\""#\"">Accept using your data for research</a>""
{code}
 
[1] http://pology.nedohodnik.net/doc/user/en_US/ch-poformat.html
[2] https://www.gnu.org/software/gettext/manual/html_node/Header-Entry.html#Header-Entry"
ISIS-1069,Bug,Closed,DomainChangeJdoAbstract's open action incorrectly annotated as being a bulk action.,"This the base class for AuditEntry, CommandJdo, PublishedEvent (in isisaddons)."
ISIS-1068,Improvement,Closed,Rationalize menuOrder for domain services that appear in UI,
ISIS-1067,Improvement,Closed,EmailNotificationServiceDefault should replace all occurrences of ${confirmationUrl} in the email template,"... this way custom templates can use ""full form"", e.g.:
<a href=""http://example.com/link"">http://example.com/link</a>"
ISIS-1066,Bug,Closed,Moving CustomRepresentationService to dom - There is no application attached to current thread main,"Hi,

We are using  something similar to CustomRepresentationService of todoapp, we use it to get a simple JSON representation.

Our CustomRepresentationService is annotated as DomainService, its package is registered in isis.properties (isis.services.ServicesInstallerFromAnnotation.packagePrefix but not in isis.services!) and it is located in the dom module.

With apache isis 1.7 it was working, now we migrated to isis 1.8 and now this causes an error during maven install:
WicketRuntimeException: There is no application attached to current thread main
{noformat}
16:05:09,146  [IsisTransaction      main       INFO ]  abort transaction IsisTransaction@2a49af03[state=MUST_ABORT,commands=0]
Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 10.018 sec <<< FAILURE! - in ase.integration.test.ESIntegTest
ase.integration.test.ESIntegTest  Time elapsed: 10.018 sec  <<< ERROR!
java.lang.RuntimeException: org.apache.isis.core.runtime.system.transaction.IsisTransactionManagerException: org.apache.wicket.WicketRuntimeException: There is no application attached to current thread main
	at org.apache.isis.core.integtestsupport.IsisSystemForTest.setUpSystem(IsisSystemForTest.java:350)
	at ase.integration.AddressSearchEngineSystemInitializer.initIsft(AddressSearchEngineSystemInitializer.java:46)
	at ase.integration.AbstractAseIntegTest.initClass(AbstractAseIntegTest.java:13)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
{noformat}

When I run the application on tomcat everything seems to work, the UI is available and I can access the CustomRepresentationService through Rest API.

I did the described changes on the todoapp for isis 1.8 and I'm getting same result (I attached my changes with patch.txt).

I moved the CustomRepresentationService to dom module because I need an possibility to unit test the generated JSON strings.

Please fix that issue or assist me in creating a workaround.
Thanks,
Timothy"
ISIS-1065,Bug,Closed,Auditing of editing of properties only audits one of the properties changed (the last one),"The reason being that the JDO preDirty callback (from which IsisTransaction#enlistUpdating is called) is called multiple times for each dirtied property.

The fix is to add a guard to only add to the ""pre"" values if the pre value has not already been captured."
ISIS-1064,New Feature,Closed,Allow DB schemas (or any other setup) to be performed as DN metamodel is built up for each class.,"To support modularization (eg of isisaddons), it'd be good practice to allow classes to be mapped to specific (DB) schemas, rather than the default ""public"" (HSQLDB/Postgres) or ""dbo"" (MSSQL) schema.

This requires some mechanism to intercept the creation process and create the schema before hand.

This enhancement is:
- provide the ability to register a listener class (implementing org.datanucleus.metadata.MetaDataListener), so that this can be done on start-up
- provide a default implementation that works ""out-of-the-box"" for (at least) HSQLDB, PostgreSQL and MS SQL Server."
ISIS-1063,Bug,Closed,View models with mandatory enum properties are not initialized correctly.,"... because deep within Isis, in PersistenceSession#createViewModelInstance, there is some code that initializes all mandatory fields of a pojo just after an adapter has been created for it.

This has the effect of trampling the state on the pojo that was created by from the view model's memento.

here's one possible fix:

{code}
    public ObjectAdapter createViewModelInstance(final ObjectSpecification objectSpec, final String memento) {
        if (LOG.isDebugEnabled()) {
            LOG.debug(""creating view model instance of "" + objectSpec);
        }
        final Object pojo = objectSpec.createObject();

        final ViewModelFacet facet = objectSpec.getFacet(ViewModelFacet.class);

        //
        // the code below is horrid... we effectively initialize the view model pojo twice from the memento.
        // An alternative would be to not do the default initialize above, but that might change behaviour
        //

        // we initialize the pojo here in order to be able to build the OID
        facet.initialize(pojo, memento);

        final ObjectAdapter adapter = getAdapterManager().adapterFor(pojo);

        // next, (legacy behaviour... remove?) we initialize the pojo (set default values for any non-optional fields)
        // nb: this could have the effect of overwriting some of the state just set up
        objectSpec.initialize(adapter);

        // so finally we re-initialize, in order to reinstate any state that might have been overwritten.
        facet.initialize(pojo, memento);

        return adapter;
    }
{code}

However, perhaps we should simply not do the defaulting for view models at all, on the basis that it's the view model's own responsibility to set up its entire state.

So another possible fix is simply:

{code}
    public ObjectAdapter createViewModelInstance(final ObjectSpecification objectSpec, final String memento) {
        if (LOG.isDebugEnabled()) {
            LOG.debug(""creating view model instance of "" + objectSpec);
        }
        final Object pojo = objectSpec.createObject();

        final ViewModelFacet facet = objectSpec.getFacet(ViewModelFacet.class);
        facet.initialize(pojo, memento);

        final ObjectAdapter adapter = getAdapterManager().adapterFor(pojo);

        // no longer initialize the pojo for any default values 

        return adapter;
    }
{code}
"
ISIS-1062,Bug,Closed,Guice injector should create serializable proxies for the injected beans,"org.apache.isis.viewer.wicket.viewer.IsisWicketApplication#initWicketComponentInjection() should use new GuiceComponentInjector(this, injector, TRUE) so that it creates a serializable proxy for the injected beans.
Otherwise all the bean impls have to be Serializable themselves."
ISIS-1061,Task,Closed,"Upgrade Wicket to 6.19.0 (or rather, 6.20.0 when released since we found issues with 6.19.0).","Upgrade Wicket from 6.17.0 to 6.19.0 (latest stable release).
I use 6.19 in the application I work on for few weeks now and I've no issues so far."
ISIS-1060,Wish,Closed,An exception is logged when the provided credentials are invalid,"If trying to authenticate with wrong credentials Isis Shiro integration logs an ERROR with its complete stacktrace.
This is not an error in the application so I think it should be logged with lower level, e.g. WARN (but even WARN looks too much to me for this normal use case).
The second change that I'd recommend is to not dump the stacktrace.
Instead of:
  LOG.error(""Unable to authenticate"", ae);
do:
  LOG.error(""Unable to authenticate. Reason: "" + ae.getMessage());"
ISIS-1059,Bug,Closed,[Duplicate] Isis restriction of using some characters when the property is a @PrimaryKey,"Possible duplicate of ISIS-820

 

If a domain entity uses PersistenceCapable(identityType = IdentityType.APPLICATION) combined with PrimaryKey annotated property then it is not allowed to use some symbols like '@'.

The exception is:

Caused by: java.lang.IllegalArgumentException: identifier 's_my@email.tld' contains an '@' symbol
 at org.apache.isis.core.commons.ensure.Ensure.ensureThatArg(Ensure.java:75)
 at org.apache.isis.core.metamodel.adapter.oid.RootOidDefault.<init>(RootOidDefault.java:124)
 at org.apache.isis.core.metamodel.adapter.oid.RootOidDefault.<init>(RootOidDefault.java:92)
 at org.apache.isis.core.runtime.system.persistence.OidGenerator.createPersistentOrViewModelOid(OidGenerator.java:99)
 at org.apache.isis.objectstore.jdo.datanucleus.persistence.FrameworkSynchronizer$3.run(FrameworkSynchronizer.java:203)
 at org.apache.isis.objectstore.jdo.datanucleus.persistence.FrameworkSynchronizer$8.call(FrameworkSynchronizer.java:350)
 ...."
ISIS-1058,Task,Closed,Upgrade embedded Jetty to latest 8.x,Any objections to upgrade embedded Jetty from 6.x to 8.x ?
ISIS-1057,Bug,Closed,WebRequestCycleForIsis should use the configured SignIn page,WebRequestCycleForIsis should not create instances of WicketSignInPage directly but should use PageClassRegistry to get the configured signin page.
ISIS-1056,New Feature,Closed,[DUPLICATE] Support user-defined annotations (as per Spring and JSR-303 etc).,"eg, instead of:

@Action(semantics=SemanticsOf.SAFE)
@ActionLayout(contributed=Contributed.AS_ASSOCIATION)
@CollectionLayout(render=RenderType.EAGERLY)
public List<Foo> someFoos() { ... }

we could allow custom annotations like this to be defined:

@Action(semantics=SemanticsOf.SAFE)
@ActionLayout(contributed=Contributed.AS_ASSOCIATION)
@CollectionLayout(render=RenderType.EAGERLY)
public @interface ContributedCollection {
}

which would then allow:

@ContributedCollection
public List<Foo> someFoos() { ... }

~~~~
This might also be a good way to support value types, eg by introducing a new ValueObject and ValueObjectLayout annotations:

@ValueObject (
    mustSatisfy=MoneySpec.class,
    appliesTo={BigDecimal.class}
)
@ValueObjectLayout(
    named=""Money""
)
public @interface Money {
}

and then:

public void deposit(@Money BigDecimal bd) { ... }

Behind the scenes, Isis would just be copying facets from the ObjectSpecification that represents the @Money annotation onto the parameter or property feature.."
ISIS-1055,Improvement,Closed,The application name/logo in sign up & password reset page should be a link to the signin page,To safe the users some time in navigation the application name (or logo) above the sign up and password reset forms could be a link to the sign in page.
ISIS-1054,Improvement,Closed,AbstractDomainEvent disable and invalidate methods should support TranslatableString,So that messages raised by a vetoing subscriber can be translated to the appropriate language.
ISIS-1053,Bug,Closed,[WON'T FIX] Unable to render java.lang.Number in UI,
ISIS-1052,Task,Closed,Isis 1.9.0 release tasks,
ISIS-1051,Improvement,Closed,performance fix: LayoutMetadataReaderFromJson is called too often,"Taken from a comment by Martin on ISIS-931:

While debugging ISIS-911 I've noticed that org.apache.isis.core.metamodel.layoutmetadata.json.LayoutMetadataReaderFromJson#asProperties is expensive. It is called at start time and tries to load .layout.json file for every introspected method. This includes JRE classes, JDO classes, and many more. I think it should be called only for objects/entities. The expensiveness is that it tries to find a file in the classpath and if it is not found then it throws org.apache.isis.core.metamodel.layoutmetadata.LayoutMetadataReader.ReaderException. The stacktrace of this exception is ignored at org.apache.isis.core.metamodel.specloader.specimpl.FacetedMethodsBuilder#readMetadataProperties so 
ReaderException could override java.lang.Throwable#fillInStackTrace() to return null and save some time."
ISIS-1050,Bug,Closed,[WON'T FIX] Reflection VFS related issues in jetty-console,"Just tried java -jar .../simpleapp-...-jetty-console.jar and it logs several VFS related stacktraces:

java.io.FileNotFoundException: /tmp/simpleapp-webapp-1.8.0-SNAPSHOT-jetty-console.jar_8080/webapp/WEB-INF/classes (Is a directory)
	at java.util.zip.ZipFile.open(Native Method)
	at java.util.zip.ZipFile.<init>(ZipFile.java:215)
	at java.util.zip.ZipFile.<init>(ZipFile.java:145)
	at java.util.jar.JarFile.<init>(JarFile.java:154)
	at java.util.jar.JarFile.<init>(JarFile.java:118)
	at org.reflections.vfs.Vfs$DefaultUrlTypes$1.createDir(Vfs.java:207)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:98)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:236)
	at org.reflections.Reflections.scan(Reflections.java:203)
	at org.reflections.Reflections.<init>(Reflections.java:128)
	at org.reflections.Reflections.<init>(Reflections.java:169)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:76)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findSubTypesOfClasses(FixtureScripts.java:226)
....

and

ava.lang.NoClassDefFoundError: org/apache/commons/vfs2/VFS
	at org.reflections.vfs.Vfs$DefaultUrlTypes$7.matches(Vfs.java:281)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:97)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:236)
	at org.reflections.Reflections.scan(Reflections.java:203)
	at org.reflections.Reflections.<init>(Reflections.java:128)
	at org.reflections.Reflections.<init>(Reflections.java:169)
	at org.reflections.Reflections.<init>(Reflections.java:142)
	at org.apache.isis.objectstore.jdo.service.RegisterEntities.registerAllPersistenceCapables(RegisterEntities.java:67)


It seems they are harmless. The application seems to run fine.

The problem could be related to the recent upgrade of Reflections to 0.9.9 and/or jetty-console-maven-plugin to 1.56."
ISIS-1049,Improvement,Closed,Move Wicket viewer under core.,"This topic was discussed on dev@isis.a.o, no objections [1]

For this release, do NOT change the groupId and artifactId... to avoid disruption to the user community.   Will change these instead in 1.9.0.

The primary benefit of this change is for the release process.

[1] http://isis.markmail.org/thread/ox3i6arna4n7gz3v"
ISIS-1048,Improvement,Closed,"Make view model URLs more secure, eg through a private key.","At the moment it is possible to reverse engineer a view model URL, or perhaps to steal it.  

It ought to be encrypted somehow, eg using HMAC.

http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/AuthJavaSampleHMACSignature.html
http://www.smartjava.org/content/protect-rest-service-using-hmac-play-20"
ISIS-1047,Improvement,Closed,The focus should be on the first field of an action parameter dialog,
ISIS-1046,Improvement,Closed,Get rid of chatty Shiro messages about no CacheManager being set.,"I think this is all done via other tickets.

~~~

 

For example, configure the MemoryConstrainedCacheManager.

In Wicket viewer, set up a way to invalidate the session (this is easy enough to do, see eg the code that calls the SessionLogger), so that the cache can also be clear.

We also need some way to ""log out"" for RO viewer. However, perhaps that can be left to another day."
ISIS-1045,Improvement,Closed,"New domain events are created for each phase for properties, but not for collections nor actions.  The current design doesn't support use of the wrapper factory.","In the domain events design we have 5 phases: hide/disable/validate/pre-execute/post-execute.  The framework attempts to reuse the same event where possible

for actions:
- for hide, always creates new event
- for disable, always creates new event
- for validate, always creates new event, puts onto thread-local
- for pre-execute, uses the event from validate (obtain from thread-local)
- for post-execute, uses the event from pre-execute (passed as local var).

for collections:
- ditto

but for properties, although we originally had the same algorithm, this was changed (patch from Oscar) to:
- for hide, always creates new event
- for disable, always creates new event
- for validate, always creates new event, puts onto thread-local
- for pre-execute, always creates a new event (ignores that on thread-local)
- for post-execute, uses the event from pre-execute (passed as local var).

The reason that Oscar needed this change was because the framework does not anticipate there being more than one ""pending"" interaction.  However, if the wrapper factory is used, then this assumption isn't true, because validateX() -> wrap -> validateY().  

This use case actually needs a stack of pending interaction events to support this change.

As things stand:
* the getUserData() functionality is broken for property domain events
* the underlying problem remains for actions -> actions using the wrapper factory during the validate phase.

There is also a suggestion that the Guava event bus might be an issue in that it buffers changes; I'm not exactly sure what this means (we don't use the async guava bus), and I don't know if its behaviour is significant or not.     But in any case, the above design defect is an issue irrespective and which needs addressing; once that's fixed then we can look at the Guava event bus to decide if it is also a problem for us or not."
ISIS-1044,Improvement,Closed,"Table counts and gmap3/fullcalendar2 do not honour any vetoing, eg by subscribers or WithApplicationTenancy","Suppose that the Isis addon security module is being used with application tenancy checking; this means that the Wicket table (CollectionContentsAsAjaxTable) will only show rows for those entities for which the user is authorized (the visibility has not been vetoed).

However, the underlying EntityCollectionModel does contain those objects, and the size of that collection is what is shown in the ""showing 1-5 of 15"" totals etc rendered at the bottom of the table.

So the question is: how to ensure that figure is correct?  
* One option is to eagerly check the visibility of every item (even those not on the current page).  
* Another option is to suppress the totals, somehow (would require additional metadata, along with a worse UI for users

~~~
Related: the gmap3/fullcalendar2/excel Isis addons do not check for the object visibility, meaning that they expose information when they should not."
ISIS-1043,Improvement,Closed,Enhance fixture script framework with better support for parameters being passed between scripts.,
ISIS-1042,Bug,Closed,Dropdown of Enums does not honour title() method,"The dropdown of enums shows the name of the enum, not the result of the title() method when available."
ISIS-1041,Bug,Closed,"Under certain circumstances, appears that auditing can cause the same tuple to be audited within a single transaction.","In the case of the Isis addon's implementation of auditing, there is a unique key constraint on (xactn/object oid/propertyId).  This should indeed be unique.  

However, for a large xactn (in isis-app-todoapp) found certain circumstances when the ""changedProperties"" map (keyed by AdapterAndProperty) seems to hold entries that violate this constraint.

Fix is to implement the hashCode/equals of AdapterAndProperty in a fashion in a more straightforward way."
ISIS-1040,Improvement,Closed,Extend FixtureScript / ExecutionContext with defaultParam / checkParam...,"... in support the ""Dublin"" way of working with fixtures.

The isis-app-todoapp in Isisaddons [will] demonstrates usage.

"
ISIS-1039,Improvement,Closed,XmlSnapshot.Builder interface missing the build() method...,
ISIS-1038,Improvement,Closed,Extend ActionDomainEvent so that it provides the return value during the Executed phase.,
ISIS-1037,Improvement,Closed,Support layout.xml as well as layout.json,"As discussed at http://markmail.org/message/ehdxwhxucxslkne4 we may use Jackson instead of Gson to read/write the layout **Repr classes.

As a bonus it should be very easy to create .xml version of them and provide XML schema (.xsd) so it is easier for application developers to edit and validate in the IDE.

Optional: with tool like https://github.com/fnogatz/xsd2json we may create JSON schema as well."
ISIS-1036,Improvement,Closed,Inject services into Comparators specified in a @CollectionLayout(sortedBy=...) clause,
ISIS-1035,New Feature,Closed,[DUPLICATE] Allow parented collections to have bulk actions associated with them...,"... so that they have checkboxes against them, and the invoked action is called for each selected instance."
ISIS-1034,Improvement,Closed,[WON'T FIX] Support bulk actions that return Blobs and Clobs,"https://github.com/apache/isis/blob/432ec3f1ec1b71b11fd24e24e26fb6a8fd324648/core/metamodel/src/main/java/org/apache/isis/core/metamodel/spec/feature/ObjectAction.java#L392

"
ISIS-1033,New Feature,Closed,"Extend DomainObjectContainer, add isViewModel(...).",
ISIS-1032,Improvement,Closed,Contract test for bidirectional relationship can't handle overridden methods,The contract tests search for methods with a specific name. It asserts to find one but when the method is overridden in a test it finds more then one.
ISIS-1031,Wish,Open,[Wish] Make it possible to filter on tables,"It should be possible to show pagination in the tables possibly with configurable page size. It should also be nice to have ability to filter entities in a table.

The DataTable,js (https://www.datatables.net/), which looks like it has a Wicket integration already (https://github.com/wicketstuff/core/wiki/DataTables) could be a good way to go (we've used it in Naked Objects.NET application).

To enable it, suggest an extension to @CollectionLayout(filterable=...) and corresponding enhancement to layout.xml"
ISIS-1030,Bug,Closed,Not possible for a declarative view model (@ViewModel) to reference another view model/,"The issue is that the view model facet uses BookmarkService to encode any non-value types as bookmarks that are, in essence, interpreted as being persistent entities.

The fix is to enhance the Bookmark so that it distinguishes between persistent vs viewmodels, and can pass this to RootOid when rehydrating."
ISIS-1029,Bug,Closed,Hidden{where} in layout is not honored by table representations,"On removal of all annotations and defining hidden property in the respecting layout json files, these definitions are not honored in table representations. 

Below is an example of how I defined the layout:

{code}
{
      ""span"": 2,
      ""memberGroups"": {
        ""Dates"": {
          ""members"": {
            ""startDate"": {
              ""disabled"": {},
              ""hidden"": {
                ""where"": ""EVERYWHERE""
              },
              ""typicalLength"": {
                ""value"": 12
              }
            },
            ""endDate"": {
              ""actions"": {
                ""changeDates"": {}
              },
              ""disabled"": {},
              ""hidden"": {
                ""where"": ""EVERYWHERE""
              },
              ""typicalLength"": {
                ""value"": 12
              }
            },
            ""tenancyStartDate"": {
              ""disabled"": {},
              ""hidden"": {
                ""where"": ""NOWHERE""
              },
              ""typicalLength"": {
                ""value"": 12
              }
            },
            ""tenancyEndDate"": {
              ""disabled"": {},
              ""hidden"": {
                ""where"": ""NOWHERE""
              },
              ""typicalLength"": {
                ""value"": 12
              }
            },
            ""tenancyDuration"": {
              ""actions"": {
                ""changeTenancyDates"": {}
              },
              ""disabled"": {},
              ""typicalLength"": {
                ""value"": 25
              }
            }
          }
        }
      }
    }
{code}"
ISIS-1028,New Feature,Closed,Create Event Bus Service based on Axon,"Current Guava based implementation queues events, and that implies changes to the execution flow.

Axon Event Bus implementations simply dispatches events as soon as are posted.

That way, logic when dispatching events is always the same (immediate dispatching when posted), without depending on an Event being dispatched when no other Event is dispatching (so its Event Handlers would be invoked immediately) or when other Event is currently being dispatched (in which case Guava would queue it instead of immediately dispatching).

~~~~~~~~~~~~~~~~

As now implemented, the implementation can be specified in isis.properties:

isis.services.eventbus.implementation=guava  # the default

or

isis.services.eventbus.implementation=axon

or

isis.services.eventbus.implementation=com.mycompany.myapp.MyEventBusImplementation   # implementing EventBusImplementation as defined in the Isis applib.
"
ISIS-1027,New Feature,Closed,Raise metamodel validation exceptions if deprecated annotations or method prefixes are used.,"This should be configurable in isis.properties, with the default being to NOT throw metamodel validations.

suggested syntax:
isis.reflector.validator.allowDeprecated=true|false
"
ISIS-1026,Improvement,Closed,Upgrade jetty-console-maven-plugin to 1.56,"Hi,

I saw the comment in the (generated) pom.xml - for me (I'm on Java 8) 1.56 works and is ~50% faster in the build.

Best regards
Jörg

[1] http://search.maven.org/#artifactdetails|org.simplericity.jettyconsole|jetty-console-maven-plugin|1.56|maven-plugin"
ISIS-1025,Improvement,Closed,"Make it possible a (entity, value, etc.) page to be shown without the header and/or footer","It would be nice if there is a way to show any page without the header and/or footer.
This way a page might be shown as embedded (i.e. in iframe) in another application.

For the header we can use special request parameter, e.g. ""isis.no.header"".
For the footer it would be nice to have additionally a config property to globally hide it."
ISIS-1024,New Feature,Closed,Support imperative validation of a single action parameter argument (as well as of entire parameter args).,"(Did this feature get removed accidentally somehow, or was I imagining it?)

Require imperative validation on action parameters (ActionParameterValidationFacet  implementing ValidatingInteractionAdvisor).

To explain; I have an action:
{code}
    public LeaseItem newItem(
            final LeaseItemType type,
            final Charge charge,
            final InvoicingFrequency invoicingFrequency,
            final PaymentMethod paymentMethod,
            final @Named(""Start date"") LocalDate startDate,
            final ApplicationTenancy applicationTenancy) {
    }
{code}

I can write supporting methods for choices and defaults for a single parameter:

{code}
    public List<ApplicationTenancy> choices5NewItem() { ... }
    public ApplicationTenancy default5NewItem() { ... }
{code}

However it's not possible to validate an individual parameter arg, instead I have to validate all:
{code}
    public String validateNewItem(final LeaseItemType type,
                                   final Charge charge,
                                   final InvoicingFrequency invoicingFrequency,
                                   final PaymentMethod paymentMethod,
                                   final @Named(""Start date"") LocalDate startDate,
                                   final ApplicationTenancy applicationTenancy) {
        return !getApplicationTenancy().getChildren().contains(applicationTenancy)
                ? String.format(
                    ""Application tenancy '%s' is not valid for this lease (having application tenancy path '%s')"",
                    applicationTenancy.getPath(),
                    getApplicationTenancyPath())
                : null;
    }
{code}

I would prefer to be able to write:
{code}
    public String validate5NewItem(final ApplicationTenancy applicationTenancy) {
        return !getApplicationTenancy().getChildren().contains(applicationTenancy)
                ? String.format(
                    ""Application tenancy '%s' is not valid for this lease (having application tenancy path '%s')"",
                    applicationTenancy.getPath(),
                    getApplicationTenancyPath())
                : null;
    }
{code}
"
ISIS-1023,Wish,Open,[Wish] Invoke actions on entity in table collection (rows),"Enhance the Wicket viewer (with corresponding metadata annotations) to render an entity's actions as drop-down menu when that entity is rendered as a row of a table.

There's probably no need to introduce additional annotations; the @ActionLayout(hidden=...) indicates whether an action is hidden in various contexts, one of these being it being hidden (or not) within tables.

My idea therefore is that, unless every action of an entity is indicated as hidden for a table, that there is an additional column that includes a drop-down and that allows the actions to be invoked (bringing up the dialog).

Once the action is invoked (like bulk actions) the table should be reloaded (rather than, say, navigate to the object returned by the action)."
ISIS-1022,Improvement,Closed,[WON'T FIX] Refactor IsisConverterLocator so that the converters are facets.,"In ISIS-1012 we introduced the IsisConverterLocator class that inspects the ObjectSpecification and returns a suitable Wicket IConverter implementation.

The implementation of this is a big switch statement.

A better design would be for the IConverter to be made available through a suitable facet, probably as an extension of the existing ValueFacet.  This would require updating the appropriate facet factories for all appropriate values.

Note that we don't want Isis to have a dependency on Wicket, and so Isis would need to define its own ""parallel"" (copy of) IConverter, and have the ValueFacet return this.

Then, in IsisConverterLocator, it would simply be a matter of adapting the Isis' IConverter into a Wicket IConverter.

The final implementation of IsisConverterLocator would be something like:

{code}
final ObjectSpecification objectSpecification = objectAdapter.getSpecification();

ValueFacet vf = objectSpecification.getFacet(ValueFacet.class)
if(vf == null) { return null; }

final org.apache.isis.core.metamodel.IConverter ic = vf.getConverter();
if (ic == null) { return null; }

return new org.apache.wicket.util.convert.IConverter() {
    public Object convertToObject(String value, Locale locale) {
       return ic.convertToObject(value, locale);
    }
    public String convertToString(C value, Locale locale) {
        return ic.convertToString(value, locale);
    }
};
{code}"
ISIS-1021,New Feature,Closed,suppress/disable the link in the first column of a table (CollectionProperty),"Goal:
Suppress/disable the link in the first column of a table (CollectionProperty) for marked DomainObjects.

Proposal:
- Add a new field to the @DomainObjectLayout like openable/viewable.
- Special handling of title columns in CollectionContentsAsAjaxTablePanel / ObjectAdapterTitleColumn / EntityIconAndTitlePanel

Background:

I have a complex entity which is displayed in tables in different places.
In one place I want to show a subset of properties only. For this
projection I made a special in-memory object, which wraps the complex
entity and has getters for the subset of properties only. How can I mark
this inmemory object to be not openable, or with other words how do i suppress/disable the link in the first column.

Dan/Martins ""QuickFix"" was:

The column is added at

https://github.com/apache/isis/blob/master/component/viewer/wicket/ui/src/main/java/org/apache/isis/viewer/wicket/ui/components/collectioncontents/ajaxtable/CollectionContentsAsAjaxTablePanel.java#L96
and I see no way how to suppress the addition in current master branch.

The column is marked with ""title-column"" CSS class so it is easy to hide
with: visibility:hidden;, but I'm not sure how easy is to detect on which
page to apply this CSS rule.
If you use 1.8.0-SNAPSHOT then maybe you can combine it with the new
#cssClass() special method that may be used to set a custom CSS class. See
http://issues.apache.org/jira/browse/ISIS-1000

Am 26.01.2015 um 23:11 schrieb Dan Haywood <dan@haywood-associates.co.uk>:

+1 to Martin's answer, there is no configuration setting but it is possible
to hack it using Javascript and CSS and the new #cssClass in 1.8.0-SNAPSHOT.

For example, the todo app uses #cssClass() so that completed todo items are
shown in a table with a strikethrough.  This comes from the ""done"" CSS
class:

  public String cssClass() { return !isComplete() ? ""todo"" : ""done""; }


In webapp/css/application.css, if we add:

  tr.done a {
      pointer-events: none;
      cursor: default;
  }

and in webapp/scripts/application.js, if we add:

  $(document).ready(function() {
      $('tr.done a').click(function() { return false; });
  });

then the icon for each completed item cannot be clicked."
ISIS-1020,Bug,Reopened,Dropdown window opens top left of the screen,"The original issue reported here was that the select2 component sometimes renders the drop-down top-left of the screen.

This ticket has been rescoped to just upgrade select2 to 3.5.2.  This was attempted as a fix, but does not address the issue.

We believe that select2 v4 will fix the issue, for this see ISIS-1224.  Note that this depends upon Wicket 7.x (ISIS-1223).

If select2 v4 does not fix the issue, then we have also raised a ticket to rework using the selectize component (ISIS-1225).  This is also our preferred component to implement multi-select (ISIS-709).

~~~~~
Screencast to demonstrate the original issue in Estatio: https://drive.google.com/file/d/0B2jd2Sl73mDBZ0lqYUhtVjVRamc/view?usp=sharing

This is reproducible in both IE11 and Chrome.
"
ISIS-1019,Improvement,Closed,"Upgrade dependencies to javassist, org.reflections","Hi,

as Mike Burton already pointed out [1] there is an issue with Java 8 (possibly interaction with eclipse).

$mvn dependency:tree shows that there are two versions included via: 

javassist:javassist:jar:3.12.1.GA <- org.reflections:reflections:jar:0.9.8
org.javassist:javassist:jar:3.18.1-GA  <- isis-core-unittestsupport, isis-core-metamodel

According to [2], 3.18.2-GA should work with Java 8. 
[3] shows that reflections 0.9.9 uses 3.18.2 as well.

Please update the dependencies if possible.

Best regards
Jörg

[1] https://www.mail-archive.com/users@isis.apache.org/msg01966.html
[2] http://stackoverflow.com/questions/25184467/javassist-in-sync-with-java-8
[3] http://search.maven.org/#artifactdetails%7Corg.reflections%7Creflections%7C0.9.9%7Cjar
"
ISIS-1018,Improvement,Closed,Do not allow http session replacement in Wicket because Shiro knowledge becomes outdated,"While testing Wicket 6.19.0 with Isis I've found that most menu items were not displayed.
The reason was that since http://issues.apache.org/jira/browse/WICKET-5775 Wicket(-auth-roles) replaces the http session after successful login to prevent session fixation attacks.
This leads to problems with Shiro authorizations later because Shiro is not notified about the replacement and keeps using the old http session data.

https://issues.apache.org/jira/browse/SHIRO-170?focusedCommentId=13108301&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13108301 suggests how to do session replacement with Shiro.

With session replacement with Shiro or without any replacement I suggest to make Wicket's Session#replaceSession() a no-op method to avoid any similar problems in the future."
ISIS-1017,Bug,Closed,@PreDestroy annotated method is not called,"When annotating the DomainService ""SimpleObjects"" with 
...
   @PostConstruct
    @Programmatic
    public void init() {
         System.out.println("">>> @PostConstruct init called <<<"");
    }

    @PreDestroy
    @Programmatic
    public void shutdown() {
        System.out.println("">>> @PreDestroy shutdown called <<<"");
    }
...

only the @PostConstruct method will be called out of the box.
Unfortunately, the annotated @PreDestroy method not.

How to reproduce:
1) Checkout, build and check that Simpleapp 1.7.0 or 1.8.0-Snapshot is running.
2) Introduce the mentioned @PostConstruct and @PreDestroy methods
an go sure, that a message will be logged when message is called.
3) build and deploy simpleapp-webapp.war to Tomcat v7.x or Tomcat v8.x 
4) See log / use breakpoints to see that  @PostConstruct method will be successfully called.

15:40:18,311  [Schema               Thread-2   DEBUG]  Schema Transaction closing with connection ""org.datanucleus.store.rdbms.datasource.dbcp.PoolingDataSource$PoolGuardConnectionWrapper@74ce8acd""
>>> @PostConstruct init called <<<
15:40:24,504  [Reflections          Thread-2   INFO ]  Reflections took 3181 ms to scan 125 urls, producing 9629 keys and 59986 values 

5) Stop simpleapp-webapp or redeploy it or even stop tomcat
6) See log / breakpoints and realize that no @PreDestroy method was called.

Negativ side effect is, that every associated connection to JMS / Elastic Search, ... in @PostConstruct cannot be disconnected easily and cleanly.

As a workaround I have tried to activate the section in web.xml:

<!--
    THE FOLLOWING CONFIGURATION IS NOT REQUIRED IF THE WICKET VIEWER IS IN USE.
    IF THE WICKET VIEWER CONFIGURATION IS REMOVED, THEN UNCOMMENT
    --> 

    <listener>
        <listener-class>org.apache.isis.core.webapp.IsisWebAppBootstrapper</listener-class>
    </listener>

    <context-param>
        <param-name>deploymentType</param-name>
        <param-value>SERVER_EXPLORATION</param-value>
    </context-param>

    <context-param>
        <param-name>isis.viewers</param-name>
        <param-value>restfulobjects</param-value>
    </context-param>    

even this is not my scenario. Doing this the annotated methods gets called, but I hit the IsisWicketApplication Error: 
Failed to initialize 
com.google.inject.ProvisionException: Guice provision errors:

1) Error in custom provider, org.apache.isis.core.commons.exceptions.IsisException: Isis Context already set up and cannot be replaced
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  while locating org.apache.isis.core.runtime.system.IsisSystem
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.system(IsisWicketApplication.java:140)
  while locating webapp.SimpleApplication

The cool thing is, that this time both annotated method are called:

16:16:37,713  [Schema               Thread-2   DEBUG]  Schema Transaction closing with connection ""org.datanucleus.store.rdbms.datasource.dbcp.PoolingDataSource$PoolGuardConnectionWrapper@2339e31f""
>>> @PostConstruct init called <<<
16:16:45,196  [Reflections          Thread-2   INFO ]  Reflections took 3259 ms to scan 125 urls, producing 9629 keys and 59986 values 
...
INFORMATION: Cleaning up Shiro Environment
>>> @PreDestroy shutdown called <<<

16:16:53,198  [IsisContext          main       INFO ]  closing all instances
16:16:53,198  [IsisWebAppBootstrapper main       INFO ]  server shut down

Please fix that issue or assist me in creating a workaround.
Thanks,
Peter"
ISIS-1016,New Feature,Closed,Make it possible to use brand logo instead of plain text in the header,"It would be good to be possible to use an image instead of plain text for the top-left corner of the header.

See http://getbootstrap.com/components/#navbar-brand-image"
ISIS-1015,Sub-task,Closed,[WON'T FIX] DataNucleus doesn't support LocalDateTime,"While debugging ISIS-1012 I've found that Kitchensink app doesn't behave correctly for Joda-Time's LocalDateTime: 
org.apache.isis.viewer.wicket.ui.components.scalars.jodatime.JodaLocalDateTimePanel doesn't show the scalar value.

Partially the problem has been solved by moving 
{code}
@javax.jdo.annotations.Persistent(defaultFetchGroup=""true"")
{code}
next to
{code}
@Column(allowsNull = ""true"")
{code}
applied on the property getters.
But it appeared that the actual problem is that DataNucleus 3.x and 4.x do not support Joda-Time's LocalDateTime. There is support for Joda-Time's LocalDate and JSR310/ThreeTen/JDK8 LocalDateTime though.

This ticket is to document the bug. Since there is no urgent need for supporting this type its priority is set to ""Minor"".

Thanks to Dan for the directions!"
ISIS-1014,Improvement,Closed,Modal window improvements,"1. Currently the modal window is located at the top of the screen. We would prefer putting it in the center of the screen. The animation time can be eliminated or reduced and could come out of the center. 

2. We have a request that the user can move the modal window: she wants to be able to see underlying figures sometimes.

3. The user has to click twice on the OK button in order to invoke the modal window.

4. Make pressing the enter key invoke the OK action. 

"
ISIS-1013,New Feature,Closed,Dependent choices with autocomplete,It would be very useful to have the autoComplete methods behave like the dependent choices methods where it is possible to use other action parameters' values.
ISIS-1012,Improvement,Closed,Use the same date and time format across tables and fields,
ISIS-1011,Bug,Closed,Select2 component doesn't filter the suggestions,"In Security module when trying to add a new package to a role if I type ""org"" the suggestions are not filtered.
Additionally if I press ENTER with typed 'org' in the text field it still selects 'com' (because it is the first suggestion)."
ISIS-1010,Bug,Closed,"""Session already open"" error if attempting to login in a second browser tab","Steps:
1) login in an application
2) open a new browser tab and navigate to /wicket/signin
3) try to login with valid credentials

Leads to exception like:

Caused by: java.lang.IllegalStateException: Session already open and context not configured for autoclose
	at org.apache.isis.core.runtime.system.context.IsisContext.applySessionClosePolicy(IsisContext.java:180)
	at org.apache.isis.core.runtime.system.context.IsisContextThreadLocal.openSessionInstance(IsisContextThreadLocal.java:148)
	at org.apache.isis.core.runtime.system.context.IsisContext.openSession(IsisContext.java:273)
	at org.isisaddons.module.security.shiro.IsisModuleSecurityRealm.execute(IsisModuleSecurityRealm.java:206)
	at org.isisaddons.module.security.shiro.IsisModuleSecurityRealm.lookupPrincipal(IsisModuleSecurityRealm.java:135)
	at org.isisaddons.module.security.shiro.IsisModuleSecurityRealm.doGetAuthenticationInfo(IsisModuleSecurityRealm.java:74)
	at org.apache.shiro.realm.AuthenticatingRealm.getAuthenticationInfo(AuthenticatingRealm.java:568)
	at org.apache.shiro.authc.pam.ModularRealmAuthenticator.doSingleRealmAuthentication(ModularRealmAuthenticator.java:180)
	at org.apache.shiro.authc.pam.ModularRealmAuthenticator.doAuthenticate(ModularRealmAuthenticator.java:267)
	at org.apache.shiro.authc.AbstractAuthenticator.authenticate(AbstractAuthenticator.java:198)
	... 56 more


I believe a proper behavior would be: if there is a logged in user then redirect to the home page automatically without even showing the sign in page"
ISIS-1009,Improvement,Closed,Call a @PostConstruct callback for view models,"For view models that directly implement ViewModel interface, their viewModelInit(...) method is called and so they have a hook to do any additional initialization, eg looking up objects etc

But for view models that are annotated using @ViewModel, these have no such hook.

Suggest that we honour @PostConstruct annotation for all view models, as a consistent hook."
ISIS-1008,Improvement,Closed,Make it possible to stream Lobs after using the action prompt,"At the moment it seems it is not possible to stream back to the browser a character or binary content (as response attachment) after using an action prompt (modal window).

If the action doesn't require filling parameters then firing it will execute a normal (non-Ajax) request and streaming content (e.g. PDF, DOCX) is not a problem.
But if there are parameters to be provided then Isis Wicket viewer open a modal window and its OK/Submit action is executed in Ajax request. To be able to stream any Lob content back to the client we need to do something like https://cwiki.apache.org/confluence/display/WICKET/AJAX+update+and+file+download+in+one+blow"
ISIS-1007,New Feature,Closed,"Provide support for ""are you sure"" idiom, eg using a @AreYouSure annotation on the action","... or (post ISIS-970 using @Action(areYouSure=true)

(Instead of @AreYouSure, another name might be @Dangerous or @Action(dangerous=true)).

To include the ""are you sure"" checkbox (or other equivalent UI mechanism), plus also the styling of the action's button, eg make it red and with a suitable icon."
ISIS-1006,Improvement,Closed,Provide a service that knows how to create links to domain objects,"Sometimes it is needed to create links to domain objects in domain services or view models.

The idea is that Isis core provides an interface and each viewer provides an implementation if such is needed."
ISIS-1005,New Feature,Closed,"Allow users to implement an optional service to perform pre-commit processing (""ChangedObjectService"")","For example, Oscar's app has this code everywhere:

    public void updating() {
        this.setDateUpdated(Clock.getTimeAsDateTime().toDate());
        this.setUpdatedByUser(this.domainFactoryService.currentUserName());
    }

Instead, this could be done by passing all objects enlisted in the xactn (same stuff as used by audit service) to a new service.

This should be done immediately prior to calling auditing (so that if additional objects get dirtied by the service, then they are audited also)."
ISIS-1004,Bug,Closed,Infitinite recursion in updating() callback when call setter,"as per: http://isis.markmail.org/thread/6k7jh43xpzohb46k

~~~
could probably solve this by setting a thread-local in the updating callback facet (a wormhole)."
ISIS-1003,Improvement,Closed,"Add ""veto"" as a simpler API for EventBusSubscribers","Rather than having to call hide(), disable() or validate() according to the phase."
ISIS-1002,Improvement,Closed,Recognize (JDO) exceptions for foreign key constraint violations,... so that these can be rendered with meaningful error text to the end user.
ISIS-1001,New Feature,Closed,"[WON'T FIX] For hard-coded methods such as title(), iconName(),  and cssClass(), hidden(), disabled(), validate(), provide an alternative mechanism to specify such methods. ","The methods involved are:
- title()
- iconName()
- cssClass()   (introduced in ISIS-1000)

and the (probably to be deprecated) callback methods:
- loaded()
- saving()/persisting()
- saved()/persisted()
- updating()
- updated()
- removing()/deleting()
- deleted()/deleted()

In all cases, if the method is annotated with @Action (ISIS-990) or with @Programmatic then it no facet should be installed (that is, action takes precedence).

Also, if there is a clashing action, then an annotation should indicate the method (analogous to junit's @Test annotation).  Since these are all hook methods for Isis to call, I suggest the annotation is called @Hook, eg:

{code}
@Hook(HookType.TITLE)
String someOtherMethodActingLikeTitle() { ... }

@Hook(HookType.ICON_NAME)
String someMethodActingLikeIconName() {  .... }

@Hook(HookType.CSS_CLASS)
String someMethodActingLikeCssClass() { ... }
{code}

If an annotation doesn't appeal, we could instead define a special prefix, eg ""__isis_xxx"" (cf JUnit3's testXxx).  For example:

{code}
String __isis_title() { ... }
String __isis_iconName() { ... }
String __isis_cssClass() { ... }"
ISIS-1000,New Feature,Closed,Allow objects to return CSS  class (analogous to iconName() method) so that their presentation can be dynamically reflected in tables or on an object form.,"Suggest:

cssClass() as the method name (at object level).

Reuse CssClassFacet, with a new facet factory to install for the ObjectSpecification.

Update the wicket viewer in two place:
* the CollectionContentsAsAjaxTablePanel should add the CSS to each <tr>
* the EntityCombinedPanel to add the CSS to an appropriate <div> that wraps all the content on the page."
ISIS-999,New Feature,Closed,Provide a log to administrator of which users logged in and logged out,"A log showing the following info (at least) must be available:
* Account who has been logged.
* Date/Time the session has been started.
* Date/Time the session has been ended (by the user or automatically due to inactivity, etc.).

~~~
Suggest that this be specified some sort of new optional service defined in the applib.

If present, then on login and logout we can call this new optional service.

I can imagine there being a requirement to surface this info in the UI, which probably means persisting to a database, ie some sort of new audit entity.

Easiest option is to have the new service could be implemented by isisaddons' isis-module-security?  Or perhaps a completely new isisaddon service if don't want to couple this?  

Not sure how to capture timeouts; is this info available through some sort of Wicket callback?  Perhaps it should be done through a Quartz scheduler service, which can mark sessions as dead if not used for 15 minutes?"
ISIS-998,New Feature,Closed,"Actions that are NOT contributed properties but which return a URL should optionally display that URL inline within an iframe in a new tab (or other ""working area"").","This follows on from ISIS-994, but for actions that are NOT contributed properties.

the idea is that a user can invoke such an action, which returns a URL, and that the resulting page is shown inline in an iframe that in some sense ""belongs"" to the entity on which the action was invoked.

One way to accomplish this might be to dynamically create a new tab (assuming ISIS-993 has been implemented) and display the iframe on that URL.

"
ISIS-997,Wish,Open,[Wish] Extend UserProfileService to allow an avatar to be provided.,"Building on ISIS-990, have the service provide an image or o.a.isis.applib.value.Blob which contains the user's avatar.  Update the Wicket viewer to show the avatar."
ISIS-996,Improvement,Closed,[WON'T FIX] Define component factories as Spring @Components,"was previously:

Not possible to ""replace"" components in Wicket viewer (workaround is to use ""add"")

~~~~~

As per [http://isis.markmail.org/thread/x3k2www3m2wfsgtv]

To recreate:
 - copy ReferencePanelFactory to ReferencePanelFactory2

in (subclass of) IsisWicketApplication, add:
{code:java}
    @com.google.inject.Singleton
    public static class MyComponentFactoryRegistrar extends ComponentFactoryRegistrarDefault {

        @Override
        public void addComponentFactories(ComponentFactoryList componentFactories) {
            super.addComponentFactories(componentFactories);
            componentFactories.replace(new ReferencePanelFactory2());
        }
    }
{code}
and
{code:java}
        final Module overrides = new AbstractModule() {
            @Override
            protected void configure() {
                 ...
                bind(ComponentFactoryRegistrar.class).
                    to(MyComponentFactoryRegistrar.class);
            }
        };
{code}
the issue is that ""replace"" ends up replacing all component factories of type ComponentType.SCALAR_NAME_AND_VALUE, whereas it should instead just replace the one for ReferencePanelFactory.

The workaround is easy enough: call ""add"" (which puts new factory at beginning of list) rather than ""replace""."
ISIS-995,New Feature,Closed,"Allow the label of a property to be rendered as HTML.  Also, allow the label of boolean panels to be rendered on the right hand side.","Suggested syntax is:
{code}
@PropertyLayout(
  named=""Accept <a href=""http://foo.org/terms"">terms</a>?"",
  namedEscaped=false
  labelPosition=LabelPosition.RIGHT
)
{code}

The Javadoc should state that LabelPosition.RIGHT is only supported by boolean panels; if specified for other panels it will be ignored and default to LEFT instead.

"
ISIS-994,New Feature,Closed,Actions that act as contributed properties and which return a URL should display that URL inline within an iframe.,"As per [1] mailing list thread, in particular its screenshot [5],

if a contributed property (= action) returns a URL, then it should be rendered within an iframe.   It may not actually be necessary to require any other metadata.

eg
@Action(semantics=SemanticsOf.SAFE)
@ActionLayout
public URL editor(Asset asset) { ... }



[1] http://markmail.org/message/merftvqoiy6ht3kq
[5] http://postimg.org/image/k83i6b70x/"
ISIS-993,New Feature,Closed,Show different object members on multiple tabs,"4-jan-2016:
Divide the screen into two halves.

All properties in separate tabs.

Each collection in its own tabs.

~~~
as per [1] mailing list thread.

The example in the mailng list splits up the object's properties/collections (contributed or otherwise) into two different sets of tabs... but as a first pass I think a single row of tabs ought to suffice.

We also need to be mindful that we may want to use tabs as a metaphor for multiple opened objects (as a replacement for bookmarks), so this is another reason for a single row of tabs. 

To support this would require extensions to @DomainObjectLayout or equivalent xxx.layout.json file.


[1] http://markmail.org/message/merftvqoiy6ht3kq"
ISIS-992,New Feature,Closed,"[WON'T FIX] Extend Isis metamodel and Wicket viewer so that a ""delete"" action can be automatically provided for deleteable objects.","per [1], 

@DomainObject(
   deleteable=true
   ...
)
public class MyClass { .. }

could be used to automatically generate a delete() action:

public void delete(Entity entity) {
  this.getContainer().remove(entity);
  this.getContainer().flush();
}

~~~~
However, there are some things that need to be thought through here.  For an explicitly coded action there would be all the annotations/metadata in @Action and @ActionLayout.  Where would that information be specified if the action is synthesized on the fly?  Would the @DomainObject annotation need to be extended instead as, for example:

@DomainObject(
    deleteAction=@Action(...),
    ...
)

I'm not completely convinced the extra complexity is worth it to save four lines of code.

[1] http://isis.markmail.org/thread/jdylmfxrzdryhrlq"
ISIS-991,New Feature,Closed,Enhance Wicket viewer so that non-disabled collections can be added to / removed from.,"as per [1] (stuff pertaining to collections)

if collection is not @Disabled, then should render buttons to allow add/remove.

The remove implementation ought to list all current objects.

The add implementation ought to support choicesAddToXxx() and autoCompleteAddToXxx().


[1] http://isis.markmail.org/thread/jdylmfxrzdryhrlq"
ISIS-990,New Feature,Closed,Optional UserProfileService to allow the user profile information to be customized.,"As per this mailing thread [1], support an optional UserProfileService that allows the username on the tertiary menu to be overridden.

Also, the service should provide an image or o.a.isis.applib.value.Blob which contains the user's avatar.

[1] http://isis.markmail.org/thread/jtifwml37paw544p"
ISIS-989,New Feature,Closed,"[WON'T FIX] Allow data being stored to be encrypted, leveraging Cumulus4J","It's possible that this is just a matter of configuration, in which case this JIRA issue will just be a new page on our website.

Or, it might require a little bit of code, eg some sort of switch in isis.properties to enable.

~~~
For info on CumulusJ, see: [1]

[1] http://cumulus4j.org/latest-stable/documentation/getting-started.html"
ISIS-988,Question,Closed,Upgrade to log4j 2 ,"We are using Isis in combination with Elasticsearch ELK Stack (http://www.elasticsearch.org/overview/)  where we send specific log events thru logging framework. Therefore it would be useful if we use log4j 2 features like AsyncAppender, see e.g. http://www.infoq.com/news/2014/07/apache-log4j2 

Regs
Vladimir"
ISIS-987,New Feature,Closed,Provide some sort of mechanism to allow users to self-register for an Isis application.,
ISIS-986,Improvement,Closed,Visibility of contributors pages (http://isis.apache.org/contributors/),"Hi, looking for the page http://isis.apache.org/contributors/contributing.html I found that link to this page and other sibling pages is not shown in e.g. http://isis.apache.org/documentation.html or in ""Help"" menu item.

"
ISIS-985,New Feature,Closed,Filter collections so that objects that are not visible to the current user are not shown.,"There are two bits to this.

First, note that we have similar functionality when rendering an object itself, throwing a 404 if none of the object's members are visible.  However, there should also be a check if the object itself is not visible, ie through a new ObjectVisibility check.  (We already have ObjectValidity check as well as {Action/Property/Collection}Visibility, so all the required concepts exist.

Second, the object visibility check should be used to determine if an object should be rendered in a collection/table.

"
ISIS-984,Wish,Open,"[Wish] Make it possible to use custom icons, not only FontAwesome ones","See discussion at: http://markmail.org/message/nhm7eflnrru2rvcr

The idea is to replace ActionLayout#cssClassFa and ActionLayout#cssClassFaPosition with ActionLayout#icon.
Icon will be an interface/abstract class.
Isis will provide impl for FontAwesome.
Each application will be able to provide its own impl for any icon type it needs/wants to use (e.g. http://icons8.com/, http://glyphsearch.com/, http://glyphsearch.com/, etc.). "
ISIS-983,New Feature,Closed,Embedded Neo4J support,
ISIS-982,Wish,Closed,"Change the name of the ""Apache Isis"" project into something else",This name coincides with terrorist organisation. Its name can attract unwilling attention . Request you to rename the project.
ISIS-981,Improvement,Closed,Should be able to use the wrapper factory when installing fixtures.,"as per http://isis.markmail.org/thread/sny6dchkzkiy6bpb
"
ISIS-980,Improvement,Closed,Do not render empty sub-menu sections in the tertiary actions menu panel ,"When there are no tertiary menu items there is an empty section, a separator and the logout menu item.
The empty section and the separator could be removed. 
See the attachment."
ISIS-979,New Feature,Closed,Provide a new widget for collections to render hierachies in a tree-table.,"this is a duplicate of ISIS-898, so an closing.  The description that was here I've moved to that other ticket."
ISIS-978,Wish,Open,[Wish] Allow bookmarking of app menus as submenus,"Jeroen showed me a 3rd-party app once that did this (SugarCRM); I think we're now in striking distance of being able to implement it within Isis.

Basically, the idea is that, if there are a bunch of ""finder""/query actions in the application menu bar, then whenever invoked these should capture that invocation as a bookmark (we already can do this) but render that bookmark *not* in our bookmark panel but instead as a submenu of the application menu.

In other words, when the user selects a menu item from a top-level menu, they can also easily see (in the submenu) previous invocations of that query.

These could even be pinnable or retained across sessions.

~~~
Raising this now not because necessarily want to implement it, but just to reserve the idea that submenus of menu items are not for further actions, but instead might hold these bookmarks.

~~~
Jeroen: can you dig out and attach a screenshot of SugarCRM?"
ISIS-977,New Feature,Closed,Allow the application menus to be specified using a appmenu.layout.xml file.,"encapsulating the information in @DomainServiceLayout and @MemberOrder, eg:

{
  ""PRIMARY"": [
      ""FixedAssets"": {
        ""org.estatio.dom.assets.Properties"": {
          ""actions"": {
            ""newProperty"": {
              ""cssClassFa"": ""...""
            },
            ""findProperties"": {
              ...
            }
          }
        },
        ""org.estatio.dom.assets.Units"": {
          ...
        },
        ""org.estatio.dom.assets.FixedAssetRegistrations"": {
          ...
        }
      },
      ""Parties"": {
        ...
      },
      ...
   ],
   ""SECONDARY"": [
     ""Prototyping"": {
        ...
     },
     ""Changes"": {
        ...
     },
     ""Security"": {
        ...
     }
   ],
   ""TERTIARY"": {
     ""org.estatio.webapp.services.admin.EstatioAdministrationService"": {
       ""updateEpochDate"": {},
       ""listAllSettings"": {}
     }
     ""org.estatio.webapp.services.other.OtherServices"": {
       ""execute"": {
          ""cssClassFa"": ""fa-bolt""
       },
       ...       
     }
   }
 }"
ISIS-976,Wish,Open,[Wish] Add a checkbox on footer to allow prototype actions to be hidden in the Wicket viewer,"My thoughts on this is that this would be per-user rather than a singleton, but probably pluggable.  The default implementation could store in the (Wicket wrapper for) HttpSession.

UI would be a button on the bottom toolbar (alongside ""About"", only rendered if running in prototype mode); perhaps make the ""About"" into a drop-down menu).  It would provide a checkbox to hide prototype actions.

The implementation would be to enhance the PrototypeFacet so that it implements HidingInteractionAdvisor.  The implementation should delegate to an injected new service which would wrap the HttpSession, simply indicating whether prototype actions are visible or not, eg:

public interface PrototypeActionVisibilityService {
    boolean isHidden();
}

This would be injected into the FacetFactory (we do something similar with other services) and passed down to the PrototypeFacet.

In terms of providing a default impl, could write a PrototypeActionVisibilityServiceUsingWicketHttpSession, annotated as @DomainService, and this would be automatically available.  If the user writes their own impl and registers in isis.properties then this would take precedence.



"
ISIS-975,Improvement,Closed,"[WON'T FIX] Allow the prototype facet to be associated with properties and collections, not just actions.","Currently we have the ability to make actions into a prototype, meaning that they are only shown in prototype mode (--type SERVER_PROTOTYPE or Wicket development mode) and hidden during production mode (--type SERVER, or Wicket deployment mode).

Because of they way that they are implemented, contributed properties and contributed collections also ""inherit"" this prototyped-ness; they will also be hidden in prototype mode.

However, there is no way to hide regular (non-contributed) properties or collections when not running in prototype mode.

~~~
Don't think that this is a particularly significant issue, but it is an area of asymmetry in our metamodel so should probably be cleaned up, ie by introducing the notion of prototype for properties or collections.

This should be implemented as a new ""prototype"" attribute in @PropertyLayout and @CollectionLayout.

The Wicket viewer will need to honour this when rendering the entity forms (EntityPropertiesForm component etc)."
ISIS-974,Improvement,Closed,[WON'T FIX] Provide the ability to associate font-awesome icons with properties,"ie as per http://fortawesome.github.io/Font-Awesome/examples/#bootstrap

using:

@PropertyLayout(
    cssClassFa=""fa fa-fw fa-envelope-o""
)
public String getEmailAddress() { ... }

etc."
ISIS-973,Improvement,Closed,Simplify the FixtureScript API so that child fixtures are executed using the ExecutionContext object,"... and deprecate the old API.

This centralizes the responsibility of handling child fixtures into ExecutionContext (along with ""adding results""), rather than have them spread amongst inherited functionality from FixtureScript abstract superclass."
ISIS-972,Improvement,Closed,Make it possible to set FontAwesome icons after the label for action links,"By using org.apache.isis.applib.annotation.ActionLayout#cssClassFa() one can set a custom FontAwesome icon for an action link.
The small issue that I see in ToDo App is that the icon is used always as a prefix for the link's label.
Sometimes it may make more sense to use if as a suffix, e.g. for the ""Next"" link in ""Priority"" section. See screenshot."
ISIS-971,Bug,Closed,Ignore anonymous classes which inherit from @DomainService (eg in integ tests).,
ISIS-970,Improvement,Closed,"Introduce new annotations to collect together all non-UI (layout) hints, and deprecate old annotations","specifically:
{code}
@DomainObject(
    auditing = ENABLED etc. (AuditingPolicy)            // instead of @Audited
    publishing = ENABLED etc. (PublishingPolicy)        // instead of @PublishedObject
    publishingPayloadFactory = SomePayloadFactory.class // instead of @PublishedObject(payloadFactory=...)
    autoCompleteRepository = SomeRepository.class       // instead of @AutoComplete(repository=...)
    autoCompleteAction = ""autoComplete""                 // instead of @AutoComplete(action=...)
    bounded = true|false                                // instead of @Bounded.  takes precedence over autoComplete
    editing = ENABLED etc (EditingPolicy)               // instead of @Immutable
    editingDisabledReason = ""...""                       // instead of ""Always disabled"" message inferred from @Immutable
    objectType = ""CUS""                                  // instead of @ObjectType
    nature = JDO_ENTITY | EXTERNAL_ENTITY | VIEW_MODEL    // instead of @ViewModel, defaults to JDO_ENTITY
)
{code}
and
{code}
@Property(
    domainEvent = ToDoItem.DueBy.class        // instead of @PropertyInteraction
    hidden = Where.NOWHERE etc                // instead of @Hidden(where=...); ignore the When enum
    editing = ENABLED etc (EditingPolicy)     // instead of @Disabled; ignore Where and When enums
    editingDisabledReason = ""...""             // instead of @Disabled(reason=...)
    maxLength = 20                            // instead of @MaxLength; default of -1 indicates not specified
    mustSatisfy  = {SomeSpecification.class}  // instead of @MustSatisfy
    notPersisted = true|false                 // instead of @NotPersisted; defaults to false
    optional = DEFAULT|TRUE|FALSE             // instead of @Optional and @Mandatory.  
    regexPattern  = "".+\@.+""                  // instead of @RegEx(validation=...)
    regexPatternFlags = 1                     // superset of @RegEx(caseSensitive=...)
)
{code}
where cardinality defaults to mandatory unless Column(allowsNull=""true"") is set.

and
{code}
@Collection(
    domainEvent = ToDoItem.Dependencies.class // instead of @CollectionInteraction
    hidden = Where.NOWHERE etc                // instead of @Hidden(where=...); ignore the When enum
    editing = ENABLED etc (EditingPolicy)     // instead of @Disabled; ignore Where and When enums
    editingDisabledReason = ""...""             // instead of @Disabled(reason=...)
    typeOf = OrderLine.class                  // instead of @TypeOf
)
{code}
and
{code}
@Action(
    domainEvent = ToDoItem.Completed.class              // instead of @ActionInteraction
    hidden = Where.NOWHERE etc                          // instead of @Hidden(where=...); ignore the When enum
    semantics = Semantics.SAFE etc.                     // instead of @ActionSemantics
    invokeOn = InvokeOn.OBJECTS_AND_COLLECTIONS         // instead of @Bulk and @Bulk(appliesTo=...)
    command = ENABLED|DISABLED|AS_CONFIGURED            // instead of @Command
    commandPersistence = Persistence.PERSISTED          // instead of @Command(persistence=...)
    commandExecuteIn = ExecuteIn.FOREGROUND             // instead of @Command(executeIn=...)
    publishing = ENABLED etc. (PublishingPolicy)        // instead of @PublishedAction
    publishingPayloadFactory = SomePayloadFactory.class // instead of @PublishedAction(payloadFactory=...)
    restrictTo = Environment.DEVELOPMENT                // instead of @Prototype
    typeOf = OrderLine.class                            // instead of @TypeOf
)
{code}
nb: @Disabled is no longer provided for actions (use imperative disableXxx() method instead if required)
and
{code}
@Parameter(
    maxLength = 20                            // instead of @MaxLength; default of -1 indicates not specified
    minLength   = 3                               // instead of @MinLength
    mustSatisfy = {SomeSpecification.class}       // instead of @MustSatisfy
    optional = DEFAULT|TRUE|FALSE             // instead of @Optional and @Mandatory.  
    regexPattern  = "".+\@.+""                      // instead of @RegEx(validation=...)
    regexPatternFlags = 1                         // superset of @RegEx(caseSensitive=...)
)    
{code}

for ISIS-964:
{code}
@DomainObjectLayout {
    bookmarking = NEVER (BookmarkingPolicy)      // instead of @BookmarkPolicy
}
{code}
and
{code}
@ActionLayout {
    bookmarking = NEVER (BookmarkingPolicy)      // instead of @BookmarkPolicy
}
{code}
and remove
@ActionLayout {
    prototype = true|false
}



This would result in the fully supported non-deprecated Isis annotations reducing substantially:
- @DomainService  and @DomainServiceLayout
- @DomainObject  and @DomainObjectLayout
- @Property   and @PropertyLayout
- @Collection and @CollectionLayout
- @Action and @ActionLayout
- @Parameter and @ParameterLayout

with two further additional UI hints:
- @Title
- @MemberGroupLayout

All the above @XxxLayout annotations can instead be specified using a .layout.json file.

The following 3rd-party annotations also supported:
- @javax.validation.constraints.Digits
- @javax.enterprise.context.RequestScoped    
- @javax.jdo.annotations.*

There are also some annotations that need sorting out for contributed actions, specifically:
- @NotContributed(As.xxx)
- @NotInServiceMenu

... for these, see ISIS-968

Also need to figure out the best way to capture the semantics of properties and collections that are contributees (whose semantics are inferred from the contributing action)


~~~
There are still a number of partially supported annotations, mostly pertaining to value types and other DDD ideas).  Need to decide what to do with them; deprecate/remove or keep and fully implement?  They are:
- @Value
- @Defaulted
- @Encodeable
- @EqualByContent
- @Parseable
- @Aggregated
- @NotPersistable
- @Facets
"
ISIS-969,Improvement,Closed,"Create new @DomainServiceLayout annotation, and move UI hints out of @DomainService","Specifically, @DomainService(menuOrder=..., menuBar=...)"
ISIS-968,Improvement,Closed,Rationalize handling of menu actions and contributed actions,"Currently we have the following annotations:
* on the domain service: @Hidden - to hide all actions (still in the metamodel); nb: this has been deprecated in ISIS-970 with no replacement
* on the action: @NotContributed to suppress being contributed, optionally @NotContributed(As.ASSOCIATION) or @NotContributed(As.ACTION); is still in menu
* on the action: @NotInServiceMenu to suppress being in menu; can still be contributed.

This is all somewhat clumsy, and the negative @NotXxx annotations are confusing to read (@NotContributed(As.Xxx) in particular).

~~~
In Naked Objects MVC they distinguish between three different ""types"" of service:
- menu services (actions are on menus and are contributed)
- contributions (actions are only ever contributed)
- system services (actions never appear on menu or are contributed).

This separation works well; ""domain-level"" system services (typically factories and repositories) are injected into the ""view-level"" menu or contribution services.
~~~

This ticket proposes:

Extend @DomainService to characterize the nature of each domain (similar to NO MVC):
{code}
@DomainService(nature=VIEW | VIEW_MENU | VIEW_CONTRIBUTIONS | DOMAIN )
{code}

where:
* VIEW = current behaviour, and the default
* VIEW_MENU = actions are not contributed
* VIEW_CONTRIBUTIONS = in other words actions are not in service menu
* DOMAIN = are not shown in view ie actions implicitly hidden

In addition, extend @ActionLayout to include further UI hints:

{code}
@ActionLayout(
    contributedAs    = ACTION|ASSOCIATION|BOTH   // default is ""BOTH""; equivalent (inverse of) the current @NotContributed(As.Xxx)
)
{code}

which for domain service of VIEW or VIEW_CONTRIBUTIONS can restrict the contribution if required.

"
ISIS-967,New Feature,Closed,Let the LayoutMetadataReader implementation(s) be configured using isis.properties.,
ISIS-966,Bug,Closed,Restful viewer doesn't return a JSON representation when hits a 500 internally (instead getting an HTML page),"originally raised on the dev mailing list by Erik de Hair...

~~~
I've reproduce the issue, by introducing a deliberate bug in the todo app, changing one of the queries in ToDoItem:

    @javax.jdo.annotations.Query(
            name = ""findByOwnedByAndCompleteIsFalse"", language = ""JDOQL"",
            value = ""SELECT ""
                    + ""FROM dom.todo.ToDoItem ""
                    + ""WHERE ownedBy == :ownedBy ""
                    + ""   && complete = false""),


where ""complete == false""  has been changed to ""complete = false"".

In the Wicket viewer - as hoped - I got the error page with a big nasty stacktrace that included:

javax.jdo.JDOUserException
Invalid operator ""="". Did you mean to use ""==""?
org.datanucleus.api.jdo.NucleusJDOHelper#getJDOExceptionForNucleusException(NucleusJDOHelper.java:549)
org.datanucleus.api.jdo.JDOQuery#executeWithMap(JDOQuery.java:351)
org.apache.isis.objectstore.jdo.datanucleus.persistence.queries.PersistenceQueryFindUsingApplibQueryProc



In the Restful viewer, when I invoked http://localhost:8080/restful/services/ToDoItems/actions/notYetComplete/invoke I got something an HTML error:

HTTP ERROR 500

Problem accessing /restful/services/ToDoItems/actions/notYetComplete/invoke. Reason:

    javax.jdo.JDOUserException: Invalid operator ""="". Did you mean to use ""==""?
NestedThrowables:
org.datanucleus.store.query.QueryCompilerSyntaxException: Invalid operator ""="". Did you mean to use ""==""?
Caused by:

org.apache.isis.core.commons.exceptions.IsisException: javax.jdo.JDOUserException: Invalid operator ""="". Did you mean to use ""==""?
NestedThrowables:
org.datanucleus.store.query.QueryCompilerSyntaxException: Invalid operator ""="". Did you mean to use ""==""?
	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:217)
	at org.apache.isis.core.runtime.transaction.facets.ActionInvocationFacetWrapTransaction.invoke(ActionInvocationFacetWrapTransaction.java:54)
	at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionImpl.execute(ObjectActionImpl.java:367)
	at org.apache.isis.viewer.restfulobjects.server.resources.DomainResourceHelper.invokeActionUsingAdapters(DomainResourceHelper.java:306)
	at org.apache.isis.viewer.restfulobjects.server.resources.DomainResourceHelper.invokeActionQueryOnly(DomainResourceHelper.java:251)
	at org.apache.isis.viewer.restfulobjects.server.resources.DomainServiceResourceServerside.invokeActionQueryOnly(DomainServiceResourceServerside.java:165)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)


~~~~

So, I think the issue is that the Restful viewer, although it's throwing a 500 response error as expected, is also returning HTML rather than JSON error page.  
"
ISIS-965,Wish,Closed,[Duplicate] Provide a keyboard shortcut facet so that actions can be invoked using short cuts.,
ISIS-964,New Feature,Closed,"Unify UI hints into @XxxLayout annotations with corresponding support in .layout.json for properties, collections and actions.","{code}
@ClassLayout
@PropertyLayout
@CollectionLayout
@ActionLayout
@ParameterLayout
{code}"
ISIS-963,New Feature,Closed,"Allow service actions to be rendered either on a primary, secondary or tertiary (the ""me"" icon) menu","Extend @DomainService to allow an additional menuBar() attribute to be specified, eg:

@Named(""Prototyping"")
@DomainService(menuBar=MenuBar.SECONDARY)
public class MyFixtureScriptsService  {
   ///
}"
ISIS-962,Improvement,Closed,"Update all Wicket viewer HTML to use html5 doctype (also fixed in ""v1 maintenance"")","ie <!DOCTYPE html>

also: update website to explain how to configure IntelliJ and Eclipse's file templates to use HTML5 by default."
ISIS-961,Bug,Closed,"Throwing exception in application code does NOT abort the transaction (it should, of course).","Is an issue in 1.7.0, don't know if an issue earlier (but suspect it may well be).

Note that this ""only"" effects the domain code, so it won't affect all applications.

If an exception is thrown by the DBMS, then the transaction is still aborted."
ISIS-960,Improvement,Closed,The event bus swallows errors thrown in the subscribers,The event bus swallows errors thrown in the subscribers so it's returning false positives on validate and other phases.
ISIS-959,Task,Closed,Update Jackson dependency from 1.9.11 to 2.4.3,See http://markmail.org/message/lc37rxwrowzqtzdh and  https://github.com/apache/isis/pull/8
ISIS-958,New Feature,Closed,[WON'T FIX] [DUPLICATE] Create a custom distribution of TomEE containing the Isis jars,"Using ""Maven TomEE Plugin"", http://tomee.apache.org/tomee-maven-plugin.html

See also ISIS-957.
"
ISIS-957,Improvement,Closed,[WON'T FIX] [DUPLICATE] Bundle up Isis apps using TomEE Maven plugin rather than jetty-console,"[http://rmannibucau.wordpress.com/2014/03/24/java-jar-my-app-in-tomee-jar/]

 

should get for free as result of re-platforming to SpringBoot/MicroProfile"
ISIS-956,New Feature,Closed,Allow fa-icons to be specified using pattern matching on member names.,"eg to be able to add the following into isis.properties:
{code}
isis.reflector.facet.cssClassFa.patterns=\
                        create.*:fa-plus,\
                        update.*:fa-edit,\
                        add.*:fa-plus-square,\
                        remove.*:fa-minus-square,\
                        move.*:fa-exchange,\
                        first.*:fa-star,\
                        find.*:fa-search,\
                        clear.*:fa-remove,\
                        previous.*:fa-step-backward,\
                        next.*:fa-step-forward,\
                        list.*:fa-list
{code}"
ISIS-955,Improvement,Closed,Merge JDO Java Type Mapping for Money.,Review and merge https://github.com/h2000/isis-jdo-value-mapping.
ISIS-954,Bug,Closed,Duplicate menu items in the application menu,"eg in Todo app, if change:

@DomainService(menuOrder = ""20"")
@Named(""Analysis"")
public class ToDoItemAnalysis { ... }

to

@DomainService(menuOrder = ""20"")
@Named(""Prototyping"")
public class ToDoItemAnalysis { ... }


then, because there is also:

@DomainService(menuOrder = ""40.1"")
@Named(""Prototyping"")
public class ToDoItemsFixturesService extends FixtureScripts { ... }


this will  result in two ""Prototyping"" menu items.

"
ISIS-953,Improvement,Closed,Minor enhancements to Fixture script execution context,"Parse parameters into map, allow parameters to be ""set"" (if not present.
"
ISIS-952,Improvement,Closed,"Add-ons with entities (audit, command, publishing, security, sessionlogger, settings, tags) should use DB schemas","for example, rather than a table ""IsisSecurityPermissions"" in the default schema, should be a table ""Permissions"" in the ""IsisAddonsSecurity"" DB schema."
ISIS-951,New Feature,Closed,Add menu separators (bootstrap dividers) when multiple services define actions on the same menu ,"ie, using (via MemberOrder(name=...)

eg
{code:java}
public class Users {
    @MemberOrder(name=""Security"", sequence=""1"")
    public void newUser() { ... }
    @MemberOrder(name=""Security"", sequence=""2"")
    public void findUsers() { ... }
}
{code}

and
{code:java}
public class Roles {
    @MemberOrder(name=""Security"", sequence=""1"")
    public void newRole() { ... }
    @MemberOrder(name=""Security"", sequence=""2"")
    public void findRoles() { ... }
}
{code}

should be rendered as

Security
   New User
   Find Users
   ---------------
   New Role
   Find Roles
"
ISIS-950,Improvement,Closed,Suppress stack trace from Error page if exception is recognised.,
ISIS-949,Improvement,Closed,Refactor Bulk.Interaction to remove special case handling (make into a regular request-scoped service).,"specifically, the special case handling that remains in
- IsisTransactionManager#initOtherApplibServicesIfConfigured
- IsisTransaction#closeOtherApplibServicesIfConfigured

in ISIS-948, see that the special case handling for EventBusService was removed by introducing a request-scoped service; hopefully something similar could be done for Bulk.Interaction service."
ISIS-948,Improvement,Closed,"Fix concurrent exception in EventBus, improve support for request-scoped services","This ticket was prompted originally by [1], flagging up a concurrency issue.

The background here is that EventBusService (a singleton) manages the registered subscribers for the guava EventBus, but the EventBus itself is stored internally by the framework on IsisSession, ie is in effect request-scoped.  There are some special-case hooks to call open() and close() on EventBusService when the xactn is started/completed so that the service can call register() on the guava EventBus object for each interaction.

The concurrency exception is (I think) because the set used in EventBusService was not thread-safe; should've been ConcurrentHashSet or similar.

~~~
Thinking about this issue has led me to consider whether the guava EventBus should have been singleton rather than request-scoped, in particular with respect to whether we can accommodate request-scoped subscriber services as well as singleton services.   Have come to the conclusion that it doesn't actually matter either way; it would be safe to have a singleton event bus having request-scoped services as subscribers because the proxies for those services would always route the method call to the on(Event) to the appropriate underlying service from its proxy's threadlocal.

That said, have decided to keep the EventBus request-scoped.  But rather than have all the special case logic, instead wrap the guava EventBus in a new RequestScopedEventBus domain service (as its name suggests, is @RequestScoped) and have this act as the container of the guava EventBus and also keep track of the subscribers.

For its part, the original EventBusService remains as a singleton whose job it is to keep track of all the subscribers.  Some of these are singletons that will register in the system bootstrapping (during their @PostConstruct lifecycle).  Some of these might also be request-scoped services.  So far as possible want the model to be the same... that they can register in their own @PostConstruct lifecycle.  Now for these request-scoped services, the @PostConstruct should actually be called after injection of the EventBusService...  The one slight modification is that they should not register themselves but instead their proxy.  They can get hold of their proxy simply by having it be injected:

eg.
{code:java}
@RequestScoped @DomainService
public class MySubscribingService {

    private EventBusService ebs;
    public void injectEventBusService(EventBusService ebs) { this.ebs = ebs; }

    private MySubscribingService proxy;
    public void injectProxy(MySubscribingService proxy) { this.proxy = proxy; }

    @PostConstruct
    public void startRequest() {
       ebs.register(proxy);
    }

    @PreDestroy
    public void endRequest() {
       ebs.unregister(proxy);
    }

}
{code}

Note also that we now allow injection into request-scoped services (though must use injectXxx rather than @Inject xxx).

In the EventBusService, because request-scoped services might be continually registering and unregistering, but also each will be registering their proxy, then this needs to change to do reference counting.  Thus, if there are two concurrent threads then the MySubscribingService (above) will be instantiated twice, each held in the thread-local of the proxy.  This proxy will (in the @PostConstruct) be registered with the EventBusService twice (for each thread), but of course that proxy should only be registered with the guava EventBus once.

The RequestScopedEventBus is responsible for instantiating the guava EventBus, but it does this lazily, when the first call to post(...) is made.  At this time it calls back to the EventBusService asking for the current subscribers.  The EventBusService will return all the singletons (because they will always have a reference count = 1) plus it will return the proxy of all the subscribing request-scoped services (because there will always at least one current thread that would've caused its proxy to have been registered).

As I say, an alternative design could probably have dispensed with the reference counting and having the guava EventBus being request-scoped; this simpler design would instead simply hold a set of subscribers in EventBusService.   The singleton subscribing services would all be added during bootstrap, while the (singleton) proxy for all the request-scoped subscribing services would be added in the very first transaction.

Might end up refactoring to this simpler design as and when we bring CDI into the mix.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
UPDATE: as the commits below perhaps indicate, in the end I've decided to go the extra step and to refactor the design so that the guava EventBus is a singleton, held by EventBusService (and new'd up by the EventBusServiceDefault subclass).  This removes lots of complexity at the expense of a no-longer fully symmetric design:
- the event bus is new'd up only when needed, NOT in the @PostConstruct of the EventBusService
- request-scoped services get re-registered for each subsequent xactn, and these additional re-registrations are simply ignored.  
- request-scoped services must NOT unregister themselves.  In fact, the EventBusService's unregister is now a no-op.

Have also added in some checks to ensure that request-scoped services only ever register their proxy.


[1] http://isis.markmail.org/thread/o5zbm54cpb4tizqt"
ISIS-947,Bug,Closed,Todo webapp throws exception when logging in DEBUG mode,"Hi Dan, here steps to reproduce.

1. create todo thru archetype
2. adapt logging.properties (file webapp\src\main\webapp\WEB-INF\logging.properties) - uncomment line 23

log4j.rootCategory=DEBUG, Console

3. start the webapp

here the exception in console
{code}
14:24:04,469  [IsisWicketApplication main       ERROR]  Failed to initialize
com.google.inject.ProvisionException: Guice provision errors:

1) Error in custom provider, java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  while locating org.apache.isis.core.runtime.system.IsisSystem
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.system(IsisWicketApplication.java:124)
  while locating webapp.ToDoApplication

1 error
	at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:451)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:65)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:229)
	at org.apache.wicket.Application.initApplication(Application.java:823)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:85)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
Caused by: java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
	at org.apache.isis.core.runtime.services.ServiceInstantiator$2.invoke(ServiceInstantiator.java:159)
	at org.apache.isis.applib.services.queryresultscache.QueryResultsCache_$$_javassist_2.toString(QueryResultsCache_$$_javassist_2.java)
	at java.lang.String.valueOf(Unknown Source)
	at java.lang.StringBuilder.append(Unknown Source)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.invokeInjectorField(ServicesInjectorDefault.java:268)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowire(ServicesInjectorDefault.java:191)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowireViaFields(ServicesInjectorDefault.java:175)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServices(ServicesInjectorDefault.java:159)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServicesInto(ServicesInjectorDefault.java:126)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServicesInto(ServicesInjectorDefault.java:132)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowireServicesAndContainer(ServicesInjectorDefault.java:281)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.setServices(ServicesInjectorDefault.java:80)
	at org.apache.isis.core.runtime.persistence.PersistenceSessionFactoryDelegating.init(PersistenceSessionFactoryDelegating.java:133)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactoryDefault.init(IsisSessionFactoryDefault.java:197)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:122)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:133)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
	at java.lang.reflect.Method.invoke(Unknown Source)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	... 20 more
14:24:04,486  [WicketFilter         main       ERROR]  The initialization of an application with name 'WicketFilter' has failed.
com.google.inject.ProvisionException: Guice provision errors:

1) Error in custom provider, java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  while locating org.apache.isis.core.runtime.system.IsisSystem
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.system(IsisWicketApplication.java:124)
  while locating webapp.ToDoApplication

1 error
	at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:451)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:65)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:229)
	at org.apache.wicket.Application.initApplication(Application.java:823)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:85)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
Caused by: java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
	at org.apache.isis.core.runtime.services.ServiceInstantiator$2.invoke(ServiceInstantiator.java:159)
	at org.apache.isis.applib.services.queryresultscache.QueryResultsCache_$$_javassist_2.toString(QueryResultsCache_$$_javassist_2.java)
	at java.lang.String.valueOf(Unknown Source)
	at java.lang.StringBuilder.append(Unknown Source)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.invokeInjectorField(ServicesInjectorDefault.java:268)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowire(ServicesInjectorDefault.java:191)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowireViaFields(ServicesInjectorDefault.java:175)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServices(ServicesInjectorDefault.java:159)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServicesInto(ServicesInjectorDefault.java:126)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServicesInto(ServicesInjectorDefault.java:132)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowireServicesAndContainer(ServicesInjectorDefault.java:281)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.setServices(ServicesInjectorDefault.java:80)
	at org.apache.isis.core.runtime.persistence.PersistenceSessionFactoryDelegating.init(PersistenceSessionFactoryDelegating.java:133)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactoryDefault.init(IsisSessionFactoryDefault.java:197)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:122)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:133)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
	at java.lang.reflect.Method.invoke(Unknown Source)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	... 20 more
14:24:04,516  [ObjectReflectorDefault main       INFO ]  shutting down org.apache.isis.core.metamodel.specloader.ObjectReflectorDefault@44a2786
14:24:04,516  [Application          main       INFO ]  [WicketFilter] destroy: Wicket extensions initializer (wicket-jquery-ui-plugins)
14:24:04,516  [Application          main       INFO ]  [WicketFilter] destroy: Wicket core library initializer
14:24:04,516  [Application          main       INFO ]  [WicketFilter] destroy: Wicket extensions initializer
14:24:04,542  [log                  main       WARN ]  failed WicketFilter: javax.servlet.ServletException: com.google.inject.ProvisionException: Guice provision errors:

1) Error in custom provider, java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  while locating org.apache.isis.core.runtime.system.IsisSystem
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.system(IsisWicketApplication.java:124)
  while locating webapp.ToDoApplication

1 error
14:24:04,542  [log                  main       DEBUG]  EXCEPTION 
javax.servlet.ServletException: com.google.inject.ProvisionException: Guice provision errors:

1) Error in custom provider, java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  while locating org.apache.isis.core.runtime.system.IsisSystem
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.system(IsisWicketApplication.java:124)
  while locating webapp.ToDoApplication

1 error
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:450)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:85)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
Caused by: com.google.inject.ProvisionException: Guice provision errors:

1) Error in custom provider, java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  while locating org.apache.isis.core.runtime.system.IsisSystem
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.system(IsisWicketApplication.java:124)
  while locating webapp.ToDoApplication

1 error
	at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:451)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:65)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:229)
	at org.apache.wicket.Application.initApplication(Application.java:823)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	... 16 more
Caused by: java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
	at org.apache.isis.core.runtime.services.ServiceInstantiator$2.invoke(ServiceInstantiator.java:159)
	at org.apache.isis.applib.services.queryresultscache.QueryResultsCache_$$_javassist_2.toString(QueryResultsCache_$$_javassist_2.java)
	at java.lang.String.valueOf(Unknown Source)
	at java.lang.StringBuilder.append(Unknown Source)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.invokeInjectorField(ServicesInjectorDefault.java:268)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowire(ServicesInjectorDefault.java:191)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowireViaFields(ServicesInjectorDefault.java:175)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServices(ServicesInjectorDefault.java:159)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServicesInto(ServicesInjectorDefault.java:126)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServicesInto(ServicesInjectorDefault.java:132)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowireServicesAndContainer(ServicesInjectorDefault.java:281)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.setServices(ServicesInjectorDefault.java:80)
	at org.apache.isis.core.runtime.persistence.PersistenceSessionFactoryDelegating.init(PersistenceSessionFactoryDelegating.java:133)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactoryDefault.init(IsisSessionFactoryDefault.java:197)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:122)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:133)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
	at java.lang.reflect.Method.invoke(Unknown Source)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	... 20 more
14:24:04,545  [log                  main       ERROR]  Nested in javax.servlet.ServletException: com.google.inject.ProvisionException: Guice provision errors:

1) Error in custom provider, java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  while locating org.apache.isis.core.runtime.system.IsisSystem
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.system(IsisWicketApplication.java:124)
  while locating webapp.ToDoApplication

1 error:
com.google.inject.ProvisionException: Guice provision errors:

1) Error in custom provider, java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  while locating org.apache.isis.core.runtime.system.IsisSystem
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.system(IsisWicketApplication.java:124)
  while locating webapp.ToDoApplication

1 error
	at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:451)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:65)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:229)
	at org.apache.wicket.Application.initApplication(Application.java:823)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:85)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
Caused by: java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
	at org.apache.isis.core.runtime.services.ServiceInstantiator$2.invoke(ServiceInstantiator.java:159)
	at org.apache.isis.applib.services.queryresultscache.QueryResultsCache_$$_javassist_2.toString(QueryResultsCache_$$_javassist_2.java)
	at java.lang.String.valueOf(Unknown Source)
	at java.lang.StringBuilder.append(Unknown Source)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.invokeInjectorField(ServicesInjectorDefault.java:268)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowire(ServicesInjectorDefault.java:191)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowireViaFields(ServicesInjectorDefault.java:175)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServices(ServicesInjectorDefault.java:159)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServicesInto(ServicesInjectorDefault.java:126)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServicesInto(ServicesInjectorDefault.java:132)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowireServicesAndContainer(ServicesInjectorDefault.java:281)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.setServices(ServicesInjectorDefault.java:80)
	at org.apache.isis.core.runtime.persistence.PersistenceSessionFactoryDelegating.init(PersistenceSessionFactoryDelegating.java:133)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactoryDefault.init(IsisSessionFactoryDefault.java:197)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:122)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:133)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
	at java.lang.reflect.Method.invoke(Unknown Source)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	... 20 more
14:24:04,546  [log                  main       WARN ]  Failed startup of context org.mortbay.jetty.webapp.WebAppContext@3f952ad4{,src/main/webapp}
javax.servlet.ServletException: com.google.inject.ProvisionException: Guice provision errors:

1) Error in custom provider, java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  while locating org.apache.isis.core.runtime.system.IsisSystem
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.system(IsisWicketApplication.java:124)
  while locating webapp.ToDoApplication

1 error
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:450)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:85)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
Caused by: com.google.inject.ProvisionException: Guice provision errors:

1) Error in custom provider, java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  while locating org.apache.isis.core.runtime.system.IsisSystem
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.system(IsisWicketApplication.java:124)
  while locating webapp.ToDoApplication

1 error
	at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:451)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:65)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:229)
	at org.apache.wicket.Application.initApplication(Application.java:823)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	... 16 more
Caused by: java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
	at org.apache.isis.core.runtime.services.ServiceInstantiator$2.invoke(ServiceInstantiator.java:159)
	at org.apache.isis.applib.services.queryresultscache.QueryResultsCache_$$_javassist_2.toString(QueryResultsCache_$$_javassist_2.java)
	at java.lang.String.valueOf(Unknown Source)
	at java.lang.StringBuilder.append(Unknown Source)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.invokeInjectorField(ServicesInjectorDefault.java:268)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowire(ServicesInjectorDefault.java:191)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowireViaFields(ServicesInjectorDefault.java:175)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServices(ServicesInjectorDefault.java:159)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServicesInto(ServicesInjectorDefault.java:126)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServicesInto(ServicesInjectorDefault.java:132)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowireServicesAndContainer(ServicesInjectorDefault.java:281)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.setServices(ServicesInjectorDefault.java:80)
	at org.apache.isis.core.runtime.persistence.PersistenceSessionFactoryDelegating.init(PersistenceSessionFactoryDelegating.java:133)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactoryDefault.init(IsisSessionFactoryDefault.java:197)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:122)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:133)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
	at java.lang.reflect.Method.invoke(Unknown Source)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	... 20 more
14:24:04,548  [log                  main       ERROR]  Nested in javax.servlet.ServletException: com.google.inject.ProvisionException: Guice provision errors:

1) Error in custom provider, java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  while locating org.apache.isis.core.runtime.system.IsisSystem
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.system(IsisWicketApplication.java:124)
  while locating webapp.ToDoApplication

1 error:
com.google.inject.ProvisionException: Guice provision errors:

1) Error in custom provider, java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:132)
  while locating org.apache.isis.core.runtime.system.IsisSystem
    for field at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.system(IsisWicketApplication.java:124)
  while locating webapp.ToDoApplication

1 error
	at com.google.inject.internal.Errors.throwProvisionExceptionIfErrorsExist(Errors.java:451)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:65)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:229)
	at org.apache.wicket.Application.initApplication(Application.java:823)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:85)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
Caused by: java.lang.IllegalStateException: No service found for thread; make sure ((RequestScopedService)service).__isis_startRequest() is called first
	at org.apache.isis.core.runtime.services.ServiceInstantiator$2.invoke(ServiceInstantiator.java:159)
	at org.apache.isis.applib.services.queryresultscache.QueryResultsCache_$$_javassist_2.toString(QueryResultsCache_$$_javassist_2.java)
	at java.lang.String.valueOf(Unknown Source)
	at java.lang.StringBuilder.append(Unknown Source)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.invokeInjectorField(ServicesInjectorDefault.java:268)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowire(ServicesInjectorDefault.java:191)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowireViaFields(ServicesInjectorDefault.java:175)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServices(ServicesInjectorDefault.java:159)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServicesInto(ServicesInjectorDefault.java:126)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.injectServicesInto(ServicesInjectorDefault.java:132)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.autowireServicesAndContainer(ServicesInjectorDefault.java:281)
	at org.apache.isis.core.metamodel.services.ServicesInjectorDefault.setServices(ServicesInjectorDefault.java:80)
	at org.apache.isis.core.runtime.persistence.PersistenceSessionFactoryDelegating.init(PersistenceSessionFactoryDelegating.java:133)
	at org.apache.isis.core.runtime.system.session.IsisSessionFactoryDefault.init(IsisSessionFactoryDefault.java:197)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:122)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:133)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
	at java.lang.reflect.Method.invoke(Unknown Source)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	... 20 more
14:24:04,549  [log                  main       DEBUG]  started org.mortbay.jetty.webapp.WebAppContext@3f952ad4{,src/main/webapp}
{code}
"
ISIS-946,Bug,Closed,Isis application won't run from Eclipse,"{code}
java.lang.Error: Unresolved compilation problem: 
	The type javax.servlet.http.Cookie cannot be resolved. It is indirectly referenced from required .class files

	at org.apache.isis.viewer.wicket.ui.components.widgets.themepicker.ThemeChooser.<init>(ThemeChooser.java:96)
	at org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addThemePicker(PageAbstract.java:211)
	at org.apache.isis.viewer.wicket.ui.pages.PageAbstract.<init>(PageAbstract.java:180)
	at org.apache.isis.viewer.wicket.ui.pages.error.ErrorPage.<init>(ErrorPage.java:40)
	at org.apache.isis.viewer.wicket.viewer.integration.wicket.WebRequestCycleForIsis.errorPageFor(WebRequestCycleForIsis.java:177)
	at org.apache.isis.viewer.wicket.viewer.integration.wicket.WebRequestCycleForIsis.errorPageProviderFor(WebRequestCycleForIsis.java:147)
	at org.apache.isis.viewer.wicket.viewer.integration.wicket.WebRequestCycleForIsis.onException(WebRequestCycleForIsis.java:138)
	at org.apache.wicket.request.cycle.RequestCycleListenerCollection$4.notify(RequestCycleListenerCollection.java:126)
	at org.apache.wicket.request.cycle.RequestCycleListenerCollection$4.notify(RequestCycleListenerCollection.java:122)
	at org.apache.wicket.util.listener.ListenerCollection.notify(ListenerCollection.java:80)
	at org.apache.wicket.request.cycle.RequestCycleListenerCollection.onException(RequestCycleListenerCollection.java:121)
	at org.apache.wicket.request.cycle.RequestCycleListenerCollection$4.notify(RequestCycleListenerCollection.java:126)
	at org.apache.wicket.request.cycle.RequestCycleListenerCollection$4.notify(RequestCycleListenerCollection.java:122)
	at org.apache.wicket.util.listener.ListenerCollection.notify(ListenerCollection.java:80)
	at org.apache.wicket.request.cycle.RequestCycleListenerCollection.onException(RequestCycleListenerCollection.java:121)
	at org.apache.wicket.request.cycle.RequestCycle.handleException(RequestCycle.java:347){code}"
ISIS-945,Bug,Closed,[DUPLICATE] Exception by restful different than shown by Wicket viewer,"Hi,

I have a service method that I only want to expose via restful. I suppressed the method from showing up in the Wicket viewer so I didn't try to call it with the Wicket viewer.

Now restful throws an error (which is not very useful) when calling the method:

org.apache.tomcat.util.http.parser.TokenMgrError: Lexical error at line 1, column 29.  Encountered: "":"" (58), after : """"
	org.apache.tomcat.util.http.parser.HttpParserTokenManager.getNextToken(HttpParserTokenManager.java:434)
	org.apache.tomcat.util.http.parser.HttpParser.jj_ntk(HttpParser.java:300)
	org.apache.tomcat.util.http.parser.HttpParser.MediaType(HttpParser.java:21)


For some reason I now also exposed the action via Wicket. That way I get another exception with more useful information about my problem:

javax.jdo.JDOUserExceptionInvalid operator ""="". Did you mean to use ""==""?    org.datanucleus.api.jdo.NucleusJDOHelper#getJDOExceptionForNucleusException(NucleusJDOHelper.java:549)
    org.datanucleus.api.jdo.JDOQuery#execute(JDOQuery.java:299)
    nl.pocos.dom.workflow.WorkFlowStatusses#checkNumberOfPGSMLicences(WorkFlowStatusses.java:55)
    sun.reflect.NativeMethodAccessorImpl#invoke0(NativeMethodAccessorImpl.java:-2)
    sun.reflect.NativeMethodAccessorImpl#invoke(NativeMethodAccessorImpl.java:57)
    sun.reflect.DelegatingMethodAccessorImpl#invoke(DelegatingMethodAccessorImpl.java:43)
    java.lang.reflect.Method#invoke(Method.java:606)

After fixing this error the restful call works fine. I had this behaviour before but couldn't reproduce it. It looks like the TokenMgrError is thrown when some exception occurs in an action called via restful and the real reason/exception can't be found in the logs."
ISIS-944,Improvement,Closed,Minor improvements to TitleBuffer.,
ISIS-943,Bug,Closed,ObjectContracts#equals should be more resilient.,
ISIS-942,Bug,Closed,Auditing broken for deleted objects.,
ISIS-941,Bug,Closed,Wicket viewer shouldn't try to flush properties that are disabled.,"This broke in 1.6.0 because of https://issues.apache.org/jira/browse/ISIS-837

https://github.com/apache/isis/blob/0af3219129076161143bd388e3fc3ec039cbed79/component/viewer/wicket/model/src/main/java/org/apache/isis/viewer/wicket/model/models/EntityModel.java#L582

There are two conflicting requirements.  In some cases we want a derived property to appear to be editable... so that it udpates other stuff.  In other cases the derived property is not editable, so we should do nothing.

In https://github.com/apache/isis/blob/1b10065e7fefc591e7e510ecb7a5ea6dba17f485/core/metamodel/src/main/java/org/apache/isis/core/metamodel/facets/properties/update/PropertySetAndClearFacetFactory.java#L78 we go looking for setters and clears.  But if there is no setter, we install a NotPersistedFacetInferred.

The stuff about the NotPersistedFacet etc is, in fact, irrelevant.  We do still need this facet, but it's all to do with persistence and transactions.  For example, ""isNotPersisted"" on OneToOneAssociation in several places (eg IsisTransaction#enlist..., and PersistedAlgorithmDefault) in order to ensure we only deal with properties that have ""backing"" data.

And that means the fix in ISIS-837 is correct so far as it goes... EntityModel#apply shouldn't pay any attentino to the NotPersistedFacet, because as the comment from ISIS-837 and the first use case says, in these cases we DO want to flush the changes into the Isis runtime.

However, ISIS-837 didn't go far enough .... EntityModel#apply must also account for the property being disabled and in these cases do nothing.  Note that the DisabledFacet is added to the OneToOneAssociation by virtue of DisabledFacetOnPropertyInferredFacetFactory.  (See also the comment that is in PropertySetAndClearFacetFactory that shows that the facet used to be installed there, but was moved for other reasons).

"
ISIS-940,New Feature,Closed,Extend the CommandService so that both the editing and also the rendering of an entity are shown as commands.,
ISIS-939,Improvement,Closed,Simplify Persistor and ObjectStore components.,"* ClassSubstitutor... no longer any need to be pluggable.
* ObjectFactory... no longer any need to be pluggable.
* SpecificationTraverser
* CollectionTypeRegistry
* PersistAlgorithmUnified
* PojoRecreatorUnified
* IdentifierGeneratorUnified
* UpdateNotifier - deleted
* MessageBroker simplified, deleted obsolete version
* PersistenceSession simplifications
* ResolveFieldUtil for scimpi"
ISIS-938,Improvement,Closed,Mothball the core-bytecode modules (as no longer used by either objectstore),
ISIS-937,Improvement,Closed,Move TCK out of core,"So that:
a. core is smaller
b. that it at some stage be ported to use JDO objectstore rather than in-memory obejctstore without blocking release of core 1.8.0
c. that it might be replaced by the kitchensink app (and perhaps move out to isisaddons).
d. so that the TCK module of the wicket viewer can sit alongside the other TCK modules."
ISIS-936,Improvement,Closed,Incorporate the objectstore modules (JDO and in-memory) into core (metamodel and runtime),"So can simplify, and remove the JDO modules."
ISIS-935,Improvement,Closed,RO viewer should return a 404 exception if object not found.,"More fundamentally, the PersistenceSession should leverage the ExceptionRecognizer service in order to interpret exceptions.

For this to work, the ExceptionRecognizer interface itself should be extended so that semantics of recognized exceptions can be provided."
ISIS-934,Improvement,Closed,RO JSON representations should only be pretty-printed if running in prototype mode.,
ISIS-933,New Feature,Closed,"Allow the RO viewer to be configured so that it can honour or ignore UI hints (in particular, the @Render(EAGERLY) facet).","Currently in Estatio, retrieving a Property entity results in a 2.6Mb response.  This is  because its 'Units' collection is annotated as an eagerly rendered.

We expect that most RO clients to be ""data"" API clients, ie will make their own decisions about which data to retrieve and how. 

For this ticket, suggest simply a global configuration setting:

# whether to honor UI hints, in particular Render(EAGERLY).  Default to false.
#isis.viewer.restfulobjects.honorUiHints=false


~~~
In the future, this could be generalized/refined by having the RO client send an HTTP Accept header and have the RO viewer server respond appropriately."
ISIS-932,New Feature,Closed,"Use HTML5 history API so that the address URL reflects the object being viewed (including any sorting, view selection etc).","This is less important now that we have ISIS-1613, meaning page is repainted less often.

Still useful for whenever redirect to a new page"
ISIS-931,Improvement,Closed,Make Isis faster to start.,Using profiling etc.  JProfiler have provided us with an open source license.
ISIS-930,New Feature,Closed,"Support use of ""font awesome"" icons as decoration of actions and also instead of entity icons.",Note that this depends on ISIS-537.
ISIS-929,Bug,Closed,isis-module-security-dom has implicit dependency to fixtures,"importing the security addon module exactly as described [here|https://github.com/isisaddons/isis-module-security#out-of-the-box-configuration] results in a ProvisionException when launching the WebApp.

the reason seems to be, that the security domain services use fixtures to create the default admin and user roles. 

workaround: adding the following dependency to the webapp module (and providing the code on the classpath, of course) resolves this issue:
{code:xml}<dependency>
  <groupId>org.isisaddons.module.security</groupId>
  <artifactId>isis-module-security-fixture</artifactId>
  <version>0.0.1-SNAPSHOT</version>
</dependency>{code}

error observed in security-module 1.6.0-1.7.0-SNAPSHOT"
ISIS-928,Task,Closed,Isis 1.8.0 release tasks,
ISIS-927,Improvement,Closed,BookmarkService should be WrapperFactory aware...,"So if call BookmarkService#bookmarkFor(...) and pass in a wrapped object, then should automatically unwrap first.
"
ISIS-926,New Feature,Closed,"[WON'T FIX] Allow integration tests to run in parallel, each with a different user.  Part of this to include a ProgrammableClockService as a replacement for ClockService, partiitioned by user (to allow concurrent integration tests to run etc).",
ISIS-925,Improvement,Closed,View Model wizards should be in edit mode by default.,"At the moment it's necessary to press ""edit"" to edit the wizard, then ""OK"", then ""next"" etc.  Far from ideal."
ISIS-924,New Feature,Closed,[WON'T FIX] Use @DomainService(repositoryFor=...) as the basis for an implementation of the PluralNameFacet,
ISIS-923,New Feature,Closed,[WON'T FIX] Use @DomainService(repositoryFor=...) as the basis for an implementation of the AutoCompleteFacet.,
ISIS-922,New Feature,Closed,"Reinstate ""ensure safe semantics"" (per ISIS-865, ISIS-921)",
ISIS-921,Bug,Closed,"Disable ""ensure safe semantics"" feature (ISIS-865), since does not cater for edits with contributed properties.","Specifically, if perform an edit, eg on ToDoItem, then the Wicket viewer will cause any contributed actions to be fired.  The IsisTransaction will think that the dirty objects are as a result of the first such contributed action firing (there is no ""action"" created for a simple edit.

~~~
In addition, should change Command2 interface to use a stack metaphor for action events (so can nest them)."
ISIS-920,New Feature,Closed,"(As a configuration option), provide the ability to disable the Wicket viewer automatically continuing to original URL after successful login.",See http://isis.markmail.org/thread/ar5mz3uelle3z6pb
ISIS-919,Bug,Closed,"Don't ""touch"" a (request-scoped) service when logging in DEBUG mode.",Switching up logging to DEBUG causes the PojoAdapterHashMap to try to call hashCode() on a request-scoped service.  This in turn throws an exception.
ISIS-918,Improvement,Closed,Remove special-case handling of DomainObjectContainer; is just another service.,
ISIS-917,New Feature,Closed,Support pluggable representations for the RO viewer (object and list representations),"This ticket is to factor out the logic in the RO viewer that builds the JSON representation and put it behind a @DomainService.  

As a first cut, I think it's only the object representation and list representations that need to be pluggable.  

Ultimately I would like to get to a point where the representation used honours the Accept header (Content-Type), but will probably iterate to get there.  "
ISIS-916,Improvement,Closed,"Provide a mechanism so that framework-provided services, such as MementoService or BookmarkService, can be overridden by the developer.","Required to enable workarounds prior to ISIS-915 being addressed.

~~~
Could be done either by services registered in isis.properties taking precedence over @DomainService, and/or to introduce a ""priority"" attribute into @DomainService (inspired by something similar I've seen in AngularJS) whereby all framework-provded services are at priority 100 and can be overridden by a services with a higher priority.
"
ISIS-915,Bug,Closed,Framework should transparently allow view models to reference other view models.,"The description below shows the current behaviour; the core tries to interpret the ""Street"" reference as a persisted entity.

The workaround is to have explicitly implement ViewModel (rather than annotated with @ViewModel) and to traverse the graph manually.  Using XmlSnapshotService could be one way to do this (or at least to provide inspiration on how to accomplish this).

Note though that ISIS-916 is a prereq in order to implement such as workaround.

~~~
Having this ViewModel annotated classes
{code}

@org.apache.isis.applib.annotation.ViewModel
public class Address2 {

    public Address2(String lkmsId) {
        this.lkmsId = lkmsId;
    }

    public String title() {
        return ""Address lkmsId:"" + lkmsId;
    }

    public String iconName() {
        return ""Location_icon"";
    }

    // {{ LkmsId (property)
    private String lkmsId;

    @MemberOrder(sequence = ""1"")
    public String getLkmsId() {
        return lkmsId;
    }

    public void setLkmsId(final String lkmsId) {
        this.lkmsId = lkmsId;
    }

    // }}

    // {{ Street (property)
    private Street2 street;

    @MemberOrder(sequence = ""3"")
    public Street2 getStreet() {
        return street;
    }

    public void setStreet(final Street2 street) {
        this.street = street;
    }

    // }}

    // {{ Housenumber (property)
    private String houseNumber;

    @MemberOrder(sequence = ""2"")
    public String getHouseNumber() {
        return houseNumber;
    }

    public void setHouseNumber(final String housenumber) {
        this.houseNumber = housenumber;
    }

    // }}

}
{code}

and 

{code}
@ViewModel
public class Street2 {

    public Street2(String lkmsId) {
        this.lkmsId = lkmsId;
    }

    public String title() {
        return ""Street lkmsId:"" + lkmsId;
    }

    // {{ LkmsId (property)
    private String lkmsId;

    @MemberOrder(sequence = ""1"")
    public String getLkmsId() {
        return lkmsId;
    }

    public void setLkmsId(final String lkmsId) {
        this.lkmsId = lkmsId;
    }

    // }}

    // {{ Streetname (property)
    private String streetname;

    @MemberOrder(sequence = ""2"")
    public String getStreetname() {
        return streetname;
    }

    public void setStreetname(final String aName) {
        this.streetname = aName;
    }

    // }}

    // {{ Plz (property)
    private String plz;

    @MemberOrder(sequence = ""3"")
    public String getPlz() {
        return plz;
    }

    public void setPlz(final String plz) {
        this.plz = plz;
    }
    // }}

}

{code}

When calling the domain service method
{code}
 @Prototype
    @Render(Type.EAGERLY)
    public Address2 retreiveAnnotatedAddressModelSample() {
        Address2 address = new Address2(""11"");
        address.setHouseNumber(""12"");
        Street2 street = new Street2(""123"");
        street.setStreetname(""5th street"");
        street.setPlz(""1100"");
        address.setStreet(street);
        return address;
    }

{code}

will bring this exception 

{code}
Handling the following exception
org.apache.isis.core.runtime.persistence.PojoRecreationException: Could not recreate pojo for oid oid *a1.ase.viewmodel.annotated.Address2:PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPG1lbWVudG8-PGxrbXNJZD4xMTwvbGttc0lkPjxob3VzZU51bWJlcj4xMjwvaG91c2VOdW1iZXI-PHN0cmVldC5ib29rbWFyaz5hMS5hc2Uudmlld21vZGVsLmFubm90YXRlZC5TdHJlZXQyOlBEOTRiV3dnZG1WeWMybHZiajBpTVM0d0lpQmxibU52WkdsdVp6MGlWVlJHTFRnaVB6NEtQRzFsYldWdWRHOC1QR3hyYlhOSlpENHhNak04TDJ4cmJYTkpaRDQ4YzNSeVpXVjBibUZ0WlQ0MWRHZ2djM1J5WldWMFBDOXpkSEpsWlhSdVlXMWxQanh3YkhvLU1URXdNRHd2Y0d4NlBqd3ZiV1Z0Wlc1MGJ6ND08L3N0cmVldC5ib29rbWFyaz48L21lbWVudG8-
	at org.apache.isis.core.runtime.persistence.adaptermanager.AdapterManagerDefault.adapterFor(AdapterManagerDefault.java:311)
...
{code}"
ISIS-914,Bug,Closed,Wicket viewer doesn't show all String properties of a ViewModel instance,"Have this domain service method

{code}
 @Prototype
    @Render(Type.EAGERLY)
    public Address retreiveAddressModelSample() {
        final Address address = getContainer().newViewModelInstance(Address.class, ""11"");
        address.setHouseNumber(""12"");
        Street street = getContainer().newViewModelInstance(Street.class, ""123"");
        street.setStreetname(""5th street"");
        street.setPlz(""1100"");
        address.setStreet(street);
        return address;
    }
{code}

when calling thru wicket viewer appears see screenshot. 

So I miss:

- housenumber
- Stret  (getTitle())
"
ISIS-913,Improvement,Closed,"Remove the ""ViewerInstaller"" and ""EmbeddedWebServerInstaller"" APIs, since in effect defunct.","These used to make sense with client-side viewers (eg the DnD viewer); but these days all the viewers are client-side, so run up the app either using the org.apache.isis.WebServer or just mvn jetty:run or by deploying to Tomcat etc."
ISIS-912,Bug,Closed,Not possible to specify the fixtures to be loaded from the command line (ie --fixture flag is broken).,"In addition, need better documentation so that can see that it's also necessary to enable fixtures to be loaded using an additional system property ""isis.persistor.datanucleus.install-fixtures"".

eg:

-D isis.persistor.datanucleus.install-fixtures=true \ 
--fixture org.estatio.fixture.EstatioDemoFixture  \
--type PROTOTYPE \
--port 8080
"
ISIS-911,Bug,Closed,"The blob panel's ""additionalLinks"" (for upload and clear buttons) should be hidden in Edit mode.","Viewing a Blob shows the additional links ""Upload"" and ""Clear"" next to the binary.
Switching to Edit mode shows the upload field + ""Clear"" button, but the additional links are still there. The ""Upload"" button opens a Modal window for edit and the ""Clear"" button does the same as the second ""Clear"" button.

See the attached screenshot.

I think the ""additionalLinks"" should be hidden in Edit mode."
ISIS-910,Bug,Closed,Entering invalid data for Char type fails with an internal error,"Entering longer text in the input field for Char type fails with the following exception:

Caused by: org.apache.isis.core.metamodel.facets.object.parseable.InvalidEntryException: Only a single character is required
	at org.apache.isis.core.metamodel.facets.value.chars.CharValueSemanticsProviderAbstract.doParse(CharValueSemanticsProviderAbstract.java:53)
	at org.apache.isis.core.metamodel.facets.value.chars.CharValueSemanticsProviderAbstract.doParse(CharValueSemanticsProviderAbstract.java:33)
	at org.apache.isis.core.metamodel.facets.object.value.vsp.ValueSemanticsProviderAndFacetAbstract.doParse(ValueSemanticsProviderAndFacetAbstract.java:188)
	at org.apache.isis.core.metamodel.facets.object.value.vsp.ValueSemanticsProviderAndFacetAbstract.parseTextEntry(ValueSemanticsProviderAndFacetAbstract.java:173)
	at org.apache.isis.core.metamodel.facets.object.parseable.parser.ParseableFacetUsingParser.parseTextEntry(ParseableFacetUsingParser.java:88)
	at org.apache.isis.viewer.wicket.model.models.ScalarModel.setObjectAsString(ScalarModel.java:573)
	at org.apache.isis.viewer.wicket.ui.components.scalars.ScalarPanelTextFieldParseableAbstract$1.setObject(ScalarPanelTextFieldParseableAbstract.java:64)
	at org.apache.isis.viewer.wicket.ui.components.scalars.ScalarPanelTextFieldParseableAbstract$1.setObject(ScalarPanelTextFieldParseableAbstract.java:51)
....

The exception is both logged and shown in the collapsed panel in the content area.

I'd expect that an error feedback error message is shown instead.
Also Wicket StringValidator can be used to set the 'maxlength' HTML5 attribute to prevent entering such invalid data at the client side. 
"
ISIS-909,Bug,Closed,BookmarksPagesPanel often cannot detect the current/active model,"See also ISIS-842.

 

~~~

There is a logic [1] at BookmarkedPagesPanel.java that tries to detect whether an item in the bookmarks sliding menu is the currently viewed/edited item and sets CSS class ""currentBookmark"".

Most of the time bookmarkedPagesModel.isCurrent(pageParameters) doesn't work. It uses Objects.equal(current, pageParameters) and often those have similar oid but additional parameters make the check failing.

1. [https://github.com/apache/isis/blob/master/component/viewer/wicket/ui/src/main/java/org/apache/isis/viewer/wicket/ui/components/bookmarkedpages/BookmarkedPagesPanel.java#L167]"
ISIS-908,Improvement,Closed,"Enhance FixtureScript service, support ""non-strict"" mode","Currently the design of the fixture script service is that a given fixture script can only run once (by class/type).  This supports the approach where a leaf fixture script encodes both the ""how to"" (which business operations to perform) and also the ""what"" (what the fixture data actually is).  This distinction is seen in Estatio as the difference between the ""abstract"" superclasses (eg LeaseAbstract) and the concrete subclasses (eg LeaseForOxfPret004, LeaseForKalPoison001).

But another way to use fixture scripts is to keep the ""what"" in the calling fixture, and just have the leaf fixture scripts be parameterizable.  eg in effect LeaseAbstract becomes concrete (rename to LeaseSetUp) and can be called multiple times.

Thus, make the fixture script configurable to either strictly enforce the rule that a given fixture class can only be run once (Estatio's design) or, um, simply not enforce that (the other design).

~~~~

In addition...

in FixtureResultList (or equiv), an overloaded way to lookup fixtures by key:

        public static Object Lookup(this IList<IFixtureResult> fixtureResults, string key)
        {
            var keys = key.Split('/');
            return Lookup(fixtureResults, keys);
        }


and in FixtureScriptExecutionContext:

internal void TraceResult(IFixtureScript fixtureScript, string key, FixtureResult fixtureResult)
        {
            if (_traceWriter == null)
            {
                return;
            }
            var qualifiedName = FixtureScriptService.QualifiedNameFor(fixtureScript);
            var paddedQualifiedName = Pad(qualifiedName, MaxQualifiedNameLength);
            var trace = paddedQualifiedName + ""/"" + key + "": "" + fixtureResult.ToString();
            _traceWriter.WriteLine(trace);
            _traceWriter.Flush();
        }

"
ISIS-907,Improvement,Closed,Enums drop-downs are truncated... the (derived) typical length for enums uses the name() rather than the toString(),Should be the longer of the name and the toString.
ISIS-906,Bug,Closed,incorrectly attempts to render a veto exception (from a subscriber) to a non-existent action dialog panel when invoked for a no-arg action.,"eg, with this code, the ""remove"" fails though the ""removeAndReplace"" works fine:

{code}
    @ActionInteraction(Party.RemoveEvent.class)
    public void remove() {
        removeAndReplace(null);
    }

    @ActionInteraction(Party.RemoveEvent.class)
    public void removeAndReplace(@Named(""Replace with"") @Optional Party replacement) {
        getContainer().remove(this);
        getContainer().flush();
    }
{code}

and the following stacktrace:

{code}
13:24:48,119 [MarkupContainer               ] Unable to find component with id 'actionName' in [ActionPanel [Component id = content]]
	Expected: 'theme:actionPromptModalWindow:content:actionName'.
	Found with similar names: ''
13:24:48,119 [RequestCycleExtra             ] ********************************
13:24:48,120 [RequestCycleExtra             ] Handling the following exception
Unable to find component with id 'actionName' in [ActionPanel [Component id = content]]
	Expected: 'theme:actionPromptModalWindow:content:actionName'.
	Found with similar names: ''
 MarkupStream: [markup = file:/C:/Users/jvanderwal/src/isis/component/viewer/wicket/ui/target-ide/classes/org/apache/isis/viewer/wicket/ui/components/actions/ActionPanel.html
<wicket:panel>
			<div class=""actionPanel actionComponentType"">
                <div class=""myBlockContainer"">
    				<div class=""iconAndTitle panel actionPanelHeaderNew"">
    			         <span wicket:id=""entityIconAndTitle"">[icon and title]</span>
    			         <p wicket:id=""actionName"" class=""actionName"">[action name]</p>
                    </div>
    				<span wicket:id=""parameters"">
    				</span>
                </div>
			</div>
		</wicket:panel>, index = 6, current =  '<p wicket:id=""actionName"" class=""actionName"">' (line 0, column 0)]
	at org.apache.wicket.markup.MarkupStream.throwMarkupException(MarkupStream.java:526)
	at org.apache.wicket.MarkupContainer.renderNext(MarkupContainer.java:1438)
	at org.apache.wicket.MarkupContainer.renderAll(MarkupContainer.java:1557)
	at org.apache.wicket.MarkupContainer.renderComponentTagBody(MarkupContainer.java:1532)
	at org.apache.wicket.MarkupContainer.renderAssociatedMarkup(MarkupContainer.java:689)
	at org.apache.wicket.markup.html.panel.AssociatedMarkupSourcingStrategy.renderAssociatedMarkup(AssociatedMarkupSourcingStrategy.java:76)
	at org.apache.wicket.markup.html.panel.PanelMarkupSourcingStrategy.onComponentTagBody(PanelMarkupSourcingStrategy.java:112)
	at org.apache.wicket.Component.internalRenderComponent(Component.java:2514)
	at org.apache.wicket.MarkupContainer.onRender(MarkupContainer.java:1496)
	at org.apache.wicket.Component.internalRender(Component.java:2344)
	at org.apache.wicket.Component.render(Component.java:2272)
	at org.apache.wicket.MarkupContainer.renderNext(MarkupContainer.java:1392)
	at org.apache.wicket.MarkupContainer.renderAll(MarkupContainer.java:1557)
	at org.apache.wicket.MarkupContainer.renderComponentTagBody(MarkupContainer.java:1532)
	at org.apache.wicket.MarkupContainer.renderAssociatedMarkup(MarkupContainer.java:689)
	at org.apache.wicket.markup.html.panel.AssociatedMarkupSourcingStrategy.renderAssociatedMarkup(AssociatedMarkupSourcingStrategy.java:76)
	at org.apache.wicket.markup.html.panel.PanelMarkupSourcingStrategy.onComponentTagBody(PanelMarkupSourcingStrategy.java:112)
	at org.apache.wicket.Component.internalRenderComponent(Component.java:2514)
	at org.apache.wicket.MarkupContainer.onRender(MarkupContainer.java:1496)
	at org.apache.wicket.Component.internalRender(Component.java:2344)
	at org.apache.wicket.Component.render(Component.java:2272)
	at org.apache.wicket.ajax.XmlAjaxResponse.writeComponent(XmlAjaxResponse.java:128)
	at org.apache.wicket.ajax.AbstractAjaxResponse.writeComponents(AbstractAjaxResponse.java:218)
	at org.apache.wicket.ajax.AbstractAjaxResponse.writeTo(AbstractAjaxResponse.java:150)
	at org.apache.wicket.ajax.AjaxRequestHandler.respond(AjaxRequestHandler.java:359)
	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:862)
	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:97)
	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:261)
	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:218)
	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:289)
	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:259)
	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:201)
	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:282)
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
	at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)
	at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
	at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
	at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)
	at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)
	at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
	at org.mortbay.jetty.Server.handle(Server.java:326)
	at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
	at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)
	at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)
	at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
	at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
	at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)
	at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
13:24:48,120 [RequestCycleExtra             ] ********************************

{code}

"
ISIS-905,Bug,Closed,"Transaction handling fix, if throw exception on flush for no-arg action.",
ISIS-904,Improvement,Resolved,Support autoComplete with dependent choices.,as per mailing list: http://markmail.org/message/k4cs6hfzb2jl7gsm
ISIS-903,Improvement,Closed,Improve i18n support (in NamedFacetDecorator etc) to honour client-side locale.,"from the mailing list: http://markmail.org/message/wifsrte2p2q6tces

ok, here's the scoop.

It *is* possible to add i18n for Isis apps, but the implementation we have reflects the locale of the server, rather than the client. 

If client-side i18n is what you require then it ought to be possible to implement a different implementation of I18nFacetDecoratorInstaller.  You can get hold of the user's locale using:

AuthenticatedWebSessionForIsis.get().getLocale()

"
ISIS-902,Improvement,Closed,Enhance ImageResourceCacheClassPath so that can have two entities with the same simple name but in different packages.,"suggest that it:
* search as a resource (src/main/resource) using the fully-qualified name
* if not found, search up the inheritance hierarchy of the class

failing that fall back to the current strategy:
* search in images/ for the simple name
* if not found, search up the inheritance hierarchy similarly.

~~~
Need to take into account the iconName() (IconFacet) ... perhaps interpret it relative to the same package.

"
ISIS-901,New Feature,Closed,Use @DomainService(repositoryFor=...) as the basis for an implementation of the IconFacet.,"... thus meaning no requirement to write an ""iconName"" method in the domain service."
ISIS-900,New Feature,Closed,Provide a mechanism (probably in the isis-module-devutils add-on) to find classes/services that have no icon.,
ISIS-899,Bug,Closed,Can't return a view model in Isis 1.6.0 over RO viewer.,
ISIS-898,New Feature,Closed,Add a table tree view to the Wicket viewer.,"see mailing list discussion [1]

[1] http://markmail.org/message/vu3jqmlawrskplic

~~~
some further thoughts:

For example, in Estatio there are several hierarchies

EstatioInstance (""global"") /
  EstatioInstance (""italy"") /
    EstatioInstance (""Roma shopping mall"")

or:

Property/
  Floor/
    Unit

We'd like to render these objects in a single tree/table collection.

~~~
We should distinguish two cases:
- where all the rows are of the same type (EstatioInstance, turtles all the way down).
- where all the rows are of different types (Property/Floor/Unit)

For the former, the columns to use are exactly those of the (single) class.

For the latter, things are more complicated, as all the objects are of different class.  It's not clear to me what (apart from an icon and a title) should be shown as columns.  Perhaps just the intersection of those properties that are common across all types (eg name?) .  Or perhaps there's metadata (in @PropertyLayout(...)) to specify that a particular property should always be shown in such tree/table collections, even if it is null for other rows for instances of some other class.


"
ISIS-897,Bug,Closed,Wrong format for org.joda.time.LocalDateTime,"Using https://github.com/danhaywood/isis-kitchensink I tried to edit org.joda.time.LocalDateTime (Date > First > Edit > select a date from the picker > Save).

It fails with:

Caused by: java.lang.IllegalArgumentException: Invalid format: ""20140925T000000.000"" is too short
	at org.joda.time.format.DateTimeFormatter.parseLocalDateTime(DateTimeFormatter.java:828)
	at org.apache.isis.core.metamodel.facets.value.datetimejodalocal.JodaLocalDateTimeValueSemanticsProvider.parse(JodaLocalDateTimeValueSemanticsProvider.java:251)
	at org.apache.isis.core.metamodel.facets.value.datetimejodalocal.JodaLocalDateTimeValueSemanticsProvider.doRestore(JodaLocalDateTimeValueSemanticsProvider.java:244)
	... 86 more
"
ISIS-896,Bug,Closed,Minor issues with scripts in ~/scripts,"Scripts in ~/scripts do not have executable status.
Missing script for verifying release."
ISIS-895,Improvement,Closed,HomePage should honour authorization rules.,"So, if a user doesn't have permission (the home page action isn't visible and/or usable) then it shouldn't be invoked, and instead simply show the welcome messages.

However, this ticket does NOT require that the system checks that the user has permissions for the resultant object invoked from the home page action (a dashboard or whatever); rather the expectation is that the this the permissions be set-up correctly along with the user's permission to the home page action.

If the user doesn't have permission to the resultant object, then the usual behaviour should occur, ie to show the error page."
ISIS-894,Improvement,Closed,Remove @NotPersistable annotation and corresponding facet,"This annotation is a no-op (tested in Wicket and Restful Objects) and should be removed from the applib

... perhaps.  Looking again at the code, there's a check in PersistenceSession#makePersistent() and throws exception if attempt to explicitly persist.

However, JDO might persist anyway due to persistence-by-reachability, so the check would need to be added to the appropriate JDO lifecycle callback.

As I think all the above is marginal benefit, think we should just remove in 2.0.0"
ISIS-893,Improvement,Closed,"[WON'T FIX] (Cosmetics): If attempt to invoke non-existent action, get nasty error message","see the actionId=""fooBar""

diverted to error page with following stack trace:

15:59:41,112  [RequestCycleExtra    577739874@qtp-1148559558-0 WARN ]  Handling the following exception
org.apache.wicket.WicketRuntimeException: Can't instantiate page using constructor 'public org.apache.isis.viewer.wicket.ui.pages.actionprompt.ActionPromptPage(org.apache.wicket.request.mapper.parameter.PageParameters)' and argument 'actionArgs=[abc], actionArgs=[Professional], actionArgs=[$nullArg$], actionArgs=[20140925], actionArgs=[$nullArg$], objectOid=[dom.todo.ToDoItems:1], actionOwningSpec=[dom.todo.ToDoItems], actionId=[fooBar(java.lang.String,dom.todo.ToDoItem$Category,dom.todo.ToDoItem$Subcategory,org.joda.time.LocalDate,java.math.BigDecimal)], actionType=[USER]'. An exception has been thrown during construction!
	at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:194)
	at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:99)
	at org.apache.wicket.DefaultMapperContext.newPageInstance(DefaultMapperContext.java:137)
	at org.apache.wicket.core.request.handler.PageProvider.resolvePageInstance(PageProvider.java:268)
	at org.apache.wicket.core.request.handler.PageProvider.getPageInstance(PageProvider.java:166)
	at org.apache.wicket.request.handler.render.PageRenderer.getPage(PageRenderer.java:78)
	at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:100)
	at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:221)
	at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:175)
	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:862)
	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:261)
	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:218)
	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:289)
	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:259)
	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:201)
	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:282)
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
	at org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter.doFilter(IsisLogOnExceptionFilter.java:52)
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
	at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)
	at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
	at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
	at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)
	at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)
	at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
	at org.mortbay.jetty.Server.handle(Server.java:326)
	at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
	at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)
	at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)
	at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
	at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
	at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)
	at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
Caused by: java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:526)
	at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:171)
	... 41 more
Caused by: java.lang.NullPointerException
	at org.apache.isis.viewer.wicket.model.mementos.ActionMemento.<init>(ActionMemento.java:62)
	at org.apache.isis.viewer.wicket.model.mementos.ActionMemento.<init>(ActionMemento.java:50)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.newActionMementoFrom(ActionModel.java:277)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.<init>(ActionModel.java:267)
	at org.apache.isis.viewer.wicket.model.models.ActionModel.createForPersistent(ActionModel.java:111)
	at org.apache.isis.viewer.wicket.ui.pages.actionprompt.ActionPromptPage.buildModel(ActionPromptPage.java:64)
	at org.apache.isis.viewer.wicket.ui.pages.actionprompt.ActionPromptPage.<init>(ActionPromptPage.java:52)
	... 46 more
15:59:41,116  [RequestCycleExtra    577739874@qtp-1148559558-0 WARN ]  ********************************
"
ISIS-892,New Feature,Closed,[DUPLICATE] Allow action parameters to be dynamically disabled or even hidden based on either object state or on the values for other objects.,
ISIS-891,New Feature,Closed,"[Duplicate] Dynamic and optional description for actions, as way to provide additional guidance in the action prompt.",
ISIS-890,Improvement,Closed,"Get rid of exploration mode, treat as synonym for prototype.  Ditto with @Exploration annotation.","The main rationale here is to simplify and reduce number of concepts for developer to grapple with.
Another part of the rationale is to make Isis consistent with Wicket, that only has two modes, not three (DEVELOPMENT and DEPLOYMENT).
"
ISIS-889,Improvement,Closed,Action prompt dialog seems to be not quite big enough in Chrome (is ok in Firefox and IEv11),
ISIS-888,Improvement,Closed,"Remove Wicket viewer action prompt page, instead just rely on action prompt.",However... we still use the action prompt page for any bookmarked actions that take args.  So would need to figure out what to do with those.
ISIS-887,Improvement,Closed,"Mothball the o.a.isis.core:isis-module-xxx modules, as now in isisaddons.",
ISIS-886,New Feature,Closed,Provide an API (perhaps in the WrapperFactory)to allow a programmer to determine whether the current user has view and/or modify access to a feature.,"The main use case being to allow a suitable title to be rendered (in title()) based on the users' permissions, eg:

{code}
public String title() {
    StringBuilder buf = new StringBuilder();
    if(wrapperFactory.isHidden(this, ""firstName"")) {
       buf.append(this.getFirstName());
    }
   return buf.toString();
}
{code}

and isDisabled(...) similarly
"
ISIS-885,Bug,Closed,"To avoid leaking information (eg in the title) should have a ""special"" permission to throw a 404 if user doesn't have permission to view any of the class' members.","Otherwise, an unauthorized user could:

a) discover (by constructing a URL) that an object exists, and 

b) worse, could view the title of said object, which would leak information about the object's state even if the object's properties were not visible."
ISIS-884,Bug,Closed,ErrorPage vulnerable to XSS attacks.,"The default error page (org.apache.isis.viewer.wicket.ui.pages.error.ErrorPage) is vulnerable to XSS via org.apache.isis.viewer.wicket.ui.errors.ExceptionStackTracePanel

In the constructor of ExceptionStackTracePanel, it adds a Label with the exception message and calls setEscapeModelStrings(false)

This means any URL that a URL be constructed to reference an entity with Javascript inserted where the OID should be and an exception is thrown with the Javascript code inserted in to the message.

This is then written to the page un-escaped to be executed in the users session.

It is made worse by the bookmarkable feature (I think that's what does this), where an attacker can navigate to a crafted URL on a user's PC, if they don't close all of their browser windows before the session times out, when they log in they will be redirected to the crafted URL."
ISIS-883,Bug,Closed,Isis 1.3: Bookmarkable action URLs can be submitted by a user without permissions to bring up action dialog (thereafter that user can invoke).,"originally raised in mailing list, see: http://markmail.org/thread/lmr3yy5yoz4sfkk2  for Isis 1.3


When a user with an admin role logs in, they get access to functionality not available to standard users.
However, if a standard user types in the URL to one of the admin pages, they get access to it.

It appears the permissions are only checked when rendering the menus and not when executing the action.
Essentially any authenticated user can bypass authorisation.

The permissions are correctly checked when accessing the services through the Restful interface.

~~~

More detail:

I'm talking about bookmarkable URL's in the format
http://localhost:7001/rma/wicket/wicket/bookmarkable/<Page class name>?pageType=ACTION&actionSingleResultsMode=REDIRECT&objectOid=<class name>:1&actionType=USER&actionOwningSpec=<class name>&actionId=<method description>&pageTitle=<page title>&actionMode=PARAMETERS

~~~

It's not the invocation that's being accessed by the bookmarkable URL, it's the form to enter the parameters.
Clicking the ""OK"" button on that form invokes the method.

The actual URL that causes the method invocation is
POST http://localhost:7001/rma/wicket/wicket/page?1-1.IFormSubmitListener-action-parameters-inputForm
with a standard x-www-form-urlencoded post body.
"
ISIS-882,Improvement,Closed,Appropriate facets should be copied over to contributed collections and properties.,eg for @MaxLength (property) and @Paged (collection).
ISIS-881,Bug,Closed,Menu service ordering appears to be non-deterministic?,see png.
ISIS-880,Bug,Closed,Appearance of Password field (in action dialogs) requires tweaking.,".isisPasswordPanel input[type=password] {
    border-radius:4px;
    -moz-border-radius:4px;
    -webkit-border-radius:4px;
    padding:6px;
    border:1px solid #F0EFEA;
    border-top:1px solid #CCCBC7;
}
"
ISIS-879,Bug,Closed,ObjectMemberAbstract#isAlwaysHidden() does not honour where=Where.EVERYWHERE.,"in ApplicationFeatures

    protected boolean isHidden(ObjectSpecification spec) {
        final HiddenFacet facet = spec.getFacet(HiddenFacet.class);
        return facet != null &&
                !facet.isNoop() &&
                (facet.where() == Where.EVERYWHERE || facet.where() == Where.ANYWHERE) &&
                facet.when() == When.ALWAYS;
    }


    
in ObjectMemberAbstract

    @Override
    public boolean isAlwaysHidden() {
        final HiddenFacet hiddenFacet = getFacet(HiddenFacet.class);
        return hiddenFacet != null && hiddenFacet.when() == When.ALWAYS && hiddenFacet.where() == Where.ANYWHERE;
    }
"
ISIS-878,Bug,Closed,Wicket viewer escape does not dismiss some (though not all) action dialog boxes,
ISIS-877,Bug,Closed,ReferencePanel toggles to different representation in edit mode (from view mode) even if is disabled.,
ISIS-876,Sub-task,Closed,Action prompt dialog box rendering when title too long...,
ISIS-875,New Feature,Closed,Provide the ability to render action buttons in a table.,Probably require some new annotation/facet.
ISIS-874,New Feature,Closed,"Allow individual items to stand out in a collection, eg new reserved method","eg, orovide a new method, like title() or iconName(), eg cssClass(), that returns a class name which is then used to wrap the entire instance when rendered as a row in a table."
ISIS-873,New Feature,Closed,CommandContext.getCommand() should also expose the ActionInteractionEvent.,"Because at the moment the command itself doesn't see the ActionInteractionEvent, even though the subscribers do!  and there's useful information in that event object.

With this implemented the action being invoked (or indeed its validate methods etc) will be able, by injecting the Command, to be able to get to the same ActionInteractionEvent that all the other subscribers on the event bus can see.


"
ISIS-872,Task,Closed,1.7.0 release activities,
ISIS-871,Bug,Closed,"NPE - ActionInvocationFacetForInteractionAbstract passes Null to ""ObjectSpecification.isViewModelCloneable""","As it passes a null value, a NPE is thrown afterwards (the ObjectAdapter is null).

See attached patch file."
ISIS-870,New Feature,Closed,Settings service (isisaddons) should support obfuscate passwords.,
ISIS-869,New Feature,Closed,Domain service (probably isisaddons) to wrap HttpSession.,"as per mailing list discussion:http://markmail.org/message/l4yh5cfu7dz2kn33

~~~~~~~~~~~~~

1. Assuming you want to access the ServletContext from your domain model:

add to dom/pom.xml (so that ServletContext is on classpath):

        <dependency>
            <groupId>org.apache.geronimo.specs</groupId>
            <artifactId>geronimo-servlet_2.5_spec</artifactId>
            <optional>true</optional>
        </dependency>

        
2. in dom project, define interface:

package dom;

import javax.servlet.ServletContext;
import org.apache.isis.applib.annotation.Programmatic;

public interface ServletContextProvider {

    @Programmatic
    public ServletContext getServletContext();

}



3. in webapp project, define implementation:

package webapp;

import dom.ServletContextProvider;

import javax.servlet.ServletContext;
import org.apache.wicket.protocol.http.WebApplication;
import org.apache.isis.applib.annotation.DomainService;
import org.apache.isis.applib.annotation.Programmatic;

@DomainService
public class ServletContextService implements ServletContextProvider {

    @Programmatic
    public ServletContext getServletContext() {
        return WebApplication.get().getServletContext();
    }

}"
ISIS-868,New Feature,Closed,"Add-on module to provide a ""feature toggle"" domain service (wrap togglz or similar)",http://www.togglz.org/ or http://ff4j.org
ISIS-867,New Feature,Closed,Domain service to automatically maintain lastUpdatedAt and lastUpdatedBy on any entity.,"using ISIS-865.

Define:
interface Updateable {
    @Programmatic
    public void updatedBy(String userName);
    @Programmatic
    publc void updatedAt(DateTime dt);
}

Install a JDO StoreLifecycleListener on the PersistenceManager when request starts, call in preStore.

Should double-check plays well with auditing service.  (Should be ok, since even if this listener and Isis' global listener are called in indeterminate order, even then we only hit the auditing service just prior to committing the transaction.  Until that point we are just capturing the fact that entities have been enlisted in the xactn).

"
ISIS-866,Improvement,Closed,Request-scoped service should be told when the request is starting and stopping.,"For @RequestScoped services, Isis creates a proxy that implements the RequestScopedService interface (in Isis core-runtime), which defines __isis_startRequest and __isis_stopRequest.  These methods are then called when the Isis session (=request scope) is created so that the proxy can instantiate a service for the duration of the request, bound to the thread-local.

HOWEVER...

The underlying service doesn't actually know it has been created/a request is started.  It isn't possible to put logic in the constructor, because that stuff is also called by the proxy wrapper.

SO...

... a bit of research shows that the JEE way of doing this is to call methods annotated @PostConstruct and @PreDestroy.  So that's what we should do too.
"
ISIS-865,New Feature,Closed,Either warn or fail-fast if an action is annotated with safe semantics but nevertheless results in dirty objects in the xactn.,"Following on/inspired by ISIS-864.

Needs some discussion to decide on how to configure.  Warning could just be logging, while fail-fast could mean throw an exception.

"
ISIS-864,Improvement,Closed,"Command should be persisted if any dirty objects enlisted into transaction, in order to ensure no accidental orphans.","adding:
isis.services.command.actions=ignoreQueryOnly
means that commands are not persisted for any query-only actions.  But that means that if an action is incorrectly annotated with query-only semantics (ie @ActionSemantics(Of.SAFE)) and then dirties objects, then we can end up with audit entries for those dirty objects that are orphaned.

So, this enhancement is for Isis core to always persist a command whenever an object has been dirtied, even if from an action that has SAFE semantics.

then 
"
ISIS-863,Bug,Closed,Bookmark of viewmodel is too large to be stored in target field of CommandJdo table,"The bookmark of a viewmodel is too large to be stored in the target field of the IsisCommand (CommandJdo) table. The maximum length of target is 2000 characters but the bookmark of a viewmodel exceeds that.

Because it's not relevant to store this bookmark we decided not to store bookmarks for viewmodels and therefore allow null values in the target field."
ISIS-862,Improvement,Closed,Warnings for memory leaks when quitting Tomcat,"Here's the full console ouput:

SEVERE: The web application [] appears to have started a thread named [com.google.inject.internal.util.$Finalizer] but has failed to stop it. This is very likely to create a memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [] appears to have started a thread named [Timer-1] but has failed to stop it. This is very likely to create a memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [] appears to have started a thread named [com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0] but has failed to stop it. This is very likely to create a memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [] appears to have started a thread named [com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#1] but has failed to stop it. This is very likely to create a memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [] appears to have started a thread named [com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#2] but has failed to stop it. This is very likely to create a memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [] appears to have started a thread named [Timer-2] but has failed to stop it. This is very likely to create a memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [] appears to have started a thread named [com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0] but has failed to stop it. This is very likely to create a memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [] appears to have started a thread named [com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#1] but has failed to stop it. This is very likely to create a memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [] appears to have started a thread named [com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#2] but has failed to stop it. This is very likely to create a memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [org.apache.isis.security.shiro.authorization.IsisPermission$1] (value [org.apache.isis.security.shiro.authorization.IsisPermission$1@b689b7a]) and a value of type [java.util.TreeMap] (value [{}]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [com.google.inject.internal.InjectorImpl$1] (value [com.google.inject.internal.InjectorImpl$1@b76c70]) and a value of type [java.lang.Object[]] (value [[Ljava.lang.Object;@a302d6e]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [org.apache.isis.security.shiro.authorization.IsisPermission$1] (value [org.apache.isis.security.shiro.authorization.IsisPermission$1@b689b7a]) and a value of type [java.util.TreeMap] (value [{}]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [com.google.inject.internal.InjectorImpl$1] (value [com.google.inject.internal.InjectorImpl$1@b76c70]) and a value of type [java.lang.Object[]] (value [[Ljava.lang.Object;@60f695fb]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [org.apache.isis.security.shiro.authorization.IsisPermission$1] (value [org.apache.isis.security.shiro.authorization.IsisPermission$1@b689b7a]) and a value of type [java.util.TreeMap] (value [{}]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [org.apache.shiro.util.ThreadContext.InheritableThreadLocalMap] (value [org.apache.shiro.util.ThreadContext$InheritableThreadLocalMap@21180655]) and a value of type [java.util.HashMap] (value [{org.apache.shiro.util.ThreadContext_SUBJECT_KEY=org.apache.shiro.web.subject.support.WebDelegatingSubject@3047c76c, org.apache.shiro.util.ThreadContext_SECURITY_MANAGER_KEY=org.apache.shiro.web.mgt.DefaultWebSecurityManager@38759c37}]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [org.apache.shiro.util.ThreadContext.InheritableThreadLocalMap] (value [org.apache.shiro.util.ThreadContext$InheritableThreadLocalMap@21180655]) and a value of type [java.util.HashMap] (value [{org.apache.shiro.util.ThreadContext_SUBJECT_KEY=org.apache.shiro.web.subject.support.WebDelegatingSubject@3047c76c, org.apache.shiro.util.ThreadContext_SECURITY_MANAGER_KEY=org.apache.shiro.web.mgt.DefaultWebSecurityManager@38759c37}]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [org.apache.shiro.util.ThreadContext.InheritableThreadLocalMap] (value [org.apache.shiro.util.ThreadContext$InheritableThreadLocalMap@21180655]) and a value of type [java.util.HashMap] (value [{org.apache.shiro.util.ThreadContext_SUBJECT_KEY=org.apache.shiro.web.subject.support.WebDelegatingSubject@3047c76c, org.apache.shiro.util.ThreadContext_SECURITY_MANAGER_KEY=org.apache.shiro.web.mgt.DefaultWebSecurityManager@38759c37}]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [org.apache.shiro.util.ThreadContext.InheritableThreadLocalMap] (value [org.apache.shiro.util.ThreadContext$InheritableThreadLocalMap@21180655]) and a value of type [java.util.HashMap] (value [{org.apache.shiro.util.ThreadContext_SUBJECT_KEY=org.apache.shiro.web.subject.support.WebDelegatingSubject@3047c76c, org.apache.shiro.util.ThreadContext_SECURITY_MANAGER_KEY=org.apache.shiro.web.mgt.DefaultWebSecurityManager@38759c37}]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [org.apache.isis.security.shiro.authorization.IsisPermission$1] (value [org.apache.isis.security.shiro.authorization.IsisPermission$1@b689b7a]) and a value of type [java.util.TreeMap] (value [{}]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [org.apache.isis.security.shiro.authorization.IsisPermission$1] (value [org.apache.isis.security.shiro.authorization.IsisPermission$1@b689b7a]) and a value of type [java.util.TreeMap] (value [{}]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [com.google.inject.internal.InjectorImpl$1] (value [com.google.inject.internal.InjectorImpl$1@b76c70]) and a value of type [java.lang.Object[]] (value [[Ljava.lang.Object;@3162fbd6]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [org.apache.isis.security.shiro.authorization.IsisPermission$1] (value [org.apache.isis.security.shiro.authorization.IsisPermission$1@b689b7a]) and a value of type [java.util.TreeMap] (value [{}]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [org.apache.isis.security.shiro.authorization.IsisPermission$1] (value [org.apache.isis.security.shiro.authorization.IsisPermission$1@b689b7a]) and a value of type [java.util.TreeMap] (value [{}]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [org.apache.isis.security.shiro.authorization.IsisPermission$1] (value [org.apache.isis.security.shiro.authorization.IsisPermission$1@b689b7a]) and a value of type [java.util.TreeMap] (value [{}]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [com.google.inject.internal.InjectorImpl$1] (value [com.google.inject.internal.InjectorImpl$1@b76c70]) and a value of type [java.lang.Object[]] (value [[Ljava.lang.Object;@5983b7ee]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [org.apache.isis.security.shiro.authorization.IsisPermission$1] (value [org.apache.isis.security.shiro.authorization.IsisPermission$1@b689b7a]) and a value of type [java.util.TreeMap] (value [{}]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [com.google.inject.internal.InjectorImpl$1] (value [com.google.inject.internal.InjectorImpl$1@b76c70]) and a value of type [java.lang.Object[]] (value [[Ljava.lang.Object;@56a0982b]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Apr 11, 2013 11:06:39 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [] created a ThreadLocal with key of type [org.apache.isis.security.shiro.authorization.IsisPermission$1] (value [org.apache.isis.security.shiro.authorization.IsisPermission$1@b689b7a]) and a value of type [java.util.TreeMap] (value [{}]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak."
ISIS-861,Bug,Closed,"Wicket (v1.2): @Disabled fields (if don't have an @Optional) get a 'mandatory' indicator, even though can't enter anything into the field.",Originally noted in Estatio Sept 2013 (Isis v1.2).  Possibly been fixed since?
ISIS-860,Bug,Closed,Wicket viewer: bulk action rendered out of position in Firefox (Isis v1.2) ...,"Copied over from Estatio, originally raised in Sept 2013 (v1.2 of Isis).  So possibly has been fixed since."
ISIS-859,New Feature,Closed,UI: Wicket: favorites/recently viewed (as per Sugar CRM),"Suggestion from Jeroen, originally raised in context of Estatio."
ISIS-858,New Feature,Closed,Wicket: allow menu items to be grouped into submenus,"Probably by parsing the @MemberOrder(name=""foo.bar"") or reading from layout.json."
ISIS-857,New Feature,Resolved,"[WON'T FIX] JDO/Wicket/RO: provide support for a number of built-in value types (eg BaseNumber, BaseString, BaseDate... to support Money, Reference, Note, Description); annotated with @Mask annotation","The idea here is to make it easy for the developer to write their own value types which (by inheriting from base classes) are automatically supported by both the JDO Objectstore, the Wicket viewer and the RO viewer."
ISIS-856,Improvement,Open,RO viewer not handling RDBMS constraint violation gracefully,"to replicate (using Estatio)

http://localhost:8080/restful/services/api/actions/putCharge/invoke

{""description"":{""value"":""indennita' di occupazione dei locali""},""code"":{""value"":""6022""},""taxReference"":{""value"":""A""},""reference"":{""value"":""INDENN. AFFITTO""}}

and then again with a different reference, but the same code (say)

{""description"":{""value"":""indennita' di occupazione dei locali""},""code"":{""value"":""6022""},""taxReference"":{""value"":""A""},""reference"":{""value"":""INDENN. AFFITTO""}}"
ISIS-855,New Feature,Closed,Allow contributed actions to be renamed in the contributee,"eg 
for Lease#calculate(Property) -> to appear as -> Property#calculateLeases"
ISIS-854,New Feature,Closed,Separator between for menu items,"See also ISIS-977, to group menu items according to a .layout.json file."
ISIS-853,Bug,Closed,joda DateTime properties loose time when persisted,"creating and persisting an entity just containing a DateTime and a String property via service action works just fine.

when this entity is reopened and saved in wicket viewer without changing anything, the time component is set to 00:00.

or, to be more precise: to 00:00 UTC which, in my case, is rendered as 02:00  (vienna: UTC+1 + daylight saving time)"
ISIS-852,Bug,Closed,Derived property cannot be written properly,"when using the proposed modifyXxx syntax to make a derived property writable, it is rendered as ""disabled"" in wicket viewer.
{code:title=demo|borderStyle=solid}
    public LocalDate getDerivedDate() { ... }
    public void modifyDerivedDate(final LocalDate date) { ... }
{code}

when using the alternative setXxx syntax, the UI component is writable. but in this case, the value of the derived property is not written to the persisted property.
{code:title=demo|borderStyle=solid}
    // {{ BeginAt (property)
    @javax.jdo.annotations.Persistent
    private DateTime beginAt;

    @Disabled
    @javax.jdo.annotations.Column(allowsNull = ""false"")
    public DateTime getBeginAt() {
        return beginAt;
    }

    public void setBeginAt(final DateTime beginAt) {
        this.beginAt = beginAt;
    }
    // }}

    // {{ DerivedDate (property)
    @NotPersisted
    @NotPersistent
    public LocalDate getDerivedDate() {
        return getBeginAt().toLocalDate();
    }

    public void setDerivedDate(final LocalDate beginDate) {
        setBeginAt(getBeginAt().withDate(beginDate.getYear(), beginDate.getMonthOfYear(), beginDate.getDayOfMonth()));
    }
    // }}
{code}

it seems like the value set by the derived property gets overwritten by the original/old value of the persisted property that is displayed in the wicket component.
therefore it might only be an issue, if original and derived properties are members of the same entity and displayed via wicket viewer.

some background:
i try to use 3 ui components  (= derived properties: date, hour, minute) to set a single persisted DateTime property."
ISIS-851,Improvement,Closed,Remove modules from Isis core (available instead through isisaddons).,
ISIS-850,Bug,Closed,Target field in IsisCommand is to small to save actions on viewmodels,"When executing an action on a viewmodel the target contains the full memento so it will exceed the 255 characters of the column in the IsisCommand table.

Need to investigate further what the maximum column length should be and decide to either extend or change to Clob/Text"
ISIS-849,New Feature,Resolved,[WON'T FIX] Extend DataNucleus integration to also support the JPA API.,"Timebox this; if it turns out to take too long, then punt"
ISIS-848,Improvement,Closed,"Use a single consolidated mechanism for auto-discovery of services, entities and fixture scripts.","ie... implement AppSpecs/ClusterSpecs.

~~~
Isis core now supports auto-discovery (behind the scenes using org.reflections.Reflections) of entities, of services and of fixture scripts.  But the configuration of these is all over the place:

- entities are discovered:
  - in the app using WEB-INF/persistor_datanucleus.properties
  - in the integtests in the XxxSystemBuilder#testConfiguration()
- services are discovered:
   - in the app using WEB-INF/isis.properties
   - in the integtests in the XxxSystemBuilder#(constructor)
- fixture scripts are discovered:
  - in the app in the constructor of the subclass of FixtureScripts.

~~~
some other aspects to consider:

isis.properties, persistor.properties etc.

Shiro realm, whether to enable or not (shiro.ini)

web.xml fragments (filters/servlets)

per publishmq add-on, this means:
- cxf
- jolokia
- hawt.io
- RO

- spring
  - bootstraps in turn camel/activemq 
  - could tackle with a different spring file ?
  - reconfigure spring.properties




"
ISIS-847,Bug,Closed,"RegisterEntities isn't called prior to the metamodel validation, thus we currently rely on priming the metamodel through the services... not good.",
ISIS-846,Improvement,Closed,Enhance ExceptionRecognizer so that the stack trace can be suppressed in certain circumstances (for security),"See http://isis.markmail.org/thread/xrlhfx5xii6ndel4 on the dev list.

This overlaps (or could) with ISIS-884"
ISIS-845,Improvement,Closed,"[Won't Fix] Hidden (Where.REFERENCES_PARENT) should take into account the instance that is the parent, not just its type.","For example:

PartyRelationship {
    fromParty;
    toParty;
}

if rendered from the point of view of the from party, would want to show only the toParty.  But adding this annotation causes both properties to be suppressed.

This can be seen in the code:

{code}
    static Filter<ObjectAssociation> associationDoesNotReferenceParent(final ObjectSpecification parentSpec) {
        if(parentSpec == null) {
            return Filters.any();
        }
        return new Filter<ObjectAssociation>() {
            @Override
            public boolean accept(ObjectAssociation association) {
                final HiddenFacet facet = association.getFacet(HiddenFacet.class);
                if(facet == null) {
                    return true;
                }
                if (facet.where() != Where.REFERENCES_PARENT) {
                    return true;
                }
                final ObjectSpecification assocSpec = association.getSpecification();
                final boolean associationSpecIsOfParentSpec = parentSpec.isOfType(assocSpec);
                final boolean isVisible = !associationSpecIsOfParentSpec;
                return isVisible;
            }
        };
    }
{code}

Instead, the code should take into account the actual instance that is referenced, not just the type (ie look at the object that the association points back to)."
ISIS-844,New Feature,Closed,[DUPLICATE] Support custom annotations as higher-level semantics (a la BeanVal),"For example, a contributed collection requires:

import org.apache.isis.applib.annotations.*;

@ActionSemantics(Of.SAFE)
@NotContributed(As.ASSOCIATION)
@NotInServiceMenu
@Render(Type.EAGERLY)
public List<Foo> getFoos() { ... }

it would be nice to allow the user to simplify the programming model.  For example:

package com.mycompany.isis;
import org.apache.isis.applib.annotations.*;

@ActionSemantics(Of.SAFE)
@NotContributed(As.ASSOCIATION)
@NotInServiceMenu
@Render(Type.EAGERLY)
public @interface ContributedCollection {}

and then:

import com.mycompany.isis.*;

@ContributedCollection
public List<Foo> getFoos() { ... }


~~~
Thus, Isis continues to define the base ""primitive"" semantics, but the end-programmer is free to introduce higher-level semantics/abstractions if they so wish.
"
ISIS-843,Bug,Closed,AboutPage is not serializable,"     [exec] 07:47:42,526  [JavaSerializer       qtp1720950881-24 ERROR]  Error serializing object class org.apache.isis.viewer.wicket.ui.pages.about.AboutPage [object=[Page class = org.apache.isis.viewer.wicket.ui.pages.about.AboutPage, id
= 3, render count = 1]]
     [exec] org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream$ObjectCheckException: The object type is not Serializable!
     [exec] A problem occurred while checking object with type: java.io.BufferedInputStream
     [exec] Field hierarchy is:
     [exec]   3 [class=org.apache.isis.viewer.wicket.ui.pages.about.AboutPage, path=3]
     [exec]     private java.lang.Object org.apache.wicket.MarkupContainer.children [class=[Ljava.lang.Object;]
     [exec]       private java.lang.StackTraceElement net.ftlines.wicketsource.InstantiationLocation.traceElement[2][1] [class=org.apache.wicket.markup.html.WebMarkupContainer, path=3:theme]
     [exec]         private java.lang.Object org.apache.wicket.MarkupContainer.children [class=[Ljava.lang.Object;]
     [exec]           private final java.util.Map org.apache.isis.viewer.wicket.viewer.registries.pages.PageClassRegistryDefault.pagesByType[write:1][write:2][write:3][write:4][write:5][write:6][write:7][write:8][9] [class=org.apache.isis.viewer.wicket.ui.components.about.AboutPanel, path=3:theme:about]
     [exec]             private java.io.InputStream org.apache.isis.viewer.wicket.ui.components.about.AboutPanel.metaInfManifestIs [class=java.io.BufferedInputStream] <----- field that is causing the problem
     [exec]     at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.internalCheck(CheckingObjectOutputStream.java:387)
     [exec]     at org.apache.wicket.core.util.objects.checker.CheckingObjectOut
"
ISIS-842,Wish,Closed,Rework the bookmark/breadcrumbs views.,"I'm currently thinking that something like IntelliJ's ctrl+E pop-up might work well ?  And perhaps also the ctrl+1 idea for a project explorer sliding in.

____
This has had various incarnations:
- was ""open each object in a new tab"".
- bookmark window pinnable on the side (as a set of side tabs).
- a project explorer view, cf IntelliJ (ctrl+1 to toggle)."
ISIS-841,Improvement,Closed,"[NOT A PROBLEM] Remove mention of a ""loading()"" callback; this can never fire (for JDO objectstore).",Delete the LoadingCallbackFacet and update documentation.
ISIS-840,Bug,Closed,"""Permission groups"" for IsisPermission (custom security string for Shiro) not working as advertised.","Per docs [1]

user_role   = !reg/org.estatio.api,\
              !reg/org.estatio.webapp.services.admin,\
              reg/* ;
admin_role = adm/*

then a user with both user_role and admin_role should have access to everything, because the two vetos in the ""reg"" group do not veto the permission provided in the ""adm"" group.

~~~
Tracking this down showed the issue to be a reliance on equals() implementation in IsisPermission.

[1] http://isis.apache.org/components/security/shiro/format-of-permissions.html"
ISIS-839,Task,Closed,1.6.0 release tasks,
ISIS-838,Improvement,Closed,Provide an additional hook method for AbstractIsisSessionTemplate that automatically sets up the transaction.,per: http://markmail.org/thread/yof2zjwo5ws2b7el
ISIS-837,Bug,Closed,"In Wicket viewer, forms not flushing properties when annotated with JDO @NotPersistent.","In 1.5.0 there is a guard to explicitly not flush changed property values in a form's model (EntityModel#apply) for those properties that have the NotPersistedFacet.class.

However, this logic is wrong.  Even though a property is not directly persistable by JDO, it might still be implicitly persistable through business logic in the setter.

Therefore remove this guard.
"
ISIS-836,Bug,Closed,Not certain that FixtureScripts' ClassDiscoveryService works when referencing deployed 1.5.0 JAR,eg as used in example isiaddons modules tags app.
ISIS-835,Bug,Closed,"NPE in select2 with isisaddons module for tags, (optional choices for strings)",
ISIS-834,Improvement,Closed,[WON'T FIX] Ensure that only a single implementation of a DomainService is registered.,"Two complications:
- ExceptionRecognizers require multiple implementations (are chained together)
- for each implementation we identify all the types it implements, so the check isn't a simple 1:1 map (at the limit all implementations extend java.lang.Object).  Therefore need to take into account the set of injection points that the services are injected into."
ISIS-833,Improvement,Closed,Break out applib and JDO services into modules,"... so that in future these can be released independently of core; and to reduce configuration (isis.properties file).


Some principles:
* minimize the amount of configuration required;  by exploiting @DomainService annotation, in many cases it should be sufficient to simply add the appropriate module to the classpath, and let the service be auto-reigstered.
* ""on the other hand"", don't (without some safety checks) want to start automatically registering services that might substantially change behaviour of the system.  For example, the JDO services - audit, command, publishing - all require explicit configuration in isis.properties.  Automatically registering these might be ""too much, too soon"".

Thus:
* In services containing only programmatic or hidden services (""system services, repos"") then these should be annotated with @DomainService; thus they are configured and registered automatically if added to the classpath.
* In services containing only ""contributions"" can (probably safely enough) be annotated with @DomainService; thus they are configured and registered automatically if added to the classpath.
* any menu UI services should NOT be annotated with @DomainService, because the developer may want to have more fine-grained control on how the UI appears.


~~~~~~
No change for the following services:

core request-scoped services; already annotated with @DomainService, and so always available
- CommandContext                   (no UI; applib implementation; populated by runtime if available)  - UPDATED JAVADOC
- Bulk.InteractionContext          (no UI; applib implementation; not used by runtime)  - UPDATED JAVADOC
- Scratchpad                       (no UI; applib implementation; not used by runtime)  - UPDATED JAVADOC
- QueryResultsCache                (no UI; applib implementation; not used by runtime)  - UPDATED JAVADOC

core singleton services; already annotated with @DomainService, and so always available
- MementoServiceDefault                  (no UI; runtime implementation; used implicitly by runtime for commands)  - UPDATED JAVADOC
- BookmarkServiceDefault                 (no UI; runtime implementation; used implicitly by runtime for commands) - UPDATED JAVADOC, now non UI, separated out out contributions
- XmlSnapshotServiceDefault              (no UI; runtime implementation; not used by runtime) - UPDATED JAVADOC
- ClassDiscoveryServiceUsingReflections  (no UI; applib implementation; not used by runtime) - UPDATED JAVADOC
- ClockService                     (no UI; applib implementation; not used by runtime) - UPDATED JAVADOC


~~~
These services should changed to be annotated annotated with @DomainService (because JDO is now core):
- IsisJdoSupportImpl               (no UI; not used by runtime)  - NOW ANNOTATED; UPDATED EXAMPLE APPS (isis.properties, *SystemInitializer for integ tests
- EventBusServiceJdo            (no UI, used by runtime if available)  - NOW ANNOTATED; UPDATED EXAMPLE APPS (isis.properties, *SystemInitializer for integ tests

~~~
IsisJdoSupport API should move from the jdo-applib to applib; - DONE. 

~~~~~~
The following are new (Maven) modules.  

Some notes:
* If a service can be used by runtime, then its API is defined in applib; the module therefore contains only the impl.  Most of the modules below fall into this category.
* If a service is completely standalone from the framework, then it defines its own API (in an ""applib"" submodule) and its own impl.  An example of this is isis-module-settings, which defines AppSettings and UserSettings.


isis-module-wrapper                (used by integtestsupport)
- WrapperFactoryDefault            (no UI; already @DomainService; rename core-wrapper implementation); DONE, UPDATED pom.xml in example apps; 

isis-module-command-jdo   - MOVED, UPDATED.  
- CommandServiceJdo                (used by runtime if available, so API in applib) - DECIDED NOT TO MAKE INTO @DomainService FOR NOW.
- CommandServiceJdoContributions   (UI, not used by runtime)
- CommandServiceJdoRepository      (no UI, supporting service for ...Contributions); - NOW ANNOTATED AS @DomainService; UPDATED EXAMPLES
- BackgroundCommandServiceJdo               (UI visible, not used by runtime but prereq for background service) - NOW ANNOTATED AS @DomainService; UPDATED EXAMPLES
- BackgroundCommandServiceJdoContributions  (UI visible, not used by runtime)
- BackgroundCommandServiceJdoRepository     (not visible, supporting service for ...Contributions);  - NOW ANNOTATED AS @DomainService; UPDATED EXAMPLES

isis-module-audit-jdo   - MOVED, UPDATED.
- AuditingServiceJdo                (used by runtime if available, so API in applib)  - DECIDED NOT TO MAKE INTO @DomainService FOR NOW
- AuditingServiceJdoContributions   (UI, not used by runtime)
- AuditingServiceJdoRepository      (not visible, supporting service for ...Contributions); - NOW ANNOTATED AS @DomainService; UPDATED EXAMPLES

isis-module-background
- BackgroundServiceDefault         (used by runtime if available, so API in applib; requires BackgroundCommandService); CAN'T SAFELY BE A @DomainService BECAUSE OF DEPENDENCY ON impl. of BackgroundCommandService

isis-module-publishing-jdo
- PublishingServiceJdo              (used by runtime if available, so API in applib)
- PublishingServiceJdoContributions (UI, not used by runtime) 
- PublishingServiceJdoRepository    (not visible, supporting service for ...Contributions); - NOW ANNOTATED AS @DomainService; UPDATED EXAMPLES

isis-module-publishingeventserializer-ro
- RestfulObjectsSpecEventSerializer  (not visible, used by publishing service); - NOW ANNOTED AS @DomainService; UPDATED EXAMPLES

isis-module-devutils               (not used by runtime, standalone); DONE
- applib
        > DeveloperUtilitiesService
- impl
        > DeveloperUtilitiesServiceDefault    (metamodel impl)

isis-module-settings  (not used by runtime, standalone); DONE
- applib
        > ApplicationSettingsServiceRW
        > UserSettingsServiceRW        
- impl-jdo
        > ApplicationSettingsServiceJdo     (UI, not used by runtime)
        > ApplicationSettingsServiceHidden  (not UI, not used by runtime)
        > UserSettingsServiceJdo            (UI, not used by runtime)
        > UserSettingsServiceHidden         (not UI, not used by runtime)


in addition:
* move IsisJdoSupport APi into core-applib *;  DONE; HAVE REMOVED jdo-applib completely... updated pom.xml for example apps.
* EventBusServiceDefault   can be deprecated, since its subclass EventBusServiceJdo is always available; DONE

- have decided to leave ExceptionRecognizerCompositeForJdoObjectStore to be explicitly registered; likelihood that this will require customisation in some cases.  (used by runtime if available)
"
ISIS-832,Improvement,Closed,"Move jdo, shiro and restful into core","Refactoring towards Isis 2.0.0.

This change, when released, will impact the pom.xml of existing apps:

o.a.i.security:isis-security-shiro:1.5.0   -> o.a.i.core:isis-core-security-shiro:1.6.0

o.a.i.objectstore:isis-objectstore-jdo-applib:1.5.0   -> o.a.i.core:isis-core-objectstore-jdo-applib:1.6.0
o.a.i.objectstore:isis-objectstore-jdo-datanucleus:1.5.0   -> o.a.i.core:isis-core-objectstore-jdo-datanucleus:1.6.0
o.a.i.objectstore:isis-objectstore-jdo-metamodel:1.5.0   -> o.a.i.core:isis-core-objectstore-jdo-metamodel:1.6.0

o.a.i.viewer:isis-viewer-restfulobjects-applib:2.3.0 -> o.a.i.core:isis-core-viewer-restfulobjects-applib:1.6.0
o.a.i.viewer:isis-viewer-restfulobjects-rendering:2.3.0 -> o.a.i.core:isis-core-viewer-restfulobjects-rendering:1.6.0
o.a.i.viewer:isis-viewer-restfulobjects-server:2.3.0 -> o.a.i.core:isis-core-viewer-restfulobjects-server:1.6.0
o.a.i.viewer::isis-viewer-restfulobjects-tck:2.3.0 -> o.a.i.core:isis-core-viewer-restfulobjects-tck:1.6.0


also 
delete scope=import for
  o.a.i.security:isis-security-shiro
  o.a.i.objectstore:isis-objectstore-jdo
  o.a.i.viewer:isis-viewer-restfulobjects


"
ISIS-831,Improvement,Closed,"Extend (custom) EventBus vetoing logic so that can also encompass hide, disable, validate.","Previously raised on mailing list : http://markmail.org/thread/3z27xshelu4r7cx4

~~~~~
in the ""typical"" Isis programming model we use hideXxx(), disableXxx() and validateXxx() as three different precondition checks (""see it, use it, do it"").

For event bus subscribers however, an interaction can only be vetoed by raising an exception in the execute phase.

An improvement would be to define some mechanism by which the subscribers can be involved in these other business rules.  That is, a subscriber could cause an action to be hidden or greyed out if the state of the would-be source of the event is such that the action cannot be called.

One possible design is to introduce a ""Mode"" enum:

{code:java}
public enum Mode {
    HIDE, DISABLE, VALIDATE, EXECUTE
}
{code}

and then:

{code:java}
public abstract class ActionInteractionEvent {
    Mode getMode();
   ...
}
{code}

and some custom subclass:

{code:java}
public class MyActionInteractionEvent extends ActionInteractionEvent { ... }
{code}

The framework would then raise the (same) event multiple times for each action.    The subscriber would switch on the mode:

{code:java}
@Subscribe
public void on(MyActionInteractionEvent ev) {
    switch(ev.getMode()) {
        case HIDE:
          // veto if required, ie cause action to be hidden
        case DISABLE:
          // veto if required, ie cause action to be greyed out
        case VALIDATE:
          // veto if required, ie cause action prompt to be redisplayed with error message
        case EXECUTE:
          // veto if required by raising exception, 
          // else perform appropriate actions
    }
}
{code}

The event could also, perhaps, provide the mechanism to allow the veto to be communicated:

{code:java}
public abstract class ActionInteractionEvent {
    Mode getMode();
    void vetoHide();
    void vetoDisable(String reason);
    void vetoValidate(String reason);
    ...
}
{code}

thus:

{code:java}
@Subscribe
public void on(MyActionInterationEvent ev) {
    switch(ev.getMode()) {
        case HIDE:
           ... if required ... ev.vetoHide();
        case DISABLE:
           ... if required ... ev.vetoDisable(""Not allowed because..."");
        case VALIDATE:
           ... if required ... ev.vetoValidate(""Not allowed because..."");
        case EXECUTE:
           ...
    }
}
{code}

One final refinement; it's likely that work done during the validation phases (eg querying a repo) may be useful for the later execution phases.  So the event could also act as a simple map:

{code:java}
public abstract class ActionInteractionEvent {
    ...
    void put(Class subscriber, String key, Object val);
    Object get(Class subscriber, String key)
    ...
}
{code}
"
ISIS-830,Bug,Closed,Wire up JDO events to publish onto our EventBus (rather than publish our own events).,"Specifically:
- ObjectPersistedEvent   // postCreate in JDO terminology
- ObjectUpdatingEvent   // preStore in JDO terminology
- ObjectUpdatedEvent    // postStore in JDO terminology
- ObjectRemovingEvent   // preDelete in JDO terms

This would be a more flexible solution for many use cases than implementing updating() etc.... can centralize logic."
ISIS-829,Bug,Closed,updating() callback not firing on edit,"Domain object lifecycle method updating is not working in the below scenario:


1.       From the Menu service, list all domain objects

2.       Pick one to navigate into its detail page

3.       By default we can see Edit button.

4.       Click on Edit button to edit some properties. Modify some properties and click on Ok. And updating method defined in domain object is not invoked


Method is defined as below inside a domain object which is being selected from the list to update through Edit default button:
    public void updating(){
        this.setChangeBy(this.container.getUser().getName());
        this.setChangeDt(new Date());
    }
"
ISIS-828,Bug,Closed,Wrapping an already wrapped object should honour the mode if different.,"WrapperFactory#wrap(object, mode) as currently implemented will always just return the object passed in if already wrapped.

This used to be the correct behaviour, prior to the introduction of modes.

Now, however, if the domain object is already wrapped but with a wrapper that has different mode than that requested, it should be re-wrapped."
ISIS-827,Improvement,Closed,"Introduce WrappingObject, with more unique method names, as a replacement for WrappedObject.","WrappingObject to replace WrappedObject:

public interface WrappingObject {
    __isis_save() // instead of save()
    __isis_wrapped() // instead of wrappe()
}

Until ISIS-826 (Isis 2.0), WrappedObject should inherit from WrappingObject."
ISIS-826,Improvement,Closed,"Remove WrappedObject interface, use instead WrappingObject as its replacement.","For example, WrappedObject defines save() and wrapped().  If the underlying domain object also defined these methods as actions, then it would be impossible to use the wrapper to check business rules etc.

Therefore should remove this interface (in Isis 2.x), to replace with one that uses methods which are unlikely to cause a clash.

(The workaround in the meantime is to rename the action methods and use @Named() if required for the UI)."
ISIS-825,Improvement,Closed,"Wicket viewer, auto-focus on first field on action parameter not working","Autofocus ist not set on first field on action (modal dialog).
See ISIS-527.
Auto-focus is working on edit object.
"
ISIS-824,Bug,Closed,Generic repository is broken,"as per https://isis.apache.org/more-advanced-topics/how-to-09-030-How-to-use-a-generic-repository.html

disableFindByTitle() should be disableFindByTitle(String)

When I made the fix as a quick experiment, it then also threw up another issue because the JDO objectstore doesn't implement hasInstances().  So that (at least) also needs fixing."
ISIS-823,Improvement,Closed,"Restructure Todo's tests, nested static classes.",
ISIS-822,New Feature,Closed,[Duplicate] Integration tests should generate a transcript when executed (a la BDD tools such as Cucumber),"Harking back to the early days of Naked Objects...

 

perhaps also generate an Asciidoc transcript with PlantUML."
ISIS-821,Bug,Closed,Precision gets lost when double values are use in BigDecimal attributes,The restful spec requires BigDecimal values to surrounded by quotes. When doubles are being used the conversion to BigDecimal is incorrect. 
ISIS-820,Improvement,Closed,OidMarshaller - Identifier(PK) with special symbols should be allowed,"When a domain object has “#” symbol in its Primary key(of String type) and try to query it, java.lang.IllegalArgumentException (Identifier contains # symbol) exception is thrown: PFA Log file.

This is presentation constraint and need to be enhanced by encoding and decodng the PK in ISIS OidMarshaller

 

See also ISIS-1059"
ISIS-819,New Feature,Closed,Wicket viewer should show the environment details so can distinguish if running in productnio vs UAT/systest/dev etc,"original idea:
A nice way to do this might be to use a diagonal banner in the corner, like the ""fork me on github"" banners that are everywhere these days.

alternative suggestion (preferable, probably):
put this in the footer/navbar, so that doesn't hide a menu item at the top."
ISIS-818,Bug,Closed,wrapSkipRules does not execute action due to being hidden,"Having a class with an action defined as the following one:

     // {{ ComputedValue (action)
   @Hidden
   @XMSAction(locales = @XMSLocale(locale = ""es"", caption = ""Valor Calculado""))
   public ImpactLevel computedValue() {
	...
   }



Isis throws an exception while executing:

assertThat(this.service(WrapperFactory.class).wrapSkipRules(asset).computedValue(), is(impactLevel));


With the following stacktrace:

org.apache.isis.applib.services.wrapper.HiddenException: Reason: Always hidden. Identifier: com.xms.framework.architecture.domain.model.Asset#computedValue()
	at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.toException(DomainObjectInvocationHandler.java:626)
	at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.notifyListenersAndVetoIfRequired(DomainObjectInvocationHandler.java:594)
	at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.checkVisibility(DomainObjectInvocationHandler.java:578)
	at org.apache.isis.core.wrapper.handlers.DomainObjectInvocationHandler.invoke(DomainObjectInvocationHandler.java:217)
	at org.apache.isis.core.wrapper.proxy.ProxyInstantiatorForJavassist$1.invoke(ProxyInstantiatorForJavassist.java:52)
	at com.xms.framework.architecture.domain.model.business.BusinessProcess_$$_jvsta1_16.computedValue(BusinessProcess_$$_jvsta1_16.java)
	at com.xms.framework.architecture.integration.glue.business.old.AssetGlue.the_asset_with_name_has_the_asset_value(AssetGlue.java:113)
	at ✽.Then the asset with name ""EAM-ASS-VAL-010-010 - Business Process"" should have the asset value ""null""(com/xms/framework/architecture/integration/specs/base/EAM-ASS-VAL - Enterprise Architecture Model - Assets - Valuation.feature:17)
"
ISIS-817,New Feature,Closed,Configure wicket-sources debugging plugin,"See:
* https://github.com/42Lines/wicket-source
* https://www.42lines.net/2012/01/31/announcing-wicket-source/
* http://blog.armhold.com/2012/02/16/announcing-wicket-source-plugin-for-intellij-idea/
"
ISIS-816,New Feature,Closed,Provide an applib for Wicket viewer to hold any services specific to that viewer.,
ISIS-815,Improvement,Closed,"Internationalization of Wicket UI elements (edit, ok, cancel, logout, about)","Using Wicket's built-in i18n capabilities, but tweaked so that application-scoped properties override page-scope properties (rather than other way around)"
ISIS-814,New Feature,Closed,"[WON'T FIX] Provide a better way to handle polymorphic relationships, eg implement a ""PolymorphicNavigator service""","We'd like to be able to decouple modules (eg from Estatio or wherever) and make them reusable for others.

For example, Estatio has ""CommunicationChannel"", where its owner is of type CommunicationChannelOwner.  We currently use DataNucleus' support for interface mappings, but (because we use annotations) this requires us to list the fully qualified class names of the implementations in the CommunicationChannel; hardly reusable code.

Naked Objects MVC has a service called the PolymorphicNavigator [1], a mechanism to handle relationships between different Entity Framework contexts, typically via an interface.  

The PolymorphicNavigator requires that all implementations use an int (or long) as their primary key.  It then stores the relationship in a separate table, qualified by the object type.  This is a bit like DataNucleus' ""identity"" strategy for mapping interfaces [2], except that:
- two columns are used, not one (for object type, and object PK
- the link is held separately from the rest of the object's data.

[1] https://github.com/NakedObjectsGroup/NakedObjectsFramework/blob/4e860789ad115a38cd3348ceb5c0b141fb0e0d7b/Programming%20Model/NakedObjects.Helpers/Services/PolymorphicNavigator.cs
[2] http://www.datanucleus.org/products/datanucleus/jdo/orm/interfaces.html
"
ISIS-813,New Feature,Closed,Provide the ability to mock out domain services in integration tests.,"As inspired by this thread: http://markmail.org/thread/v3qptyjsrvsxi2j2 

Usually in an integration test we want the ""real"" implementations of our domain services.  That's certainly the case for repositories etc that connect to ""our"" database.

But for domain services that connect to the outside world (eg hit an external web service), it'd be useful to be able to replace the real implementation with a mock, and have this mock be used in the running system instead.

That mock would probably need to have a fairy liberal set of expectations, eg (in JMock) use allowing() or ignoring(); so I can see a bit of experimentation might be needed to make this work smoothly.  But it undoubtedly would be valuable.
"
ISIS-812,Bug,Closed,Isis 1.5 blob mapping broken for PostgreSQL (when set to null),"As reported on mailing list: http://markmail.org/thread/zoiu2v4sklo7mevq

~~~
Looking into this, I've learnt that PostgreSQL does not support BLOB datatype, but instead supports ""bytea"" (byte array) and ""oid"".  The first is in-row storage, where the data is always returned in the result set, the second is a pointer to off-row storage; PostgreSQL provides its own API for handling oid types).

For the Isis Blob class (org.apache.isis.applib.value.Blob) we provide our own IsisBlobMapping; this is automatically registered through metadata held in the JDO applib jar.   It is the job of this mapping class to read/set values on the underlying ResultSet / PreparedStatement.  DataNucleus provides some additional wrapping infrastructure.

The warning mentioned in the mailing list post indicates that DN is treating the BLOB datatype as a ""bytea"".  This *almost* works fine; our IsisBlobMapping can persist non-null values ok, but attempting to set a null value breaks PostgreSQL; it treats the null as a null pointer of type ""oid"" (offline storage), rather than a null of type ""bytea"".

After some experimentation, I've found a different way to set null that works for PostgreSQL and also works fine for HSQLDB, and MS SQL Server.

This ticket is to apply that change."
ISIS-811,Bug,Closed,Quickstart app does not compile on Java 8,"The sample application created using the maven archetype as described [here|http://isis.apache.org/intro/getting-started/quickstart-archetype.html] generates code that does not compile under Java 8, due to Java 8 having an Optional type in java.util, and that clashing with Isis' Optional annotation.

A simple fix is to explicitly import the Isis Optional annotation in TodoItem.java, or stop using * imports for java.util.

 "
ISIS-810,Improvement,Closed,Remove Wizard and Wicket viewer implementation on basis that shouldn't constrain programming model to this extent.,"ie, the work committed in ISIS-800 and ISIS-807.

Instead, should be a separate ""add-on""?

Background:
- Jeroen made this suggestion; he thinks that the Wizard interface is too prescriptive
- However Oscar thinks that we should provide a default implementation.

~~~
NB: if we do decide to remove the Wizard from IsIs, then Jeroen and I have registered the ""isisaddons.org"" domain and the github.com/isisaddons as a domain home for such add-ons.

The idea is to nurture something similar what Apache Wicket do with their ""wicketstuff"" companion site.  All of my com.danhaywood wicket extensions could then move to isisaddons.org.

"
ISIS-809,New Feature,Closed,Provide implementation of ViewModelFacet that doesn't require explicit implementation of the IViewModel interface.,"It ought to be possible just to do this automatically (at least for simple scalars).  That way any non @Persistable pojo will be a view model by default.

(Oscar takes credit for suggesting this)."
ISIS-808,Improvement,Closed,"To reduce security permissioning setup, assume read-only access to all properties and collections if user's role have read-only permissions at the class level.","Not exactly sure what this implies, possibly a refactoring in either core or the shiro security integration in terms of inferring permissions for properties."
ISIS-807,Improvement,Closed,"Break out EntityPropertiesForm into two for the new IWizard, and then make into a separate component.","As a refactoring and decoupling of the implementation made in ISIS-800.

Should include a version of the quickstart todo app with the wizard.

"
ISIS-806,Improvement,Closed,"In Wicket viewer, shouldn't be possible to invoke an action if editing a form.","Either:
- prevent the action button from being clicked if editing a property, or
- let the action button be clicked, but automatically apply any outstanding changes (this is what JIRA does, in effect)

For the second option, would probably require that actions (EntityHeaderPanel) be moved inside the form that is set up within EntityPropertiesPanel.... ie some rejigging required to the Wicket components hierarchy."
ISIS-805,Bug,Closed,(Mac and Linux) Class discovery service throws errors on startup,"These errors could be silently ignored:
{code}
2:58:45,672 [Reflections                   ] could not create Dir using directory from url file:/System/Library/Java/Extensions/libJ3DAudio.jnilib. skipping.
java.lang.RuntimeException: cannot use dir /System/Library/Java/Extensions/libJ3DAudio.jnilib
	at org.reflections.vfs.SystemDir.<init>(SystemDir.java:20)
	at org.reflections.vfs.Vfs$DefaultUrlTypes$3.createDir(Vfs.java:229)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:98)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:45,675 [Reflections                   ] could not create Vfs.Dir from url. ignoring the exception and continuing
org.reflections.ReflectionsException: could not create Vfs.Dir from url, no matching UrlType was found [file:/System/Library/Java/Extensions/libJ3DAudio.jnilib]
either use fromURL(final URL url, final List<UrlType> urlTypes) or use the static setDefaultURLTypes(final List<UrlType> urlTypes) or addDefaultURLTypes(UrlType urlType) with your specialized UrlType.
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:108)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:45,821 [Reflections                   ] could not create Dir using directory from url file:/System/Library/Java/Extensions/libJ3D.jnilib. skipping.
java.lang.RuntimeException: cannot use dir /System/Library/Java/Extensions/libJ3D.jnilib
	at org.reflections.vfs.SystemDir.<init>(SystemDir.java:20)
	at org.reflections.vfs.Vfs$DefaultUrlTypes$3.createDir(Vfs.java:229)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:98)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:45,823 [Reflections                   ] could not create Vfs.Dir from url. ignoring the exception and continuing
org.reflections.ReflectionsException: could not create Vfs.Dir from url, no matching UrlType was found [file:/System/Library/Java/Extensions/libJ3D.jnilib]
either use fromURL(final URL url, final List<UrlType> urlTypes) or use the static setDefaultURLTypes(final List<UrlType> urlTypes) or addDefaultURLTypes(UrlType urlType) with your specialized UrlType.
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:108)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:46,346 [Reflections                   ] could not create Dir using directory from url file:/usr/lib/java/libjdns_sd.jnilib. skipping.
java.lang.RuntimeException: cannot use dir /usr/lib/java/libjdns_sd.jnilib
	at org.reflections.vfs.SystemDir.<init>(SystemDir.java:20)
	at org.reflections.vfs.Vfs$DefaultUrlTypes$3.createDir(Vfs.java:229)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:98)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:46,347 [Reflections                   ] could not create Vfs.Dir from url. ignoring the exception and continuing
org.reflections.ReflectionsException: could not create Vfs.Dir from url, no matching UrlType was found [file:/usr/lib/java/libjdns_sd.jnilib]
either use fromURL(final URL url, final List<UrlType> urlTypes) or use the static setDefaultURLTypes(final List<UrlType> urlTypes) or addDefaultURLTypes(UrlType urlType) with your specialized UrlType.
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:108)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:47,793 [Reflections                   ] could not create Dir using directory from url file:/System/Library/Java/Extensions/libJ3DUtils.jnilib. skipping.
java.lang.RuntimeException: cannot use dir /System/Library/Java/Extensions/libJ3DUtils.jnilib
	at org.reflections.vfs.SystemDir.<init>(SystemDir.java:20)
	at org.reflections.vfs.Vfs$DefaultUrlTypes$3.createDir(Vfs.java:229)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:98)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:47,794 [Reflections                   ] could not create Vfs.Dir from url. ignoring the exception and continuing
org.reflections.ReflectionsException: could not create Vfs.Dir from url, no matching UrlType was found [file:/System/Library/Java/Extensions/libJ3DUtils.jnilib]
either use fromURL(final URL url, final List<UrlType> urlTypes) or use the static setDefaultURLTypes(final List<UrlType> urlTypes) or addDefaultURLTypes(UrlType urlType) with your specialized UrlType.
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:108)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:49,178 [Reflections                   ] could not create Dir using directory from url file:/System/Library/Java/Extensions/libAppleScriptEngine.jnilib. skipping.
java.lang.RuntimeException: cannot use dir /System/Library/Java/Extensions/libAppleScriptEngine.jnilib
	at org.reflections.vfs.SystemDir.<init>(SystemDir.java:20)
	at org.reflections.vfs.Vfs$DefaultUrlTypes$3.createDir(Vfs.java:229)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:98)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:49,179 [Reflections                   ] could not create Vfs.Dir from url. ignoring the exception and continuing
org.reflections.ReflectionsException: could not create Vfs.Dir from url, no matching UrlType was found [file:/System/Library/Java/Extensions/libAppleScriptEngine.jnilib]
either use fromURL(final URL url, final List<UrlType> urlTypes) or use the static setDefaultURLTypes(final List<UrlType> urlTypes) or addDefaultURLTypes(UrlType urlType) with your specialized UrlType.
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:108)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:49,350 [Reflections                   ] could not create Dir using directory from url file:/System/Library/Java/Extensions/libQTJNative.jnilib. skipping.
java.lang.RuntimeException: cannot use dir /System/Library/Java/Extensions/libQTJNative.jnilib
	at org.reflections.vfs.SystemDir.<init>(SystemDir.java:20)
	at org.reflections.vfs.Vfs$DefaultUrlTypes$3.createDir(Vfs.java:229)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:98)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:49,351 [Reflections                   ] could not create Vfs.Dir from url. ignoring the exception and continuing
org.reflections.ReflectionsException: could not create Vfs.Dir from url, no matching UrlType was found [file:/System/Library/Java/Extensions/libQTJNative.jnilib]
either use fromURL(final URL url, final List<UrlType> urlTypes) or use the static setDefaultURLTypes(final List<UrlType> urlTypes) or addDefaultURLTypes(UrlType urlType) with your specialized UrlType.
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:108)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:49,375 [Reflections                   ] could not create Dir using directory from url file:/System/Library/Java/Extensions/QTJava.zip. skipping.
java.lang.RuntimeException: cannot use dir /System/Library/Java/Extensions/QTJava.zip
	at org.reflections.vfs.SystemDir.<init>(SystemDir.java:20)
	at org.reflections.vfs.Vfs$DefaultUrlTypes$3.createDir(Vfs.java:229)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:98)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:49,376 [Reflections                   ] could not create Vfs.Dir from url. ignoring the exception and continuing
org.reflections.ReflectionsException: could not create Vfs.Dir from url, no matching UrlType was found [file:/System/Library/Java/Extensions/QTJava.zip]
either use fromURL(final URL url, final List<UrlType> urlTypes) or use the static setDefaultURLTypes(final List<UrlType> urlTypes) or addDefaultURLTypes(UrlType urlType) with your specialized UrlType.
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:108)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:49,442 [Reflections                   ] could not create Dir using directory from url file:/System/Library/Java/Extensions/libmlib_jai.jnilib. skipping.
java.lang.RuntimeException: cannot use dir /System/Library/Java/Extensions/libmlib_jai.jnilib
	at org.reflections.vfs.SystemDir.<init>(SystemDir.java:20)
	at org.reflections.vfs.Vfs$DefaultUrlTypes$3.createDir(Vfs.java:229)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:98)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
12:58:49,442 [Reflections                   ] could not create Vfs.Dir from url. ignoring the exception and continuing
org.reflections.ReflectionsException: could not create Vfs.Dir from url, no matching UrlType was found [file:/System/Library/Java/Extensions/libmlib_jai.jnilib]
either use fromURL(final URL url, final List<UrlType> urlTypes) or use the static setDefaultURLTypes(final List<UrlType> urlTypes) or addDefaultURLTypes(UrlType urlType) with your specialized UrlType.
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:108)
	at org.reflections.vfs.Vfs.fromURL(Vfs.java:90)
	at org.reflections.Reflections.scan(Reflections.java:165)
	at org.reflections.Reflections.<init>(Reflections.java:94)
	at org.reflections.Reflections.<init>(Reflections.java:135)
	at org.apache.isis.applib.services.classdiscovery.ClassDiscoveryServiceUsingReflections.findSubTypesOfClasses(ClassDiscoveryServiceUsingReflections.java:37)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.findAndInstantiateFixtureScripts(FixtureScripts.java:99)
	at org.apache.isis.applib.fixturescripts.FixtureScripts.init(FixtureScripts.java:95)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:53)
	at org.apache.isis.core.commons.lang.MethodExtensions.invoke(MethodExtensions.java:47)
	at org.apache.isis.core.metamodel.specloader.ServiceInitializer.postConstruct(ServiceInitializer.java:126)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.initializeServices(IsisSystemFixturesHookAbstract.java:181)
	at org.apache.isis.core.runtime.system.IsisSystemFixturesHookAbstract.init(IsisSystemFixturesHookAbstract.java:141)
	at org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:136)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.google.inject.internal.ProviderMethod.get(ProviderMethod.java:104)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031)
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)
	at com.google.inject.Scopes$1$1.get(Scopes.java:65)
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
	at com.google.inject.internal.SingleFieldInjector.inject(SingleFieldInjector.java:53)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:110)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:75)
	at com.google.inject.internal.MembersInjectorImpl$1.call(MembersInjectorImpl.java:73)
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024)
	at com.google.inject.internal.MembersInjectorImpl.injectAndNotify(MembersInjectorImpl.java:73)
	at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:60)
	at com.google.inject.internal.InjectorImpl.injectMembers(InjectorImpl.java:944)
	at org.apache.isis.viewer.wicket.viewer.IsisWicketApplication.init(IsisWicketApplication.java:210)
	at org.apache.wicket.Application.initApplication(Application.java:819)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:424)
	at org.apache.wicket.protocol.http.WicketFilter.init(WicketFilter.java:351)
	at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
	at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
	at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
	at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
	at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
	at org.mortbay.jetty.Server.doStart(Server.java:224)
	at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
	at org.apache.isis.core.webserver.WebServerBootstrapper.bootstrap(WebServerBootstrapper.java:93)
	at org.apache.isis.core.webserver.WebServer.run(WebServer.java:92)
	at org.apache.isis.core.webserver.WebServer.main(WebServer.java:68)
	at org.apache.isis.WebServer.main(WebServer.java:25)
{code}"
ISIS-804,Improvement,Closed,[INVALID] Make (entity) properties read-only by default.,"Currently properties are read/write by default; the programmer has to annotate with @Disabled (or equivalent) to make read-only.

While this ""subtractive programming"" approach is nice for demo's, the truth is that with larger applications, if not rigorously and completely tested, the end-user may get the opportunity to change something that they ought not; potentially corrupting data.

It would be better (and safer) for properties to be read-only by default.

The presence of the modifyXxx(...)/clearXxx() supporting methods would then indicate that they are read-write.

Another possible benefit is that - if we implement ISIS-273 (to read from fields) then the amount of boilerplate would substantially be reduced if a tool like Lombok was used.  That is, read-only properties would consist solely of a private field; read-write properties would be the field plus the modify/clear.

It might also make sense for the clearXxx() method to be optional; that is, to allow modifyXxx(..) to be called with null.

NB: for view models, properties could (perhaps) remain as read-write; there are no side-effects.

This change requires discussion on the mailing list."
ISIS-803,Improvement,Closed,Replace lifecycle methods with additional EventBus events.,"This issue is to remove a feature that is only partly implemented in the JDO objectstore, namely the lifecycle methods.

Jeroen and I were discussing this, and think they are possibly an anti-pattern since they tend to lead to fragile code.

Rather than have the object ""pushing"" changes to others, it would be better if an event were broadcast via the EventBus.  That way a subscribing service could pull appropriate changes and do whatever is necessary.

~~~
Possible implementation:

@DomainObject(
    domainEventOnLoad = ...,
    domainEventOnSave = ...,
    domainEventOnUpdate = ...,
    domainEventOnDelete = ...,
)

By using the corresponding associated phases, ie EXECUTING and EXECUTED, the subscriber can act BEFORE and/or AFTER the domain object is loaded / initially saved-persisted / updated / deleted.

The ""domainEventOnLoad"" event would allow the user to ""veto"" a specific domain entity instance (domain object) to be showed due to security or other business reasons. 
"
ISIS-802,New Feature,Closed,"Remove the ProfileStore component (in future, can raise a ProfileService as and when we identify a concrete reqt).","As a write-up from IsisCon2014, Dan said:

> >
> > 6. Profile Store
> >
> > The profile store is a component of the framework that is not supported by
> > either the Wicket or Restful Objects viewers, but whose functionality is
> > broadly superceded by the UserSettingsService.

To which Kevin replied:

> When the UI becomes user-configurable (re-arranged, pallete change,
> etc) this should be demo'd.
> 
> Where are user preferences (e.g. UI language, timezone, etc) currently
> stored? Do we have demo code?

And so Dan said:

There are two points here... where to store preferences, and how/what within Isis should consume them.

For the former, we have the UserSettingsService (part of applib); in the JDO applib there is an entity-based implementation,

For the latter, nothing in Isis particularly consumes these.  For timezones we tend to use LocalDate which gets around the issue to some extent; but you are right that the UserProfile class (in the profilestore) does hold this Localization class; that needs surfacing out as a first-class concept somehow.

So perhaps ProfileStore should live on, but not as a component, but instead as a separate service.

In all, I see three related subdomains:

[Shiro security]   ->  [Isis user profile (i18n etc) service]  ->  [Isis user settings service]

I'll raise a ticket to capture this thinking so far.


~~~~~
... which is what this ticket is...
"
ISIS-801,Bug,Closed,Action method taking domain object paramater gets triggered automatically whenever instances of that object type is accessed,"I have application security service which creates permission to manage particular entity(OmSite). Its action method is:

    @Bookmarkable
    @MemberOrder(sequence = ""9"")
    @Named(""Create Site Permission"")
    public OmPermission createSitePermission(final @Named(""Choose a site"") OmSite site) {
        final OmPermission obj = newTransientInstance(OmPermission.class);
        obj.setPermission(SecurityUtil.formatSitePermission(site.getOrgId(), site.getSiteId()));
        obj.setSite(site);
        persistIfNotAlready(obj);
        return obj;
    }


As you can see this method takes OmSite instance to create a permission to that instance. And OmPermission has foreign key to OmSite. This action is displayed in service menu and its working fine.

But the problem I am facing is when I access the list of OmSite objects in other UI pages.  This action method is getting triggered automatically and inserts bulk OmPermissions for all those List<OmSite> objects.


This action method createSitePermission should be invoked only if it is clicked manually, but it gets triggered automatically whenever OmSite is accesed in some other places.

For ex:
an action that returns a list of these OmSite, 
when OmSite is in a collection of some other entity,
When new OmSite is created.

Workaround for this issue is annotate @NotContributed  to that action method, it will prevent from invoking this method whenever its parameter instance is accessed.

BR
Ranganath Varma


Could you please look into this issue.
"
ISIS-800,New Feature,Closed,Wizard-like form for Wicket viewer,"Erik Hair on users@i.a.o:

Is it in some way possible to create a wizard like form or open an action with an action? I tried to return a not yet persisted object from an action and hoped I could edit some properties and add some elements to collections of the object before persisting it to the database...

~~~~~~
Dan:
Short answer is that we don't really (properly) support this.  And we should.

I agree that @NotPersistable is confusing and its not clear what to use; the right solution would be to implement a view model (currently: implement the ViewModel interface), and then - optionally - write a custom ComponentFactory for the Wicket viewer to render the wizard appropriately.

But the snag even with the above is that (currently) view models are immutable; they support actions but their properties cannot be edited.

I can see the way forward on this; I don't think it's difficult, but it will require a change in core and probably the wicket viewer also.
"
ISIS-799,Improvement,Closed,Isis Shiro - Server restart for loading new permission,"I created security ISIS service (application-specific) to create users, roles and permissions and their mappings from UI.

I am facing one issue in the following scenario:


1.       Using SQL script one user(admin) with role access to all services inserted into security tables

2.       Logged in using admin to create another user(BBY) to access some services

3.       Logged out admin

4.       Logged in using BBY. BBY doesn't see those services which are given access by admin

5.       Jetty server restart and logged in using BBY

6.       BBY now can be able to see those services.


I think when BBY user logs in should see the services as this user has got permissions even without restart the server."
ISIS-798,Improvement,Closed,Minor improvements in support of integration testing.,"1. loosen up FixtureScript so that some methods are non-final
2. have FixtureScript use the FixtureScripts#newExecutionContext hook

3. change WrapperFactory's DomainObjectInvocationHandler so that does not assume the underlying delegate is inmemory (ie use AdapterManager#adapterFor rather than AdapterManager#getAdapter).
"
ISIS-797,Bug,Closed,'Restful objects' decodes json request body while this is not ,"A json-string with a '++'-sign in a value fired at the restful objects viewer has the '++'-sign removed when calling action method.

Example json:
{""password"":{""value"":""abc+def""}}

This string is directly put into the PUT request as body. The value in the action-method (called by the restful call) looks URL-decoded because the '+'-sign is replaced by a whitespace.
"
ISIS-796,Bug,Closed,"lifecycle callback ""updating()"" is not firing","when trying to override lifecycle callbacks, only some of them fire as expected.

working:
- created()
- saving()
- persisting()
- saved()
- persisted()
- updated()

missing:
- updating()
- loading()
- loaded()

no yet tested:
- removing()
- removed()

test scenario:
- create new entity of class X
- list all entities of X
- open created instance
- edit property
- click 'ok'

result:
according to the logfile, ""updated"" is called right after the corresponding datastore UPDATE (as expected), but ""updating"" is missing."
ISIS-795,Improvement,Closed,disable persistence-by-reachability-at-commit in the archetypes.,See http://isis.apache.org/components/objectstores/jdo/disabling-persistence-by-reachability.html
ISIS-794,Dependency upgrade,Closed,"Upgrade to Wicket 6.16.0, remove CharSequenceResource",Per ISIS-788 and WICKET-5600.
ISIS-793,Improvement,Closed,Make Wicket viewer's IsisApplication easier to override (to support customization use cases),"One such use case is the ability to provide a ""lost password"" or ""register user"" pages.  

This ticket isn't to implement such features, merely to make more of the functionality in IsisWicketApplication overrideable such that this functionality might be more easily developed within the user community."
ISIS-792,Task,Closed,Tidy-up tasks for Isis 1.5.0 release,
ISIS-791,Wish,Closed,Actions returning collection annotated to indicate which properties as columns,"It would be nice to have a way of hiding (result) fields per
finder/repo action to be more flexible in the user interface."
ISIS-790,Improvement,Closed,Replace DN Blob/Clob Mappings with Blob/Clob converters,"See ISIS-788 for background on the Blob/Clob converters.  

ISIS-789 (upgrade to DN 4.0) is a prereq (meaning ISIS-568 for JDK is also)."
ISIS-789,Improvement,Closed,Upgrade to DN 4.0,"NB: DN 4.0 only supports Java 7, so this is also dependent on our moving to Java 7 across board (see ISIS-568).

NB: should also check ISIS-647 (fix for http://www.datanucleus.org/servlet/jira/browse/NUCCORE-1103).

- will possibly want to enable to get better perf?

NB: also know that there's a change to the way that polymorphism works, is mapped differently (in Estatio).
"
ISIS-788,Improvement,Closed,"Delete the Isis Blob/Clob Converter classes for JDO, since redundant.","As per query to Andy Jefferson:

> I also implemented the TypeConverter interface for Blob and Clob;
> but I'm not sure how DN actually uses it.  Can you enlighten me?

If the user has specified to use a TypeConverter on a field
http://www.datanucleus.org/products/accessplatform/jdo/types.html#typeconverter

then it will select TypeConverterMapping for that field (the log should say).
This has the TypeConverter internally, and will handle creation of the
required column (for the datastore type of the converter), and automate the getObject/setObject of the XXXMapping that you would have had to write if you had written the Mapping class manually.
https://github.com/datanucleus/datanucleus-rdbms/blob/3.2/src/java/org/datanucleus/store/rdbms/mapping/java/TypeConverterMapping.java

On a persist, the setObject is called, passing through the converter. On a
fetch the getObject is called, passing through the converter.

In DN 4.0, there is even less need to provide the XXXMapping classes,  adding on TypeConverterMultiMapping so for cases like your multi-column Blob it may be possible to do it just via a (different) converter (with multiple columns).
"
ISIS-787,Bug,Closed,Property validation not displaying error message.,"This is not an issue in 1.4.1, so must be a regression from some other change made on snapshot ... perhaps the upgrade to Wicket 6.15.0.

Not going to spend time to investigate, since have solution (refactoring the OK submit button to use AjaxButton rather than vanilla Button)."
ISIS-786,New Feature,Closed,Allow event bus subscribers to veto interactions by throwing a RecoverableException or NonRecoverableException,"If the subscriber method throws either an org.apache.isis.applib.RecoverableException or an org.apache.isis.applib.NonRecoverableException, then the transaction will be aborted and the interaction effectively vetoed.

A RecoverableException will be rendered in a user-friendly manner to the end-ser, a NonRecoverableException rendered as a serious/unexpected error.

Any other exception type (eg an ""accidental"" one such as NullPointerException) will be ignored.  This preserves previous behaviour."
ISIS-785,Improvement,Closed,Invoke action parameter with a collection of entities.,"Overlaps with ISIS-709

As an Isis user
I want to pass as an action parameter a collection of entities 
In order to avoid repetitive work to the end-user

~~~
One possible prog model API would be to annotate one of the action params with a new annotation, named @BulkParam, such as in:

public class TodoItem {

  ...
  private TodoItem parentTodoItem;

  ....

  public void addRelatedTodo(@Named(""To-Do Item"") @BulkParam TodoItem todoItem, @Named(""Comments"") String comments) {
       ....
  }
  ...

}

Where the viewer founds it, instead of asking for one TodoItem, it will allow the user to select multiple items.
Once done, it will execute the action multiple times, passing each time one of the TodoItem selected.
If there are other params, the viewer will pass on each action invokation the same value for all them.
Only one param can be annotated with @BulkParam, for avoiding combinatorial explosion (10 items selected of one param, 10 items on the other param would require to be execute 100 times, one for each combination).

The User Interface could be adapted to the choices or autocomplete parameter facets, for easing the work of the user.

If ""choices"", there can be alternative displays (see https://plugins.jquery.com/tag/multiselect/):
1. the viewer can present the user a grid or checkbox (like the one in http://liveline.github.io/jquery-checkallbox/) with all choices, and the user can check any of them. Alternative: http://www.ryancramer.com/journal/entries/select_multiple/
2. multi-select drop-down, like this ones: http://ivaynberg.github.io/select2/, http://harvesthq.github.io/chosen/, https://github.com/ehynds/jquery-ui-multiselect-widget, http://www.droplist.vinmein.com/. They require minimal changes on the current actions dialog, but does not allow to always view all choices selected (I could live with it).


If ""autocomplete"":
1. It could be based on a two panels disposition, left and right, where the user incrementally searches on an edit box placed over the left panel, similar to current autocomplete implementation, but placing on the left panel : http://quasipartikel.at/multiselect_next/
2. Similar approach to the ""choices"" one, also with this same widget that admits remote dataset loading and min number of chars entered: http://ivaynberg.github.io/select2/


As seen, a widget like http://ivaynberg.github.io/select2/ would allow to solve both situations without requiring much changes on the viewer’s action dialog. "
ISIS-784,New Feature,Closed,"Change Wicket viewer to get rid of edit mode, instead allow individual fields to be edited by clicking on them (similar to the way that JIRA works).",http://wb.agilecoders.de/demo/x-editable
ISIS-783,Improvement,Closed,Integration test support enhancements,"1. Allow services to be appended to in IntegSystemForTest.Builder
   ... thereby allowing this class to be extended/inherited from.  
   ... useful for building related suites of integration tests together that share a common base definition of the ""system under test""

2. auto-inject services into integration tests, if annotated using @Inject etc.
   ... remove boilerplate from setup.
"
ISIS-782,Improvement,Closed,Integration testing framework should automatically install the FixtureClock singleton rather than the regular Clock,"The ClockService delegates to the Clock singleton.  If the absence of any explicit initialization, the Clock singleton lazily instantiates itself with a non-replaceable SystemClock that simply delegates to the system time.

In integration tests, however, we should use FixtureClock.  The default behaviour of this is to act the same as the SystemClock, however it also exposes methods to allow the date/time to be set.  Once set, any call for the date/time is fixed.

Currently, because of the way in which Isis bootstraps, by the time the test starts the Clock singleton has already been hit, meaning that it isn't possible for a developer-written fixture to install the FixtureClock explicitly.

This ticket is for the testing framework (in IsisSystemForTest) to automatically install the FixtureClock on behalf of any tests that want to use it."
ISIS-781,Improvement,Closed,Add edit capability to view objects,"View object should have the same capability as domain object in the viewer. Currently it does not support ""edit"". Without this capability, actions must be employed and state management becomes more of an issue on the server side.
The view object should support all of the viewer specific semantics that the domain objects support via the viewer generation. "
ISIS-780,Improvement,Closed,@Inject on field and @RequestScoped are incompatible - use a MetaModelValidator to detect,"Our support for @RequestScoped annotation is home-grown; we create a Javassist proxy for the service, which then delegates to dynamically created instances of the actual service bound on a thread-local.

The Javassist proxy automatically forwards all method calls to the underlying service for the current thread.  

If the request-scoped service has other services injected into it via methods (ie setXxx(...) or injectXxx(...), then these method calls are forwarded just like any other, and everything works fine.

However, if the request-scoped service has its other services injected via a field annotated with @RequestScoped, then the service will be injected into the Javassist proxy and the underlying service will get a null pointer.

One day we might replace our home-grown injection with a more sophisticated third-party library (eg a CDI impl?) that can handle the above.  But until such time, as a workaround we should fail-fast: detect the situation and through an exception on start-up."
ISIS-779,Improvement,Closed,"Refactor EventBusService as a @RequestScoped service, and have it own the guava EventBus as a field.","Originally this ticket was raised as a bug to the effect that ""EventBus should not re-register services on open/close; this is not thread-safe.""

Subsequent analysis shows that isn't actually the case; the current design is thread-safe.

How it works is that, although EventBusServiceDefault is application-scoped, the guava EventBus itself is obtained from the PersistenceSession, ie is in effect for the session.

It would however be preferrable to convert EventBusService(Default) into a request-scoped, and then having it simply new up the guava EventBus each time.  The only real issue is the ordering of the service injection; the domain services do a reverse callback to the EventBusService in the setterXxx() / injectXxx()
; there might be ordering issues.
"
ISIS-778,Improvement,Closed,Simpify ReferencePanel and EntityLinkSelect2Panel,As a prerequisite to tackling ISIS-764 (multi-select).
ISIS-777,Bug,Closed,RO Viewer is not thread-safe for concurrent requests.,"scenario is:
- actions/listAll/invoke
   - returning a list of references
- forEach($get(...)) 
   - multiple pending requests to similar resources at same time.

Intermittent errors, one or more of these requests will fail with 500; has stack trace:

{
  ""message"" : ""java.util.ConcurrentModificationException"",
 
  ""stackTrace"" : [
    ""java.util.ArrayList$Itr.checkForComodification(ArrayList.java:859)"",
     ""java.util.ArrayList$Itr.next(ArrayList.java:831)"",
         ""com.google.common.collect.Iterators$7.computeNext(Iterators.java:646)"",
         ""com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:143)"",
         ""com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:138)"",
         ""com.google.common.collect.Iterators.addAll(Iterators.java:356)"",
         ""com.google.common.collect.Lists.newArrayList(Lists.java:146)"",
         ""com.google.common.collect.Lists.newArrayList(Lists.java:128)"",
         ""org.apache.isis.core.metamodel.specloader.specimpl.ObjectSpecificationAbstract.getObjectActions(ObjectSpecificationAbstract.java:744)"",
         ""org.apache.isis.core.metamodel.specloader.specimpl.ObjectSpecificationAbstract.getObjectActions(ObjectSpecificationAbstract.java:758)"",
         ""org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer.withMembers(DomainObjectReprRenderer.java:215)"",
\n ""org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer.render(DomainObjectReprRenderer.java:150)"",
""org.apache.isis.viewer.restfulobjects.server.resources.ResourceAbstract.responseOfOk(ResourceAbstract.java:209)"",
""org.apache.isis.viewer.restfulobjects.server.resources.ResourceAbstract.responseOfOk(ResourceAbstract.java:204)"",
""org.apache.isis.viewer.restfulobjects.server.resources.DomainResourceHelper.objectRepresentation(DomainResourceHelper.java:195)"",
""org.apache.isis.viewer.restfulobjects.server.resources.DomainObjectResourceServerside.object(DomainObjectResourceServerside.java:112)"",
""sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)"",
""sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)"",
""sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)"",
""java.lang.reflect.Method.invoke(Method.java:606)"",
""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:167)"",
""org.jboss.resteasy.core.ResourceMethod.invokeOnTarget(ResourceMethod.java:269)"",
""org.jboss.resteasy.core.ResourceMethod.invoke(ResourceMethod.java:227)"",
""org.jboss.resteasy.core.ResourceMethod.invoke(ResourceMethod.java:216)"",
""org.jboss.resteasy.core.SynchronousDispatcher.getResponse(SynchronousDispatcher.java:542)"",
""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:524)"",
""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:126)"",
""org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:208)"",
""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55)"",
""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:50)"",
""javax.servlet.http.HttpServlet.service(HttpServlet.java:725)"",
""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:301)"",
""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)"",
""org.apache.isis.viewer.restfulobjects.server.webapp.IsisTransactionFilterForRestfulObjects.doFilter(IsisTransactionFilterForRestfulObjects.java:41)"",
""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239)"",
""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)"",
""org.apache.isis.core.webapp.IsisSessionFilter$SessionState$1.handle(IsisSessionFilter.java:320)"",
""org.apache.isis.core.webapp.IsisSessionFilter.doFilter(IsisSessionFilter.java:409)"",
""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239)"",
""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)"",
""org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)"",
""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239)"",
""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)"",
""org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)"",
""org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)"",
""org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)"",
""org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)"",
""org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)"",
""org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)"",
""org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)"",
""org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239)"",
""org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)"",
""org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:219)"",
""org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106)"",
""org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:503)"",
""org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:136)"",
""org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:74)"",
""org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:610)"",
""org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88)"",
""org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:509)"",
""org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1015)"",
""org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:651)"",
""org.apache.coyote.http11.Http11AprProtocol$Http11ConnectionHandler.process(Http11AprProtocol.java:277)"",
""org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.doRun(AprEndpoint.java:2451)"",
""org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:2440)"",
""java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)"",
""java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)"",
""java.lang.Thread.run(Thread.java:744)"" ],
  ""causedBy"" : null
"
ISIS-776,New Feature,Closed,FixtureScripts service as means of doing fixture management for end-to-end stories.,"Provide a composite pattern around FixtureScript, and a FixtureScripts service to locate and make available in the UI.

Refactor todo app / quickstart archetype to use this service."
ISIS-775,Bug,Closed, ISIS-Shiro isPermitted issue,"I want to use Apache-Shiro API methods in my code for some permissions check. But permission check is not working in ISIS-Shiro environment as it is based on class-based secyrity mechanism.


For ex:

in shiro.ini - I gave permission as below:
site_role = BBY:0540

In the code subject.isPermitted(""BBY:541"") also returning true.

In non-ISIS environment, this security checking is working fine.

Please help how to solve this issue.

Please find attached files.
 Shiro version is 1.2.2 as this is coming via Isis-secuirty-shiro-1.3.0

"
ISIS-774,Improvement,Closed,Remove IsisWicketUnsecuredApplication,"This isn't used in the example apps, and isn't being maintained, and is almost certainly broken...
"
ISIS-773,Improvement,Closed,Convert example apps to use IntelliJ-style regions.,
ISIS-772,Improvement,Closed,Reimplement WrapperFactory to use javassist instead of cglib/asm (for Java7 support),"See ISIS-568, ISIS-569"
ISIS-771,Dependency upgrade,Closed,Upgrade Wicket to wicket 6.15.0 (or whatever is latest),
ISIS-770,Improvement,Closed,Remove dependency on wicket-ioc (because brings in cglib/asm dependency),So we can remove any dependency on cglib/asm as a prereq to properly supporting Java7 (ISIS-568).
ISIS-769,Bug,Closed,"IsisTransaction should do a ""precommit"" for pending updates to applib services, prior to commiting the underlying (JDO) transaction.","As discussed on the mailing list, see http://isis.markmail.org/thread/anln67ohbvkx4r4s."
ISIS-768,Wish,Closed,[WON'T FIX] Session scoped service,A session scoped service for holding frequently used data.
ISIS-767,Improvement,Closed,Enable integration and BDD tests to do a lightweight teardown (eg zap contents of tables) rather than tear down entire system.,"Background to this is email from Oscar to dev list:


We have implemented some BDD tests as Scenario Outlines [1].

But just for one execution, is spending aprox. 15 min in completing a Scenario Outline with aprox. 20 scenarios.

The problem is that they become really slow, as the whole Isis system is recreated for each example.

Following best practices, Scenarios should be independent, but I think there should be ways to guarantee it without sacrificing speed.
- Isis System does not need to be recreated (introspected) for each Scenario, as the source code has not changed.
- Database can be recreated, or perhaps there's an ""abstraction"" on DataNucleus or JDBC to empty a DataStore without re-creating the table structure from the JDO annotations.

Perhaps are other alternatives to improve their speed that does not require refactoring the Isis BDD integrations tests implementation?

Regards,

Oscar

[1] http://jnye.co/Posts/11/repeating-bdd-tests-using-scenario-outlines-and-an-examples-table-with-specflow
"
ISIS-766,Bug,Closed,ISIS Service / ViewModel method calling twice when this method processing BLOB type,"Isis service or ViewModel method getting called twice.

For ex:
I have one Hidden service which has lookup method with @HomePage returning  a ViewModel instance using newViewModelInstance(..) method and that renders one action method taking Blob parameter as button. It's basically upload button to upload a file. When I click on upload button, this upload method called and completed the uploading and again getting called second time by itself. And this is inconsistent behavior. Some times its working(meaning called only once) but some other times it's not.

So I tried this upload action with service class by extending AbstractService which appears in the menu with Upload action. Here also it's the same issue.

Please find attached files in this Jira as I don't have GIT client to push the files in github

BR
Ranganath Varma
"
ISIS-765,Improvement,Closed,Allow UserMemento#hasRole to match on wildcards,"The roles the user has are prefixed by the realm they they were defined in. In orderer to make role matching across realms easier I suggest to use regex matching.

Example:
""*user_role"" matches both ""ldapRealm:user_role"" and ""localRealm:user_role"""
ISIS-764,Improvement,Closed,Combine ReferencePanel and EntityLink2SelectPanel,"In comparison to the drop-down support we have for value types (ValueChoicesSelect2Panel), with reference types we have two widgets: ReferencePanel and EntityLinkSelect2Panel.   These should be combined into one.

This is a useful prereq to ISIS-785 and ISIS-709 (support for multi-select in core and in the wicket viewer)."
ISIS-763,Improvement,Closed,it would be good if service/factory actions (eg Charges#newCharge()) could somehow be rendered alongside the bulk actions for the list of the entity (eg Charges). ,
ISIS-762,Improvement,Closed,"For commands on contributed actions, the target and ""user friendly"" target details should be captured as the contributee, not the contributed service.","Thus, when searching for ""recent changes"", these commands (of contributed actions will show up as having been (seemingly) invoked on the target object (even though the actual method invocation is on the contributing service)."
ISIS-761,Bug,Closed,"ErrorPage itself is not serializable, resulting in stack traces in the log.","{code}
17:10:15,550 [JavaSerializer                ] Error serializing object class org.apache.isis.viewer.wicket.ui.pages.error.ErrorPage [object=[Page class = org.apache.isis.viewer.wicket.ui.pages.error.ErrorPage, id = 9, render count = 0]]
org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream$ObjectCheckException: The object type is not Serializable!
A problem occurred while checking object with type: org.apache.wicket.RequestListenerInterface
Field hierarchy is:
  9 [class=org.apache.isis.viewer.wicket.ui.pages.error.ErrorPage, path=9]
    private java.lang.Object org.apache.wicket.MarkupContainer.children [class=[Ljava.lang.Object;]
      java.lang.Object org.apache.wicket.Component.data[1] [class=org.apache.wicket.markup.html.WebMarkupContainer, path=9:theme]
        private java.lang.Object org.apache.wicket.MarkupContainer.children [class=[Ljava.lang.Object;]
          private final java.lang.annotation.Annotation org.apache.wicket.guice.GuiceProxyTargetLocator.bindingAnnotation[9] [class=org.apache.isis.viewer.wicket.ui.errors.ExceptionStackTracePanel, path=9:theme:exceptionStackTrace]
            java.lang.Object org.apache.wicket.Component.data [class=org.apache.isis.viewer.wicket.ui.errors.ExceptionModel]
              private java.lang.Exception org.apache.isis.viewer.wicket.ui.errors.ExceptionModel.exception [class=org.apache.wicket.core.request.handler.ListenerInvocationNotAllowedException]
                private final org.apache.wicket.RequestListenerInterface org.apache.wicket.core.request.handler.ListenerInvocationNotAllowedException.iface [class=org.apache.wicket.RequestListenerInterface] <----- field that is causing the problem
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.internalCheck(CheckingObjectOutputStream.java:387)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.check(CheckingObjectOutputStream.java:361)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.checkFields(CheckingObjectOutputStream.java:645)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.internalCheck(CheckingObjectOutputStream.java:569)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.check(CheckingObjectOutputStream.java:361)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.checkFields(CheckingObjectOutputStream.java:645)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.internalCheck(CheckingObjectOutputStream.java:569)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.check(CheckingObjectOutputStream.java:361)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.checkFields(CheckingObjectOutputStream.java:645)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.internalCheck(CheckingObjectOutputStream.java:569)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.check(CheckingObjectOutputStream.java:361)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.internalCheck(CheckingObjectOutputStream.java:432)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.check(CheckingObjectOutputStream.java:361)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.checkFields(CheckingObjectOutputStream.java:645)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.internalCheck(CheckingObjectOutputStream.java:569)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.check(CheckingObjectOutputStream.java:361)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.internalCheck(CheckingObjectOutputStream.java:432)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.check(CheckingObjectOutputStream.java:361)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.checkFields(CheckingObjectOutputStream.java:645)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.internalCheck(CheckingObjectOutputStream.java:569)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.check(CheckingObjectOutputStream.java:361)
	at org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream.writeObjectOverride(CheckingObjectOutputStream.java:713)
	at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:343)
	at org.apache.wicket.serialize.java.JavaSerializer$SerializationCheckerObjectOutputStream.writeObjectOverride(JavaSerializer.java:268)
	at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:343)
	at org.apache.wicket.serialize.java.JavaSerializer.serialize(JavaSerializer.java:78)
	at org.apache.wicket.pageStore.DefaultPageStore.serializePage(DefaultPageStore.java:376)
	at org.apache.wicket.pageStore.DefaultPageStore.storePage(DefaultPageStore.java:150)
	at org.apache.wicket.page.PageStoreManager$PersistentRequestAdapter.storeTouchedPages(PageStoreManager.java:410)
	at org.apache.wicket.page.RequestAdapter.commitRequest(RequestAdapter.java:181)
	at org.apache.wicket.page.AbstractPageManager.commitRequest(AbstractPageManager.java:98)
	at org.apache.wicket.page.PageManagerDecorator.commitRequest(PageManagerDecorator.java:73)
	at org.apache.wicket.page.PageAccessSynchronizer$2.commitRequest(PageAccessSynchronizer.java:258)
	at org.apache.wicket.Application$2.onDetach(Application.java:1628)
	at org.apache.wicket.request.cycle.RequestCycleListenerCollection$3.notify(RequestCycleListenerCollection.java:105)
	at org.apache.wicket.request.cycle.RequestCycleListenerCollection$3.notify(RequestCycleListenerCollection.java:101)
	at org.apache.wicket.util.listener.ListenerCollection$1.notify(ListenerCollection.java:120)
	at org.apache.wicket.util.listener.ListenerCollection.reversedNotify(ListenerCollection.java:144)
	at org.apache.wicket.util.listener.ListenerCollection.reversedNotifyIgnoringExceptions(ListenerCollection.java:113)
	at org.apache.wicket.request.cycle.RequestCycleListenerCollection.onDetach(RequestCycleListenerCollection.java:100)
	at org.apache.wicket.request.cycle.RequestCycle.onDetach(RequestCycle.java:640)
	at org.apache.wicket.request.cycle.RequestCycle.detach(RequestCycle.java:589)
	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:293)
	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:259)
	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:201)
	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:282)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)
	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:724)
Caused by: java.io.NotSerializableException: org.apache.wicket.RequestListenerInterface
	at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1181)
	at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1541)
	at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1506)
	at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1429)
	at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1175)
	at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1541)
	at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1506)
	at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1429)
	at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1175)
	at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1541)
	at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1506)
	at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1429)
	at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1175)
	at java.io.ObjectOutputStream.writeArray(ObjectOutputStream.java:1375)
	at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1171)
	at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1541)
	at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1506)
	at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1429)
	at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1175)
	at java.io.ObjectOutputStream.writeArray(ObjectOutputStream.java:1375)
	at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1171)
	at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1541)
	at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1506)
	at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1429)
	at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1175)
	at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:347)
	at org.apache.wicket.serialize.java.JavaSerializer$SerializationCheckerObjectOutputStream.writeObjectOverride(JavaSerializer.java:260)
	... 47 more
{code}"
ISIS-760,Bug,Closed,IllegalStateException when commands/audit enabled in Estatio and failing to persist the Oid of a view model.,"There are two separate issues here:
- first is that the auditing service's column for storing OIDs isn't long enough for view models.
- the second is that, given this then causes the xactn to be aborted, that it throws an IllegalStateException for any subsequent interaction with the system.  The only fix is to restart the server.  See details below

The reason for the second issue is that the previous session does not close correctly.  This is because of an exception being thrown in PersistenceSession#close:

PersistenceSession.completeCommandIfConfigured() line: 418	
PersistenceSession.closeServices() line: 399	
PersistenceSession.close() line: 372	
IsisSessionDefault.close() line: 119	
IsisContextThreadLocal(IsisContext).closeSessionInstance() line: 219	
WebRequestCycleForIsis.onEndRequest(RequestCycle) line: 134	

This in turn is because of an attempt to complete any pending command (per the CommandJdo service) on a xactn that has already been aborted....

private void completeCommandIfConfigured() {
        final CommandContext commandContext = getServiceOrNull(CommandContext.class);
        if(commandContext != null) {
            final CommandService commandService = getServiceOrNull(CommandService.class);
            if(commandService != null) {
                final Command command = commandContext.getCommand();
                commandService.complete(command);
            }
        }
    }

So, when closing the session, need to take this into account.  Should propogate exception if any arises, but still ensure that the persistence session is closed for next-time around.

~~~~~~~~~~
to reproduce:
with estatio demo data

> find invoices for status new
> choose oxford
> approve all.


A server restart was required.

{code}
java.lang.IllegalStateException
Session already open and context not configured for autoclose
 org.apache.isis.core.runtime.system.context.IsisContext#applySessionClosePolicy(IsisContext.java:186)
 org.apache.isis.core.runtime.system.context.IsisContextThreadLocal#openSessionInstance(IsisContextThreadLocal.java:148)
 org.apache.isis.viewer.wicket.viewer.integration.wicket.WebRequestCycleForIsis#onBeginRequest(WebRequestCycleForIsis.java:81)
 org.apache.wicket.request.cycle.RequestCycleListenerCollection$1#notify(RequestCycleListenerCollection.java:65)
 org.apache.wicket.request.cycle.RequestCycleListenerCollection$1#notify(RequestCycleListenerCollection.java:61)
 org.apache.wicket.util.listener.ListenerCollection#notify(ListenerCollection.java:80)
 org.apache.wicket.request.cycle.RequestCycleListenerCollection#onBeginRequest(RequestCycleListenerCollection.java:60)
 org.apache.wicket.request.cycle.RequestCycleListenerCollection$1#notify(RequestCycleListenerCollection.java:65)
 org.apache.wicket.request.cycle.RequestCycleListenerCollection$1#notify(RequestCycleListenerCollection.java:61)
 org.apache.wicket.util.listener.ListenerCollection#notify(ListenerCollection.java:80)
 org.apache.wicket.request.cycle.RequestCycleListenerCollection#onBeginRequest(RequestCycleListenerCollection.java:60)
 org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:213)
 org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:289)
 org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:259)
 org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:201)
 org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:282) 
org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:243)
 org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:210)
 org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
 org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
 org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
 org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83) 
org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
 org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
 org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
 org.apache.catalina.core.ApplicationFilterChain#internalDoFilter(ApplicationFilterChain.java:243)
 org.apache.catalina.core.ApplicationFilterChain#doFilter(ApplicationFilterChain.java:210)
 org.apache.catalina.core.StandardWrapperValve#invoke(StandardWrapperValve.java:225)
 org.apache.catalina.core.StandardContextValve#invoke(StandardContextValve.java:123)
 org.apache.catalina.authenticator.AuthenticatorBase#invoke(AuthenticatorBase.java:472)
 org.apache.catalina.core.StandardHostValve#invoke(StandardHostValve.java:168) 
org.apache.catalina.valves.ErrorReportValve#invoke(ErrorReportValve.java:98) 
org.apache.catalina.valves.AccessLogValve#invoke(AccessLogValve.java:927) 
org.apache.catalina.core.StandardEngineValve#invoke(StandardEngineValve.java:118)
 org.apache.catalina.connector.CoyoteAdapter#service(CoyoteAdapter.java:407) 
org.apache.coyote.http11.AbstractHttp11Processor#process(AbstractHttp11Processor.java:1001)
 org.apache.coyote.AbstractProtocol$AbstractConnectionHandler#process(AbstractProtocol.java:579)
 org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor#run(JIoEndpoint.java:310)
 java.util.concurrent.ThreadPoolExecutor#runWorker(ThreadPoolExecutor.java:1145)
 java.util.concurrent.ThreadPoolExecutor$Worker#run(ThreadPoolExecutor.java:615)
 java.lang.Thread#run(Thread.java:724) 
{code}

On the server:

{code}
Caused by: javax.jdo.JDOFatalUserException: Attempt to store value ""org.estatio.dom.invoice.viewmodel.InvoiceSummaryForPropertyDueDateStatus:PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPG1lbWVudG8-PHJlZmVyZW5jZT5DQVM8L3JlZmVyZW5jZT48ZHVlRGF0ZT4yMDE0LTAzLTMxPC9kdWVEYXRlPjxzdGF0dXM-QVBQUk9WRUQ8L3N0YXR1cz48bmV0QW1vdW50PjE3MTc1LjYwPC9uZXRBbW91bnQ-PHZhdEFtb3VudD4zNzc4LjYzPC92YXRBbW91bnQ-PGdyb3NzQW1vdW50PjIwOTU0LjIzPC9ncm9zc0Ftb3VudD48dG90YWw-MTwvdG90YWw-PC9tZW1lbnRvPg=="" in column ""target"" that has maximum length of 255. Please correct your data!
NestedThrowables:
org.datanucleus.exceptions.NucleusUserException: Attempt to store value ""org.estatio.dom.invoice.viewmodel.InvoiceSummaryForPropertyDueDateStatus:PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPG1lbWVudG8-PHJlZmVyZW5jZT5DQVM8L3JlZmVyZW5jZT48ZHVlRGF0ZT4yMDE0LTAzLTMxPC9kdWVEYXRlPjxzdGF0dXM-QVBQUk9WRUQ8L3N0YXR1cz48bmV0QW1vdW50PjE3MTc1LjYwPC9uZXRBbW91bnQ-PHZhdEFtb3VudD4zNzc4LjYzPC92YXRBbW91bnQ-PGdyb3NzQW1vdW50PjIwOTU0LjIzPC9ncm9zc0Ftb3VudD48dG90YWw-MTwvdG90YWw-PC9tZW1lbnRvPg=="" in column ""target"" that has maximum length of 255. Please correct your data!
        at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:528)
        at org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.java:732)
        at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistent(JDOPersistenceManager.java:752)
        at org.apache.isis.objectstore.jdo.datanucleus.persistence.commands.DataNucleusCreateObjectCommand.execute(DataNucleusCreateObjectCommand.java:54)
        at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.executeCommands(DataNucleusObjectStore.java:368)
        at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.execute(DataNucleusObjectStore.java:362)
        at org.apache.isis.core.runtime.system.transaction.IsisTransaction.doFlush(IsisTransaction.java:425)
        at org.apache.isis.core.runtime.system.transaction.IsisTransaction.commit(IsisTransaction.java:658)
        at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.endTransaction(IsisTransactionManager.java:396)
        at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:184)
        ... 52 more
{code}



"
ISIS-759,Bug,Closed,"Transient errors being logged as result of incorrect call to sendRedirect; not sure why, need diagnostics.","For now, just introduce a new filter which will log the request URL whenever an exception propogates out."
ISIS-758,Bug,Closed,Auditing should be able to cope with a change to a property where the referenced object has been deleted.,"For example, doing a ""cascade"" delete of Parent <->* Child.

Here, the Parent and each of the Children will be audited, and in the case of Child, its ""parent"" reference is changing from (parent) to null.  

However, as the parent itself is deleted, trying to generate its toString() (when using JDO object store) is causing an exception.

The fix is to grab the toString of the object when the objects are enlisted into the transaction, before they are deleted.

"
ISIS-757,Bug,Closed,Make it possible to override logging.properties ,Currently only the logging.properties in /WEB-INF are honoured. Perhaps use the isis.config.dir as override location?
ISIS-756,Bug,Closed,Improvements for JRebel support in Maven and other IDEs,
ISIS-755,Improvement,Closed,Allow external system data to be integrated and managed with an Apache Isis domain object ,"Problem statement: The framework currently offers no lifecycle support for domain objects that get their data from and to external systems.

Requirements:

1. Manage domain object state lifecycle consistent with a locally persisted domain object.
2. Treat the domain object as a peer with all other domain objects for viewer generation and integration.
3. Integrate with standard OTB domain services such as audit service."
ISIS-754,Improvement,Closed,"BDD tests speed improvement with DN options, through a new IsisConfigurationForTests","as per mailing list thread...

http://isis.markmail.org/thread/5sg2flzyhpehvygu

and in particular

http://markmail.org/message/mtons6nr5kcdowjd



In fact, decided to name IsisConfigurationForJdoIntegTests, and put into the jdo objectstore, because this is all about setting up JDO/DN-specific properties.
"
ISIS-753,Improvement,Closed,Add EventBusService into archetypes' isis.properties file,
ISIS-752,Bug,Closed,"When collection is eagerly rendered (open), the title doesn't display the number of elements, instead just displays (+).",Workaround is to toggle the collection from hidden to visible list.
ISIS-751,Task,Closed,Update NOTICE copyright dates,
ISIS-750,Improvement,Closed,"For consistency with CommandJdo, allow the serializedForm to be stored as a clob (rather than as a zipped byte array)",
ISIS-749,Improvement,Closed,Make logging less noisy for selected classes,"1. AdapterManagerDefault#adapterFor(final TypedOid typedOid, final ConcurrencyChecking concurrencyChecking) {

change:
LOG.info(""updating version in oid, on "" + originalOid + "" ("" + originalVersion + "") to ("" + recreatedVersion +"")"");
to LOG.debug

2. ResourceServlet # resourceFor

BUT FOR NOW, leave these (which are quite noisy) as is:
3. PersistenceQueryFindUsingApplibQueryProcessor - is listing the parameters/arguments
4. PersistenceQueryFindAllInstancesProcessor - is listing the parameters/arguments
"
ISIS-748,Improvement,Closed,"Improve the way we setup logging to vary between prod and test, and independent of viewer.","There is very similar code in both IsisWebAppBootstrapper and the IsisWicketApplication, using IsisLoggingConfigurer.  This should be factored out into something reusable by both, as a context initlaizer (global webapp scope).

Then, in both cases let the logging.properties be picked up from some other directory outside of WEB-INF.

~~~
UPDATE: it seems that specifying log4j.configuration seems to override this already???

/usr/lib/jvm/java-7-openjdk-amd64/bin/java -Djava.util.logging.config.file=/var/lib/tomcat7/conf/logging.properties -Djava.awt.headless=true -Dfile.encoding=UTF-8 -server -Xms128m -Xmx768m -XX:PermSize=64m -XX:MaxPermSize=256m -XX:+DisableExplicitGC -Dlog4j.configuration=/etc/tomcat7/estatio/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.endorsed.dirs=/usr/share/tomcat7/endorsed -classpath /usr/share/tomcat7/bin/bootstrap.jar:/usr/share/tomcat7/bin/tomcat-juli.jar -Dcatalina.base=/var/lib/tomcat7 -Dcatalina.home=/usr/share/tomcat7 -Djava.io.tmpdir=/tmp/tomcat7-tomcat7-tmp org.apache.catalina.startup.Bootstrap start

"
ISIS-747,Bug,Closed,Quickstart and simple apps have wicket deployment type as context-params instead of init-params,
ISIS-746,Bug,Closed,"When multiple realms configured for Shiro, should be more intelligent about obtaining roles from those realms","We currently attempt to obtain roles for realms that did *not* authenticate the token.

Ideally, should only ask for roles from the realms that authenticated the token.

As a workaround, should (as currently) query all realms but then catch and ignore any exceptions thrown by those realms that did not authenticate the token.

"
ISIS-745,Improvement,Closed,"Do not suppress the org.apache.isis classes from the ""download metamodel"" action (as provided by DeveloperUtilities service)","Probably ok to still filter out the java.* and org.joda.*, though."
ISIS-744,Bug,Closed,Column size can't be greater than 8000 characters on SQL Server,"For the CommandJdo.exception property.

Solution is to map the string using JDO as a jdbc_type of ""CLOB"" (mapped to text datatype in SQL Server).
"
ISIS-743,Wish,Closed,Remove the concept of transient objects and of @NotPersistable; instead we have view models.,For discussion; but think that view models supercede our earlier ideas of transient objects etc.
ISIS-742,Wish,Closed,"For GSOC, develop an integration with zapier or ittt, for app automation.","Don't think this is a full summer's work, though.

[4] https://zapier.com
[5] http://ittt.com
"
ISIS-741,Wish,Closed,"[WON'T FIX] For GSOC, write an integration with Twilio or similar, for voice calls, SMS messaging, etc.","Don't think this is a full summer's work, though.

https://www.twilio.com"
ISIS-740,Wish,Closed,"For GSOC, to write a clean-room implementation of a JDO enhancer, as a replacement for the DN one, and that ideally integrates with the JRebel plugin","not really Isis-specific (actually is more relevant to http://db.apache.org/jdo/), but would definitely benefit the Isis community."
ISIS-739,Wish,Closed,"For GSOC, to develop an oAuth integration",probably not a full summer's work though (even though I'm not exactly sure what an oAuth integration actually is)
ISIS-738,Wish,Closed,Add-on module to integrate with Drools (or similar) rules engine.,
ISIS-737,Wish,Closed,"For GSOC, develop screencasts for all the various features that we have",cos people would rather watch youtube than read
ISIS-736,Wish,Closed,"For GSOC, - build a ""real-life"" app in some suitable domain, along with a semi-academic write-up of their learnings","- to would give us another substantial example app, along with some marketing material about how learnable Isis"
ISIS-735,Improvement,Closed,Fix for todo app (and quickstart archetype); ToDoItem#notYetCompleted action should return null if invoked as bulk action.,... same as for ToDoItem#completed() action.
ISIS-734,Improvement,Closed,"In Wicket viewer, if action returns a blob/clob, then currently performing in a new window/tab.","The open-in-new-tab behavior should only be for actions that return URLs, not for actions that return blob/clobs."
ISIS-733,Bug,Closed,"If toggle an object twice in standalone list (for bulk action), ends up invoking action (when shouldn't) and also throwing concurrency exception","Problem tracked down to the way in which the Wicket viewer attempts to detect that an object has already been toggled, ultimately relying on the toString of the oidStr, which includes the Version's timestamp.

The underlying problem is that, for each interaction, the JDO objectstore simply new's up a new Date() for the timestamp, rather than leaving as null.

The net effect is that the check for existence of a toggled object in the Wicket viewer fails.

Fix is for the JDO objectstore to leave the Version's timestamp as null."
ISIS-732,Improvement,Closed,The refresh of a standalone collection after invoking a bulk action should only be done if the original action was safe (query only),"That is, shouldn't re-invoke a non-idempotent action, and probably is dubious to re-invoke an idempotent action."
ISIS-731,Bug,Closed,Bulk actions broken... the logic to re-execute the action fails,"ISIS-718 seems to be the culprit; we clear the action model's arguments for an action panel because it may get reused, however this same action model is cached by the collection model of an action that returns a standalone collection, and re-executed after the bulk action is performed.  This results in a NPE, because those arguments were cleared.

The fix (a fix) is for the collection panel to clone the action model.

This issue discovered during voting for 1.4.0; rather than pull that vote, suggest we fix in a patch release 1.4.1

"
ISIS-730,New Feature,Closed,"Provide a very simple ClockService, so all services accessed in same way via DI",
ISIS-729,New Feature,Closed,"Provide facet factory to treat all actions by default as commands, unless explicitly opted out","Opting out through:  @Command(disabled=false)

Also:
- can restrict to just non-safe (non-query only actions)
- if the CommandFacet is already present, then that should take precedence
- any implementation of HasTransactionId (command, audit entry or published event) should *never* have auditing automatically enabled.
- require ActionSemanticsFacet to be available in case specified non-query only actions should be ignored

Enable using isis.properties:

#isis.services.command.actions=all|none|ignoreQueryOnly
"
ISIS-728,New Feature,Closed,"Provide facet factory to enable auditing by default on all objects, unless explicitly opted out","Opting out through:  @Auditable(disabled=false)

Also:
- if the AuditableFacet is already present, then that should take precedence
- any implementation of HasTransactionId (command, audit entry or published event) should *never* have auditing automatically enabled.

Enable using isis.properties:

#isis.services.audit.objects=all|none
"
ISIS-727,New Feature,Closed,"Enhance standalone tables so that renders according to runtime type, not compile-time type","For example, this means can return an action returning simply List<Object>, but if all objects are of the same type, then will show all the properites of that type.

In fact, will search for the lowest common superclass and use that.

This is an enabling feature for ISIS-726."
ISIS-726,New Feature,Closed,Provide a 'Recent changes' contributed action that provides a unified view of commands and audit entries for domain objects.,
ISIS-725,New Feature,Closed,"For 2.0.0, should we remove the ProfileStore?","The Wicket and RO viewers do not use the ProfileStore, only the (unreleased and perhaps to be mothballed DnD and Scimpi viewers, see ISIS-720).

Also, we now have a new pattern for applib services, and the functionality of the profile store (if required at all) should be reworked into one of these services.  (NB: we already have the applib UserSettings service, which might suffice for many reqts).
"
ISIS-724,New Feature,Closed,[WON'T FIX] Support HTML file format as a way of specifying dynamic layout facets (similar to .layout.json files currently),"The HTML could have some supporting CSS so that the layout file when viewed in a browser, would also provide some sort of indication as to the rendered UI."
ISIS-723,Improvement,Closed,BookmarkService should support lookup of domain services as well as domain entities (and throw an exception for view models),This enables background command service to schedule background commands to execute against services (rather than just entities).
ISIS-722,Question,Closed,"[DUPLICATE] For 2.0.0, should we get rid of the identity map, and simply ""new up"" PojoAdapters around pojos as-and-when?","If we did this, then the next obvious improvement would be to use a javassist to proxy every pojo, so that the pojo itself could provide its own (single-use) PojoAadapter."
ISIS-721,Question,Closed,"For 2.0.0, should we remove the ObjectStore API and standardize on the JDO Objectstore","Note that the DN ObjectStore itself defines a Store Manager API [1], so - if there were a need - it would still be possible for other arbitary datastores to be supported.

Doing this provide opportunities to substantially simplify Isis' internals (eg ISIS-534)






[1] http://www.datanucleus.org/extensions/store_manager.html"
ISIS-720,Question,Closed,"Should we mothball all currently unreleased components? (dnd viewer, scimpi viewer, nosql os, xml os)","These haven't been worked on for over 3 years now (either in incubation or after graduating).

Mothballing means that these would still reside in the git repo, but would not be updated/refactored on an ongoing basis, and resurrecting them would take more work (perhaps substantially more)."
ISIS-719,Improvement,Closed,Use org.webjars for some common dependencies (eg jquery),
ISIS-718,Improvement,Closed,Actions that return a URL should open in new tab/window,"Rather than redirect server-side, instead attach some Javascript to the Ajax target and have the browser do the redirect instead

See http://stackoverflow.com/questions/4907843/open-a-url-in-a-new-tab-using-javascript "
ISIS-717,Improvement,Closed,"[WON'T FIX] Simplify Facet API, get rid of isNoop concept",
ISIS-716,Dependency upgrade,Closed,Update to DN 3.3.8 (deferred),
ISIS-715,Dependency upgrade,Closed,Update to Wicket 6.13.0,
ISIS-714,New Feature,Closed,"Blob/Clob mapping under DataNucleus is broken (just default serialize, not picking up the extension points)","Perhaps this was always broken, but have noticed that Blobs and Clobs are being persisted just by virtue of being Serializable... the IsisBlobMapping and IsisBlobConverter etc don't seem to be being picked up."
ISIS-713,New Feature,Closed,Handle page expiry when occurs in an ajax query.,"This is a theoretical issue rather than one we are encountering much, but nevertheless...

.. issue as documented in https://issues.apache.org/jira/browse/WICKET-3081, and perhaps the suggested solution also.
"
ISIS-712,Bug,Closed,Inconsistency in domain logic for validation of optional strings causes Wicket viewer to trip up.,"First, to explain the issue.  We have the following code:

    private String turnoverRentRule;
    @javax.jdo.annotations.Column(allowsNull = ""true"", length = 254)
    @Optional
    public String getTurnoverRentRule() { ... }
    public void setTurnoverRentRule(final String turnoverRentRule) { ... }
    public String validateTurnoverRentRule(final String rule) {
        if (rule == null || rule.trim().length() == 0) {
            return ""Rule cannot be empty"";
        }
        return rule.equals(""INVALID"")? ""invalid rule!"": null;
    }

This code is logically inconsistent: the validateXxx() method suggests that the turnoverRentRule is required, yet the @Column(allowsNull=""true"") (and also the @Optional, though that is redundant) suggest the opposite.

In the Wicket viewer, what I'm seeing when the field is left empty, is that Wicket's form#validate phase skips over and does not call the validate.  This is because the validator that is installed by StringPanel's TextField implements IValidator but not INullAcceptingValidator, and Wicket does not check nulls on simple IValidators.

I think the above is correct and shouldn't change.

However, in the Wicket viewer, I then also go on in the form#submit phase to run the validation again, this time using Isis' infrastructure (see the stack trace below).  This (redundantly) validates each property again, but (not redundantly) also performs any object-level checking, as per the any validate() method on the object. 

The above is also ok.

Here's where the issues are:

1. with the above faulty domain object code, what we see is that the validateXxx() method does get called (by Isis) in the submit phase, even though it wasn't called (by Wicket) in the validate phase.  This results in the ""Rule cannot be empty"" message being returned.  However, the handling in EntityPropertiesForm#okButton#onSubmit that then detects this change accidentally switches the form to view mode.  It should stay in edit mode.

2. the Isis PropertyValidateFacet ought to honour the @Optional semantic; if the proposed value is null, and the facet holder is not mandatory, then the validation should be skipped.

This ticket is to fix both of these issues.

Thread [1934620956@qtp-1127736517-7] (Suspended (breakpoint at line 194 in ToDoItem))	
	ToDoItem.validateTurnoverRentRule() line: 194	
	GeneratedMethodAccessor127.invoke(Object, Object[]) line: not available	
	DelegatingMethodAccessorImpl.invoke(Object, Object[]) line: 43	
	Method.invoke(Object, Object...) line: 606	
	uV.invoke(Method, Object, Object[]) line: 1078	
	Method.invoke(Object, Object...) line: 592	
	MethodExtensions.invoke(Method, Object, Object[]) line: 50	
	AdapterInvokeUtils.invoke(Method, ObjectAdapter, Object) line: 48	
	AdapterInvokeUtils.invoke(Method, ObjectAdapter, ObjectAdapter) line: 52	
	PropertyValidateFacetViaMethod.invalidReason(ObjectAdapter, ObjectAdapter) line: 61	
	PropertyValidateFacetViaMethod(PropertyValidateFacetAbstract).invalidates(ValidityContext<ValidityEvent>) line: 55	
	InteractionUtils.isValidResult(FacetHolder, ValidityContext<?>) line: 69	
	OneToOneAssociationImpl.isAssociationValidResult(ObjectAdapter, ObjectAdapter) line: 110	
	OneToOneAssociationImpl.isAssociationValid(ObjectAdapter, ObjectAdapter) line: 105	
	ObjectValidPropertiesFacetImpl.invalidReason(ObjectValidityContext) line: 58	
	ObjectValidPropertiesFacetImpl(ObjectValidPropertiesFacetAbstract).invalidates(ValidityContext<ValidityEvent>) line: 45	
	InteractionUtils.isValidResult(FacetHolder, ValidityContext<?>) line: 69	
	ObjectSpecificationDefault(ObjectSpecificationAbstract).isValidResult(ObjectAdapter) line: 1050	
	ObjectSpecificationDefault(ObjectSpecificationAbstract).isValid(ObjectAdapter) line: 1040	
	EntityModel.getReasonInvalidIfAny() line: 572	
	EntityPropertiesForm$2.onSubmit() line: 377	
	EntityPropertiesForm(Form).delegateSubmit(IFormSubmitter) line: 1253	
	EntityPropertiesForm(Form).process(IFormSubmitter) line: 925	
	EntityPropertiesForm(FormAbstract).process(IFormSubmitter) line: 118	
	EntityPropertiesForm(Form).onFormSubmitted(IFormSubmitter) line: 771	
	EntityPropertiesForm(Form).onFormSubmitted() line: 704	
	GeneratedMethodAccessor163.invoke(Object, Object[]) line: not available	
	DelegatingMethodAccessorImpl.invoke(Object, Object[]) line: 43	
	Method.invoke(Object, Object...) line: 606	
	RequestListenerInterface.internalInvoke(Component, Object) line: 258	
	RequestListenerInterface.invoke(IRequestableComponent) line: 216	
	ListenerInterfaceRequestHandler.invokeListener() line: 240	
	ListenerInterfaceRequestHandler.respond(IRequestCycle) line: 226	
	RequestCycle$HandlerExecutor.respond(IRequestHandler) line: 861	
	RequestCycle$HandlerExecutor(RequestHandlerStack).execute(IRequestHandler) line: 64	
	RequestCycle.execute(IRequestHandler) line: 261	
	RequestCycle.processRequest() line: 218	
	RequestCycle.processRequestAndDetach() line: 289	
	WicketFilter.processRequestCycle(RequestCycle, WebResponse, HttpServletRequest, HttpServletResponse, FilterChain) line: 259	
	WicketFilter.processRequest(ServletRequest, ServletResponse, FilterChain) line: 201	
	WicketFilter.doFilter(ServletRequest, ServletResponse, FilterChain) line: 282	
	ServletHandler$CachedChain.doFilter(ServletRequest, ServletResponse) line: 1212	
	ShiroFilter(AbstractShiroFilter).executeChain(ServletRequest, ServletResponse, FilterChain) line: 449	
	AbstractShiroFilter$1.call() line: 365	
	SubjectCallable.doCall(Callable<V>) line: 90	
	SubjectCallable.call() line: 83	
	WebDelegatingSubject(DelegatingSubject).execute(Callable<V>) line: 383	
	ShiroFilter(AbstractShiroFilter).doFilterInternal(ServletRequest, ServletResponse, FilterChain) line: 362	
	ShiroFilter(OncePerRequestFilter).doFilter(ServletRequest, ServletResponse, FilterChain) line: 125	
	ServletHandler$CachedChain.doFilter(ServletRequest, ServletResponse) line: 1212	
	ServletHandler.handle(String, HttpServletRequest, HttpServletResponse, int) line: 399	
	SecurityHandler.handle(String, HttpServletRequest, HttpServletResponse, int) line: 216	
	SessionHandler.handle(String, HttpServletRequest, HttpServletResponse, int) line: 182	
	WebAppContext(ContextHandler).__handle(String, HttpServletRequest, HttpServletResponse, int) line: 766	
	WebAppContext(ContextHandler).handle(String, HttpServletRequest, HttpServletResponse, int) line: not available	
	WebAppContext.handle(String, HttpServletRequest, HttpServletResponse, int) line: 450	
	Server(HandlerWrapper).handle(String, HttpServletRequest, HttpServletResponse, int) line: 152	
	Server.handle(HttpConnection) line: 326	
	HttpConnection.handleRequest() line: 542	
	HttpConnection$RequestHandler.content(Buffer) line: 945	
	HttpParser.parseNext() line: 756	
	HttpParser.parseAvailable() line: 212	
	HttpConnection.handle() line: 404	
	SocketConnector$Connection.run() line: 228	
	QueuedThreadPool$PoolThread.run() line: 582	
"
ISIS-711,Bug,Closed,Fix so that can raiseError in bulk actions.,
ISIS-710,New Feature,Closed,Enhance contributed actions to support hide/disable/validate,
ISIS-709,New Feature,Closed,Support multi-select for the drop-down box,"See also ISIS-785 (substantial overlap).

~~~~~~~
ISIS-778 (now implemented) is a prereq to this.  (NB: ISIS-764 is a duplicate of ISIS-778).

"
ISIS-708,Improvement,Closed,BookmarkService null handling,"lookup(Bookmark) ... 
- if not found, then return null (rather than throw exception)

bookmarkFor(Object)
- if pass in null, then simply return null

"
ISIS-707,Bug,Closed,Support Bulk.InteractionContext with contributed actions.,"Currently the ActionInvocationFacetViaMethod looks for the bulk facet and initializes the Bulk.InteractionContext request-scoped service for ""regular"" invokedAs if not present.

For contributed actions, this is too late in the day; the result is that the target domain object shows up as the contributing service, not the contributee.

This ticket is to do equivalent setup in the ObjectActionContributee."
ISIS-706,Improvement,Closed,"Blob vs Clob request handling, also relationship with bulk actions.",
ISIS-705,Improvement,Closed,Support actions accepting parameters that return Blobs/Clobs,"The issue here is that the returned Blob/Clob must be handled with a scheduled handler (see ActionResultResponseHandlingStrategy class) but it is also necessary to refresh the page by redirecting to a new page.  (In the case of an action accepting parameters, want to remove the dialog.  
"
ISIS-704,New Feature,Closed,"In Wicket viewer, get rid of edit button/edit mode, and instead allow user to change editable fields one at a time, by clicking on that field.","In other words, similar to the way in which JIRA works."
ISIS-703,New Feature,Closed,Provide a switch in the Wicket viewer to make the positioning of a fields label either to the left or above the field.,"Similar to ISIS-702, but whereas that relates to fine-tuning individual fields, this ticket is about providing a global ""default"".


(have asked Martin for his opinion on whether this makes sense to roll into ISIS-537)."
ISIS-702,New Feature,Closed,Provide new annotation/facet as a hint for the layout of the label for a property.,"Currently the Wicket viewer always puts the label to the left.  But an alternative is to put the label above the field.  This might make sense for ""large"" textAreas, eg for @Multiline fields."
ISIS-701,New Feature,Closed,"In Wicket viewer, make uppercase text switchable","at the moment, the CSS uses text-transform: uppercase.  But experiments show that using regular casing might make for a better UI.

This ticket is to allow the text-transform part of the CSS to be switchable somehow.

The workaround in the meantime is to override the CSS in the application-specific CSS."
ISIS-700,Bug,Closed,Bug in memento service - strings with double spaces get converted into single space  :-(,Thanks to the memento service using DOM4J's pretty printing.
ISIS-699,Improvement,Closed,"In Wicket viewer, when redirect to next page after invoking an action, have the browser's address bar show the URL of the object","At the moment, it shows a URL in the form...

http://localhost:8080/wicket/wicket/page?11

rather than

http://localhost:8080/wicket/entity/TODO:L_1

say"
ISIS-698,Improvement,Closed,Allow JDOQL to be able to select scalars (eg project individual field(s)) rather than entire entities.,"a typical (currently supported) query is:

    @javax.jdo.annotations.Query(
          name = ""findByPropertyAndType"", language = ""JDOQL"",
          value = ""SELECT ""
                        + ""FROM org.estatio.dom.lease.LeaseTerm ""
                        + ""WHERE leaseItem.type == :leaseItemType ""
                        + ""   && leaseItem.lease.occupancies.contains(lu) ""
                        + ""   && (lu.unit.property == :property) "" 
                        + ""VARIABLES org.estatio.dom.lease.Occupancy lu""),

this ticket is to support queries of the form (note the ""SELECT startDate""):

    @javax.jdo.annotations.Query(
            name = ""findStartDatesByPropertyAndType"", language = ""JDOQL"",
            value = ""SELECT startDate ""
                        + ""FROM org.estatio.dom.lease.LeaseTerm ""
                        + ""WHERE leaseItem.type == :leaseItemType ""
                        + ""   && leaseItem.lease.occupancies.contains(lu) ""
                        + ""   && (lu.unit.property == :property) "" 
                        + ""VARIABLES org.estatio.dom.lease.Occupancy lu"")"
ISIS-697,New Feature,Closed,Extend DeveloperUtilitiesService to be able to refresh services (for contributed actions),"In addition, the ""refreshLayout"" is redundant because (in prototype mode and for the wicket viewer, at least), this is performed automatically when the object is rendered."
ISIS-696,New Feature,Closed,Extra overload for BookmarkService for lookup with downcast (making more consistent with API of MementoService).,"MementoService provides accessor methods in the form:

<T> T MementoService#get(String,Class<T>)

where the Class<T> is used to check the type of the accessed value within the memento, and to downcast appropriately.

In BookmarkService, the lookup method is simply:

Object BookmarkService#lookup(Bookmark)

Instead, suggest:

<T> T BookmarkService#lookup(Bookmark, Class<T>)"
ISIS-695,Task,Closed,Tidy-up tasks for Isis 1.4.0 release,
ISIS-694,Task,Closed,"Mothball the old docbkx stuff, we are now exclusively using the CMS.","Move all the src/docbkx folders to a new mothballed/docbkx directory;
maintain the hierarchy."
ISIS-693,Improvement,Closed,Minor extensions in support of Excel import/export functionality.,"Specifically:
* RuntimeContext#bookmarkFor(Class,String)
* ViewModelFacet#memento(Object)

The export/import functionality itself has been implemented outside of Apache, at https://github.com/danhaywood/isis-domainservice-excel
"
ISIS-692,Improvement,Closed,Prevent/reduce flicker on pages with drop-down list box.,"The select2 field uses javascript to dynamically create a <div>; when this is created the other elements on the page have to reflow.

This improvement is to use a wrapping <div> placeholder that is fixed to the same size as the div that gets added, thereby preventing the reflow.

~~~
It's possible (not tested) that this might also prevent the appearance of scrollbars on large action dialogs."
ISIS-691,Bug,Closed,"In Wicket viewer, improve drop-down list's handling of null entity or values","Several issues:
1.  for entities, if the reference is null, the drop-down (EntityLinkSelect2Panel) always shows the first object in edit mode
2.  for value types (eg enums), it is not possible to set a null value (!)

~~~
To replicate (1) add the following property to the simple archetype's SimpleObject class:

    // //////////////////////////////////////
    // other (property)
    // //////////////////////////////////////

    private SimpleObject other;

    @Column(allowsNull=""true"")
    @MemberOrder(sequence = ""1"")
    // @Mandatory
    public SimpleObject getOther() {
        return other;
    }

    public void setOther(final SimpleObject other) {
        this.other = other;
    }

    public List<SimpleObject> choicesOther() {
        List<SimpleObject> list = container.allInstances(SimpleObject.class);
        return list;
    }

~~~
To replicate (2), 

ToDoItem

    @javax.jdo.annotations.Column(allowsNull=""true"")
    public Subcategory getSubcategory() {


and 

ToDoItemContributions

    public ToDoItem updateCategory(
            final ToDoItem item, 
            final @Named(""Category"") Category category,
            final @Optional @Named(""Subcategory"") Subcategory subcategory) {
        ...
    }

and

    public static enum Category {
        Professional {
            @Override
            public List<Subcategory> subcategories() {
                return Arrays.asList(null, Subcategory.OpenSource, Subcategory.Consulting, Subcategory.Education);
            }
        }, Domestic {
            @Override
            public List<Subcategory> subcategories() {
                return Arrays.asList(null, Subcategory.Shopping, Subcategory.Housework, Subcategory.Garden, Subcategory.Chores);
            }
        }, Other {
            @Override
            public List<Subcategory> subcategories() {
                return Arrays.asList(null, Subcategory.Other);
            }
        };
        
        public abstract List<Subcategory> subcategories();
    }
"
ISIS-690,New Feature,Closed,'Show all' button for tables.,
ISIS-689,New Feature,Closed,[WON'T FIX] Bulk action take arguments,see instead ISIS-1585 ... bulk actions deprecated
ISIS-688,Improvement,Closed,Make it possible to configure the Wicket timeout for Ajax calls.,"Currently, for a long-running operation, we see that Wicket hits some sort of timeout on the Ajax call.  This results in the animated ""waiting"" veil/overlay being removed, and the action dialog still being presented to the user.  This is confusing; the user doesn't get any hint as to whether the action has succeeded, failed, or (as is actually the case) is still running.

This ticket is to handle such calls better, somehow, at least from a UI perspective."
ISIS-687,Bug,Closed,@AutoComplete annotation on repository does not seem to honour @MinLength,
ISIS-686,Bug,Closed,Logout as admin doesn't work (could be if on any machine other than localhost?),"This might require extending Isis' Security API, for which there is already a JIRA ticket raised."
ISIS-685,New Feature,Closed,"Add new @Command(async=true|false) flag, so that Command is automatically scheduled to run in the background","Returns a background Command, has no parent user-initiated Command object."
ISIS-684,Improvement,Closed,"Rename ReifiableAction to simply 'Command', and update services also","renames:
- ReifiableAction -> Command
- ReifiableActionContext -> CommandContext
- BackgroundActionService -> BackgroundCommandService
- @Reified to @Command
"
ISIS-683,Improvement,Closed,"In Wicket viewer, if delete objects from a standalone collection, then selecting again causes an exception.","... would seem to be due to the EntityCollectionModel being stale.

To reproduce in Estatio:
1. create some invoices
2. list invoices
3. select all invoices (on current page)
4. bulk delete
   - the invoices are deleted
5. select all again
  - at this point, triggers exception (or it might be when do a further delete action)."
ISIS-682,Improvement,Closed,"In the Wicket viewer, the tooltip for icons should show the title (and perhaps also the type) of the icon being linked to.",
ISIS-681,Improvement,Closed,"In Wicket viewer, provide a larger clickable target for rows, by making a hyperlink out of any scalar field, ...","... and provide a tooltip as a hint so it's easy for the user to see what the link is to.

For columns which have a reference to some related object, the current behaviour should be unchanged."
ISIS-680,Improvement,Closed,"Provide an alternative (perhaps lower-fidelity) alternative to the clipboard link, for those environments where flash is not supported.","Following on from ISIS-679;
a possibility might be to have a hidden div that shows the URL of the current page."
ISIS-679,Improvement,Closed,"The Wicket viewer's clipboard functionality currently uses Flash.  This is not supported in some environments, so there should be the ability to disable/hide in the UI.",
ISIS-678,Improvement,Closed,"[WON'T FIX] When invoke action in Wicket viewer, prefer redirect-after-post to be to a deep link.",.. so that the user can easily copy the URL out of the browser address bar.
ISIS-677,Improvement,Closed,The blob/clob panel does not show the name of the blob/clob present (eg if just uploaded).,
ISIS-676,Bug,Closed,"In Wicket viewer for object with an editable drop-down of an object, if edit, then cancel, then edit, then the drop-down widget is no longer rendered.","This doesn't seem to be an issue with the value drop-down, only with EntityLinkSelect2Panel."
ISIS-675,Bug,Closed,"If try to upload attachment, then have to do the operation twice.","That is
- the file dialog is shown, choose file, hit OK
- the file dialog is shown AGAIN, this time choose file and hit OK and it is accepted."
ISIS-674,New Feature,Closed,[DUPLICATE] Allow action parameters to be defaulted based on the (change of) value of other parameters.,"For example:

public void foo(
   Charge charge,
   BigDecimal amount,
   String description) {
  
}
public String default2Foo(Charge charge, BigDecimal amount) {
    return charge != null && amount != null? amount + "" "" charge.getDescription() : null;
}

Here, the value of the 'description' parameter is defaulted from that of both the preceding 'charge' and 'amount' parameters.  Changing either should cause the default value for the 'description' to be recomputed.

This is analogous to the way that choices are recomputed for category/subcategory, see ActionParametersFormPanel:

        @Override
        public void onUpdate(AjaxRequestTarget target, ScalarModelProvider provider) {

            final ActionModel actionModel = getActionModel();
            final ObjectAdapter[] pendingArguments = actionModel.getArgumentsAsArray();
            try {
                final ObjectAction action = actionModel.getActionMemento().getAction();
                final int numParams = action.getParameterCount();
                for (int i = 0; i < numParams; i++) {
                    final ScalarPanelAbstract paramPanel = paramPanels.get(i);
                    if(paramPanel != null) {
                        // this could throw a ConcurrencyException as we may have to reload the 
                        // object adapter of the action in order to compute the choices
                        // (and that object adapter might have changed)
                        if(paramPanel.updateChoices(pendingArguments)) {                                      <<<<<< THIS LOOKS SIMILAR TO WHAT NEEDS TO BE DONE...
                            target.add(paramPanel);
                        }
                    }
                }
            } catch(ConcurrencyException ex) {
"
ISIS-673,New Feature,Closed,AbstractIsisSessionTemplate as a way to run arbitrary 'runnable' in an Isis session,"Useful for batch jobs and scheduled (eg Quartz) jobs.

Naming inspired by Spring's JdbcTemplate etc."
ISIS-672,Improvement,Closed,"Unify BackgroundTask and Interaction into same entity, rename to ""ReifiableAction"".",
ISIS-671,Improvement,Closed,Add a ReifiableActionFacet and @Reifiable annotation as a way to restrict which ReifiableActions are persisted.  Enable background task service to hint that an ReifiableAction should be persisted even if not annotated.,NB: using the new terminology/names of ISIS-672.
ISIS-670,Improvement,Closed,"Replace AuditingService and AuditingService2 with new AuditingService3 API, more consistent with other APIs","Following on from ISIS-667, the other services (interaction, published now use UUID instead of string for transactoinId, java.sql.Timestamp instead of long for timestamps).

This ticket is to replace AuditingService2 with an equivalent AuditingService3 that uses these new types.

NB: this is a breakage of applib API, and according to semver, we ought to rev Isis to 2.0.  I don't think this is justified however; the refactor is very simple for anyone that has used this API, and revving to 2.0 seems to be overkill.  Better to address in the release notes for next 1.x release."
ISIS-669,Bug,Closed,Download of Excel files in Wicket viewer on *nix/OSx machines doesn't work.,File.createTempFile on mac.
ISIS-668,Improvement,Closed,"Improve parsing of isis.services key in the isis.properties file, to allow ""commented-out"" services.","It'd be nice to be able to comment out lines in the isis.services key, eg using #.  Also to support comments this way."
ISIS-667,Improvement,Closed,General tidy-up/rationalization of JDO domain service impls,"We now have six implementations of various applib domain services by JDO objectstore:
- auditing service
- publishing service
- background task service
- interaction service
- appsettings
- user settings

This ticket is to rationalize them (in particular the first four, that all share a common usage of transactionId)"
ISIS-666,New Feature,Closed,Provide the ablity to return (and render) a different object when an action is invoked.,"As per discussion in http://markmail.org/message/xhmeq62ywr2vqvje

for example, could return a collection of view models from Lucene service (ISIS-383), which would show the title of each as a property.  When click on to render, would instead automatically show the backing domain object.

Further discussion in Dec 2015, http://isis.markmail.org/thread/t3q6d5artdnxrmck

~~~
This ticket was originally raised as: ""provide redirect hints so that the viewer can navigate to some other entity than that returned.""  That is actually a different use case, relating to the request rather than the response.  It has been recreated as ISIS-1280.
"
ISIS-665,Improvement,Closed,ObjectActionImpl should escalate a thrown Isis ApplicationException to its underlying cause if the transaction is in a state of mustAbort.,"We hit a situation whereby a bug in the domain code was causing a JDOUserException to be thrown (missing a mandatory-field), but then throwing an org.apache.isis.applib.ApplicationException.  

This exception is only intended for non-fatal exceptions.  Isis therefore attempted to commit the transaction subsequently only to find it had already been aborted.

ObjectActionImpl should try to identify this programming error, and ""do the right thing"", which is probably to throw the ApplicationException's underlying cause (else a runtime exception if there is none).

NB: this ticket should also include adding some documentation to the website, since this is a pretty subtle issue."
ISIS-664,New Feature,Closed,"Provide an abstract class for running ""sudo"" scheduler jobs","To be used as the basis for Quartz scheduler jobs, say... but do not bring in a dependency on Quartz.

The main work here is in extending the security APIs to enable ""sudo"".  This will enable persisted BackgroundTaskJdo entities (from ISIS-661) to be run as the user that created them."
ISIS-663,New Feature,Closed,"Provide a ""contributions"" service for AuditEntry, so that audit entries are shown as a contributed collection to the Interaction entity.","Building on an idea in ISIS-661 and ISIS-662, whereby BackgroundTask and PublishedEvent will have a similar service. 

The idea is that viewing Interaction can show all this associated information (BackgroundTask, PublishedEvent, AuditEntry)."
ISIS-662,New Feature,Closed,"Provide a ""contributions"" service to add a PublishedEvents contributed collection for the Interaction entity.","Building on an idea in ISIS-661, whereby BackgroundTask will have a similar service. 

The idea is that viewing Interaction can show all this associated information (BackgroundTask, now also PublishedEvent)."
ISIS-661,New Feature,Closed,BackgroundService and BackgroundTaskService as a way of creating mementos to execute jobs asynchronously,"BackgroundService is the service that creates the mementos, with a default implementation in isis-core.

usage:

public void submitInvoices() {
     for(Customer customer: customerRepository.findCustomersToInvoice()) {
         backgroundService.execute(customer).submitInvoice();
     }
 }
 
 @javax.inject.Inject
 private BackgroundService backgroundService;


Here the service creates a javassist proxy through which it can figure out the arguments.  The MementoService and BookmarkService can be used to create the memento string (XML).

~~~~~~~~~~~~~
BackgroundTaskService is the service that persists the mementos, with a default implementation in objectstore-jdo.  Each persisted BackgroundTask should be associated with the transactionId of the Interaction (see ISIS-660).

~~~~
also:
- require separate ""contributions"" service to add in the BackgroundTask collection to the Interaction.

~~~~
NB: the docs should indicate that an alternative implementation for BackgroundTaskService could be webhooks.  Per Maurizio's comment:

a web hook is basically an HTTP callback
An example of web hook is available on the Google infrastructure, where task longer than 30 sec. are not allowed. 
This is similar to your idea of background service:

public void calculateInvoices() {
     for(Customer customer: customerRepository.findCustomersToInvoice()) {
         Queue queue = QueueFactory.getDefaultQueue();
         queue.add(withUrl(""/worker"").param(""id"", customer.getId()));     
     }
 }

Tasks added to the queue will execute by calling the request handler at the URL /worker with the parameter id at a given task rate.

https://developers.google.com/appengine/docs/java/taskqueue/overview-push "
ISIS-660,New Feature,Closed,Profiling support and also infrastructure for background (async job) support,"Two use cases envisaged:
1. profiling of the application
2. as a handle for long-running async calls.  Can envisage a contributed collection that would list long-running async calls associated with a persisted Interaction.

The request-scoped InteractionContext provides context information to the caller.  By default this is an in-memory representation, discarded once done.

The complementary InteractionFactory interface allows the instantiationof the Interaction to be delegated.  So the other part of this ticket is a JDO implementation allowing the Interactions to be persisted and thereby queried.

With this done, any action invocation will also be recorded as a persisted Interaction object.
"
ISIS-659,Improvement,Closed,Extend MementoServiceDefault service to handle Bookmarks and also enums (as well as simple values),"The caller is expected to use the BookmarkService (to convert an object's Oid into a Bookmark).
"
ISIS-658,Improvement,Closed,Provide a custom panel for java.sql.Timestamp,
ISIS-657,Improvement,Closed,"JDO objectstore service implemenations should use ""IsisXxx"" as a common prefix to any tables.","To reduce the risk of conflicts.  
Thus:
* AuditEntry table -> IsisAuditEntry
* PublishedEvent table -> IsisPublishedEvent
"
ISIS-656,New Feature,Closed,Roles not setup when using Shiro,"as per http://markmail.org/thread/3diasqoulbujpeom

The problem turns out to be a missing ""!"" in the ShiroAuthenticatorOrAuthorizor.

         final Collection<Realm> realms = securityManager.getRealms();
         for (final Realm realm : realms) {
-            if(realm.supports(token)) {
+            if(!realm.supports(token)) {
                 continue;
             }
             ...
         }

with this fix, and with shiro.ini as configured per [1] pointing at realms [2] and [3], then the following code:

for (RoleMemento rm:container.getUser().getRoles()) {
    LOG.info(""ROLE: ""+rm.getName());
}

for 'sven' logs:

21:46:10,279  [ToDoItem             2125139315@qtp-71626409-4 INFO ]  ROLE: realm1:admin_role
21:46:10,279  [ToDoItem             2125139315@qtp-71626409-4 INFO ]  ROLE: org.apache.isis.viewer.wicket.roles.USER


while for 'dick' logs:

21:51:07,062  [ToDoItem             503033028@qtp-71626409-0 INFO ]  ROLE: realm1:user_role
21:51:07,062  [ToDoItem             503033028@qtp-71626409-0 INFO ]  ROLE: realm1:self-install_role
21:51:07,062  [ToDoItem             503033028@qtp-71626409-0 INFO ]  ROLE: realm1:analysis_role
21:51:07,062  [ToDoItem             503033028@qtp-71626409-0 INFO ]  ROLE: org.apache.isis.viewer.wicket.roles.USER




[1] https://github.com/apache/isis/blob/ad16b962928715e343369b00d8a42cd12c9bd79b/example/application/quickstart_wicket_restful_jdo/webapp/src/main/webapp/WEB-INF/shiro.ini#L73
[2] https://github.com/apache/isis/blob/ad16b962928715e343369b00d8a42cd12c9bd79b/example/application/quickstart_wicket_restful_jdo/webapp/src/main/resources/webapp/realm1.ini
[3] https://github.com/apache/isis/blob/ad16b962928715e343369b00d8a42cd12c9bd79b/example/application/quickstart_wicket_restful_jdo/webapp/src/main/resources/webapp/realm2.ini"
ISIS-655,New Feature,Closed,"Deprecate Bulk.InteractionContext, instead use a new request-scoped Bulk.InteractionContextService bean.",The new request-scoped support in ISIS-652 is a better way to pass interaction context information about a bulk action to an object.
ISIS-654,New Feature,Closed,"Provide a request-scoped QueryResultsCache service, as a technique for performance tuning.","With Isis, the emphasis is on behaviourally complete domain objects.  However, this can result in ""naive"" algorithms whereby the same code is revisited mulitple times, eg in a tight loop  If that code makes repository queries, then a performance problem is likely to result.

This ticket exploits the request-scoping support introduced in ISIS-652, and provides a service that acts as a cache of query results.  This enables that inner code to look in the cache first."
ISIS-653,New Feature,Closed,"Provide a ""Scratchpad"" request-scoped service, as a way of passing arbitrary user data from one place to another.  One use case is to coordinate the response of bulk actions.","This builds on ISIS-652 (request scoped).  The Scratchpad service itself is basically a wrapper around Map, with signature:

get(Object key)
put(Object key, Object value)
clear(Object key)"
ISIS-652,New Feature,Closed,Support @RequestScoped beans (registered as services),"Java EE 6 defines the @RequestScoped annotation, whereby a bean injected into an object is scoped to the request, and is recreated for each new request/interaction.

This ticket is to allow Isis services (as registered in isis.properties under the isis.services key) to also be annotated with this annotation, and behave similarly.
"
ISIS-651,Improvement,Closed,Modifications to enable JRebel support,"Make JDO PersistenceManagerFactory accessible so can be interacted with outside of Isis runtime

Invalidate Isis spec cache by way of class (not just by object).

~~~
need to be able to do similar with the DN metadata:

http://www.datanucleus.org/servlet/jira/browse/NUCCORE-1104

Assuming that there's auto-enhancement within the IDE, this means that JRebel picks up each class twice: once for the unenhanced class, then almost immediately for the enhanced class.  Therefore, I think that all that may be required is to remove the ClassMetaData whenever an unenhanced class is reloaded DN's will lazily recreate metadata as required.

An enhancement might be to do the enhancement within the JRebel plugin (and not in the IDE).  This would require the enhancement is done in a separate classloader; it (obviously!) isn't allowed to reference the java.lang.Class being loaded within the plugin itself.  As enhancement does cause this to occur, it must be namespaced off to a separate classloader.

resources:
- http://www.datanucleus.org/servlet/wiki/pages/viewpage.action?pageId=6619188  (Metadata Generation, programmatic running of Enhancement)
- http://markmail.org/message/xn6fowrxqeucac26  (useful forum messages hinting on the classloader stuff)
- http://www.datanucleus.org/products/accessplatform/jpa/enhancer.html#api (background notes)
"
ISIS-650,Improvement,Closed,Nested Menu Support in Apache ISIS,"Apache ISIS to provide support for nested menus in case there are large number of domain objects.

Probably by parsing the @MemberOrder(name=""foo.bar"") or reading from layout.json.
"
ISIS-649,New Feature,Closed,"In wicket viewer, make it easier to develop custom styling by wrapping the body of all pages in a div with custom style","Rather than define a new property, simple use a sanitized version of the ""applicationName"" (as defined in IsisWicketApplication subclass).
"
ISIS-648,New Feature,Closed,Improve support for bulk update,"As originally described in http://markmail.org/message/7uqgptkwkspai276

~~~
The requirement is to be able to:
a) provide the ability for some actions to be bulk-only
b) provide a mechanism so that all objects selected to have a bulk action upon be able to interact with each other in the context of that action
    - for example, to pass information along
c) for the return type of a bulk action to be respected rather than ignore
    - because there are many such returns, only the value of the last one should be acted up

Tackling (a) first, that is an extension to the @Bulk annotation: @Bulk(BULK_AND_REGULAR) or @Bulk(BULK_ONLY)

For (b), enhance the existing @Bulk.InteractionContext class so that can put or get user data.

For (c), this is an enhancement to the Wicket viewer


~~~
As a worked example of how to use these capabilties: we want to be able to update a bunch of objects, which then add themselves to some sort of wizard.

public class ToDoItem {

    @Bulk(BULK_ONLY)
    public ToDoItemBulkChangeWizard bulkUpdate() {
        Bulk.InteractionContext ctxt = Bulk.InteractionContext.get();
        ToDoItemBulkChangeWizard wizard = (ToDoItemBulkChangeWizard)ctxt.getIserData(""wizard"");
        if(wizard == null) { 
            wizard = container.newViewModelInstance(ToDoItemBulkChangeWizard.class, new UUID().toString());
            ctxt.setUserData(""wizard"", wizard);
        }

        wizard.add(this);
        return wizard;       
    }

}


public class ToDoItemBulkChangeWizard extends AbstractViewModel {

    // viewModelInit() and viewModelMemento() omitted

    private List<ToDoItem> _items = Lists.newArrayList();
    public List<ToDoItem> getItems() { return _items; }

    @Programmatic
    public void add(ToDoItem item) { _items.add(item); }

    public ToDoItemBulkChangeWizard markAllAsCompleted() {
        for(ToDoItem item: _items) {
           item.complete();
        }
    }

    public ToDoItemBulkChangeWizard markAllAsNotYetCompleted() {
        for(ToDoItem item: _items) {
           item.notYetComplete();
        }
    }   
}


Note that the wizard above would need to serialize the _sites field somehow.  The BookmarkServiceDefault (serialize each object to its oid string) and the ViewModelSupportDefault class (serialize a bunch of strings to a single string) should allow you to do this.

"
ISIS-647,Dependency upgrade,Closed,Upgrade to DN 4.0.x (nb: prereq for JDK 8 support),"In implementing ISIS-646, we uncovered an issue with DN, raised as bug [1].  In Isis we've implemented the workaround (jdoQuery.addExtension(...)).

This ticket is to remove the workaround and upgrade to new version of DN when available.

[1] http://www.datanucleus.org/servlet/jira/browse/NUCCORE-1103
"
ISIS-646,Dependency upgrade,Closed,"Upgrade DataNucleus to 3.3.6 (JDO 3.1), and use the convenience 'accessplatform' POMs.","<datanucleus-accessplatform-jdo-rdbms.version>3.3.6</datanucleus-accessplatform-jdo-rdbms.version>
<datanucleus-jodatime.version>3.2.1</datanucleus-jodatime.version>
<datanucleus-maven-plugin.version>3.3.2</datanucleus-maven-plugin.version>

<dependency>
     <groupId>org.datanucleus</groupId>
     <artifactId>datanucleus-accessplatform-jdo-rdbms</artifactId>
     <version>${datanucleus-accessplatform-jdo-rdbms.version}</version>
     <type>pom</type>
</dependency>

<dependency>
     <groupId>org.datanucleus</groupId>
     <artifactId>datanucleus-jodatime</artifactId>
     <version>${datanucleus-jodatime.version}</version>
</dependency>

also (according to Andy Jefferson) from 3.3.1, the datanucleus-maven-plugin uses the current (scope=""provided"") version of datanucleus, which means we can remove the dependency exclusion hacks for that plugin:

<plugin>
    <groupId>org.datanucleus</groupId>
    <artifactId>datanucleus-maven-plugin</artifactId>
    <version>${datanucleus-maven-plugin.version}</version>
    <configuration>
        <fork>false</fork>
        <verbose>true</verbose>
     </configuration>
     <executions>
         <execution>
             <phase>compile</phase>
              <goals>
                  <goal>enhance</goal>
               </goals>
          </execution>
     </executions>
 </plugin>
"
ISIS-645,Test,Closed,Test not passing on latest Isis SNAPSHOT when executed with Spanish locale,"The following test is not passing when executed on a machine with a Spanish locale, breaking the Isis Maven build.

Tests in error: 
  test(org.apache.isis.applib.services.xmlsnapshot.XmlSnapshotServiceAbstractTest): Invalid format: ""01-Apr-2013"" is malformed at ""Apr-2013""

Tests run: 182, Failures: 0, Errors: 1, Skipped: 0



additional info:

Hi, Dan and Jeroen.

There's a test that it's not successfully executed on the latest ISIS snapshot. Seems there are problems related to user locale (my machine's locale is a Spanish one).

I've some some recent commits related to Joda.

The log message is at bottom of this message.

I've just created ISIS-645 for this.

HTH,

Oscar



-------------------------------------------------------------------------------
Test set: org.apache.isis.applib.services.xmlsnapshot.XmlSnapshotServiceAbstractTest
-------------------------------------------------------------------------------
Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 0.209 sec <<< FAILURE!
test(org.apache.isis.applib.services.xmlsnapshot.XmlSnapshotServiceAbstractTest)  Time elapsed: 0.208 sec  <<< ERROR!
java.lang.IllegalArgumentException: Invalid format: ""01-Apr-2013"" is malformed at ""Apr-2013""
        at org.joda.time.format.DateTimeFormatter.parseLocalDateTime(DateTimeFormatter.java:828)
        at org.joda.time.format.DateTimeFormatter.parseLocalDate(DateTimeFormatter.java:772)
        at org.apache.isis.applib.services.xmlsnapshot.XmlSnapshotServiceAbstract.getChildElementValue(XmlSnapshotServiceAbstract.java:75)
        at org.apache.isis.applib.services.xmlsnapshot.XmlSnapshotServiceAbstractTest.test(XmlSnapshotServiceAbstractTest.java:56)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
        at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
        at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
        at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
        at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
        at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:236)
        at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:134)
        at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:113)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
        at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
        at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
        at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:103)
        at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:74)
"
ISIS-644,Bug,Closed,"Update FrameworkSynchronizer to avoid the ""Object not yet known to Isis"" exception","Sometimes the Isis synchronizer has not yet picked up the domain entity and needs to be created.

It has been detected when using the @Persistent (""dependentElement=""true"") JDO annotation, such as in:

@PersistenceCapable
@Inheritance(strategy = InheritanceStrategy.NEW_TABLE)
public class TimeScale extends AbstractScale {

   // {{ TimeScaleLevels (Collection)
   @Persistent(mappedBy = ""timeScale"", dependentElement = ""true"")
   private SortedSet<PointInTime> timeScaleLevels = new TreeSet<PointInTime>();
   
   ...
}

The solution is simply to update the ensureRootObject method.
Replace the ""getAdapterManager().getAdapterFor(pojo)"" by ""getAdapterManager().adapterFor(pojo)"" as it will create the adapter if it's still not available to Isis."
ISIS-643,Bug,Closed,FrameworkSynchronizer throws NPE on delete of child entity in 1-N relationship,"Hello,

Scenario is:
There is 1-N relationship between MOrganisation and OmOrgExtendedAttr entities. MOrganisation is parent entity and OmOrgExtendedAttr  is child entity.

OmOrgExtendedAttr cannot exist without MOrganisation.
MOrganisation can exist without OmOrgExtendedAttr 

So on delete of MOrganisation, OmOrgExtendedAttr  is also deleted. There is no problem in this case.

But problem is on delete of OmOrgExtendedAttr . The error that is coming is NullPointerException in FrameworkSynchronizer of isis-objectstore-jdo-datanucleous component for adpater for the POJO.


Please find attached log and also the java files

Could you please help on this issue ASAP.

Thanks
Ranganath



"
ISIS-642,New Feature,Closed,"Provide breadcrumb drop-down; when revisiting a page, any UI hints from last visit should be retained.",Building on ISIS-638.
ISIS-641,Bug,Closed,Incompatibility of TreeSet for @Bulk. ,"Incompatibility of TreeSet for @Bulk.
ActionPanel assumes that standalone lists are of type of type java.util.List.
 Trying to do a bulk delete operation on a treeset of an entity throws an class cast exception

java.util.TreeSet cannot be cast to java.util.List
org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel$ResultType#asList(ActionPanel.java:460)
org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel$ResultType#determineFor(ActionPanel.java:446)
org.apache.is
"
ISIS-640,Improvement,Closed,Extend MementoService.Memento API so that can also return the set of keys held in the Memento,"(Originally for ISIS-638, though subsequently not used by that code).  Left in as a useful extension to the API, however."
ISIS-639,Improvement,Closed,Jetty webserver support long URLs,"The Jetty webserver that we bundle for development limits the URL length.   This is a potential issue for longer URLs (eg as per ISIS-638).

Extend to at least 8,192 bytes."
ISIS-638,New Feature,Closed,"Provide the capability to capture UI hints, and copy to clipboard","The idea being that a user, having selected a certain views, or page numbers, or sorting, can then grab the URL of that object, eg to send in an email to a colleague."
ISIS-637,Bug,Closed,StalePage exceptions ... when omitting mandatory entity drop-down in action prompt ,"This can be reproduced in Estatio.   Make sure to uncomment the InvoiceService#validateCalculateInvoiceForProperty method.


# install the demo fixtures (Administration>install demo fixtures)

then:

# Invoices > calculate invoices for property
# leave the first drop-down (for property) deliberately empty 
# Hit OK.

Get no error message, though the Wicket ajax box flashes red indicating somethings wrong.

Now enter a valid property in the drop-down, 

... triggers stale page exception.

Alternatively you can also enter a period end date which lies before a period start date."
ISIS-636,Bug,Closed,BookmarkServiceDefault throws NPE if the BookmarkHolder (to which it contributes a property) returns a null Bookmark,Just requires a guard.
ISIS-635,Bug,Closed,JDO Publishing Service impl causes ConcurrentModificationException in core.,"Basically broken, because the jdo PublishedEvent object is itself enlisted in the still-in-progress transaction, and this causes a ConcurrentModificationException in IsisTransaction."
ISIS-634,Improvement,Closed,Drop-downs (for enums/bounded and autocomplete) should honour TypicalLengthFacet.,"... and in the case of enums, should dynamically calculate the typical length as being the max length of all enum values."
ISIS-633,New Feature,Closed,Press ESC to close/cancel the action prompt dialog,a nice bit of candyfloss.
ISIS-632,Bug,Closed,PublishingService's PublishedEvent id has an incorrect max length,"As reported by Bilgin Ibryam...  stack trace below.

Attempt to store value ""bec9ff8b-c903-4efd-a834-18ba918d8e6b.0"" in column """"id"""" that has maximum length of 32. Please correct your data!

This is the PublishedEvent class; which is initialized with:

publishedEvent.setId(metadata.getId());

where metadata is EventMetadata

    /**
     * Returns a string that concatenates the {@link #getTransactionId()} and the
     * {@link #getSequence()} with a period (<tt>.</tt>).
     */
    public String getId() {
        return getTransactionId() + ""."" + getSequence();
    }

and

    /**
     * Isis' identifier of the transaction within which this event
     * originated.
     * 
     * <p>
     * Note that there could be several events all with the same transaction Id.
     */
    public UUID getTransactionId() {
        return transactionId;
    }

and 

    /**
     * The zero-based sequence number of this event within the transaction.
     * 
     * <p>
     * The combination of {@link #getTransactionId() transaction Id} and {@link #getSequence() sequence}
     * is guaranteed to be unique.
     */
    public int getSequence() {
        return sequence;
    }

~~~~~

A UUID.toString is something like ""067e6162-3b6f-4ae2-a171-2470b63dff00"" (36 chars).  It corresponds to the transaction Id of Isis.

A sequence is incremented for each published object in a transaction.  This is an int, the maximum value of which is 10 digits.  

Therefore the length should be 36 + 1 + 10 = 47 chars.


~~~~~~~~~~~~~
original stacktrace:

javax.jdo.JDOFatalUserException
Attempt to store value ""bec9ff8b-c903-4efd-a834-18ba918d8e6b.0"" in column """"id"""" that has maximum length of 32. Please correct your data!
org.datanucleus.api.jdo.NucleusJDOHelper#getJDOExceptionForNucleusException(NucleusJDOHelper.java:528)
org.datanucleus.api.jdo.JDOPersistenceManager#jdoMakePersistent(JDOPersistenceManager.java:732)
org.datanucleus.api.jdo.JDOPersistenceManager#makePersistent(JDOPersistenceManager.java:752)
org.apache.isis.objectstore.jdo.datanucleus.persistence.commands.DataNucleusCreateObjectCommand#execute(DataNucleusCreateObjectCommand.java:54)
org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore#executeCommands(DataNucleusObjectStore.java:361)
org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore#execute(DataNucleusObjectStore.java:355)
org.apache.isis.core.runtime.system.transaction.IsisTransaction#doFlush(IsisTransaction.java:388)
org.apache.isis.core.runtime.system.transaction.IsisTransaction#flush(IsisTransaction.java:337)
org.apache.isis.core.runtime.system.transaction.IsisTransactionManager#flushTransaction(IsisTransactionManager.java:298)
org.apache.isis.core.runtime.persistence.internal.RuntimeContextFromSession$7#flush(RuntimeContextFromSession.java:221)
org.apache.isis.core.metamodel.services.container.DomainObjectContainerDefault#flush(DomainObjectContainerDefault.java:229)
org.apache.isis.core.metamodel.services.container.DomainObjectContainerDefault#allMatches(DomainObjectContainerDefault.java:402)
org.apache.isis.applib.AbstractContainedObject#allMatches(AbstractContainedObject.java:175)
org.estatio.dom.EstatioDomainService#allMatches(EstatioDomainService.java:70)
org.estatio.dom.communicationchannel.CommunicationChannels#findByOwner(CommunicationChannels.java:113)
org.estatio.dom.communicationchannel.CommunicationChannelContributions#communicationChannels(CommunicationChannelContributions.java:159)
org.estatio.dom.party.OrganisationChangedPayload#getCommunicationChannels(OrganisationChangedPayload.java:49)
sun.reflect.NativeMethodAccessorImpl#invoke0(NativeMethodAccessorImpl.java:-2)
sun.reflect.NativeMethodAccessorImpl#invoke(NativeMethodAccessorImpl.java:57)
sun.reflect.DelegatingMethodAccessorImpl#invoke(DelegatingMethodAccessorImpl.java:43)
java.lang.reflect.Method#invoke(Method.java:606)
org.apache.isis.core.commons.lang.MethodExtensions#invoke(MethodExtensions.java:50)
org.apache.isis.core.commons.lang.MethodExtensions#invoke(MethodExtensions.java:45)
org.apache.isis.core.metamodel.adapter.util.AdapterInvokeUtils#invoke(AdapterInvokeUtils.java:44)
org.apache.isis.core.progmodel.facets.collections.accessor.CollectionAccessorFacetViaAccessor#getProperty(CollectionAccessorFacetViaAccessor.java:69)
org.apache.isis.core.metamodel.specloader.specimpl.OneToManyAssociationImpl#get(OneToManyAssociationImpl.java:149)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.ObjectCollectionReprRenderer#addValue(ObjectCollectionReprRenderer.java:73)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.ObjectCollectionReprRenderer#render(ObjectCollectionReprRenderer.java:55)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer#addAssociations(DomainObjectReprRenderer.java:264)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer#withMembers(DomainObjectReprRenderer.java:212)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer#render(DomainObjectReprRenderer.java:150)
org.apache.isis.viewer.restfulobjects.rendering.eventserializer.RestfulObjectsSpecEventSerializer#asPayloadRepr(RestfulObjectsSpecEventSerializer.java:99)
org.apache.isis.viewer.restfulobjects.rendering.eventserializer.RestfulObjectsSpecEventSerializer#serialize(RestfulObjectsSpecEventSerializer.java:75)
org.apache.isis.objectstore.jdo.applib.service.publish.PublishingServiceJdo#publish(PublishingServiceJdo.java:48)
org.apache.isis.core.runtime.persistence.objectstore.transaction.PublishingServiceWithDefaultPayloadFactories#publishObject(PublishingServiceWithDefaultPayloadFactories.java:90)
org.apache.isis.core.runtime.system.transaction.IsisTransaction#publishedChangedObjectsIfRequired(IsisTransaction.java:478)
org.apache.isis.core.runtime.system.transaction.IsisTransaction#commit(IsisTransaction.java:596)
org.apache.isis.core.runtime.system.transaction.IsisTransactionManager#endTransaction(IsisTransactionManager.java:383)
org.apache.isis.viewer.wicket.viewer.integration.wicket.WebRequestCycleForIsis#onRequestHandlerExecuted(WebRequestCycleForIsis.java:101)
org.apache.wicket.request.cycle.RequestCycleListenerCollection$8#notify(RequestCycleListenerCollection.java:195)
org.apache.wicket.request.cycle.RequestCycleListenerCollection$8#notify(RequestCycleListenerCollection.java:191)
org.apache.wicket.util.listener.ListenerCollection#notify(ListenerCollection.java:80)
org.apache.wicket.request.cycle.RequestCycleListenerCollection#onRequestHandlerExecuted(RequestCycleListenerCollection.java:190)
org.apache.wicket.request.cycle.RequestCycleListenerCollection$8#notify(RequestCycleListenerCollection.java:195)
org.apache.wicket.request.cycle.RequestCycleListenerCollection$8#notify(RequestCycleListenerCollection.java:191)
org.apache.wicket.util.listener.ListenerCollection#notify(ListenerCollection.java:80)
org.apache.wicket.request.cycle.RequestCycleListenerCollection#onRequestHandlerExecuted(RequestCycleListenerCollection.java:190)
org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:262)
org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:218)
org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:289)
org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:259)
org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:201)
org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:282)
org.mortbay.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1157)
org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
org.mortbay.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1157)
org.mortbay.jetty.servlet.ServletHandler#handle(ServletHandler.java:388)
org.mortbay.jetty.security.SecurityHandler#handle(SecurityHandler.java:216)
org.mortbay.jetty.servlet.SessionHandler#handle(SessionHandler.java:182)
org.mortbay.jetty.handler.ContextHandler#handle(ContextHandler.java:765)
org.mortbay.jetty.webapp.WebAppContext#handle(WebAppContext.java:440)
org.mortbay.jetty.handler.ContextHandlerCollection#handle(ContextHandlerCollection.java:230)
org.mortbay.jetty.handler.HandlerCollection#handle(HandlerCollection.java:114)
org.mortbay.jetty.handler.HandlerWrapper#handle(HandlerWrapper.java:152)
org.mortbay.jetty.Server#handle(Server.java:326)
org.mortbay.jetty.HttpConnection#handleRequest(HttpConnection.java:542)
org.mortbay.jetty.HttpConnection$RequestHandler#headerComplete(HttpConnection.java:926)
org.mortbay.jetty.HttpParser#parseNext(HttpParser.java:549)
org.mortbay.jetty.HttpParser#parseAvailable(HttpParser.java:212)
org.mortbay.jetty.HttpConnection#handle(HttpConnection.java:404)
org.mortbay.io.nio.SelectChannelEndPoint#run(SelectChannelEndPoint.java:410)
org.mortbay.thread.QueuedThreadPool$PoolThread#run(QueuedThreadPool.java:582)
org.datanucleus.exceptions.NucleusUserException
Attempt to store value ""bec9ff8b-c903-4efd-a834-18ba918d8e6b.0"" in column """"id"""" that has maximum length of 32. Please correct your data!
org.datanucleus.store.rdbms.mapping.datastore.CharRDBMSMapping#setString(CharRDBMSMapping.java:273)
org.datanucleus.store.rdbms.mapping.java.SingleFieldMapping#setString(SingleFieldMapping.java:201)
org.datanucleus.store.rdbms.fieldmanager.ParameterSetter#storeStringField(ParameterSetter.java:159)
org.datanucleus.state.JDOStateManager#providedStringField(JDOStateManager.java:1256)
org.apache.isis.objectstore.jdo.applib.service.publish.PublishedEvent#jdoProvideField(PublishedEvent.java:-1)
org.apache.isis.objectstore.jdo.applib.service.publish.PublishedEvent#jdoProvideFields(PublishedEvent.java:-1)
org.datanucleus.state.JDOStateManager#provideFields(JDOStateManager.java:1346)
org.datanucleus.store.rdbms.request.InsertRequest#execute(InsertRequest.java:264)
org.datanucleus.store.rdbms.RDBMSPersistenceHandler#insertTable(RDBMSPersistenceHandler.java:167)
org.datanucleus.store.rdbms.RDBMSPersistenceHandler#insertObject(RDBMSPersistenceHandler.java:143)
org.datanucleus.state.JDOStateManager#internalMakePersistent(JDOStateManager.java:3776)
org.datanucleus.state.JDOStateManager#makePersistent(JDOStateManager.java:3752)
org.datanucleus.ExecutionContextImpl#persistObjectInternal(ExecutionContextImpl.java:2199)
org.datanucleus.ExecutionContextImpl#persistObjectWork(ExecutionContextImpl.java:2045)
org.datanucleus.ExecutionContextImpl#persistObject(ExecutionContextImpl.java:1893)
org.datanucleus.api.jdo.JDOPersistenceManager#jdoMakePersistent(JDOPersistenceManager.java:727)
org.datanucleus.api.jdo.JDOPersistenceManager#makePersistent(JDOPersistenceManager.java:752)
org.apache.isis.objectstore.jdo.datanucleus.persistence.commands.DataNucleusCreateObjectCommand#execute(DataNucleusCreateObjectCommand.java:54)
org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore#executeCommands(DataNucleusObjectStore.java:361)
org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore#execute(DataNucleusObjectStore.java:355)
org.apache.isis.core.runtime.system.transaction.IsisTransaction#doFlush(IsisTransaction.java:388)
org.apache.isis.core.runtime.system.transaction.IsisTransaction#flush(IsisTransaction.java:337)
org.apache.isis.core.runtime.system.transaction.IsisTransactionManager#flushTransaction(IsisTransactionManager.java:298)
org.apache.isis.core.runtime.persistence.internal.RuntimeContextFromSession$7#flush(RuntimeContextFromSession.java:221)
org.apache.isis.core.metamodel.services.container.DomainObjectContainerDefault#flush(DomainObjectContainerDefault.java:229)
org.apache.isis.core.metamodel.services.container.DomainObjectContainerDefault#allMatches(DomainObjectContainerDefault.java:402)
org.apache.isis.applib.AbstractContainedObject#allMatches(AbstractContainedObject.java:175)
org.estatio.dom.EstatioDomainService#allMatches(EstatioDomainService.java:70)
org.estatio.dom.communicationchannel.CommunicationChannels#findByOwner(CommunicationChannels.java:113)
org.estatio.dom.communicationchannel.CommunicationChannelContributions#communicationChannels(CommunicationChannelContributions.java:159)
org.estatio.dom.party.OrganisationChangedPayload#getCommunicationChannels(OrganisationChangedPayload.java:49)
sun.reflect.NativeMethodAccessorImpl#invoke0(NativeMethodAccessorImpl.java:-2)
sun.reflect.NativeMethodAccessorImpl#invoke(NativeMethodAccessorImpl.java:57)
sun.reflect.DelegatingMethodAccessorImpl#invoke(DelegatingMethodAccessorImpl.java:43)
java.lang.reflect.Method#invoke(Method.java:606)
org.apache.isis.core.commons.lang.MethodExtensions#invoke(MethodExtensions.java:50)
org.apache.isis.core.commons.lang.MethodExtensions#invoke(MethodExtensions.java:45)
org.apache.isis.core.metamodel.adapter.util.AdapterInvokeUtils#invoke(AdapterInvokeUtils.java:44)
org.apache.isis.core.progmodel.facets.collections.accessor.CollectionAccessorFacetViaAccessor#getProperty(CollectionAccessorFacetViaAccessor.java:69)
org.apache.isis.core.metamodel.specloader.specimpl.OneToManyAssociationImpl#get(OneToManyAssociationImpl.java:149)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.ObjectCollectionReprRenderer#addValue(ObjectCollectionReprRenderer.java:73)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.ObjectCollectionReprRenderer#render(ObjectCollectionReprRenderer.java:55)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer#addAssociations(DomainObjectReprRenderer.java:264)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer#withMembers(DomainObjectReprRenderer.java:212)
org.apache.isis.viewer.restfulobjects.rendering.domainobjects.DomainObjectReprRenderer#render(DomainObjectReprRenderer.java:150)
org.apache.isis.viewer.restfulobjects.rendering.eventserializer.RestfulObjectsSpecEventSerializer#asPayloadRepr(RestfulObjectsSpecEventSerializer.java:99)
org.apache.isis.viewer.restfulobjects.rendering.eventserializer.RestfulObjectsSpecEventSerializer#serialize(RestfulObjectsSpecEventSerializer.java:75)
org.apache.isis.objectstore.jdo.applib.service.publish.PublishingServiceJdo#publish(PublishingServiceJdo.java:48)
org.apache.isis.core.runtime.persistence.objectstore.transaction.PublishingServiceWithDefaultPayloadFactories#publishObject(PublishingServiceWithDefaultPayloadFactories.java:90)
org.apache.isis.core.runtime.system.transaction.IsisTransaction#publishedChangedObjectsIfRequired(IsisTransaction.java:478)
org.apache.isis.core.runtime.system.transaction.IsisTransaction#commit(IsisTransaction.java:596)
org.apache.isis.core.runtime.system.transaction.IsisTransactionManager#endTransaction(IsisTransactionManager.java:383)
org.apache.isis.viewer.wicket.viewer.integration.wicket.WebRequestCycleForIsis#onRequestHandlerExecuted(WebRequestCycleForIsis.java:101)
org.apache.wicket.request.cycle.RequestCycleListenerCollection$8#notify(RequestCycleListenerCollection.java:195)
org.apache.wicket.request.cycle.RequestCycleListenerCollection$8#notify(RequestCycleListenerCollection.java:191)
org.apache.wicket.util.listener.ListenerCollection#notify(ListenerCollection.java:80)
org.apache.wicket.request.cycle.RequestCycleListenerCollection#onRequestHandlerExecuted(RequestCycleListenerCollection.java:190)
org.apache.wicket.request.cycle.RequestCycleListenerCollection$8#notify(RequestCycleListenerCollection.java:195)
org.apache.wicket.request.cycle.RequestCycleListenerCollection$8#notify(RequestCycleListenerCollection.java:191)
org.apache.wicket.util.listener.ListenerCollection#notify(ListenerCollection.java:80)
org.apache.wicket.request.cycle.RequestCycleListenerCollection#onRequestHandlerExecuted(RequestCycleListenerCollection.java:190)
org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:262)
org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:218)
org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:289)
org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:259)
org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:201)
org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:282)
org.mortbay.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1157)
org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
org.mortbay.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1157)
org.mortbay.jetty.servlet.ServletHandler#handle(ServletHandler.java:388)
org.mortbay.jetty.security.SecurityHandler#handle(SecurityHandler.java:216)
org.mortbay.jetty.servlet.SessionHandler#handle(SessionHandler.java:182)
org.mortbay.jetty.handler.ContextHandler#handle(ContextHandler.java:765)
org.mortbay.jetty.webapp.WebAppContext#handle(WebAppContext.java:440)
org.mortbay.jetty.handler.ContextHandlerCollection#handle(ContextHandlerCollection.java:230)
org.mortbay.jetty.handler.HandlerCollection#handle(HandlerCollection.java:114)
org.mortbay.jetty.handler.HandlerWrapper#handle(HandlerWrapper.java:152)
org.mortbay.jetty.Server#handle(Server.java:326)
org.mortbay.jetty.HttpConnection#handleRequest(HttpConnection.java:542)
org.mortbay.jetty.HttpConnection$RequestHandler#headerComplete(HttpConnection.java:926)
org.mortbay.jetty.HttpParser#parseNext(HttpParser.java:549)
org.mortbay.jetty.HttpParser#parseAvailable(HttpParser.java:212)
org.mortbay.jetty.HttpConnection#handle(HttpConnection.java:404)
org.mortbay.io.nio.SelectChannelEndPoint#run(SelectChannelEndPoint.java:410)
org.mortbay.thread.QueuedThreadPool$PoolThread#run(QueuedThreadPool.java:582)"
ISIS-631,Documentation,Closed,Require documentation for the file upload feature (in Wicket viewer),"Hello,

I want to understand the process of using File upload feature in ISIS. But there is no documentation available for that.

Regards
Ranganath"
ISIS-630,Bug,Closed,LocalDates are parsed to a wrong date when running in different timezone,This issue occurred to me when doing some late night coding. It was around 12:30 AM CET when I ran an action which should have all date fields defaulted to 1-1-2014 but in return displayed as 31-12-2013. Setting my computer clock one hour ahead made the issue disappear. This could be critical in timezones further away from UTC.
ISIS-629,Bug,Closed,Selecting a different option from a dropdown resets other fields,"After selecting a different option from a dropdown the other values get reset to their default values.

To reproduce:
# Create new todo
# Change due by date
# Change category -> the due by date is being reset"
ISIS-628,Bug,Closed,Download directories include spurious shell scripts,"The download area contains several shell scripts.
These should be removed ASAP:

archetype/quickstart_wicket_restful_jdo-archetype/upd.sh
archetype/simple_wicket_restful_jdo-archetype/upd.sh
component/objectstore/jdo/upd.sh
component/security/file/upd.sh
component/security/shiro/upd.sh
component/viewer/restfulobjects/upd.sh
component/viewer/wicket/upd.sh
core/upd.sh"
ISIS-627,Bug,Closed,"Lazily loaded object cannot be deleted, throws an NPE","In Estatio, the LeaseTerm entity forms a chain, each pointing to the previous and next.  When a Lease is terminated, the algorithm is to spin through all the LeaseTerms and those in the future that are no longer needed.  This is done recursively:

LT1 -> LT2 -> LT3 -> LT4

So, for example LT3 and LT4 would be deleted.

The issue we've found is that calling container.remove() on LT4 fails with an NPE in core (PersistenceSession#destroyObject.  This is because the adapter passed in is null.

~~~
The root cause seems to be that LT4 is lazily loaded from LT3. JDO hasn't yet had occasion to load LT4, which means, in turn, that the pojoAdapter/pojo are not in Isis maps.

In the call to PersistenceSession#destroyObject, the code is using AdapterManager#getAdapterFor(pojo), which will return null if the object is not yet loaded in the maps.

The fix is a one-liner... use AdapterManager#adapterFor(pojo), which will map the pojo to a pojoAdapter if required."
ISIS-626,Improvement,Closed,Recognize Wicket PageExpiredExceptions and display a friendlier error message,"Wicket's PageExpiredException is relatively easy for an end-user to trigger, eg just browse to http://localhost:8080/wicket/wicket/page?NNN where NNN is any number not recently visited (eg choose NNN=999).

The viewer should automatically detect this exception type and display an appropriate error message."
ISIS-625,New Feature,Closed,Better reporting of metamodel violation errors,"Currently metamodel exceptions are rather difficult to spot in the exception log, and there is no indication of an exception in the running applicaiotn - just a nasty stacktrace.

Both of these should be addressed... attempting to access the webapp should show the metamodel exceptions that occurred."
ISIS-624,New Feature,Closed,Use javax.validation.constraints.Digits to specify length and scale for BigDecimal action parameters (to avoid JDO exceptions later).,"Using the JDO @Column annotation the length/scale of properties can be specified.  However, there is no capability to capture these semantics for action parameters (and the @Column annotation cannot be specified for parameters, even if we thought that were a good idea).

With no semantics, Isis currently infers the scale of a BigDecimal from the entered input.  For example, entering ""123.45"" will parse to a BD with scale of 2, entering ""123.4567"" will parse to a BD with scale of 4.

The problem, then, is that if a BD with too large a scale is assigned to a property with a lower scale, then JDO will throw an exception.

So this ticket is to bring in a dependency on beanval 1.1 (JSR-349) such that we can reuse the semantics of its @javax.validation.constraint.Digits annotation:

public class ToDoItem

    @javax.jdo.annotations.Column(length=10, scale=2)
    private Cost cost;

    public void updateCost(@javax.validation.constraint.Digits(integer=8,fraction=2) BigDecimal newCost) {
       setCost(cost);
    }
}

In addition, it should be possible to add this annotation to properties too.  If there is a mismatch between JDO and the Isis annotaitons, then a metamodel validation exception should be thrown.

~~~
side note: ISIS-491 is to more fully integration bean validation... this is only a very small step."
ISIS-623,Improvement,Closed,Make the default logging of JDO and IsisSytemForTest less verbose,"The default logging of JDO and IsisSytemForTest is quite verbose. Also, IsisSytemForTest doesn't read the logging.properties file so there's no way to override the logging levels.

"
ISIS-622,Task,Closed,Download pages must use ASF mirror system for current releases,"The downloads page
http://isis.apache.org/download.html
currently directs users to download from
https://dist.apache.org/repos/dist/release/isis/

This is presumably because the ASF download area:
http://www.apache.org/dist/isis/
was not set up originally.
This has now been done, and the mirrors will start to pick up the files over the next few days.

All ASF downloads must use the ASF mirror system.
Now that ISIS has been set up, please can you update the download page as per
http://www.apache.org/dev/release-download-pages

However, it would be best to wait a couple of days before replacing the page so that mirrors have a chance to catch up.

Likewise, following a successful release vote (and promotion of the files to the dist/release/isis area), please wait a couple of days before announcing a new release. This is so the mirrors can catch up.
Thanks"
ISIS-621,Bug,Closed,Improve the Wicket viewer's parsing of numbers ,"1. silently ignores invalidly formatted numbers

Noticed with BigDecimal (but also an issue for other numeric types)...

""When a field is mandatory you can enter anything. There is no check if an actual  value is  number being  entered.

As an example: when a user enters 100,50 it is not being parsed as number but no feedback is returned .""

In fact, looking at the code, the Wicket framework provides a bunch of IConverter implementations, which we should use.  (Strangely, there is none for BigInteger, but can subclass AbstractIntegerConverter).

[ done]

2. Next up, finding that the , (thousands separator) and . (decimal point separator) are both allowed, but there is opportunity for confusion.  

Isis should always use the locale of the end-user (via the HTTP Accept-Language header), but a European user might not know that, and might assume that the system was running under En_US.  Thus, the user could enter ""12.23"" (meaning 12 point 23) , and then the system would intrepret this under their local as 1223 (one thousand two hundred and twenty three).  

Thus, what we want is for the system to disallow the thousands (grouping) separator when entering a new value.  However, the thousands should still be rendered when in view mode.

3. Entering two many decimal places should be trapped and flagged as an error.  Currently it throws an exception.

4. When rendering big decimals, should pad with zeros to the required scale.  for example, if the scale is 2, then ""123.1"" should be rendered as ""123.10"""
ISIS-620,Bug,Closed,When editing an entity twice a concurrency exception is thrown,"When editing an entity twice a concurrency exception is thrown when using the backspace (browser back) anywhere in the application.

To reproduce:
* load fixtures
* open arbitrary todo
* click edit, change description, click save
* again, click edit, change description, click save

The result:
sven attempted to update TODO:L_23, however this object has since been modified by sven at Mon Dec 02 18:13:13 CET 2013 [3 vs 2]"
ISIS-619,Bug,Closed,Extend IsisActions to support easy mocking of the DOC#newTransientInstance,"When mocking DomainObjectContainer#newTransientInstance(..)  in unit tests we want a ""plain"" instance of the requested class being returned."
ISIS-618,Improvement,Closed,"Simplify ActionPage, separate out result components from prompt.",
ISIS-617,Bug,Closed,Wicket viewer throws NPE when rendering Isis DateTime in a collection,"This was thrown up as an issue as part of fixing ISIS-615 :-(

The workaround is to use the Joda date/time types rather than the Isis ones."
ISIS-616,Improvement,Closed,JDO Implementation of the AuditingService should implement the AuditingService2 API,See also ISIS-614
ISIS-615,Bug,Closed, using the JDO implementation of the AuditingService,"while using the JDO implementation of the AuditingService , i received the following exception:


1) Error in custom provider, org.apache.isis.core.metamodel.specloader.validator.MetaModelInvalidException: 1: org.apache.isis.objectstore.jdo.applib.service.audit.AuditEntry#user: incompatible default handling of required/optional properties between Isis and JDO; add @javax.jdo.annotations.Column(allowsNull=""..."")
2: org.apache.isis.objectstore.jdo.applib.service.audit.AuditEntry#objectType: incompatible default handling of required/optional properties between Isis and JDO; add @javax.jdo.annotations.Column(allowsNull=""..."")
3: org.apache.isis.objectstore.jdo.applib.service.audit.AuditEntry#identifier: incompatible default handling of required/optional properties between Isis and JDO; add @javax.jdo.annotations.Column(allowsNull=""..."")
4: org.apache.isis.objectstore.jdo.applib.service.audit.AuditEntry#preValue: incompatible default handling of required/optional properties between Isis and JDO; add @javax.jdo.annotations.Column(allowsNull=""..."")
5: org.apache.isis.objectstore.jdo.applib.service.audit.AuditEntry#postValue: incompatible default handling of required/optional properties between Isis and JDO; add @javax.jdo.annotations.Column(allowsNull=""..."")
6: org.apache.isis.objectstore.jdo.applib.service.audit.AuditEntry#timestampEpoch: incompatible default handling of required/optional properties between Isis and JDO; add @javax.jdo.annotations.Column(allowsNull=""..."")
"
ISIS-614,New Feature,Closed,Extend the dynamic JSON layout so that DisabledFacet (@Disabled annotation) can be specified dynamically,Similar to ISIS-601 and ISIS-602
ISIS-613,New Feature,Closed,Extend the dynamic JSON layout so that HiddenFacet (@Hidden annotation) can be specified dynamically,Similar to ISIS-601 and ISIS-602
ISIS-612,New Feature,Closed,Return a URL from an action opens a new browser window,"Something like this:

Class Invoice {
    ...
    public URL viewInvoice() {
        return new URL(String.format(""http://reportserver/reports/invoice?invoiceNumber=%s"", getInvoiceNumber));
    }
    ...
}

Suggestions from Dan:

We could either implement this into the Wicket viewer, whereby it understoods that a returned URL means for it to be opened, or we could do it through a domain service (and the Wicket viewer knows nothing about it).

To try it with the former, take a look at StandaloneValuePanel is a good place to look; you will see I do some ""special"" processing for handling downloads of blobs and clobs there.

The answer here [x] shows one way to do a redirect (I think I might use a different API, probably equivalent though)

The gist of the latter is to define a service, eg ""UrlOpenerService"", with the implementatino in the estatio-webapp whereby it has access to all of Wicket framework.  
"
ISIS-611,Improvement,Closed,Ensure classes are properly eagerly registered with JDO Object store,"The RegisterEntities service is only a partial solution; should instead explore using something like ""datanucleus.autoStartClassNames"" property (see http://www.datanucleus.org/products/accessplatform/jdo/autostart.html).

Also, it's probably rather naff to require the RegisterEntities service to be registered; all we really need is the package names in order to locate the @PersistenceCapable classes."
ISIS-610,Bug,Closed,Please clear up incubator directories,Isis graduated some while ago; please clear up the old Incubator release directories.
ISIS-609,New Feature,Closed,Suppress showing actions for collections that are not rendered eagerly,
ISIS-608,New Feature,Closed,"Show count for collections (if rendered eagerly), else a hint to expand.",
ISIS-607,New Feature,Closed,Extend the dynamic JSON layout so that DescribedAsFacet (@DescribedAs annotation) can be specified dynamically,Similar to ISIS-601 and ISIS-602
ISIS-606,New Feature,Closed,Extend the dynamic JSON layout so that CssClassFacet (@CssClass annotation) can be specified dynamically,Similar to ISIS-601 and ISIS-602
ISIS-605,New Feature,Closed,Extend the dynamic JSON layout so that MultiLineFacet (@MultiLine annotation) can be specified dynamically,
ISIS-604,New Feature,Closed,Extend the dynamic JSON layout so that TypicalLengthFacet (@TypicalLength annotation) can be specified dynamically,
ISIS-603,New Feature,Closed,Extend the dynamic JSON layout so that NamedFacet (@Named annotation) can be specified dynamically,Similar to ISIS-601 and ISIS-602
ISIS-602,New Feature,Closed,Extend the dynamic JSON layout so that RenderFacet (@Render annotation) can be specified dynamically,Similar to ISIS-60 (@Paged annotation)
ISIS-601,New Feature,Closed,Extend the dynamic JSON layout so that the PagedFacet (@Paged annotation) can be specified for collections.,"thus:

    {
        span: 6,
        collections: {
            dependencies: {
                actions: { ... }
                    add:{},
                    remove: {}
                },
                paged: {
                    value: 5
                }
            },
            similarTo: {}
        }
    }

Note the new ""paged"" node."
ISIS-600,Improvement,Closed,"Change format of facet properties file, scope by member then facet","Although layout facets are most likely to be represented in json, they can also be loaded from a properties file.  Internally the json is converted to a bunch of properties, and it is the properties that are parsed and used to create facets.

Since this stuff was originally done for the memberOrder and memberOrderLayout facets, the properties file syntax is currently:

memberOrder.<memberName>.name=
memberOrder.<memberName>.sequence=

and

memberOrderLayout.columnSpans=3,4,0,5
memberOrderLayout.columnSpans.left=General,Detail

etc

This ticket is to invert this ordering, in preparation for other facets being added, and to distinguish member-level facets from class-level facets.  

eg:

member.<memberName>.memberOrder.name=
member.<memberName>.memberOrder.sequence=

and

memberOrderLayout.columnSpans=3,4,0,5
memberOrderLayout.columnSpans.left=General,Detail

The format of the JSON file is unchanged."
ISIS-599,Improvement,Closed,Better message and diagnostics for Exception Recognizers,"When a registered ExceptionRecognizer recognizes an exception, it parses the exception message and returns a user-friendly message to display.  Nothing is logged.

Currently the parsed message returned is parsed from the outer-most exception; for better information it should instead parse the root cause.

For the developer, it would be useful for the exceptions to be logged.  One way to do this might be to make them logged if running in prototype mode, but not logged otherwise."
ISIS-598,Improvement,Closed,Add support for @Inject standard annotation,"Add support for injecting services by using @Inject annotations on the field name, in addition to using setXXX() or injectXXX() methods."
ISIS-597,Improvement,Closed,Services still not injected when entering @PostConstruct methods on a Service,"Methods annotated with @PostConstruct are invoked before their objects being injected.

Steps to reproduce:

As per [1], create a method on a service annotated with @PostConstruct, like this one:

@PostConstruct
   public void init(final Map<?, ?> props) {

	server.setGlobal(""eventOccurrences"", this.eventOccurrences);

	
   }

   ....

   // {{ injected: EventOccurrences
   private EventOccurrences eventOccurrences;

   public final void injectEventOccurrences(final EventOccurrences eventOccurrences) {
       this.eventOccurrences = eventOccurrences;
   }

   // }}

The problem is that when the execution arrives to:
    server.setGlobal(""eventOccurrences"", this.eventOccurrences);

this.eventOccurrences is still null... So it has not yet been injected (or instantiated).


[1] http://isis.apache.org/core/services/initializing-services.html"
ISIS-596,Improvement,Closed,Require smarter handling of bookmarked objects that have been deleted,"If an object is deleted, then it isn't automatically removed from the bookmarked panel.

And, if an object is deleted by someone else, then it should be gracefully removed from the panel also."
ISIS-595,New Feature,Closed,Validate metamodel to ensure that any bookmarkable actions are explicitly annotated as having safe action semantics.,"Currently we silently ignore any actions that are bookmarkable but have non-safe action semantics.  While this is not dangerous behaviour, it is potentially confusing to the developer.

Better to fail-fast during bootstrapping with an unambiguous error message."
ISIS-594,Improvement,Closed,Tidy up and simplify URLs in Wicket viewer.,"... by mounting the pages, and using templated URLs for a cleaner look.

Also remove info from pageParameters that can be inferred from existing information (pageType, pageTitle, actionMode)."
ISIS-593,New Feature,Closed,MementoService enhancements ,"eg. to make it easier to implement ViewModels interface (memento strings).

nb: initially MementoService was called ViewModelSupportService, but has since been generalized."
ISIS-592,New Feature,Closed,Make XmlSnapshot (in core.runtime) available as an applib service.,"... making this capability more easily discoverable.

First implementation renamed to ViewModelSupport.

Have subsequently renamed again to MementoService."
ISIS-591,Improvement,Closed,"For Wicket viewer, load Javascript libraries (except for JQuery) from the footer.","ie per best practice, eg http://stackoverflow.com/questions/5329807/benefits-of-loading-js-at-the-bottom-as-opposed-to-the-top-of-the-document"
ISIS-590,Improvement,Closed,Wicket viewer strip wicket tags should depend on the deployment mode.,"Thus:
- if in Isis SERVER mode (= Wicket DEPLOYMENT mode), should strip wicket tags
- if in Isis PROTOTYPE mode (= Wicket DEVELOPMENT mode), should not strip wicket tags.

In both cases, can be overridden by setting ""isis.viewer.wicket.stripWicketTags"" config in one of the loaded configuration files (typically viewer_wicket.properties, but isis.properties would also work)."
ISIS-589,Improvement,Closed,"Bundle all (or at least most) of the Wicket viewer's individual CSS resources into a single bundle, because hitting a limitation of no more than 31 CSS files in IE9 :-(","On complex objects that happen to include most of the Wicket viewer's components, we are hitting IE9's limit of 31 CSS files.

"
ISIS-588,Improvement,Closed,"In Wicket viewer, make bookmark panel smaller, and enable with a keyboard shortcut",
ISIS-587,Improvement,Closed,Various UI improvements for Wicket viewer.,"1. multiline strings (eg ToDoItem#notes) should use more of the page.

2. multiline strings (eg ToDoItem#notes) should honour MaxLengthFacet in a cross-browser fashion

3. regular strings should set size (TypicalLengthFacet) and maxlength (MaxLengthFacet).   If the typical length > max length, then use max length.

4. report of truncation of dates in tables on Chrome/Mac.  Make a bit wider."
ISIS-586,New Feature,Closed,Allow the IsisLdapRealm to read its role/perm mappings from an .ini file,"The motivation here is to allow for multi-realm configuration, eg both LDAP and Ini, where the perm/role mappings are shared.

To help explain this, also update the quickstart archetype to show how to configure multiple realms.  In the case of ini realms, these can therefore load a .ini file from some arbitrary location on the classpath."
ISIS-585,Bug,Closed,Fix links in simple archetype html welcome text,
ISIS-584,Improvement,Closed,scala support in ISIS,ISIS to provide the support to Scala Language for development
ISIS-583,Improvement,Closed,Contributed collections ignore @Render annotation,Contributed collections ignore @Render annotation: it always renders eagerly
ISIS-582,Improvement,Closed,[WON'T FIX] Abstract properties are not rendered in the UI (in tables),"Abstract properties are not rendered in the viewer. 

As a workaround replace the abstract with a dummy implementation:

    abstract public BigDecimal getValue();

replace with:

    public BigDecimal getValue() {
        return null;
    }


NB: Have added a page to the website; please remove when this implemented... http://isis.apache.org/components/viewers/wicket/tips-and-workarounds.html"
ISIS-581,Task,Closed,Release tasks for Isis wicket viewer v1.3.1,Release some minor but important fixes for the Wicket viewer.
ISIS-580,Bug,Closed,Date fields are cleared  when tabbing through other fields.,"To reproduce, add following (eg to ToDoItems service):

    public void testIt(
            String x,
            LocalDate d,
            String y,
            String y2,
            LocalDate d2,
            String z) {
    }

Enter a date for 'd', then enter a value for either 'y' or 'y2'; the date 'd' will be blanked out."
ISIS-579,Improvement,Closed,Add support for range queries in JDO objectstore,"Use the Isis applib QueryAbstract#getStart() and #getCount() and feed into JDO Query#setRange() method.

For a more pleasant API, extend QueryDefault with a new ""withRange(...)"" builder method so that don't need to overload the constructor."
ISIS-578,Bug,Closed,Simple archetype's links to source code in github mirror is incorrect.,
ISIS-577,Improvement,Closed,"Specify @Column(length=...) for JDO entities (ApplicationSetting, UserSetting, PublishedEvent)",
ISIS-576,Improvement,Closed,JDO exception recognizer for sql integrity constraints should only recognize uniqueness constraints,"Since the user-friendly message is ""Data already exists"".

Currently it detects any violation, including for example a NOT NULL constraint violation."
ISIS-575,New Feature,Closed,Tiny new feature... add a tooltip to icons/titles so can see what type it represents.,
ISIS-574,Improvement,Closed,Upgrade isis-security-shiro to use shiro 1.2.3 (currently using 1.2.1),"On attempting to upgrade our dependency on Shiro to the latest (1.2.2), found that our the unit tests, at least, do not pass.

The reason seems to be that our globally registered IsisPermissionResolver, in shiro.ini is not picked up, and so IsisPermission is not used to interpret the permission strings (Shiro's default WildcardPermission is used instead).

Not clear at this point whether the issue lies with Shiro, or with Isis misconfiguring Shiro (in a way that used to work)."
ISIS-573,New Feature,Closed,"[WON'T FIX] To improve performance, set up caching of query results against any entities that are immutable (ie ref data, ie have ImmutableFacet on them).","In DN, this is done using:

query.addExtension(""datanucleus.query.results.cached"", ""true"");
query.addExtension(""datanucleus.query.resultCache.validateObjects"", ""false"");

So, need to figure out how to set up these properties on queries by repositories of immutable facets.   But this could probably be done transparently.

NB: for these cache results to hang around and not get garbage collected, would also need to set the global config parm:

datanucleus.cache.queryResult.type=strong

... its default value is weak.

Further info at: http://www.datanucleus.org/products/datanucleus/jdo/query_cache.html#datastoreCompilation
"
ISIS-572,New Feature,Closed,"[WON'T FIX] To improve performance, support the use of data pinned to caches for entities that are intended to be reference data.  For these, infer the ImmutableFacet.","That is, allow the developer to add the DN extension:

@Extension(vendorName=""datanucleus"", key=""cache-pin"", value=""true"")

as a way to pin any reference data into memory.

If present, we should infer that the entity is immutable (ImmutableFacet).


"
ISIS-571,New Feature,Closed,"[WON'T FIX] To (hopefully) improve performance, use Render.EAGERLY as a hint to instruct JDO to eagerly load the collection (using a dynamic fetch group).","Information on JDO dynamic fetch groups at [http://www.datanucleus.org/products/datanucleus/jdo/fetchgroup.html#dynamic]

My thought is that Isis would spin through each of the classes, and look for those that have any collections annotated EAGERLY.  It would then programmatically define a JDO fetch group for each.

When the object is displayed, Isis would select ONE of these fetch groups and use it to avoid some of the N+1 issues.

NB: it probably would need to select just one of them, otherwise the resulting query submitted by DataNucleus would be of the form

SELECT
  FROM entity
  JOIN child_entity1 ON ...
  JOIN child_entity2 ON ...

ie, a rather large amount of data..."
ISIS-570,Bug,Closed,Drop downs for action parameters don't repaint themselves correctly when a validation error occurs for other parameters on the form.,"To reproduce:

1. ToDoItems#newToDo
- create two items with the same description, such that the uniqueness constraint on description fires
- the category/subcategory fields are not repainted."
ISIS-569,Improvement,Closed,Fix JMock to support JDK7 (JavassistImposteriser),"Isis standardized on using JMock a while back, however as a library it doesn't seem to be keeping up.

Specifically, its mocking of classes depends on cglib 2.x (and therefore asm 3.x), which conflicts with cglib 3/ asm 4.x (required for JDK 7).

Candidates to replace it are mockito and jmockit.  Personally I don't much like mockito; jmockit comes out well in this comparison:
https://blog.42.nl/articles/mockito-powermock-vs-jmockit/"
ISIS-568,Improvement,Closed,"Drop support for JDK 1.6, standardize on JDK 1.7.",Discussion on mailing list: http://markmail.org/message/d66qufilwlluyguu
ISIS-567,Improvement,Closed,Provide the capability to disable concurrency checking through a global property (in isis.properties),"This is only really intended as an ""emergency"" measure, if a concurrency exception is being thrown in a case which we hadn't anticipated / should be automatically resolved (or otherwise brought to the user's attention), but is not being trapped.

This flag would allow the administrator to temporarily disable checking in order that users can continue (albeit at a higher risk of losing updates)."
ISIS-566,Bug,Closed,Concurrency conflict on related entity that has not been edited,"This can be reproduced as follows:
- load the Estatio demo fixture
- Parties>allParties
- select first party
- unlock
- choose edit

... and a concurrency exception on BankAccount (contributed collection on Party via FinancialAccountContributions#financialAccounts()) is thrown:

Another user has just changed this data
root attempted to update org.estatio.dom.financial.BankAccount:L_0, however this object has since been modified by root at Wed Oct 16 08:56:44 GMT 2013 [2 vs 1]"
ISIS-565,Bug,Closed,NullPointerException on OneToOneAssociation#clearValue,"Facet sometimes is null and throws a NPE. Further root cause analysis is needed, reproducable by running Estatio and opening and saving a fixture property."
ISIS-564,Improvement,Closed,The API for the AuditingService#audit omits the id of the property being changed.  Fix this (respecting semver),"Unfortunately this is published API.  therefore we need to mark as deprecated and introduce a new AuditingService2 subinterface that defines the fixed version of audit(...).  If the implementation of the service implements AuditingService2 rather than AuditingService, then call the new method rather than the old."
ISIS-563,New Feature,Closed,[WON'T FIX] Implement generic Spec Transformers for BDD tests,"If the user follows simple conventions when writing BDD tests, some inference can be done from them and a generic Spec Transformer can be used for deriving the Entity from the Gherkin's sentence.

For example, on the following Glue, instead of capturing only the name of the employee, we can capture (employee with name \""[^\""]*\""):

@When(""The company's (employee with name \""[^\""]*\"") has a role assigned"")

From there we know that:
- The Domain Entity singular name is ""employee"", and Isis has the ability to derive the singular name form the Entity's class name, or specify it through the Isis ""@Named"" annotation.
- We must search an Entity of the previous type by name.
- The name must be equal to PETER.

As the Domain Entity singular name must be explicitely used, it also reinforces the ""Ubiquitous Language"" on those BDD tests.


We can admit some variants of the previous case, such as:
- the employee with name ""PETER""
- the employee named ""PETER""
- the property with reference ""REF-001""
- the property referenced ""REF-001""
- the product with id ""PR-001""
"
ISIS-562,Improvement,Open,Decimal numbers are displayed and entered using the user's locale,"Decimal numbers are currently displayed in their native database format using the point as decimal separator. In mainland Europe the general a comma is used as a separator.

Additionally it would be nice to also display the appropriate thousands separator to improve readability for large numbers."
ISIS-561,Improvement,Closed,"Now we have support for view models, we could simplify matters elsewhere by removing support for transient objects.",Some discussion is required before going ahead with this.  But it'd be nice to delete a bunch of code... :-)
ISIS-560,Bug,Closed,"When invoking an action, drop downs get cleared (in the UI) if there is a validation error, but the underlying model is set.  ","This allows the user to hit OK and complete the object even though it seems that there is no value for those drop downs.

for example:

ToDoItems#newToDo(...)

leave description blank;
the category/subcategory are blank, but can complete (so they actually have values)
"
ISIS-559,New Feature,Closed,"When a @Bulk action is invoked, an interaction context (available via a ThreadLocal) should provide additional contextual information.","eg:

    @Bulk
    public ToDoItem completed() {
        ... 
        
        // demonstrating the use of ... 
        final InteractionContext ctxt = InteractionContext.current.get();
        @SuppressWarnings(""unused"")
        List<Object> allObjects = ctxt.getDomainObjects();
        
        LOG.debug(""completed: ""
                + ctxt.getIndex() +
                "" ["" + ctxt.getSize() + ""]""
                + (ctxt.isFirst() ? "" (first)"" : """")
                + (ctxt.isLast() ? "" (last)"" : """"));

        return this;
    }
"
ISIS-558,Improvement,Closed,"When bulk action is invoked, the action that generated the collection should be resubmitted (so that a full refresh takes place).",
ISIS-557,Improvement,Closed,"If @javax.jdo.annotations.Column(length=...) is specified, then should be used to infer the MaxLengthFacet","Moreover, if the @MaxLength annotation is also present, then ensure that both have the same length specified, otherwise fail fast using the MetaModelValidator."
ISIS-556,Sub-task,Closed,Re-enable maven-enforcer-plugin before merging ISIS-537 branch to master,"Maven Enforcer plugin breaks the build when some transitive dependency of dependency A has different version than the same artifact coming as transitive dependency from dependency B.


[INFO] --- maven-enforcer-plugin:1.2:enforce (validate-enforce) @ isis-viewer-wicket-ui ---
[WARNING] 
Dependency convergence error for org.webjars:jquery:1.9.0 paths to dependency are:
+-org.apache.isis.viewer:isis-viewer-wicket-ui:1.3.0-SNAPSHOT
  +-de.agilecoders.wicket:wicket-bootstrap-core:0.9.0-20131001.073459-3
    +-org.webjars:bootstrap:3.0.0
      +-org.webjars:jquery:1.9.0
and
+-org.apache.isis.viewer:isis-viewer-wicket-ui:1.3.0-SNAPSHOT
  +-de.agilecoders.wicket:wicket-bootstrap-extensions:0.9.0-20131001.073550-3
    +-org.webjars:jquery-ui:1.10.2-1
      +-org.webjars:jquery:1.9.1


This slows down the development and we need to disable it in branch ISIS-537."
ISIS-555,New Feature,Closed,"Provide a new ""simple"" archetype, based on the quickstart (todo) app, but stripped right back.","The ToDo app is, perhaps, a little bit heavyweight to start new development (and for demos).  This new ""simple"" archetype should provide a bare minimum of functionality.

At the same time:
* tidy up bad links in the HTML within the ToDo app
* mothball some examples that aren't being maintained...
  * example/application/claims
  * example/domain-service/email-service"
ISIS-554,New Feature,Closed,"Automatically render a ""Dashboard"" service (perhaps one annotated with @Dashboard) as an object in the Wicket viewer.",
ISIS-553,New Feature,Closed,"Provide view model support, as sketched out in the Restful Objects spec","and as will be used by Estatio, to provide a view model pulling together Property and Invoices."
ISIS-552,Bug,Closed,Upgrade to Wicket 6.11.0 and disable HTML5 functionality that caused interference between required text fields and the Wicket viewer's veil.,"In Wicket 6.10.0 (per https://issues.apache.org/jira/browse/WICKET-5289), sets the HTML5 ""required"" attribute.  This causes HTML5 browsers such as Chrome to display a client-side pop-up.

When the OK button is clicked, the Wicket viewer always displays the veil (see jquery.isis.viewer.wicket.js), and relies upon a page refresh to clear the veil.

However, because the page is never submitted, the veil does not disappear.  The only workaround is to resubmit the page, thus losing any text that might have been entered.


In Wicket 6.11.0, a new HTML5Attributes feature (WICKET-5331) makes this behaviour pluggable.

This ticket was previously to disable the setRequired flag for Wicket 6.10.0.

With the advent of Wicket 6.11.0, it is instead to upgrade to Wicket 6.11.0 and to use this new feature."
ISIS-551,Bug,Closed,Not forwarding onto the error page correctly if any of the application actions (ie menus) hit the object store when the transaction has been set to ABORT due to an earlier failure.,"In Estatio we have an application action (ie action on a domain service tha appears in the menu) that has an disableXxx guard which queries the database.

If an error occurs, the transaction will be set to status ABORT.

When Isis tries to forwarding to the error page, the error page attempts to render the application actions, and hits a further error.  This causes the error page to not be rendered either, getting a generic servlet container 503.

The correct thing to do, I think, is to suppress the application actions menu services from the error page."
ISIS-550,New Feature,Closed,Complete the guava EventBus support with new annotations,"A while back I introduced support for the Guava eventbus in the domain model, and introduced the @PostsPropertyChangedEvent.  This will cause the old/new values of the change to be sent to any (domain service) subscriber.

This work is incomplete though.  We ought also to have some additional annotations for other significant actions.  I'm thinking:
- @PostsCollectionAddedToEvent
- @PostsCollectionRemovedFromEvent
- @PostsActionInvokedEvent
- @PostsObjectPersistedEvent
- @PostsObjectDeletedEvent.  
I think that this would probably cover most of the lifecycle events you would want to handle; it'd also be a pretty useful way of decoupling a domain model (without the overhead of publishing via Isis' PublishingService API).
"
ISIS-549,Bug,Closed,RegisterEntities has two @PostConstruct methods...,"... which we discovered are called out-of-sync when run on Ubuntu/CentOS, as a war file.  This results in the RegisterEntities service doing nothing, hence the DN metamodel is not built eagerly, hence strange exceptions later on.

Fix is:
a) ensure that all services have only a single @PostConstruct method (fail fast otherwise)
b) refactor RegisterEntities"
ISIS-548,Task,Closed,Remove logging introduced in ISIS-547 once the proposed fix to Wicket itself has been implemented.,See ISIS-547 comment by Martin Grigorov.
ISIS-547,Improvement,Closed,Provide better error logging from the Wicket applicaiton init() method if Isis fails to boot.,"This is a work-around for the fact that the Wicket framework's WicketFilter, that calls Application#init(), does not log any runtime exception that is thrown.

For example, if a missing JDBC driver has not been configured, then this fact is never logged explicitly.

The fix is to catch the runtime exception in the IsisWicketApplicaiton, and have it log before propogating the exception up to its caller (WicketFilter)."
ISIS-546,Improvement,Closed,OID marshalling should allow an '@' symbol for the version.getUser(),"In testing Estatio's LDAP integration, have found that the userId contains an '@' symbol.  When this is marshalled into an OID (as part of the serialization of the version of the object) we get a runtime exception.

The original reason for excluding the '@' symbol was because of URI encoding concerns, eg if the OID appeared in a URI for the Restful Objects viewer.  However, the value would only ever occur in the path part of the URI (if in the body or query string, then the RO spec defines base 64 encoding anyway).  

As per http://www.ietf.org/rfc/rfc3986.txt (section 3.3), the path component may contain an '@' symbol."
ISIS-545,Bug,Closed,Test in error (Unparseable date),"Test in error in project Isis Core Integration Testing Support 
log >>
Tests in error:
  saveObjectAndAssociatedCollection(org.apache.isis.core.runtime.fixturedomainse
rvice.ObjectFixtureFilePersistorTest): Unparseable date: ""08-Mar-2010 01:00 UTC""

  oldFieldNameSkipped(org.apache.isis.core.runtime.fixturedomainservice.ObjectFi
xtureFilePersistorTest): Unparseable date: ""08-Mar-2010 01:00 UTC""
  saveOneObject(org.apache.isis.core.runtime.fixturedomainservice.ObjectFixtureF
ilePersistorTest): Unparseable date: ""08-Mar-2010 01:00 UTC""
  saveReferencedObject(org.apache.isis.core.runtime.fixturedomainservice.ObjectF
ixtureFilePersistorTest): Unparseable date: ""08-Mar-2010 01:00 UTC""
  invalidFieldLine(org.apache.isis.core.runtime.fixturedomainservice.ObjectFixtu
reFilePersistorTest): Unparseable date: ""08-Mar-2010 01:00 UTC""
  saveTwoObjects(org.apache.isis.core.runtime.fixturedomainservice.ObjectFixture
FilePersistorTest): Unparseable date: ""08-Mar-2010 01:00 UTC""
  saveNoObjects(org.apache.isis.core.runtime.fixturedomainservice.ObjectFixtureF
ilePersistorTest): Unparseable date: ""08-Mar-2010 01:00 UTC""
  loadInstance(org.apache.isis.core.runtime.fixturedomainservice.ObjectFixtureFi
lePersistorTest): Unparseable date: ""08-Mar-2010 01:00 UTC""

Tests run: 117, Failures: 0, Errors: 8, Skipped: 1"
ISIS-544,Improvement,Closed,"If auto-focus on an action param date, then doesn't show calendar picker.","to fix, some sort of additional bit of JQuery to show the drop down if "".first-field"" class is present and also is a date (again, based on CSS class?)"
ISIS-543,Improvement,Closed,"title() should take precedence over @Title, or perhaps should fail eagerly?","from discussion on mailing list:

Every domain object should provide a title - a string representation of itself that is sufficiently unique to identify it to the end-user.  There are two main ways of doing this, either declaratively - using @Title annotations - or imperatively - with the title() method.  (If neither are present, then toString() is used).

This ticket is so that the declarative behaviour is the default, but if a class provides a title() method, then this should be used instead.  The ticket also suggested that perhaps having both @Title and title() might be considered an error, in which case we could use the MetaModelValidator interface to prevent Isis from booting.  However, I think this doesn't make sense, because it might be that the properties annotated with @Title might be inherited from a superclass, whereas the subclass might want to override this with its own title().  So having both shouldn't be considered an error.

I suspect that the fix is very easy ... just reversing the order of the registration of TitleAnnotationFacetFactory and TitleMethodFacetFactory in ProgrammingModelFacetsJava5.  "
ISIS-542,New Feature,Closed,Restrict which entities a service action is contributed to (as either a contributed action or contributed assocation).,"For example, an action

void foo(A a, B b) { ... }

will be contributed to both entities A and B.  We might want to allow it to be contributed to one or the other.

Suggestion is that @NotContributed annotation applies to action parameters (with current behaviour maintained for compatibility as the default for all parameters of the action):

eg

void foo(
    @NotContributed(As.Action) A, 
    @NotContributed(As.Association) B) { ... }
"
ISIS-541,Improvement,Closed,"Enhance contributed actions/associations to support hideXxx, disableXxx, validateXxx, defaultXxx and choices where the contributee is automatically populated.","(think this is actually orthogonal to the conditional choices stuff...?)

"
ISIS-540,Improvement,Closed,ExceptionRecognizerForJDODataStoreException is too general...,"Will capture *every* JDO objectstore exception, even unexpected ones such as ""NOT NULL constraint check violated"".  Such errors should *not* be recognized."
ISIS-539,Improvement,Closed,Allow a reason to be specified in @Disabled annotation,
ISIS-538,Improvement,Closed,"Improve performance of rendering lists (in Wicket viewer) (also fixed in ""v1 maintenance"")","rendering a Lease, showing LeaseUnit in table (they would be in view mode).  Even so, we compute the choices etc, even though never used (see stack trace).

In ScalarPanelAbstract#buildGui(), we have:

    private void buildGui() {
        
        // REVIEW: this is nasty, both write to the same entityLink field
        // even though only one is used
        componentIfCompact = addComponentForCompact();
        componentIfRegular = addComponentForRegular();



Brands.findUniqueNames() line: 46	
LeaseUnit.choicesBrandName() line: 278	
NativeMethodAccessorImpl.invoke0(Method, Object, Object[]) line: not available [native method]	
NativeMethodAccessorImpl.invoke(Object, Object[]) line: not available	
DelegatingMethodAccessorImpl.invoke(Object, Object[]) line: not available	
Method.invoke(Object, Object...) line: not available	
MethodExtensions.invoke(Method, Object, Object[]) line: 50	
MethodExtensions.invoke(Method, Object) line: 45	
AdapterInvokeUtils.invoke(Method, ObjectAdapter) line: 44	
PropertyChoicesFacetViaMethod.getChoices(ObjectAdapter, SpecificationLoader) line: 72	
OneToOneAssociationImpl.getChoices(ObjectAdapter) line: 248	
ScalarModel$Kind$1.getChoices(ScalarModel, ObjectAdapter[]) line: 163	
ScalarModel.getChoices(ObjectAdapter[]) line: 584	
ValueChoicesSelect2Panel.getChoiceMementos(ObjectAdapter[]) line: 93	
ValueChoicesSelect2Panel.setChoices(ObjectAdapter[]) line: 194	
ValueChoicesSelect2Panel.addComponentForRegular() line: 76	
ValueChoicesSelect2Panel(ScalarPanelAbstract).buildGui() line: 178	
ValueChoicesSelect2Panel(ScalarPanelAbstract).onBeforeRender() line: 147	
ValueChoicesSelect2Panel(Component).internalBeforeRender() line: 923	
ValueChoicesSelect2Panel(Component).beforeRender() line: 991	
"
ISIS-537,New Feature,Closed,"Convert Wicket viewer to use Bootstrap, so that it can be themed.",forked to https://github.com/martin-g/isis
ISIS-536,Improvement,Closed,Provide the capability to disable concurrency checking in core through a thread-local,"In some situations it may be necessary to temporarily disable concurrency checking.  

One example is when running integration test fixtures, where we simply want to delete all existing data, and don't care about any existing state.

However, another might be to get better control of callbacks from the JDO objectstore.  For example, on the preDelete callback to the FrameworkSynchronizer, we've seen concurrency exceptions, but these might be as the a result of JDO bumping up the version of the adapter being deleted.  Further research is required here.  One possibility though is that the preDelete might require checking to be temporarily disabled for the thread, so that when the callback fires, it knows not to do the concurrency check.

This ticket is to provide this thread local capability.  Analysis of the codebase shows that - when configured with Wicket and the JDO objectstore - the ConcurrencyException is thrown either via AdapterManager, or in the Framework Synchronizer.  Both of these should honour the value of the thread local."
ISIS-535,Improvement,Closed,Enhance the ToDo example to show how to add application-specific logging.,
ISIS-534,Improvement,Closed,Does JDO Objectstore ever need to create DataNucleusUpdateObjectCommand commands?,"Following on from ISIS-533, I'm not sure there's ever any reason for the DataNucleusUpdateObjectCommand to do anything, therefore for it to be created.  The Isis core can, instead, merely rely upon DN's built-in object dirtying.

This ticket is to explore this issue and perhaps to make the objectChanged() method - that creates the Update command - into a no-op if the JDO objectstore is configured."
ISIS-533,Bug,Closed,"When flushing transaction, allow for fact that flushing might cause additional persistence commands to be created, and iterate.","Against 1.3.0-SNAPSHOT, https://github.com/apache/isis/tree/655b6c0b73f38ea8983471ea7d304b944bb9d223, 

had the following stacktrace below.

~~~~
Analysis:

In org.apache.isis.core.runtime.system.transaction.IsisTransaction#doFlush, we execute all queued persistence commands - these are typically gonna be inserts - via getContainer.persist(...) - or deletes - via getContainer().remove(...).  Looking at the code it seems that a call to a collection.addTo or collection.removeFrom also queues up an ""update"" command.

Anyway, if in the course of executing one of these commands in the doFlush it cascades such that another persistence command is created, then we'll get this issue.  This *could* legitimately happen if one of the persistence callbacks, such as ""saved()"" or ""deleted()"" is used.

There was a recent issue like this on Isis' .NET ""sister"" framework, Naked Objects .NET.  The solution was to keep flushing until there are no commands left.

~~~~~
 - java.util.ConcurrentModificationException
   -
   -
   java.util.AbstractList$Itr#checkForComodification(AbstractList.java:372)
   - java.util.AbstractList$Itr#next(AbstractList.java:343)
   -
   java.util.Collections$UnmodifiableCollection$1#next(Collections.java:1008)
   -
   org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore#executeCommands(DataNucleusObjectStore.java:360)
   -
   org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore#execute(DataNucleusObjectStore.java:355)
   -
   org.apache.isis.core.runtime.system.transaction.IsisTransaction#doFlush(IsisTransaction.java:365)
   -
   org.apache.isis.core.runtime.system.transaction.IsisTransaction#flush(IsisTransaction.java:331)
   -
   org.apache.isis.core.runtime.system.transaction.IsisTransactionManager#flushTransaction(IsisTransactionManager.java:298)
   -
   org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel#executeActionOnTargetAndProcessResults(ActionPanel.java:181)
   -
   org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel#executeActionAndProcessResults(ActionPanel.java:137)
   -
   org.apache.isis.viewer.wicket.ui.components.actions.ActionParametersFormPanel$ActionParameterForm$1#onSubmit(ActionParametersFormPanel.java:126)
   - org.apache.wicket.markup.html.form.Form#delegateSubmit(Form.java:1253)
   - org.apache.wicket.markup.html.form.Form#process(Form.java:925)
   - org.apache.wicket.markup.html.form.Form#onFormSubmitted(Form.java:771)
   - org.apache.wicket.markup.html.form.Form#onFormSubmitted(Form.java:704)
   -
   sun.reflect.NativeMethodAccessorImpl#invoke0(NativeMethodAccessorImpl.java:-2)
   -
   sun.reflect.NativeMethodAccessorImpl#invoke(NativeMethodAccessorImpl.java:39)
   -
   sun.reflect.DelegatingMethodAccessorImpl#invoke(DelegatingMethodAccessorImpl.java:25)
   - java.lang.reflect.Method#invoke(Method.java:597)
   -
   org.apache.wicket.RequestListenerInterface#internalInvoke(RequestListenerInterface.java:258)
   -
   org.apache.wicket.RequestListenerInterface#invoke(RequestListenerInterface.java:216)
   -
   org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler#invokeListener(ListenerInterfaceRequestHandler.java:240)
   -
   org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler#respond(ListenerInterfaceRequestHandler.java:226)
   -
   org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:861)
   -
   org.apache.wicket.request.RequestHandlerStack#execute(RequestHandlerStack.java:64)
   -
   org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:261)
   -
   org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:218)
   -
   org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:289)
   -
   org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:259)
   -
   org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:201)
   -
   org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:282)
   -
   org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1326)
   -
   org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
   -
   org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
   -
   org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
   -
   org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
   -
   org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
   -
   org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
   -
   org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
   -
   org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1326)
   -
   org.eclipse.jetty.servlet.ServletHandler#doHandle(ServletHandler.java:479)
   -
   org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:119)
   -
   org.eclipse.jetty.security.SecurityHandler#handle(SecurityHandler.java:520)
   -
   org.eclipse.jetty.server.session.SessionHandler#doHandle(SessionHandler.java:227)
   -
   org.eclipse.jetty.server.handler.ContextHandler#doHandle(ContextHandler.java:940)
   -
   org.eclipse.jetty.servlet.ServletHandler#doScope(ServletHandler.java:409)
   -
   org.eclipse.jetty.server.session.SessionHandler#doScope(SessionHandler.java:186)
   -
   org.eclipse.jetty.server.handler.ContextHandler#doScope(ContextHandler.java:874)
   -
   org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:117)
   -
   org.eclipse.jetty.server.handler.ContextHandlerCollection#handle(ContextHandlerCollection.java:250)
   -
   org.eclipse.jetty.server.handler.HandlerCollection#handle(HandlerCollection.java:149)
   -
   org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:110)
   - org.eclipse.jetty.server.Server#handle(Server.java:349)
   -
   org.eclipse.jetty.server.HttpConnection#handleRequest(HttpConnection.java:441)
   -
   org.eclipse.jetty.server.HttpConnection$RequestHandler#content(HttpConnection.java:921)
   - org.eclipse.jetty.http.HttpParser#parseNext(HttpParser.java:784)
   - org.eclipse.jetty.http.HttpParser#parseAvailable(HttpParser.java:223)
   -
   org.eclipse.jetty.server.AsyncHttpConnection#handle(AsyncHttpConnection.java:46)
   -
   org.eclipse.jetty.io.nio.SelectChannelEndPoint#handle(SelectChannelEndPoint.java:545)
   -
   org.eclipse.jetty.io.nio.SelectChannelEndPoint$1#run(SelectChannelEndPoint.java:43)
   -
   org.eclipse.jetty.util.thread.QueuedThreadPool#runJob(QueuedThreadPool.java:598)
   -
   org.eclipse.jetty.util.thread.QueuedThreadPool$3#run(QueuedThreadPool.java:533)
   - java.lang.Thread#run(Thread.java:680)

"
ISIS-532,Bug,Closed,Quickstart Build error with maven 3,"I checkout the latest version of isis in github and I did mvn clean install, I receive an error during the build of quickstart
       Quickstart Wicket/Restful/JDO DOM ................. FAILURE


[INFO] --- maven-surefire-plugin:2.10:test (default-test) @ quickstart_wicket_restful_jdo-dom ---
[WARNING] The POM for org.apache.maven.plugins:maven-surefire-plugin:jar:2.10 is invalid, transitive dependencies (if any) will not be available, enab
sept. 14, 2013 11:02:06 AM org.sonatype.guice.bean.reflect.NamedClass
WARNING: Error injecting: org.apache.maven.plugin.surefire.SurefirePlugin
java.lang.TypeNotPresentException: Type org.apache.maven.plugin.surefire.SurefirePlugin not present
        at org.sonatype.guice.bean.reflect.URLClassSpace.loadClass(URLClassSpace.java:100)
        at org.sonatype.guice.bean.reflect.NamedClass.load(NamedClass.java:45)
        at org.sonatype.guice.bean.reflect.AbstractDeferredClass.get(AbstractDeferredClass.java:47)
        at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40)
        at com.google.inject.internal.InjectorImpl$4$1.call(InjectorImpl.java:968)
        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1014)
        at com.google.inject.internal.InjectorImpl$4.get(InjectorImpl.java:964)
        at com.google.inject.Scopes$1$1.get(Scopes.java:59)
        at org.sonatype.guice.bean.locators.LazyBeanEntry.getValue(LazyBeanEntry.java:79)
        at org.sonatype.guice.plexus.locators.LazyPlexusBean.getValue(LazyPlexusBean.java:53)
        at org.codehaus.plexus.DefaultPlexusContainer.lookup(DefaultPlexusContainer.java:243)
        at org.codehaus.plexus.DefaultPlexusContainer.lookup(DefaultPlexusContainer.java:235)
        at org.apache.maven.plugin.internal.DefaultMavenPluginManager.getConfiguredMojo(DefaultMavenPluginManager.java:455)
        at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:92)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
        at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
Caused by: java.lang.NoClassDefFoundError: org/apache/maven/plugin/surefire/SurefireReportParameters
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClass(ClassLoader.java:791)
        at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
        at java.net.URLClassLoader.defineClass(URLClassLoader.java:449)
        at java.net.URLClassLoader.access$100(URLClassLoader.java:71)
        at java.net.URLClassLoader$1.run(URLClassLoader.java:361)
        at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
        at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClassFromSelf(ClassRealm.java:386)
        at org.codehaus.plexus.classworlds.strategy.SelfFirstStrategy.loadClass(SelfFirstStrategy.java:42)
        at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClass(ClassRealm.java:244)
        at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClass(ClassRealm.java:230)
        at org.sonatype.guice.bean.reflect.URLClassSpace.loadClass(URLClassSpace.java:96)
        ... 33 more
Caused by: java.lang.ClassNotFoundException: org.apache.maven.plugin.surefire.SurefireReportParameters
        at org.codehaus.plexus.classworlds.strategy.SelfFirstStrategy.loadClass(SelfFirstStrategy.java:50)
        at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClass(ClassRealm.java:244)
        at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClass(ClassRealm.java:230)
        ... 47 more

[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO]
[INFO] Quickstart Wicket/Restful/JDO DOM ................. FAILURE [4.000s]
[INFO] Quickstart Wicket/Restful/JDO Fixtures ............ SKIPPED
[INFO] Quickstart Wicket/Restful/JDO Integration Tests ... SKIPPED
[INFO] Quickstart Wicket/Restful/JDO Webapp .............. SKIPPED
[INFO] quickstart_wicket_restful_jdo-archetype ........... SKIPPED
[INFO] Email service ..................................... SKIPPED
[INFO] Isis Maven Mojo (isis-maven-plugin) ............... SKIPPED
[INFO] Apache Isis (Aggregator) .......................... SKIPPED
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 5.969s
[INFO] Finished at: Sat Sep 14 11:02:06 GMT+01:00 2013
[INFO] Final Memory: 41M/495M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.10:test (default-test) on project quickstart_wicket_restful_jdo-dom: Execution default-test of goal org.apache.maven.plu
gins:maven-surefire-plugin:2.10:test failed: Unable to load the mojo 'test' in the plugin 'org.apache.maven.plugins:maven-surefire-plugin:2.10'. A required class is missing: org/apache/maven/plugin/su
refire/SurefireReportParameters
[ERROR] -----------------------------------------------------
[ERROR] realm =    plugin>org.apache.maven.plugins:maven-surefire-plugin:2.10
[ERROR] strategy = org.codehaus.plexus.classworlds.strategy.SelfFirstStrategy
[ERROR] urls[0] = file:/C:/Documents%20and%20Settings/Administrateur.TOSHIBA-7BA50F3/.m2/repository/org/apache/maven/plugins/maven-surefire-plugin/2.10/maven-surefire-plugin-2.10.jar
[ERROR] urls[1] = file:/C:/Documents%20and%20Settings/Administrateur.TOSHIBA-7BA50F3/.m2/repository/org/codehaus/plexus/plexus-utils/1.1/plexus-utils-1.1.jar
[ERROR] Number of foreign imports: 1
[ERROR] import: Entry[import  from realm ClassRealm[maven.api, parent: null]]
[ERROR]
[ERROR] -----------------------------------------------------: org.apache.maven.plugin.surefire.SurefireReportParameters
[ERROR] -> [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/PluginContainerException
D:\isis\source\isis>"
ISIS-531,Bug,Closed,"Reinstate metamodel pseudo-""API"" classes that are used by danhaywood's wicket extensions, was breaking backward compatibility",
ISIS-530,Improvement,Closed,Upgrade to Wicket 6.10.0 and wicket-jquery-ui,
ISIS-529,Improvement,Closed,Provide hidden versions of the ApplicationSettingsService and UserSettingsService.,
ISIS-528,Improvement,Closed,Allow framework to deal with transient objects not instantiated by newTransientInstance.  Improve javadoc.,"Per this thread: http://markmail.org/thread/wx24e64iydksxzkh.

"
ISIS-527,Improvement,Closed,"Wicket viewer, auto-focus on first field when edit an object or on action parameter.",
ISIS-526,Bug,Closed,Action Resource Parameters representation,"As per 18.2.1 of RO Spec document, Parameters has to be a map. The existing RO Viewer gives it as an array instead of map. "
ISIS-525,Improvement,Closed,"Wicket tags should be stripped by default, overridable with an Isis property.","To override the (new) default behaviour of stripping wicket tags, add:

isis.viewer.wicket.stripWicketTags=false"
ISIS-524,Improvement,Closed,Allow to control the database schema generation using a property in isis.properties file. ,"In the DataNucleusPersistenceMechanismInstaller.addDataNucleusPropertiesIfRequired  method the property datanucleus.autoCreateSchema is set to true by default. Setting isis.persistor.datanucleus.impl.datanucleus.autoCreateSchema to false in isis.properties file the createSchema  does not affect the schema generation.

This is required to enable Isis to run on GAE (see also ISIS-322)."
ISIS-523,Improvement,Closed,"If max length of title in collections is 0, then suppress the title label also.",
ISIS-522,Task,Closed,Mothball the SQL ObjectStore.,
ISIS-521,Improvement,Closed,Xxx.layout.json is not read for abstract classes (as used for parented collections),
ISIS-520,Improvement,Closed,Allow wicket viewer to be run in either development or deployment mode by passing in the Isis --type cmd line arg.,"Isis' deploymentType configuration parameter declares EXPLORATION, PROTOTYPING and SERVER as three modes of operation; broadly speaking, ""SERVER"" corresponds to production.

Wicket, meanwhile, has its configurationType which takes values of ""DEVELOPMENT"" or ""DEPLOYMENT"".

Currently the Wicket viewer reads the Wicket ""configurationType"" init-param, and infers the Isis deploymentType from it.

However, it would also be useful to go the other way, so that running the app through the org.apache.isis.WebServer (ie jetty) would honour the --type (-t) cmd line arg.

For simplicity, suggest:
- Isis SERVER = Wicket DEPLOYMENT mode
- Isis anything else = Wicket DEVELOPMENT mode

"
ISIS-519,Improvement,Closed,"Delete applib's src-archived/old-valueholders (and the other src-archived stuff too, the never implemented searchable annotations/interfaces).","This stuff dates from NOF v2.0, for goodness sake!

As for the archived annotations/interfaces, we have a ticket to do Lucene integration, which will cover that ground."
ISIS-518,New Feature,Closed,Support Guava's Predicate API for allMatches etc in the applib; deprecate the Filter<T> API.,
ISIS-517,New Feature,Closed,"??? Support JSR-305 annotations (@Immutable, @Signed, @MatchesPattern)","for jsr305 annotations, eg @Immutable, @Signed, @MatchesPattern
applib.Filters.and(Filter<T>, Filter<T>) should be Filter<? super T>

from duplicate ISIS-241:
@javax.annotation.MatchesPattern 
@javax.annotation.Nonnegative 
@javax.annotation.Nullable 
@javax.annotation.concurrent.Immutable 
@javax.annotation.meta.Exhaustive (equivalent to @Bounded) 

note that jsr305 is part of Isis' dependencies because of the dependency we take on google guava.
"
ISIS-516,New Feature,Closed,[DUPLICATE] Wicket: be able to invoke @Bulk on items within a parent collection (already supported for standalone collections),could specify where=PARENTED_...
ISIS-515,New Feature,Closed,[WON'T FIX] Pinnable (and persistable) bookmarks,This builds on ISIS-471 (pinnable bookmarks for a session).
ISIS-514,New Feature,Closed,[WON'T FIX] [DUPLICATE] Feature: Allow @Bulk actions to accept parameters,
ISIS-513,New Feature,Closed,[ADDONS] Wicket: Pdf.js display in browser natively,Render PDFs in browser natively
ISIS-512,Sub-task,Closed,Wicket: render icons for actions (if available),"If a resource is available, then render an icon for the action.  Possibly also define an annotation (eg to indicate whether to show the icon, the label or the icon&label."
ISIS-511,New Feature,Closed,Provide the ability to plugin a dashboard for the Wicket viewer,Dashboard object and register a componentFactory for it.  Have well-known mechanism to obtain dashboard from one of the services (eg DashboardProvider)
ISIS-510,New Feature,Closed,[DUPLICATE] Help page overlay (a la ? in gmail),
ISIS-509,Improvement,Closed,Tidy up and rationalize Util classes in core (and all dependents),
ISIS-508,New Feature,Closed,"Integrate with d3js.org (for what, I don't know exactly...)",
ISIS-507,New Feature,Closed,[WON'T FIX] UI: more specific icon for bookmarked repository actions,
ISIS-506,Bug,Closed,Stability: defaultXxx() not working for properties...,
ISIS-505,Improvement,Closed,[INVALID] Wicket error handling returns only a 500 if encounter an unenhanced object,
ISIS-504,Improvement,Closed,Metamodel validator should throw a violation if discover any properties/collections on a service,"Specifically, any getter (apart from getId())
any setter."
ISIS-503,Improvement,Closed,Refactor the way that members are ordered to allow contributee actions to be ordered within regular actions ,"Currently ordering is done on FacetedMethods, and contributee actions are grafted onto the end.  Also complicating matters is the ObjectActionSet, which groups contributee actions according to the service that contributed them.

First change is to remove ObjectActionSet, and have everything flattened.  Second change is to rework MemberLayoutArranger such that it acts upon ObjectMembers rather than FacetedMethods.

At same time, suggest retire the old ""actionOrder()"" supporting method."
ISIS-502,Bug,Closed,wicket componentList order sensitivity,"When replacing a component factory (IsisBlobPanelFactory, for example), it is added to the end of the component list instead of the same place it came from. Since, unfortunately, the order of these components affects which factory is chosen to render a component type, this actually changes the behavior of the app in unexpected and hard to debug ways, since a different factory now will intercept the component request. 

I've got a patch which fixes this, basically by injecting the replacement factory into the same location in the component list, but I'm not sure how to attach it to the bug ticket. "
ISIS-501,Dependency upgrade,Closed,Maven error with DN enhancer: required artifact missing,"Seems that there has been changes on the DN repositories and/or dependencies recently.

The current snapshot fails to build with message: 

[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1:23.839s
[INFO] Finished at: Tue Aug 27 21:14:03 CEST 2013
[INFO] Final Memory: 59M/123M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.datanucleus:datanucleus-maven-plugin:3.2.0-release:enhance (default) on project isis-objectstore-jdo-applib: Execution default of goal org.datanucleus:datanucleus-maven-plugin:3.2.0-release:enhance failed: Plugin org.datanucleus:datanucleus-maven-plugin:3.2.0-release or one of its dependencies could not be resolved: Could not find artifact javax.jdo:jdo-api:jar:3.1-SNAPSHOT -> [Help 1]


The solution, detailed on [1], is to go to the pom.xml of the ""dom"" (domain) module and force the ""datanucleus-maven-plugin"" to use the jdo-api 3.0.1 version, instead of a the 3.0.1-SNAPSHOT version. To do that, simply add this:

	<build>
		<plugins>
			<plugin>
				<groupId>org.datanucleus</groupId>
				<artifactId>datanucleus-maven-plugin</artifactId>
				<version>3.2.0-release</version>
				<dependencies>

										.....
					<dependency> 
                     		 		<groupId>javax.jdo</groupId> 
   				                <artifactId>jdo-api</artifactId> 
                     				<version>3.0.1</version> 
               			</dependency> 

										.....


[1] http://www.datanucleus.org/servlet/jira/browse/NUCMAVEN-27
"
ISIS-500,Improvement,Closed,Make EntityIconAndTitlePanel easier to subclass; minor tidy up ComponentFactory and PageRegistryDefault.,
ISIS-499,Improvement,Closed,Enhance the Isis Eclipse templates to include JDO managed relationships (collections),"Add templates for implementing JDO managed relationships as detailed on:
- http://www.datanucleus.org/products/datanucleus/jdo/orm/relationships.html

Includes support for:
- 1:n bidirectional relationship (implemented using a foreign key).
- 1:n bidirectional relationship (implemented using a join table).
- 1:n unidirectional relationship (implemented using a foreign key).
- 1:n unidirectional relationship (implemented using a join table).
- m:n unidirectional & bidirectional relationship (for the entity acting as the parent).
- m:n unidirectional & bidirectional relationship (for the entity acting as the child).
"
ISIS-498,New Feature,Closed,"Enhance Wicket's BlobPanel so that, if an image is uploaded as the blob, then it is displayed in thumbnail form.",
ISIS-497,New Feature,Closed,Allow service actions to be rendered as contributed collections or as contributed properties.,"Thus:

a non-void service action that accepts a single argument of the entity type is rendered as a property if it returns a scalar, or a collection if it returns a list<T>.

To prevent the service action from being contributed, use @NotContributed annotation, which is extended to:

@NotContributed  ... not contributed at all
@NotContributed(As.ACTION)   .... but is contributed as a property/collection (dependent on return type)
@NoContributed(As.ASSOCIATION) .... but is contributed as an action

Contributed collections are implicitly eagerly rendered.
Contributed properties can be hidden from tables by annotating the service action with @Hidden(where=ALL_TABLES), in the usual fashion.
"
ISIS-496,Bug,Closed,Quickstart RO viewer - a link is broken,"A link is broken in quickstart RO viewer

http://localhost:8080/restful/domain-types/dom.todo.ToDoItem.Category/actions/id "
ISIS-495,Improvement,Closed,Remove dependences to commons-lang and commons-collection,"Re: commons-lang:

Analysis shows that only Scimpi module has a fairly deep dependency on commons-lang (string escaping).  Otherwise there's very little usage, so should be refactored to remove these dependencies in Isis as a whole.



Re: commons-collection:

Analysis shows can all be easily refactored to use guava.



Re: commons-jxpath

unused dependency."
ISIS-494,Bug,Closed,[WON'T FIX] Provide formal API for IsisTransactionManager/PersistenceSession so that other viewers can correctly handle such things as data integrity exceptions.,"Raised by Oscar Bou on mailing list:

We have tried to create a new persistent object on a Factory Method. 

The object has a not-null field (called ""name"").

By error (we have ""unnamed"" entities), we were not providing any value to name (passing ""null"").

The fact is that the wicket viewer showed: ""No results""

But on the log the following trace could be found.



Trace:

     [exec] 14:25:01,631  [sqlonly              qtp1236443008-29 DEBUG]   org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
     [exec] 2. INSERT INTO BUSINESSCONTINUITYMANAGEMENTSYSTEM (UPDATEDBYUSER,DATECREATED,ID,DESCRIPTION,""NAME"",SCOPE_BUSINESSCONTINUITYMANAGEMENTSYSTEMSCOPE_ID_OID,CREATEDBYUSER,TENANTID,DATEUPDATED) 
     [exec] VALUES ('sven','06/13/2013 14:25:01.288','081CF6E0-9329-42BC-AB00-2307266F1CE2',NULL,NULL,NULL,'sven','TENANT','06/13/2013 
     [exec] 14:25:01.288') 
     [exec] 14:25:01,634  [audit                qtp1236443008-29 ERROR]  2. PreparedStatement.executeUpdate() INSERT INTO BUSINESSCONTINUITYMANAGEMENTSYSTEM (UPDATEDBYUSER,DATECREATED,ID,DESCRIPTION,""NAME"",SCOPE_BUSINESSCONTINUITYMANAGEMENTSYSTEMSCOPE_ID_OID,CREATEDBYUSER,TENANTID,DATEUPDATED) VALUES ('sven','06/13/2013 14:25:01.288','081CF6E0-9329-42BC-AB00-2307266F1CE2',NULL,NULL,NULL,'sven','TENANT','06/13/2013 14:25:01.288')
     [exec] java.sql.SQLIntegrityConstraintViolationException: violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_10482 table: BUSINESSCONTINUITYMANAGEMENTSYSTEM column: ""NAME""
     [exec] 	at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
     [exec] 	at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
     [exec] 	at org.hsqldb.jdbc.JDBCPreparedStatement.fetchResult(Unknown Source)
     [exec] 	at org.hsqldb.jdbc.JDBCPreparedStatement.executeUpdate(Unknown Source)
     [exec] 	at net.sf.log4jdbc.PreparedStatementSpy.executeUpdate(PreparedStatementSpy.java:1022)
     [exec] 	at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
     [exec] 	at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
     [exec] 	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeUpdate(ParamLoggingPreparedStatement.java:399)
     [exec] 	at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:439)
     [exec] 	at org.datanucleus.store.rdbms.request.InsertRequest.execute(InsertRequest.java:409)
     [exec] 	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertTable(RDBMSPersistenceHandler.java:167)
     [exec] 	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertObject(RDBMSPersistenceHandler.java:143)
     [exec] 	at org.datanucleus.state.JDOStateManager.internalMakePersistent(JDOStateManager.java:3774)
     [exec] 	at org.datanucleus.state.JDOStateManager.makePersistent(JDOStateManager.java:3750)
     [exec] 	at org.datanucleus.ExecutionContextImpl.persistObjectInternal(ExecutionContextImpl.java:2125)
     [exec] 	at org.datanucleus.ExecutionContextImpl.persistObjectWork(ExecutionContextImpl.java:1973)
     [exec] 	at org.datanucleus.ExecutionContextImpl.persistObject(ExecutionContextImpl.java:1821)
     [exec] 	at org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.java:727)
     [exec] 	at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistent(JDOPersistenceManager.java:752)
     [exec] 	at org.apache.isis.objectstore.jdo.datanucleus.persistence.commands.DataNucleusCreateObjectCommand.execute(DataNucleusCreateObjectCommand.java:53)
     [exec] 	at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.executeCommands(DataNucleusObjectStore.java:360)
     [exec] 	at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.execute(DataNucleusObjectStore.java:354)
     [exec] 	at org.apache.isis.core.runtime.system.transaction.IsisTransaction.doFlush(IsisTransaction.java:367)
     [exec] 	at org.apache.isis.core.runtime.system.transaction.IsisTransaction.flush(IsisTransaction.java:333)
     [exec] 	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.flushTransaction(IsisTransactionManager.java:301)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.executeActionOnTargetAndProcessResults(ActionPanel.java:182)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.executeActionAndProcessResults(ActionPanel.java:138)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.buildGui(ActionPanel.java:96)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.<init>(ActionPanel.java:89)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanelFactory.createComponent(ActionPanelFactory.java:49)
     [exec] 	at org.apache.isis.viewer.wicket.ui.ComponentFactoryAbstract.createComponent(ComponentFactoryAbstract.java:82)
     [exec] 	at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.createComponent(ComponentFactoryRegistryDefault.java:120)
     [exec] 	at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.addOrReplaceComponent(ComponentFactoryRegistryDefault.java:105)
     [exec] 	at org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addComponent(PageAbstract.java:263)
     [exec] 	at org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addChildComponents(PageAbstract.java:258)
     [exec] 	at org.apache.isis.viewer.wicket.ui.pages.action.ActionPage.<init>(ActionPage.java:54)
     [exec] 	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
     [exec] 	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
     [exec] 	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
     [exec] 	at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
     [exec] 	at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:170)
     [exec] 	at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:98)
     [exec] 	at org.apache.wicket.DefaultMapperContext.newPageInstance(DefaultMapperContext.java:137)
     [exec] 	at org.apache.wicket.core.request.handler.PageProvider.resolvePageInstance(PageProvider.java:268)
     [exec] 	at org.apache.wicket.core.request.handler.PageProvider.getPageInstance(PageProvider.java:166)
     [exec] 	at org.apache.wicket.request.handler.render.PageRenderer.getPage(PageRenderer.java:78)
     [exec] 	at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:94)
     [exec] 	at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:196)
     [exec] 	at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:165)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:854)
     [exec] 	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:254)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:211)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:282)
     [exec] 	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:259)
     [exec] 	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:201)
     [exec] 	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:282)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1326)
     [exec] 	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
     [exec] 	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
     [exec] 	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
     [exec] 	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
     [exec] 	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
     [exec] 	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
     [exec] 	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1326)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:479)
     [exec] 	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
     [exec] 	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:520)
     [exec] 	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:227)
     [exec] 	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:940)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:409)
     [exec] 	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:186)
     [exec] 	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:874)
     [exec] 	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
     [exec] 	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250)
     [exec] 	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:149)
     [exec] 	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:110)
     [exec] 	at org.eclipse.jetty.server.Server.handle(Server.java:349)
     [exec] 	at org.eclipse.jetty.server.HttpConnection.handleRequest(HttpConnection.java:441)
     [exec] 	at org.eclipse.jetty.server.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:904)
     [exec] 	at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:565)
     [exec] 	at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:217)
     [exec] 	at org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:46)
     [exec] 	at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:545)
     [exec] 	at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:43)
     [exec] 	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:598)
     [exec] 	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:533)
     [exec] 	at java.lang.Thread.run(Thread.java:680)
     [exec] Caused by: org.hsqldb.HsqlException: violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_10482 table: BUSINESSCONTINUITYMANAGEMENTSYSTEM column: ""NAME""
     [exec] 	at org.hsqldb.error.Error.error(Unknown Source)
     [exec] 	at org.hsqldb.Table.enforceRowConstraints(Unknown Source)
     [exec] 	at org.hsqldb.Table.insertSingleRow(Unknown Source)
     [exec] 	at org.hsqldb.StatementDML.insertRowSet(Unknown Source)
     [exec] 	at org.hsqldb.StatementInsert.getResult(Unknown Source)
     [exec] 	at org.hsqldb.StatementDMQL.execute(Unknown Source)
     [exec] 	at org.hsqldb.Session.executeCompiledStatement(Unknown Source)
     [exec] 	at org.hsqldb.Session.execute(Unknown Source)
     [exec] 	... 87 more
     [exec] 14:25:01,640  [sqlonly              qtp1236443008-29 ERROR]   org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
     [exec] 2. INSERT INTO BUSINESSCONTINUITYMANAGEMENTSYSTEM (UPDATEDBYUSER,DATECREATED,ID,DESCRIPTION,""NAME"",SCOPE_BUSINESSCONTINUITYMANAGEMENTSYSTEMSCOPE_ID_OID,CREATEDBYUSER,TENANTID,DATEUPDATED) VALUES ('sven','06/13/2013 14:25:01.288','081CF6E0-9329-42BC-AB00-2307266F1CE2',NULL,NULL,NULL,'sven','TENANT','06/13/2013 14:25:01.288')
     [exec] java.sql.SQLIntegrityConstraintViolationException: violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_10482 table: BUSINESSCONTINUITYMANAGEMENTSYSTEM column: ""NAME""
     [exec] 	at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
     [exec] 	at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
     [exec] 	at org.hsqldb.jdbc.JDBCPreparedStatement.fetchResult(Unknown Source)
     [exec] 	at org.hsqldb.jdbc.JDBCPreparedStatement.executeUpdate(Unknown Source)
     [exec] 	at net.sf.log4jdbc.PreparedStatementSpy.executeUpdate(PreparedStatementSpy.java:1022)
     [exec] 	at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
     [exec] 	at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
     [exec] 	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeUpdate(ParamLoggingPreparedStatement.java:399)
     [exec] 	at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:439)
     [exec] 	at org.datanucleus.store.rdbms.request.InsertRequest.execute(InsertRequest.java:409)
     [exec] 	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertTable(RDBMSPersistenceHandler.java:167)
     [exec] 	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertObject(RDBMSPersistenceHandler.java:143)
     [exec] 	at org.datanucleus.state.JDOStateManager.internalMakePersistent(JDOStateManager.java:3774)
     [exec] 	at org.datanucleus.state.JDOStateManager.makePersistent(JDOStateManager.java:3750)
     [exec] 	at org.datanucleus.ExecutionContextImpl.persistObjectInternal(ExecutionContextImpl.java:2125)
     [exec] 	at org.datanucleus.ExecutionContextImpl.persistObjectWork(ExecutionContextImpl.java:1973)
     [exec] 	at org.datanucleus.ExecutionContextImpl.persistObject(ExecutionContextImpl.java:1821)
     [exec] 	at org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.java:727)
     [exec] 	at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistent(JDOPersistenceManager.java:752)
     [exec] 	at org.apache.isis.objectstore.jdo.datanucleus.persistence.commands.DataNucleusCreateObjectCommand.execute(DataNucleusCreateObjectCommand.java:53)
     [exec] 	at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.executeCommands(DataNucleusObjectStore.java:360)
     [exec] 	at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.execute(DataNucleusObjectStore.java:354)
     [exec] 	at org.apache.isis.core.runtime.system.transaction.IsisTransaction.doFlush(IsisTransaction.java:367)
     [exec] 	at org.apache.isis.core.runtime.system.transaction.IsisTransaction.flush(IsisTransaction.java:333)
     [exec] 	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.flushTransaction(IsisTransactionManager.java:301)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.executeActionOnTargetAndProcessResults(ActionPanel.java:182)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.executeActionAndProcessResults(ActionPanel.java:138)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.buildGui(ActionPanel.java:96)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.<init>(ActionPanel.java:89)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanelFactory.createComponent(ActionPanelFactory.java:49)
     [exec] 	at org.apache.isis.viewer.wicket.ui.ComponentFactoryAbstract.createComponent(ComponentFactoryAbstract.java:82)
     [exec] 	at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.createComponent(ComponentFactoryRegistryDefault.java:120)
     [exec] 	at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.addOrReplaceComponent(ComponentFactoryRegistryDefault.java:105)
     [exec] 	at org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addComponent(PageAbstract.java:263)
     [exec] 	at org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addChildComponents(PageAbstract.java:258)
     [exec] 	at org.apache.isis.viewer.wicket.ui.pages.action.ActionPage.<init>(ActionPage.java:54)
     [exec] 	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
     [exec] 	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
     [exec] 	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
     [exec] 	at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
     [exec] 	at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:170)
     [exec] 	at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:98)
     [exec] 	at org.apache.wicket.DefaultMapperContext.newPageInstance(DefaultMapperContext.java:137)
     [exec] 	at org.apache.wicket.core.request.handler.PageProvider.resolvePageInstance(PageProvider.java:268)
     [exec] 	at org.apache.wicket.core.request.handler.PageProvider.getPageInstance(PageProvider.java:166)
     [exec] 	at org.apache.wicket.request.handler.render.PageRenderer.getPage(PageRenderer.java:78)
     [exec] 	at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:94)
     [exec] 	at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:196)
     [exec] 	at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:165)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:854)
     [exec] 	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:254)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:211)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:282)
     [exec] 	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:259)
     [exec] 	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:201)
     [exec] 	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:282)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1326)
     [exec] 	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
     [exec] 	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
     [exec] 	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
     [exec] 	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
     [exec] 	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
     [exec] 	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
     [exec] 	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1326)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:479)
     [exec] 	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
     [exec] 	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:520)
     [exec] 	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:227)
     [exec] 	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:940)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:409)
     [exec] 	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:186)
     [exec] 	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:874)
     [exec] 	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
     [exec] 	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250)
     [exec] 	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:149)
     [exec] 	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:110)
     [exec] 	at org.eclipse.jetty.server.Server.handle(Server.java:349)
     [exec] 	at org.eclipse.jetty.server.HttpConnection.handleRequest(HttpConnection.java:441)
     [exec] 	at org.eclipse.jetty.server.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:904)
     [exec] 	at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:565)
     [exec] 	at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:217)
     [exec] 	at org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:46)
     [exec] 	at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:545)
     [exec] 	at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:43)
     [exec] 	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:598)
     [exec] 	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:533)
     [exec] 	at java.lang.Thread.run(Thread.java:680)
     [exec] Caused by: org.hsqldb.HsqlException: violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_10482 table: BUSINESSCONTINUITYMANAGEMENTSYSTEM column: ""NAME""
     [exec] 	at org.hsqldb.error.Error.error(Unknown Source)
     [exec] 	at org.hsqldb.Table.enforceRowConstraints(Unknown Source)
     [exec] 	at org.hsqldb.Table.insertSingleRow(Unknown Source)
     [exec] 	at org.hsqldb.StatementDML.insertRowSet(Unknown Source)
     [exec] 	at org.hsqldb.StatementInsert.getResult(Unknown Source)
     [exec] 	at org.hsqldb.StatementDMQL.execute(Unknown Source)
     [exec] 	at org.hsqldb.Session.executeCompiledStatement(Unknown Source)
     [exec] 	at org.hsqldb.Session.execute(Unknown Source)
     [exec] 	... 87 more
     [exec] 14:25:01,644  [Persist              qtp1236443008-29 WARN ]  Persistencia del objeto ""com.xms.framework.risk.domain.model.continuity.BusinessContinuityManagementSystem@47febf99"" con SQL ""INSERT INTO BUSINESSCONTINUITYMANAGEMENTSYSTEM (UPDATEDBYUSER,DATECREATED,ID,DESCRIPTION,""NAME"",SCOPE_BUSINESSCONTINUITYMANAGEMENTSYSTEMSCOPE_ID_OID,CREATEDBYUSER,TENANTID,DATEUPDATED) VALUES (?,?,?,?,?,?,?,?,?)"" ha tirado un error : violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_10482 table: BUSINESSCONTINUITYMANAGEMENTSYSTEM column: ""NAME""
     [exec] 14:25:05,540  [sqlonly              qtp1236443008-31 DEBUG]   org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
     [exec] 2. SELECT 'com.xms.framework.risk.domain.model.continuity.BusinessContinuityManagementSystem' 
     [exec] FROM BUSINESSCONTINUITYMANAGEMENTSYSTEM A0 WHERE A0.TENANTID = 'n/a' 
     [exec] 14:25:05,542  [resultsettable       qtp1236443008-31 INFO ]  |---|
     [exec] 14:25:05,542  [resultsettable       qtp1236443008-31 INFO ]  |C1 |
     [exec] 14:25:05,542  [resultsettable       qtp1236443008-31 INFO ]  |---|
     [exec] 14:25:05,542  [resultsettable       qtp1236443008-31 INFO ]  |---|
     [exec] 14:25:05,546  [sqlonly              qtp1236443008-31 DEBUG]   org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
     [exec] 2. INSERT INTO BUSINESSCONTINUITYMANAGEMENTSYSTEM (UPDATEDBYUSER,DATECREATED,ID,DESCRIPTION,""NAME"",SCOPE_BUSINESSCONTINUITYMANAGEMENTSYSTEMSCOPE_ID_OID,CREATEDBYUSER,TENANTID,DATEUPDATED) 
     [exec] VALUES ('sven','06/13/2013 14:25:05.543','29F3CC48-0253-4E27-B487-F509E038F5E0',NULL,NULL,NULL,'sven','TENANT','06/13/2013 
     [exec] 14:25:05.543') 
     [exec] 14:25:05,546  [audit                qtp1236443008-31 ERROR]  2. PreparedStatement.executeUpdate() INSERT INTO BUSINESSCONTINUITYMANAGEMENTSYSTEM (UPDATEDBYUSER,DATECREATED,ID,DESCRIPTION,""NAME"",SCOPE_BUSINESSCONTINUITYMANAGEMENTSYSTEMSCOPE_ID_OID,CREATEDBYUSER,TENANTID,DATEUPDATED) VALUES ('sven','06/13/2013 14:25:05.543','29F3CC48-0253-4E27-B487-F509E038F5E0',NULL,NULL,NULL,'sven','TENANT','06/13/2013 14:25:05.543')
     [exec] java.sql.SQLIntegrityConstraintViolationException: violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_10482 table: BUSINESSCONTINUITYMANAGEMENTSYSTEM column: ""NAME""
     [exec] 	at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
     [exec] 	at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
     [exec] 	at org.hsqldb.jdbc.JDBCPreparedStatement.fetchResult(Unknown Source)
     [exec] 	at org.hsqldb.jdbc.JDBCPreparedStatement.executeUpdate(Unknown Source)
     [exec] 	at net.sf.log4jdbc.PreparedStatementSpy.executeUpdate(PreparedStatementSpy.java:1022)
     [exec] 	at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
     [exec] 	at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
     [exec] 	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeUpdate(ParamLoggingPreparedStatement.java:399)
     [exec] 	at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:439)
     [exec] 	at org.datanucleus.store.rdbms.request.InsertRequest.execute(InsertRequest.java:409)
     [exec] 	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertTable(RDBMSPersistenceHandler.java:167)
     [exec] 	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertObject(RDBMSPersistenceHandler.java:143)
     [exec] 	at org.datanucleus.state.JDOStateManager.internalMakePersistent(JDOStateManager.java:3774)
     [exec] 	at org.datanucleus.state.JDOStateManager.makePersistent(JDOStateManager.java:3750)
     [exec] 	at org.datanucleus.ExecutionContextImpl.persistObjectInternal(ExecutionContextImpl.java:2125)
     [exec] 	at org.datanucleus.ExecutionContextImpl.persistObjectWork(ExecutionContextImpl.java:1973)
     [exec] 	at org.datanucleus.ExecutionContextImpl.persistObject(ExecutionContextImpl.java:1821)
     [exec] 	at org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.java:727)
     [exec] 	at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistent(JDOPersistenceManager.java:752)
     [exec] 	at org.apache.isis.objectstore.jdo.datanucleus.persistence.commands.DataNucleusCreateObjectCommand.execute(DataNucleusCreateObjectCommand.java:53)
     [exec] 	at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.executeCommands(DataNucleusObjectStore.java:360)
     [exec] 	at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.execute(DataNucleusObjectStore.java:354)
     [exec] 	at org.apache.isis.core.runtime.system.transaction.IsisTransaction.doFlush(IsisTransaction.java:367)
     [exec] 	at org.apache.isis.core.runtime.system.transaction.IsisTransaction.flush(IsisTransaction.java:333)
     [exec] 	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.flushTransaction(IsisTransactionManager.java:301)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.executeActionOnTargetAndProcessResults(ActionPanel.java:182)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.executeActionAndProcessResults(ActionPanel.java:138)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.buildGui(ActionPanel.java:96)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.<init>(ActionPanel.java:89)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanelFactory.createComponent(ActionPanelFactory.java:49)
     [exec] 	at org.apache.isis.viewer.wicket.ui.ComponentFactoryAbstract.createComponent(ComponentFactoryAbstract.java:82)
     [exec] 	at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.createComponent(ComponentFactoryRegistryDefault.java:120)
     [exec] 	at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.addOrReplaceComponent(ComponentFactoryRegistryDefault.java:105)
     [exec] 	at org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addComponent(PageAbstract.java:263)
     [exec] 	at org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addChildComponents(PageAbstract.java:258)
     [exec] 	at org.apache.isis.viewer.wicket.ui.pages.action.ActionPage.<init>(ActionPage.java:54)
     [exec] 	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
     [exec] 	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
     [exec] 	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
     [exec] 	at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
     [exec] 	at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:170)
     [exec] 	at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:98)
     [exec] 	at org.apache.wicket.DefaultMapperContext.newPageInstance(DefaultMapperContext.java:137)
     [exec] 	at org.apache.wicket.core.request.handler.PageProvider.resolvePageInstance(PageProvider.java:268)
     [exec] 	at org.apache.wicket.core.request.handler.PageProvider.getPageInstance(PageProvider.java:166)
     [exec] 	at org.apache.wicket.request.handler.render.PageRenderer.getPage(PageRenderer.java:78)
     [exec] 	at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:94)
     [exec] 	at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:196)
     [exec] 	at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:165)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:854)
     [exec] 	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:254)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:211)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:282)
     [exec] 	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:259)
     [exec] 	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:201)
     [exec] 	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:282)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1326)
     [exec] 	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
     [exec] 	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
     [exec] 	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
     [exec] 	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
     [exec] 	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
     [exec] 	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
     [exec] 	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1326)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:479)
     [exec] 	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
     [exec] 	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:520)
     [exec] 	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:227)
     [exec] 	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:940)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:409)
     [exec] 	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:186)
     [exec] 	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:874)
     [exec] 	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
     [exec] 	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250)
     [exec] 	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:149)
     [exec] 	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:110)
     [exec] 	at org.eclipse.jetty.server.Server.handle(Server.java:349)
     [exec] 	at org.eclipse.jetty.server.HttpConnection.handleRequest(HttpConnection.java:441)
     [exec] 	at org.eclipse.jetty.server.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:904)
     [exec] 	at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:565)
     [exec] 	at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:217)
     [exec] 	at org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:46)
     [exec] 	at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:545)
     [exec] 	at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:43)
     [exec] 	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:598)
     [exec] 	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:533)
     [exec] 	at java.lang.Thread.run(Thread.java:680)
     [exec] Caused by: org.hsqldb.HsqlException: violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_10482 table: BUSINESSCONTINUITYMANAGEMENTSYSTEM column: ""NAME""
     [exec] 	at org.hsqldb.error.Error.error(Unknown Source)
     [exec] 	at org.hsqldb.Table.enforceRowConstraints(Unknown Source)
     [exec] 	at org.hsqldb.Table.insertSingleRow(Unknown Source)
     [exec] 	at org.hsqldb.StatementDML.insertRowSet(Unknown Source)
     [exec] 	at org.hsqldb.StatementInsert.getResult(Unknown Source)
     [exec] 	at org.hsqldb.StatementDMQL.execute(Unknown Source)
     [exec] 	at org.hsqldb.Session.executeCompiledStatement(Unknown Source)
     [exec] 	at org.hsqldb.Session.execute(Unknown Source)
     [exec] 	... 87 more
     [exec] 14:25:05,550  [sqlonly              qtp1236443008-31 ERROR]   org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
     [exec] 2. INSERT INTO BUSINESSCONTINUITYMANAGEMENTSYSTEM (UPDATEDBYUSER,DATECREATED,ID,DESCRIPTION,""NAME"",SCOPE_BUSINESSCONTINUITYMANAGEMENTSYSTEMSCOPE_ID_OID,CREATEDBYUSER,TENANTID,DATEUPDATED) VALUES ('sven','06/13/2013 14:25:05.543','29F3CC48-0253-4E27-B487-F509E038F5E0',NULL,NULL,NULL,'sven','TENANT','06/13/2013 14:25:05.543')
     [exec] java.sql.SQLIntegrityConstraintViolationException: violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_10482 table: BUSINESSCONTINUITYMANAGEMENTSYSTEM column: ""NAME""
     [exec] 	at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
     [exec] 	at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
     [exec] 	at org.hsqldb.jdbc.JDBCPreparedStatement.fetchResult(Unknown Source)
     [exec] 	at org.hsqldb.jdbc.JDBCPreparedStatement.executeUpdate(Unknown Source)
     [exec] 	at net.sf.log4jdbc.PreparedStatementSpy.executeUpdate(PreparedStatementSpy.java:1022)
     [exec] 	at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
     [exec] 	at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
     [exec] 	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeUpdate(ParamLoggingPreparedStatement.java:399)
     [exec] 	at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:439)
     [exec] 	at org.datanucleus.store.rdbms.request.InsertRequest.execute(InsertRequest.java:409)
     [exec] 	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertTable(RDBMSPersistenceHandler.java:167)
     [exec] 	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertObject(RDBMSPersistenceHandler.java:143)
     [exec] 	at org.datanucleus.state.JDOStateManager.internalMakePersistent(JDOStateManager.java:3774)
     [exec] 	at org.datanucleus.state.JDOStateManager.makePersistent(JDOStateManager.java:3750)
     [exec] 	at org.datanucleus.ExecutionContextImpl.persistObjectInternal(ExecutionContextImpl.java:2125)
     [exec] 	at org.datanucleus.ExecutionContextImpl.persistObjectWork(ExecutionContextImpl.java:1973)
     [exec] 	at org.datanucleus.ExecutionContextImpl.persistObject(ExecutionContextImpl.java:1821)
     [exec] 	at org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.java:727)
     [exec] 	at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistent(JDOPersistenceManager.java:752)
     [exec] 	at org.apache.isis.objectstore.jdo.datanucleus.persistence.commands.DataNucleusCreateObjectCommand.execute(DataNucleusCreateObjectCommand.java:53)
     [exec] 	at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.executeCommands(DataNucleusObjectStore.java:360)
     [exec] 	at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.execute(DataNucleusObjectStore.java:354)
     [exec] 	at org.apache.isis.core.runtime.system.transaction.IsisTransaction.doFlush(IsisTransaction.java:367)
     [exec] 	at org.apache.isis.core.runtime.system.transaction.IsisTransaction.flush(IsisTransaction.java:333)
     [exec] 	at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.flushTransaction(IsisTransactionManager.java:301)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.executeActionOnTargetAndProcessResults(ActionPanel.java:182)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.executeActionAndProcessResults(ActionPanel.java:138)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.buildGui(ActionPanel.java:96)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.<init>(ActionPanel.java:89)
     [exec] 	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanelFactory.createComponent(ActionPanelFactory.java:49)
     [exec] 	at org.apache.isis.viewer.wicket.ui.ComponentFactoryAbstract.createComponent(ComponentFactoryAbstract.java:82)
     [exec] 	at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.createComponent(ComponentFactoryRegistryDefault.java:120)
     [exec] 	at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.addOrReplaceComponent(ComponentFactoryRegistryDefault.java:105)
     [exec] 	at org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addComponent(PageAbstract.java:263)
     [exec] 	at org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addChildComponents(PageAbstract.java:258)
     [exec] 	at org.apache.isis.viewer.wicket.ui.pages.action.ActionPage.<init>(ActionPage.java:54)
     [exec] 	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
     [exec] 	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
     [exec] 	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
     [exec] 	at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
     [exec] 	at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:170)
     [exec] 	at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:98)
     [exec] 	at org.apache.wicket.DefaultMapperContext.newPageInstance(DefaultMapperContext.java:137)
     [exec] 	at org.apache.wicket.core.request.handler.PageProvider.resolvePageInstance(PageProvider.java:268)
     [exec] 	at org.apache.wicket.core.request.handler.PageProvider.getPageInstance(PageProvider.java:166)
     [exec] 	at org.apache.wicket.request.handler.render.PageRenderer.getPage(PageRenderer.java:78)
     [exec] 	at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:94)
     [exec] 	at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:196)
     [exec] 	at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:165)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:854)
     [exec] 	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:254)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:211)
     [exec] 	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:282)
     [exec] 	at org.apache.wicket.protocol.http.WicketFilter.processRequestCycle(WicketFilter.java:259)
     [exec] 	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:201)
     [exec] 	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:282)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1326)
     [exec] 	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
     [exec] 	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
     [exec] 	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
     [exec] 	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
     [exec] 	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
     [exec] 	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
     [exec] 	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1326)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:479)
     [exec] 	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
     [exec] 	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:520)
     [exec] 	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:227)
     [exec] 	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:940)
     [exec] 	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:409)
     [exec] 	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:186)
     [exec] 	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:874)
     [exec] 	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
     [exec] 	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250)
     [exec] 	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:149)
     [exec] 	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:110)
     [exec] 	at org.eclipse.jetty.server.Server.handle(Server.java:349)
     [exec] 	at org.eclipse.jetty.server.HttpConnection.handleRequest(HttpConnection.java:441)
     [exec] 	at org.eclipse.jetty.server.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:904)
     [exec] 	at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:565)
     [exec] 	at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:217)
     [exec] 	at org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:46)
     [exec] 	at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:545)
     [exec] 	at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:43)
     [exec] 	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:598)
     [exec] 	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:533)
     [exec] 	at java.lang.Thread.run(Thread.java:680)
     [exec] Caused by: org.hsqldb.HsqlException: violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_10482 table: BUSINESSCONTINUITYMANAGEMENTSYSTEM column: ""NAME""
     [exec] 	at org.hsqldb.error.Error.error(Unknown Source)
     [exec] 	at org.hsqldb.Table.enforceRowConstraints(Unknown Source)
     [exec] 	at org.hsqldb.Table.insertSingleRow(Unknown Source)
     [exec] 	at org.hsqldb.StatementDML.insertRowSet(Unknown Source)
     [exec] 	at org.hsqldb.StatementInsert.getResult(Unknown Source)
     [exec] 	at org.hsqldb.StatementDMQL.execute(Unknown Source)
     [exec] 	at org.hsqldb.Session.executeCompiledStatement(Unknown Source)
     [exec] 	at org.hsqldb.Session.execute(Unknown Source)
     [exec] 	... 87 more
     [exec] 14:25:05,553  [Persist              qtp1236443008-31 WARN ]  Persistencia del objeto ""com.xms.framework.risk.domain.model.continuity.BusinessContinuityManagementSystem@34940a15"" con SQL ""INSERT INTO BUSINESSCONTINUITYMANAGEMENTSYSTEM (UPDATEDBYUSER,DATECREATED,ID,DESCRIPTION,""NAME"",SCOPE_BUSINESSCONTINUITYMANAGEMENTSYSTEMSCOPE_ID_OID,CREATEDBYUSER,TENANTID,DATEUPDATED) VALUES (?,?,?,?,?,?,?,?,?)"" ha tirado un error : violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_10482 table: BUSINESSCONTINUITYMANAGEMENTSYSTEM column: ""NAME""



So seems that Isis is ""eating"" this exception. In this case is due to an error by ourselves, but the fact is that in other cases it could originate ""bad business logic"", as the object ""seems to be persisted"".
The only thing we have made is annotate the ""name"" property with @Column(allowsNull = ""false"")

But, if I modify the Quickstart archetype ""ToDoItem.java"" from this:

    @Column(allowsNull = ""false"", scale = 2)
    @Optional
    @MemberOrder(sequence = ""4.1"")
    public BigDecimal getCost() {
        return cost;
    }

to this:

    @Column(scale = 2)
    @Optional
    @MemberOrder(sequence = ""4.1"")
    public BigDecimal getCost() {
        return cost;
    }


And try to create a new instance with the newToDoItem action, it detects it properly showing, as per attached screenshot.



What can be have not properly configured?

On isis.services we are including the ""org.apache.isis.objectstore.jdo.applib.service.exceprecog.ExceptionRecognizerCompositeForJdoObjectStore""

isis.services = org.apache.isis.objectstore.jdo.datanucleus.service.support.IsisJdoSupportImpl, \
                org.apache.isis.core.metamodel.services.bookmarks.BookmarkServiceDefault,\
                org.apache.isis.objectstore.jdo.service.RegisterEntities,\
                org.apache.isis.objectstore.jdo.applib.service.exceprecog.ExceptionRecognizerCompositeForJdoObjectStore,\
                org.apache.isis.viewer.restfulobjects.rendering.eventserializer.RestfulObjectsSpecEventSerializer,\
                org.apache.isis.applib.services.audit.AuditingService$Stderr,\
                org.apache.isis.applib.services.publish.PublishingService$Stderr ,\
	....

"
ISIS-493,New Feature,Closed,Annotation to identify domain services/repositories,"Introduce a new @DomainService annotation, that can optionally indicate that it is a repository for an entity.

eg for a service that is a repository:

@DomainService(repositoryFor=Organization.class)
public class Organizations { 
     public List<Organization> findByName(...) { ... }
     ...
}


and for a service that isn't a repository, eg:

@DomainService
public class BarcodeScanner {
     ...
}


~~~~~~~~

background to this request originally raised by Oscar Bou, :http://markmail.org/thread/7xa2gtcytwvq7ogp


copied in for convenience:

We are implementing some BDD tests. And we have the need to always write custom spec transformers (one for each domain entity class) like this one:

public class ETO  {
    private ETO() {}
...

   public static class Party extends NullRecognizingTransformer<org.estatio.dom.party.Party> {
        @Override
        public org.estatio.dom.party.Party transformNonNull(String id) {
            try {
                return ScenarioExecution.current().getVar(""party"", id, org.estatio.dom.party.Party.class);
            } catch(IllegalStateException e) {
                return ScenarioExecution.current().service(Parties.class).findPartyByReferenceOrName(id);
            }
        }
    }


If we had an annotation like ""@IsisRepository(org.estatio.dom.party.Party.class)"" for annotating the Party's repository, the previous transformer could be ""generalized"" (previously searching also for a var on the Scenario context with the class name in camelCase).

Obviously, if none is found it should be mandatory to declare a transformer.

There could be also other scenarios where could be useful to be able to know what's the repository for a given domain entity class. Sure you can think about more.

The container (or any other Isis class) could have a method for returning the proper repository for a class.

What do you think? Could it be useful? Any problems derived from it?


~~~~~~~
Dan's response:

Hi Oscar,
yup, I like the idea, I think... though I'd probably use @DomainService
instead of @IsisRepository.

Another benefit is that we can use it to automatically locate services so
that they don't need to be explicitly registered - something that you've
asked for in the past, IIRC.  A suitable implementation of
org.apache.isis.core.runtime.services.ServicesInstaller would do the trick,
I think.

It might need a few iterations to get exactly correct, however.   A couple
of questions I have is:
- is it your intention to generalize the
""findPartyByReferenceOrName(String)"" bit (in the catch block) also?  If so,
wouldn't that require that DomainService would need to be an interface
(declaring findById(...)) rather than a simple annotation?
- I'm not sure about how hierarchies of classes work.  for example, we have
Parties domain service, for any sort of Party, but also Organisations
domain service, for Organisation (subtype of Party) and Persons domain
service (for Person, subtype of Party).  The entities are closely related
through inheritance, but I don't really have a pattern to explain to myself
what the relationship should be (if any) between their corresponding domain
services of Parties, Organisations and Persons.

Let's exchange a few more mails on this before going ahead and writing some
new code on it....

Dan


~~~
Oscar's response:

Hi, Dan.

yup, I like the idea, I think... though I'd probably use @DomainService
instead of @IsisRepository.

Well, perhaps we need two. But I consider relevant to be able to distinguish
""Repositories"" as defined in DDD from the other kind of Domain Services.

The @DomainService annotation would mark a service as that.

But the @IsisRepository(entity=XXXX), @Repository(entity=XXXX), etc. would have
the additional meaning to be acting as the repository for a specific kind of
Domain Entities, so the ""entity=XXXX"" param should be mandatory.

They should also be considered as Domain Services.

- is it your intention to generalize the
""findPartyByReferenceOrName(String)"" bit (in the catch block) also?  If so,
wouldn't that require that DomainService would need to be an interface
(declaring findById(...)) rather than a simple annotation?

Yes. In fact, we currently have a generic ""findByName"", ""findByProperty"", etc
methods on a generic abstract repository, implemented with the help of the
IsisJdoSupport service. We are ""multi-tenant"", and that allows us to always
filter by tenant and apply some other business filters. We use those protected
methods on the domain ""finders"" defined on each entity's repository.

As we are sharing the implementation, we chose inheritance, but an interface
would also do the trick.

But we consider that an ""implementation detail"" in addition to the annotation,
not a replacement.

- I'm not sure about how hierarchies of classes work.  for example, we have
Parties domain service, for any sort of Party, but also Organisations
domain service, for Organisation (subtype of Party) and Persons domain
service (for Person, subtype of Party).  The entities are closely related
through inheritance, but I don't really have a pattern to explain to myself
what the relationship should be (if any) between their corresponding domain
services of Parties, Organisations and Persons.

In our case, we have references to ""Parties"" on other Domain Entities, so we
need to be able to associate ""Parties"", in addition to ""Organizations"" and
""Persons"". So we need to have ""finders"" for Parties. If that's the case, we need
the ""Party Repository"", in addition to the ""Organization Repository"" and the
""Person Repository"". No need for inheritance between them, unless you have to
share the implementation of some methods, validations, etc. That was not our
case. All them inherit from the ""abstract base domain repository"".

But what we have needed is the ability to distinguish between ""creation"" actions
or ""factory methods"" (we firstly implemented it by searching for methods defined
on services and starting with ""create"", but we changed after to an annotation
called ""@FactoryMethod"" - perhaps other names are better, and names are
important on DDD, we know :-) ) in order to be able to know ""how"" to create a
""Party"" descendant (on Edit forms and action params we are offering the user the
option to create a new entity in addition to select from an existing one).
"
ISIS-492,New Feature,Closed,Improve the mandatory validation message for an action parameter,"org.apache.isis.applib.services.wrapper.InvalidException: Source: com.xms.framework.risk.domain.model.RiskAssessment@4ae59431. Reason: Mandatory. Identifier: com.xms.framework.risk.domain.model.RiskAssessment#valuateAnEnterpriseArchitectureEntity_Qualitative(com.xms.framework.architecture.domain.model.Entity,com.xms.framework.risk.domain.model.RiskObjective,com.xms.framework.risk.domain.model.ImpactCriterion,com.xms.framework.risk.domain.model.ValuationLevel,java.lang.String). Position: 3. Proposed: null
	at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.toException(DomainObjectInvocationHandler.java:584)
	at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.notifyListenersAndVetoIfRequired(DomainObjectInvocationHandler.java:556)
	at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.handleActionMethod(DomainObjectInvocationHandler.java:506)
	at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.invoke(DomainObjectInvocationHandler.java:236)
	at org.apache.isis.core.wrapper.internal.InvocationHandlerMethodInterceptor.intercept(InvocationHandlerMethodInterceptor.java:37)
	at 
...

To 

org.apache.isis.applib.services.wrapper.InvalidException: Source: com.xms.framework.risk.domain.model.RiskAssessment@4ae59431. Reason: Mandatory. Position: 3. Proposed: null. Identifier: com.xms.framework.risk.domain.model.RiskAssessment#valuateAnEnterpriseArchitectureEntity_Qualitative(com.xms.framework.architecture.domain.model.Entity,com.xms.framework.risk.domain.model.RiskObjective,com.xms.framework.risk.domain.model.ImpactCriterion,com.xms.framework.risk.domain.model.ValuationLevel,java.lang.String)"
ISIS-491,Wish,Open,[Wish] Integrate JSR-349 validation.,"as per http://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/

The reference implementation (Hibernate Validator) is Apache licensed [1].

~~~
Implementation: should not be too difficult; mostly a matter of writing some FacetFactories.

It may not make sense to use every feature of JSR-349... 
* constructor parameters
* constraint groups


1. In Isis bootstrapping, get hold and cache the Validator.  (This is thread-safe, so could perhaps be global; maybe as a new top-level component cf AuthorizationManager etc).

{code}
ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
validator = factory.getValidator();
{code}

and also

{code}
executableValidator = validator.forExecutables();
{code}


Validating a property change can be done using:

{code}
Set<ConstraintViolation<Car>> constraintViolations = validator.validateValue(
        Car.class,
        ""manufacturer"",
        null
);

assertEquals( 1, constraintViolations.size() );
assertEquals( ""may not be null"", constraintViolations.iterator().next().getMessage() );
{code}


(nb: using validator.validateProperty(...) would mean that the value has been applied already).

eg this would be a facet that implements ValidatingInteractionAdvisor and acts on a ValidityContext of type PropertyModifyContext.  (eg subclass PropertyValidateFacetAbstract)


2. Validating a parameter of an action can be done using:

{code}
Car object = new Car( ""Morris"" );
Method method = Car.class.getMethod( ""drive"", int.class );
Object[] parameterValues = { 80 };
Set<ConstraintViolation<Car>> violations = executableValidator.validateParameters(
        object,
        method,
        parameterValues
);

assertEquals( 1, violations.size() );
Class<? extends Annotation> constraintType = violations.iterator()
        .next()
        .getConstraintDescriptor()
        .getAnnotation()
        .annotationType();
assertEquals( Max.class, constraintType );
{code}

This would be in a Facet that implements ValidatingInteractionAdvisor and acts on a ValidityContext of type ActionInvocationContext (eg subclass ActionValidationFacetAbstract)

~~~
There are also some new features that could be implemented:

3. validating the return value of an action:

{code}
Car object = new Car( ""Morris"" );
Method method = Car.class.getMethod( ""getPassengers"" );
Object returnValue = Collections.<Passenger>emptyList();
Set<ConstraintViolation<Car>> violations = executableValidator.validateReturnValue(
        object,
        method,
        returnValue
);

assertEquals( 1, violations.size() );
Class<? extends Annotation> constraintType = violations.iterator()
        .next()
        .getConstraintDescriptor()
        .getAnnotation()
        .annotationType();
assertEquals( Size.class, constraintType );
{code}


This would need to be done after the action has been invoked; if the constraint failed, then an exception would be thrown causing the transaction to be aborted.  This might require a new subclass of ValidityContext, eg ActionReturnValueContext.


4. cf ISIS-479, all dirtied objects should be validated prior to commit.
a) we re-validate all properties (using the value of the property as the proposed value).  This would be done using InteractionUtils, called from isAssociationValid with a ValidityContext of PropertyModifyContext.
b) we validate the object, ie InteractionUtils, with  all with a ValidityContext of ObjectValidityContext.

We would then have a new facet, implementing ValidatingInteractionAdvisor and acting on an ObjectValidityContext (eg subclass ValidateObjectFacetAbstract); which should perform:

{code}
Set<ConstraintViolation<Car>> constraintViolations = validator.validate( car );
{code}


"
ISIS-490,Improvement,Closed,Switch from log4j to using slf4j throughout,"This idea was discussed a while back on the dev list, see [1]

See also: ISIS-489, making logging configurable via JMX.

[1] http://markmail.org/thread/pxjdjde2cibjml2f"
ISIS-489,Improvement,Closed,"[WON'T FIX] Allow logging to be configured using JMX, possibly support other real-time metrics/analytics.","eg using logging-jmx-service, perhaps?

See also: ISIS-490, convert to using slf4j"
ISIS-488,New Feature,Closed,"Derive Isis' MandatoryFacet from JDO @Column(allowNulls=) annotation, and provide @Mandatory annotation as override","Thus:

@javax.jdo.annotations.Column(allowNulls=""false"")
public String getFoo() { ... }

is mandatory

@javax.jdo.annotations.Column(allowNulls=""true"")
public String getFoo() { ... }

is optional

@javax.jdo.annotations.Column
public int getFoo() { ... }

is mandatory (JDO default for primitives)

@javax.jdo.annotations.Column
public String getFoo() { ... }

is optional (JDO default for non-primitives)

~~~

In certain circumstances (when using roll-up SUPERCLASS_TABLE inheritance) it is necessary to annotate a mandatory property as optional in JDO.  To force Isis to implement a mandatory check, use the @Mandatory annotation

eg:

@javax.jdo.annotations.Inheritance(strategy = InheritanceStrategy.SUPERCLASS_TABLE)
public class SomeSubclass {

    @javax.jdo.annotations.Column(allowNulls=""false"")
    @Mandatory
    public String getFoo() { ... }

"
ISIS-487,Bug,Closed,[WON'T FIX] Domain Object not validated by Isis before being sent to the database and RuntimeException handling on IsisTransactionManager,"see also ISIS-164

~~~
Experiencing the following issues:
1. Domain Object not validated by Isis before being sent to the database (executed within a BDD test; perhaps that's relevant).
2. Not sure if I could/should throw an exception on the ""onFailure()"" closure (as the Isis transaction wouldn't be aborted).
3. I would expect to be able to know the Runtime Exception that has originated the failure.



I'm executing this code from inside a BDD integration test.


I have a Domain Object that inherits from this class, which contains a required ""name"" property:

{code}
public abstract class AbstractMultiTenantEntity extends
AbstractMultiTenantObject implements MultiTenantEntity {

/**
* Name of this Entity.
*/
private String name;

@Column(allowsNull = ""false"")
@Override
@MemberOrder(sequence = ""0.1"")
public String getName() {
return this.name;
}

@Override
public void setName(final String name) {
this.name = name;
}

public String validateName(final String name) {
if (name == null) {
return ""Name cannot be an empty string"";
} else {
return null;
}
}

...
}
{code}



The Domain Object class is declared simply as:

{code}
public class Risk extends AbstractMultiTenantEntity {

...

}

{code}

I have a factory method like this one:

{code}
public Risk addQuantitativeRiskToAsset(...) {

....

// Here the ""name"" field is null.
this.persist(risk);
return risk;
}
{code}



The point is that, due to a ""programming error"", I was not initializing the ""name"" field (it was null). But this could happen also on other use cases.

But the main problem is that, when the this.persist(risk) method is executed, the INSERT SQL instruction appears in the log and a database CONSTRAINT exception requiring the NAME database table field not to be NULL appears  (so Isis has not previously validated the domain object and detected that the ""name"" property was null).



As the ""database persist"" is ""cached"", the only line appearing at the log is:


10:44:16,317  [DataNucleusSimplePersistAlgorithm main       INFO ]  persist PojoAdapter@6ac42aea[T~~:!com.xms.framework.risk.domain.model.Risk:461a09cf-c483-4779-ae58-a1840baf6a9c,specification=Risk,version=null,pojo-toString=com.xms.framework.risk.domain.model.Risk@6ee01906,pojo-hash=#6ee01906]


But on the first ""flush()"", when the persistence manager tries to insert the record the following exception is showed in the log:


-------------------------

{code}
11:12:30,643  [DataNucleusSimplePersistAlgorithm main       INFO ]  persist PojoAdapter@6d70c116[T~~:!com.xms.framework.risk.domain.model.Risk:bff8097b-72d9-40e1-b6de-aab8f5743194,specification=Risk,version=null,pojo-toString=com.xms.framework.risk.domain.model.Risk@85f4d6e2,pojo-hash=#ffffffff85f4d6e2]
11:12:30,894  [audit                main       INFO ]  2. PreparedStatement.new PreparedStatement returned 
11:12:30,894  [audit                main       INFO ]  2. Connection.prepareStatement(INSERT INTO RISK (ID,""NAME"",AUTOMATICNAMING,LIKELIHOOD,CODE,EVENT_EVENT_ID_OID,IMPACT,UPDATEDBYUSER,DESCRIPTION,CATEGORY_RISKCATEGORY_ID_OID,ASSET_ENTITY_ID_OID,EVENTDESCRIPTION,CONSEQUENCESDESCRIPTION,RISKREGISTER_RISKREGISTER_ID_OID,EVENTSOURCEDESCRIPTION,OWNER_BUSINESSACTOR_ID_OID,IMPACTLEVEL_IMPACTLEVEL_ID_OID,CREATEDBYUSER,TENANTID,EVENTSOURCE_EVENTSOURCE_ID_OID,LIKELIHOODLEVEL_LIKELIHOODLEVEL_ID_OID,DATECREATED,DATEUPDATED,RISKSLEADEDBYIT_VULNERABILITY_ID_OID,RISKSMODIFIED_CONTROL_ID_OID) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?), 1) returned net.sf.log4jdbc.PreparedStatementSpy@afe1bc5
11:12:30,894  [audit                main       INFO ]  2. PreparedStatement.clearBatch() returned 
11:12:30,894  [audit                main       INFO ]  2. PreparedStatement.setTimestamp(23, 2013-08-03 11:12:30.643, java.util.GregorianCalendar[time=1375521135947,areFieldsSet=true,areAllFieldsSet=true,lenient=true,zone=sun.util.calendar.ZoneInfo[id=""Europe/Madrid"",offset=3600000,dstSavings=3600000,useDaylight=true,transitions=165,lastRule=java.util.SimpleTimeZone[id=Europe/Madrid,offset=3600000,dstSavings=3600000,useDaylight=true,startYear=0,startMode=2,startMonth=2,startDay=-1,startDayOfWeek=1,startTime=3600000,startTimeMode=2,endMode=2,endMonth=9,endDay=-1,endDayOfWeek=1,endTime=3600000,endTimeMode=2]],firstDayOfWeek=2,minimalDaysInFirstWeek=4,ERA=1,YEAR=2013,MONTH=7,WEEK_OF_YEAR=31,WEEK_OF_MONTH=1,DAY_OF_MONTH=3,DAY_OF_YEAR=215,DAY_OF_WEEK=7,DAY_OF_WEEK_IN_MONTH=1,AM_PM=0,HOUR=11,HOUR_OF_DAY=11,MINUTE=12,SECOND=15,MILLISECOND=947,ZONE_OFFSET=3600000,DST_OFFSET=3600000]) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setTimestamp(22, 2013-08-03 11:12:30.643, java.util.GregorianCalendar[time=1375521135947,areFieldsSet=true,areAllFieldsSet=true,lenient=true,zone=sun.util.calendar.ZoneInfo[id=""Europe/Madrid"",offset=3600000,dstSavings=3600000,useDaylight=true,transitions=165,lastRule=java.util.SimpleTimeZone[id=Europe/Madrid,offset=3600000,dstSavings=3600000,useDaylight=true,startYear=0,startMode=2,startMonth=2,startDay=-1,startDayOfWeek=1,startTime=3600000,startTimeMode=2,endMode=2,endMonth=9,endDay=-1,endDayOfWeek=1,endTime=3600000,endTimeMode=2]],firstDayOfWeek=2,minimalDaysInFirstWeek=4,ERA=1,YEAR=2013,MONTH=7,WEEK_OF_YEAR=31,WEEK_OF_MONTH=1,DAY_OF_MONTH=3,DAY_OF_YEAR=215,DAY_OF_WEEK=7,DAY_OF_WEEK_IN_MONTH=1,AM_PM=0,HOUR=11,HOUR_OF_DAY=11,MINUTE=12,SECOND=15,MILLISECOND=947,ZONE_OFFSET=3600000,DST_OFFSET=3600000]) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setNull(21, -5) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setNull(20, -5) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setString(19, ""TENANT"") returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setString(18, ""tester"") returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setNull(17, -5) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setNull(16, -5) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setNull(15, 12) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setLong(14, 2) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setNull(13, 12) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setNull(12, 12) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setLong(11, 15) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setNull(10, -5) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setNull(9, 12) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setString(8, ""tester"") returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setBigDecimal(7, 1000.0) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setLong(6, 0) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setNull(5, 12) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setBigDecimal(4, 0.5) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setBoolean(3, true) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setNull(2, 12) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setString(1, ""2BB81475-3DB5-49B6-A2C2-CEECEA5B1A4B"") returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setNull(24, -5) returned 
11:12:30,895  [audit                main       INFO ]  2. PreparedStatement.setNull(25, -5) returned 
11:12:30,895  [Native               main       DEBUG]  INSERT INTO RISK (ID,""NAME"",AUTOMATICNAMING,LIKELIHOOD,CODE,EVENT_EVENT_ID_OID,IMPACT,UPDATEDBYUSER,DESCRIPTION,CATEGORY_RISKCATEGORY_ID_OID,ASSET_ENTITY_ID_OID,EVENTDESCRIPTION,CONSEQUENCESDESCRIPTION,RISKREGISTER_RISKREGISTER_ID_OID,EVENTSOURCEDESCRIPTION,OWNER_BUSINESSACTOR_ID_OID,IMPACTLEVEL_IMPACTLEVEL_ID_OID,CREATEDBYUSER,TENANTID,EVENTSOURCE_EVENTSOURCE_ID_OID,LIKELIHOODLEVEL_LIKELIHOODLEVEL_ID_OID,DATECREATED,DATEUPDATED,RISKSLEADEDBYIT_VULNERABILITY_ID_OID,RISKSMODIFIED_CONTROL_ID_OID) VALUES (<'2BB81475-3DB5-49B6-A2C2-CEECEA5B1A4B'>,<null>,<true>,<0.5>,<null>,<0>,<1000.0>,<'tester'>,<null>,<null>,<15>,<null>,<null>,<2>,<null>,<null>,<null>,<'tester'>,<'TENANT'>,<null>,<null>,<2013-08-03 11:12:30.643>,<2013-08-03 11:12:30.643>,<null>,<null>)
11:12:30,895  [Native               main       DEBUG]  INSERT INTO RISK (ID,""NAME"",AUTOMATICNAMING,LIKELIHOOD,CODE,EVENT_EVENT_ID_OID,IMPACT,UPDATEDBYUSER,DESCRIPTION,CATEGORY_RISKCATEGORY_ID_OID,ASSET_ENTITY_ID_OID,EVENTDESCRIPTION,CONSEQUENCESDESCRIPTION,RISKREGISTER_RISKREGISTER_ID_OID,EVENTSOURCEDESCRIPTION,OWNER_BUSINESSACTOR_ID_OID,IMPACTLEVEL_IMPACTLEVEL_ID_OID,CREATEDBYUSER,TENANTID,EVENTSOURCE_EVENTSOURCE_ID_OID,LIKELIHOODLEVEL_LIKELIHOODLEVEL_ID_OID,DATECREATED,DATEUPDATED,RISKSLEADEDBYIT_VULNERABILITY_ID_OID,RISKSMODIFIED_CONTROL_ID_OID) VALUES (<'2BB81475-3DB5-49B6-A2C2-CEECEA5B1A4B'>,<null>,<true>,<0.5>,<null>,<0>,<1000.0>,<'tester'>,<null>,<null>,<15>,<null>,<null>,<2>,<null>,<null>,<null>,<'tester'>,<'TENANT'>,<null>,<null>,<2013-08-03 11:12:30.643>,<2013-08-03 11:12:30.643>,<null>,<null>)
11:12:30,895  [Native               main       DEBUG]  INSERT INTO RISK (ID,""NAME"",AUTOMATICNAMING,LIKELIHOOD,CODE,EVENT_EVENT_ID_OID,IMPACT,UPDATEDBYUSER,DESCRIPTION,CATEGORY_RISKCATEGORY_ID_OID,ASSET_ENTITY_ID_OID,EVENTDESCRIPTION,CONSEQUENCESDESCRIPTION,RISKREGISTER_RISKREGISTER_ID_OID,EVENTSOURCEDESCRIPTION,OWNER_BUSINESSACTOR_ID_OID,IMPACTLEVEL_IMPACTLEVEL_ID_OID,CREATEDBYUSER,TENANTID,EVENTSOURCE_EVENTSOURCE_ID_OID,LIKELIHOODLEVEL_LIKELIHOODLEVEL_ID_OID,DATECREATED,DATEUPDATED,RISKSLEADEDBYIT_VULNERABILITY_ID_OID,RISKSMODIFIED_CONTROL_ID_OID) VALUES (<'2BB81475-3DB5-49B6-A2C2-CEECEA5B1A4B'>,<null>,<true>,<0.5>,<null>,<0>,<1000.0>,<'tester'>,<null>,<null>,<15>,<null>,<null>,<2>,<null>,<null>,<null>,<'tester'>,<'TENANT'>,<null>,<null>,<2013-08-03 11:12:30.643>,<2013-08-03 11:12:30.643>,<null>,<null>)
11:12:30,895  [sqlonly              main       INFO ]  INSERT INTO RISK (ID,""NAME"",AUTOMATICNAMING,LIKELIHOOD,CODE,EVENT_EVENT_ID_OID,IMPACT,UPDATEDBYUSER,DESCRIPTION,CATEGORY_RISKCATEGORY_ID_OID,ASSET_ENTITY_ID_OID,EVENTDESCRIPTION,CONSEQUENCESDESCRIPTION,RISKREGISTER_RISKREGISTER_ID_OID,EVENTSOURCEDESCRIPTION,OWNER_BUSINESSACTOR_ID_OID,IMPACTLEVEL_IMPACTLEVEL_ID_OID,CREATEDBYUSER,TENANTID,EVENTSOURCE_EVENTSOURCE_ID_OID,LIKELIHOODLEVEL_LIKELIHOODLEVEL_ID_OID,DATECREATED,DATEUPDATED,RISKSLEADEDBYIT_VULNERABILITY_ID_OID,RISKSMODIFIED_CONTROL_ID_OID) 
VALUES ('2BB81475-3DB5-49B6-A2C2-CEECEA5B1A4B',NULL,1,0.5,NULL,0,1000.0,'tester',NULL,NULL,15,NULL,NULL,2,NULL,NULL,NULL,'tester','TENANT',NULL,NULL,'08/03/2013 
11:12:30.643','08/03/2013 11:12:30.643',NULL,NULL) 
11:12:30,898  [audit                main       ERROR]  2. PreparedStatement.executeUpdate() INSERT INTO RISK (ID,""NAME"",AUTOMATICNAMING,LIKELIHOOD,CODE,EVENT_EVENT_ID_OID,IMPACT,UPDATEDBYUSER,DESCRIPTION,CATEGORY_RISKCATEGORY_ID_OID,ASSET_ENTITY_ID_OID,EVENTDESCRIPTION,CONSEQUENCESDESCRIPTION,RISKREGISTER_RISKREGISTER_ID_OID,EVENTSOURCEDESCRIPTION,OWNER_BUSINESSACTOR_ID_OID,IMPACTLEVEL_IMPACTLEVEL_ID_OID,CREATEDBYUSER,TENANTID,EVENTSOURCE_EVENTSOURCE_ID_OID,LIKELIHOODLEVEL_LIKELIHOODLEVEL_ID_OID,DATECREATED,DATEUPDATED,RISKSLEADEDBYIT_VULNERABILITY_ID_OID,RISKSMODIFIED_CONTROL_ID_OID) VALUES ('2BB81475-3DB5-49B6-A2C2-CEECEA5B1A4B',NULL,1,0.5,NULL,0,1000.0,'tester',NULL,NULL,15,NULL,NULL,2,NULL,NULL,NULL,'tester','TENANT',NULL,NULL,'08/03/2013 11:12:30.643','08/03/2013 11:12:30.643',NULL,NULL)
java.sql.SQLIntegrityConstraintViolationException: violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_11646 table: RISK column: ""NAME""
at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
at org.hsqldb.jdbc.JDBCPreparedStatement.fetchResult(Unknown Source)
at org.hsqldb.jdbc.JDBCPreparedStatement.executeUpdate(Unknown Source)
at net.sf.log4jdbc.PreparedStatementSpy.executeUpdate(PreparedStatementSpy.java:1022)
at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeUpdate(ParamLoggingPreparedStatement.java:399)
at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:439)
at org.datanucleus.store.rdbms.request.InsertRequest.execute(InsertRequest.java:409)
at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertTable(RDBMSPersistenceHandler.java:167)
at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertObject(RDBMSPersistenceHandler.java:143)
at org.datanucleus.state.JDOStateManager.internalMakePersistent(JDOStateManager.java:3774)
at org.datanucleus.state.JDOStateManager.makePersistent(JDOStateManager.java:3750)
at org.datanucleus.ExecutionContextImpl.persistObjectInternal(ExecutionContextImpl.java:2125)
at org.datanucleus.ExecutionContextImpl.persistObjectWork(ExecutionContextImpl.java:1973)
at org.datanucleus.ExecutionContextImpl.persistObject(ExecutionContextImpl.java:1821)
at org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.java:727)
at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistent(JDOPersistenceManager.java:752)
at org.apache.isis.objectstore.jdo.datanucleus.persistence.commands.DataNucleusCreateObjectCommand.execute(DataNucleusCreateObjectCommand.java:53)
at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.executeCommands(DataNucleusObjectStore.java:360)
at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.execute(DataNucleusObjectStore.java:354)
at org.apache.isis.core.runtime.system.transaction.IsisTransaction.doFlush(IsisTransaction.java:367)
at org.apache.isis.core.runtime.system.transaction.IsisTransaction.flush(IsisTransaction.java:333)
at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.flushTransaction(IsisTransactionManager.java:301)
at org.apache.isis.core.runtime.persistence.internal.RuntimeContextFromSession$7.flush(RuntimeContextFromSession.java:216)
at org.apache.isis.core.metamodel.services.container.DomainObjectContainerDefault.flush(DomainObjectContainerDefault.java:202)
at com.xms.framework.risk.domain.model.RiskRegister.addQuantitativeRiskToAsset(RiskRegister.java:391)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.isis.core.progmodel.facets.actions.invoke.ActionInvocationFacetViaMethod.invoke(ActionInvocationFacetViaMethod.java:94)
at org.apache.isis.core.runtime.transaction.facets.ActionInvocationFacetWrapTransaction$1.execute(ActionInvocationFacetWrapTransaction.java:55)
at org.apache.isis.core.runtime.transaction.facets.ActionInvocationFacetWrapTransaction$1.execute(ActionInvocationFacetWrapTransaction.java:52)
at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:220)
at org.apache.isis.core.runtime.transaction.facets.ActionInvocationFacetWrapTransaction.invoke(ActionInvocationFacetWrapTransaction.java:52)
at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionImpl.execute(ObjectActionImpl.java:412)
at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.handleActionMethod(DomainObjectInvocationHandler.java:509)
at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.invoke(DomainObjectInvocationHandler.java:236)
at org.apache.isis.core.wrapper.internal.InvocationHandlerMethodInterceptor.intercept(InvocationHandlerMethodInterceptor.java:37)
at com.xms.framework.risk.domain.model.RiskRegister$$EnhancerByCGLIB$$c25c4db1.addQuantitativeRiskToAsset(<generated>)
at com.xms.framework.risk.integration.glue.risk.RiskRegisterGlue.when_add_quantitative_risk_to_this_risk_register_with_asset_and_threat_event_and_likelihood_and_impact(RiskRegisterGlue.java:211)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at cucumber.runtime.Utils$1.call(Utils.java:44)
at cucumber.runtime.Timeout.timeout(Timeout.java:12)
at cucumber.runtime.Utils.invoke(Utils.java:40)
at cucumber.runtime.java.JavaStepDefinition.execute(JavaStepDefinition.java:35)
at cucumber.runtime.StepDefinitionMatch.runStep(StepDefinitionMatch.java:38)
at cucumber.runtime.Runtime.runStep(Runtime.java:271)
at cucumber.runtime.model.StepContainer.runStep(StepContainer.java:44)
at cucumber.runtime.model.StepContainer.runSteps(StepContainer.java:39)
at cucumber.runtime.model.CucumberScenario.run(CucumberScenario.java:40)
at cucumber.runtime.junit.ExecutionUnitRunner.run(ExecutionUnitRunner.java:83)
at cucumber.runtime.junit.FeatureRunner.runChild(FeatureRunner.java:63)
at cucumber.runtime.junit.FeatureRunner.runChild(FeatureRunner.java:18)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
at cucumber.runtime.junit.FeatureRunner.run(FeatureRunner.java:70)
at cucumber.api.junit.Cucumber.runChild(Cucumber.java:77)
at cucumber.api.junit.Cucumber.runChild(Cucumber.java:37)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
at cucumber.api.junit.Cucumber.run(Cucumber.java:82)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: org.hsqldb.HsqlException: violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_11646 table: RISK column: ""NAME""
at org.hsqldb.error.Error.error(Unknown Source)
at org.hsqldb.Table.enforceRowConstraints(Unknown Source)
at org.hsqldb.Table.insertSingleRow(Unknown Source)
at org.hsqldb.StatementDML.insertRowSet(Unknown Source)
at org.hsqldb.StatementInsert.getResult(Unknown Source)
at org.hsqldb.StatementDMQL.execute(Unknown Source)
at org.hsqldb.Session.executeCompiledStatement(Unknown Source)
at org.hsqldb.Session.execute(Unknown Source)
... 79 more
11:12:30,902  [sqlonly              main       ERROR]  2. PreparedStatement.executeUpdate() INSERT INTO RISK (ID,""NAME"",AUTOMATICNAMING,LIKELIHOOD,CODE,EVENT_EVENT_ID_OID,IMPACT,UPDATEDBYUSER,DESCRIPTION,CATEGORY_RISKCATEGORY_ID_OID,ASSET_ENTITY_ID_OID,EVENTDESCRIPTION,CONSEQUENCESDESCRIPTION,RISKREGISTER_RISKREGISTER_ID_OID,EVENTSOURCEDESCRIPTION,OWNER_BUSINESSACTOR_ID_OID,IMPACTLEVEL_IMPACTLEVEL_ID_OID,CREATEDBYUSER,TENANTID,EVENTSOURCE_EVENTSOURCE_ID_OID,LIKELIHOODLEVEL_LIKELIHOODLEVEL_ID_OID,DATECREATED,DATEUPDATED,RISKSLEADEDBYIT_VULNERABILITY_ID_OID,RISKSMODIFIED_CONTROL_ID_OID) VALUES ('2BB81475-3DB5-49B6-A2C2-CEECEA5B1A4B',NULL,1,0.5,NULL,0,1000.0,'tester',NULL,NULL,15,NULL,NULL,2,NULL,NULL,NULL,'tester','TENANT',NULL,NULL,'08/03/2013 11:12:30.643','08/03/2013 11:12:30.643',NULL,NULL)
java.sql.SQLIntegrityConstraintViolationException: violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_11646 table: RISK column: ""NAME""
at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
at org.hsqldb.jdbc.JDBCPreparedStatement.fetchResult(Unknown Source)
at org.hsqldb.jdbc.JDBCPreparedStatement.executeUpdate(Unknown Source)
at net.sf.log4jdbc.PreparedStatementSpy.executeUpdate(PreparedStatementSpy.java:1022)
at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeUpdate(ParamLoggingPreparedStatement.java:399)
at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:439)
at org.datanucleus.store.rdbms.request.InsertRequest.execute(InsertRequest.java:409)
at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertTable(RDBMSPersistenceHandler.java:167)
at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertObject(RDBMSPersistenceHandler.java:143)
at org.datanucleus.state.JDOStateManager.internalMakePersistent(JDOStateManager.java:3774)
at org.datanucleus.state.JDOStateManager.makePersistent(JDOStateManager.java:3750)
at org.datanucleus.ExecutionContextImpl.persistObjectInternal(ExecutionContextImpl.java:2125)
at org.datanucleus.ExecutionContextImpl.persistObjectWork(ExecutionContextImpl.java:1973)
at org.datanucleus.ExecutionContextImpl.persistObject(ExecutionContextImpl.java:1821)
at org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.java:727)
at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistent(JDOPersistenceManager.java:752)
at org.apache.isis.objectstore.jdo.datanucleus.persistence.commands.DataNucleusCreateObjectCommand.execute(DataNucleusCreateObjectCommand.java:53)
at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.executeCommands(DataNucleusObjectStore.java:360)
at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.execute(DataNucleusObjectStore.java:354)
at org.apache.isis.core.runtime.system.transaction.IsisTransaction.doFlush(IsisTransaction.java:367)
at org.apache.isis.core.runtime.system.transaction.IsisTransaction.flush(IsisTransaction.java:333)
at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.flushTransaction(IsisTransactionManager.java:301)
at org.apache.isis.core.runtime.persistence.internal.RuntimeContextFromSession$7.flush(RuntimeContextFromSession.java:216)
at org.apache.isis.core.metamodel.services.container.DomainObjectContainerDefault.flush(DomainObjectContainerDefault.java:202)
at com.xms.framework.risk.domain.model.RiskRegister.addQuantitativeRiskToAsset(RiskRegister.java:391)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.isis.core.progmodel.facets.actions.invoke.ActionInvocationFacetViaMethod.invoke(ActionInvocationFacetViaMethod.java:94)
at org.apache.isis.core.runtime.transaction.facets.ActionInvocationFacetWrapTransaction$1.execute(ActionInvocationFacetWrapTransaction.java:55)
at org.apache.isis.core.runtime.transaction.facets.ActionInvocationFacetWrapTransaction$1.execute(ActionInvocationFacetWrapTransaction.java:52)
at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:220)
at org.apache.isis.core.runtime.transaction.facets.ActionInvocationFacetWrapTransaction.invoke(ActionInvocationFacetWrapTransaction.java:52)
at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionImpl.execute(ObjectActionImpl.java:412)
at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.handleActionMethod(DomainObjectInvocationHandler.java:509)
at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.invoke(DomainObjectInvocationHandler.java:236)
at org.apache.isis.core.wrapper.internal.InvocationHandlerMethodInterceptor.intercept(InvocationHandlerMethodInterceptor.java:37)
at com.xms.framework.risk.domain.model.RiskRegister$$EnhancerByCGLIB$$c25c4db1.addQuantitativeRiskToAsset(<generated>)
at com.xms.framework.risk.integration.glue.risk.RiskRegisterGlue.when_add_quantitative_risk_to_this_risk_register_with_asset_and_threat_event_and_likelihood_and_impact(RiskRegisterGlue.java:211)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at cucumber.runtime.Utils$1.call(Utils.java:44)
at cucumber.runtime.Timeout.timeout(Timeout.java:12)
at cucumber.runtime.Utils.invoke(Utils.java:40)
at cucumber.runtime.java.JavaStepDefinition.execute(JavaStepDefinition.java:35)
at cucumber.runtime.StepDefinitionMatch.runStep(StepDefinitionMatch.java:38)
at cucumber.runtime.Runtime.runStep(Runtime.java:271)
at cucumber.runtime.model.StepContainer.runStep(StepContainer.java:44)
at cucumber.runtime.model.StepContainer.runSteps(StepContainer.java:39)
at cucumber.runtime.model.CucumberScenario.run(CucumberScenario.java:40)
at cucumber.runtime.junit.ExecutionUnitRunner.run(ExecutionUnitRunner.java:83)
at cucumber.runtime.junit.FeatureRunner.runChild(FeatureRunner.java:63)
at cucumber.runtime.junit.FeatureRunner.runChild(FeatureRunner.java:18)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
at cucumber.runtime.junit.FeatureRunner.run(FeatureRunner.java:70)
at cucumber.api.junit.Cucumber.runChild(Cucumber.java:77)
at cucumber.api.junit.Cucumber.runChild(Cucumber.java:37)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
at cucumber.api.junit.Cucumber.run(Cucumber.java:82)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: org.hsqldb.HsqlException: violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_11646 table: RISK column: ""NAME""
at org.hsqldb.error.Error.error(Unknown Source)
at org.hsqldb.Table.enforceRowConstraints(Unknown Source)
at org.hsqldb.Table.insertSingleRow(Unknown Source)
at org.hsqldb.StatementDML.insertRowSet(Unknown Source)
at org.hsqldb.StatementInsert.getResult(Unknown Source)
at org.hsqldb.StatementDMQL.execute(Unknown Source)
at org.hsqldb.Session.executeCompiledStatement(Unknown Source)
at org.hsqldb.Session.execute(Unknown Source)
... 79 more
11:12:30,902  [sqltiming            main       ERROR]  2. PreparedStatement.executeUpdate() FAILED! INSERT INTO RISK (ID,""NAME"",AUTOMATICNAMING,LIKELIHOOD,CODE,EVENT_EVENT_ID_OID,IMPACT,UPDATEDBYUSER,DESCRIPTION,CATEGORY_RISKCATEGORY_ID_OID,ASSET_ENTITY_ID_OID,EVENTDESCRIPTION,CONSEQUENCESDESCRIPTION,RISKREGISTER_RISKREGISTER_ID_OID,EVENTSOURCEDESCRIPTION,OWNER_BUSINESSACTOR_ID_OID,IMPACTLEVEL_IMPACTLEVEL_ID_OID,CREATEDBYUSER,TENANTID,EVENTSOURCE_EVENTSOURCE_ID_OID,LIKELIHOODLEVEL_LIKELIHOODLEVEL_ID_OID,DATECREATED,DATEUPDATED,RISKSLEADEDBYIT_VULNERABILITY_ID_OID,RISKSMODIFIED_CONTROL_ID_OID) VALUES ('2BB81475-3DB5-49B6-A2C2-CEECEA5B1A4B',NULL,1,0.5,NULL,0,1000.0,'tester',NULL,NULL,15,NULL,NULL,2,NULL,NULL,NULL,'tester','TENANT',NULL,NULL,'08/03/2013 11:12:30.643','08/03/2013 11:12:30.643',NULL,NULL) {FAILED after 2 msec}
java.sql.SQLIntegrityConstraintViolationException: violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_11646 table: RISK column: ""NAME""
at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
at org.hsqldb.jdbc.JDBCPreparedStatement.fetchResult(Unknown Source)
at org.hsqldb.jdbc.JDBCPreparedStatement.executeUpdate(Unknown Source)
at net.sf.log4jdbc.PreparedStatementSpy.executeUpdate(PreparedStatementSpy.java:1022)
at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)
at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeUpdate(ParamLoggingPreparedStatement.java:399)
at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:439)
at org.datanucleus.store.rdbms.request.InsertRequest.execute(InsertRequest.java:409)
at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertTable(RDBMSPersistenceHandler.java:167)
at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertObject(RDBMSPersistenceHandler.java:143)
at org.datanucleus.state.JDOStateManager.internalMakePersistent(JDOStateManager.java:3774)
at org.datanucleus.state.JDOStateManager.makePersistent(JDOStateManager.java:3750)
at org.datanucleus.ExecutionContextImpl.persistObjectInternal(ExecutionContextImpl.java:2125)
at org.datanucleus.ExecutionContextImpl.persistObjectWork(ExecutionContextImpl.java:1973)
at org.datanucleus.ExecutionContextImpl.persistObject(ExecutionContextImpl.java:1821)
at org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.java:727)
at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistent(JDOPersistenceManager.java:752)
at org.apache.isis.objectstore.jdo.datanucleus.persistence.commands.DataNucleusCreateObjectCommand.execute(DataNucleusCreateObjectCommand.java:53)
at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.executeCommands(DataNucleusObjectStore.java:360)
at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.execute(DataNucleusObjectStore.java:354)
at org.apache.isis.core.runtime.system.transaction.IsisTransaction.doFlush(IsisTransaction.java:367)
at org.apache.isis.core.runtime.system.transaction.IsisTransaction.flush(IsisTransaction.java:333)
at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.flushTransaction(IsisTransactionManager.java:301)
at org.apache.isis.core.runtime.persistence.internal.RuntimeContextFromSession$7.flush(RuntimeContextFromSession.java:216)
at org.apache.isis.core.metamodel.services.container.DomainObjectContainerDefault.flush(DomainObjectContainerDefault.java:202)
at com.xms.framework.risk.domain.model.RiskRegister.addQuantitativeRiskToAsset(RiskRegister.java:391)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.isis.core.progmodel.facets.actions.invoke.ActionInvocationFacetViaMethod.invoke(ActionInvocationFacetViaMethod.java:94)
at org.apache.isis.core.runtime.transaction.facets.ActionInvocationFacetWrapTransaction$1.execute(ActionInvocationFacetWrapTransaction.java:55)
at org.apache.isis.core.runtime.transaction.facets.ActionInvocationFacetWrapTransaction$1.execute(ActionInvocationFacetWrapTransaction.java:52)
at org.apache.isis.core.runtime.system.transaction.IsisTransactionManager.executeWithinTransaction(IsisTransactionManager.java:220)
at org.apache.isis.core.runtime.transaction.facets.ActionInvocationFacetWrapTransaction.invoke(ActionInvocationFacetWrapTransaction.java:52)
at org.apache.isis.core.metamodel.specloader.specimpl.ObjectActionImpl.execute(ObjectActionImpl.java:412)
at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.handleActionMethod(DomainObjectInvocationHandler.java:509)
at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.invoke(DomainObjectInvocationHandler.java:236)
at org.apache.isis.core.wrapper.internal.InvocationHandlerMethodInterceptor.intercept(InvocationHandlerMethodInterceptor.java:37)
at com.xms.framework.risk.domain.model.RiskRegister$$EnhancerByCGLIB$$c25c4db1.addQuantitativeRiskToAsset(<generated>)
at com.xms.framework.risk.integration.glue.risk.RiskRegisterGlue.when_add_quantitative_risk_to_this_risk_register_with_asset_and_threat_event_and_likelihood_and_impact(RiskRegisterGlue.java:211)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at cucumber.runtime.Utils$1.call(Utils.java:44)
at cucumber.runtime.Timeout.timeout(Timeout.java:12)
at cucumber.runtime.Utils.invoke(Utils.java:40)
at cucumber.runtime.java.JavaStepDefinition.execute(JavaStepDefinition.java:35)
at cucumber.runtime.StepDefinitionMatch.runStep(StepDefinitionMatch.java:38)
at cucumber.runtime.Runtime.runStep(Runtime.java:271)
at cucumber.runtime.model.StepContainer.runStep(StepContainer.java:44)
at cucumber.runtime.model.StepContainer.runSteps(StepContainer.java:39)
at cucumber.runtime.model.CucumberScenario.run(CucumberScenario.java:40)
at cucumber.runtime.junit.ExecutionUnitRunner.run(ExecutionUnitRunner.java:83)
at cucumber.runtime.junit.FeatureRunner.runChild(FeatureRunner.java:63)
at cucumber.runtime.junit.FeatureRunner.runChild(FeatureRunner.java:18)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
at cucumber.runtime.junit.FeatureRunner.run(FeatureRunner.java:70)
at cucumber.api.junit.Cucumber.runChild(Cucumber.java:77)
at cucumber.api.junit.Cucumber.runChild(Cucumber.java:37)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
at cucumber.api.junit.Cucumber.run(Cucumber.java:82)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: org.hsqldb.HsqlException: violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_11646 table: RISK column: ""NAME""
at org.hsqldb.error.Error.error(Unknown Source)
at org.hsqldb.Table.enforceRowConstraints(Unknown Source)
at org.hsqldb.Table.insertSingleRow(Unknown Source)
at org.hsqldb.StatementDML.insertRowSet(Unknown Source)
at org.hsqldb.StatementInsert.getResult(Unknown Source)
at org.hsqldb.StatementDMQL.execute(Unknown Source)
at org.hsqldb.Session.executeCompiledStatement(Unknown Source)
at org.hsqldb.Session.execute(Unknown Source)
... 79 more
11:12:30,903  [audit                main       INFO ]  2. PreparedStatement.close() returned 
11:12:30,903  [Persist              main       WARN ]  Persistencia del objeto ""com.xms.framework.risk.domain.model.Risk@1b373a71"" con SQL ""INSERT INTO RISK (ID,""NAME"",AUTOMATICNAMING,LIKELIHOOD,CODE,EVENT_EVENT_ID_OID,IMPACT,UPDATEDBYUSER,DESCRIPTION,CATEGORY_RISKCATEGORY_ID_OID,ASSET_ENTITY_ID_OID,EVENTDESCRIPTION,CONSEQUENCESDESCRIPTION,RISKREGISTER_RISKREGISTER_ID_OID,EVENTSOURCEDESCRIPTION,OWNER_BUSINESSACTOR_ID_OID,IMPACTLEVEL_IMPACTLEVEL_ID_OID,CREATEDBYUSER,TENANTID,EVENTSOURCE_EVENTSOURCE_ID_OID,LIKELIHOODLEVEL_LIKELIHOODLEVEL_ID_OID,DATECREATED,DATEUPDATED,RISKSLEADEDBYIT_VULNERABILITY_ID_OID,RISKSMODIFIED_CONTROL_ID_OID) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)"" ha tirado un error : violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_11646 table: RISK column: ""NAME""
11:12:30,903  [Persist              main       WARN ]  Persistencia del objeto ""com.xms.framework.risk.domain.model.Risk@1b373a71"" con SQL ""INSERT INTO RISK (ID,""NAME"",AUTOMATICNAMING,LIKELIHOOD,CODE,EVENT_EVENT_ID_OID,IMPACT,UPDATEDBYUSER,DESCRIPTION,CATEGORY_RISKCATEGORY_ID_OID,ASSET_ENTITY_ID_OID,EVENTDESCRIPTION,CONSEQUENCESDESCRIPTION,RISKREGISTER_RISKREGISTER_ID_OID,EVENTSOURCEDESCRIPTION,OWNER_BUSINESSACTOR_ID_OID,IMPACTLEVEL_IMPACTLEVEL_ID_OID,CREATEDBYUSER,TENANTID,EVENTSOURCE_EVENTSOURCE_ID_OID,LIKELIHOODLEVEL_LIKELIHOODLEVEL_ID_OID,DATECREATED,DATEUPDATED,RISKSLEADEDBYIT_VULNERABILITY_ID_OID,RISKSMODIFIED_CONTROL_ID_OID) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)"" ha tirado un error : violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_11646 table: RISK column: ""NAME""
11:12:30,903  [Persist              main       WARN ]  Persistencia del objeto ""com.xms.framework.risk.domain.model.Risk@1b373a71"" con SQL ""INSERT INTO RISK (ID,""NAME"",AUTOMATICNAMING,LIKELIHOOD,CODE,EVENT_EVENT_ID_OID,IMPACT,UPDATEDBYUSER,DESCRIPTION,CATEGORY_RISKCATEGORY_ID_OID,ASSET_ENTITY_ID_OID,EVENTDESCRIPTION,CONSEQUENCESDESCRIPTION,RISKREGISTER_RISKREGISTER_ID_OID,EVENTSOURCEDESCRIPTION,OWNER_BUSINESSACTOR_ID_OID,IMPACTLEVEL_IMPACTLEVEL_ID_OID,CREATEDBYUSER,TENANTID,EVENTSOURCE_EVENTSOURCE_ID_OID,LIKELIHOODLEVEL_LIKELIHOODLEVEL_ID_OID,DATECREATED,DATEUPDATED,RISKSLEADEDBYIT_VULNERABILITY_ID_OID,RISKSMODIFIED_CONTROL_ID_OID) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)"" ha tirado un error : violación del restricción de integridad: restricción ('check') NOT NULL; SYS_CT_11646 table: RISK column: ""NAME""


-------------------------

Despite that, the this.persist(risk) code is executed without throwing an exception.



The problem with the seems to be related to the current ""executeWithinTransaction()"" implementation:

public class IsisTransactionManager implements SessionScopedComponent {

  ...

  public <Q> Q executeWithinTransaction(final TransactionalClosureWithReturn<Q> closure) {
       final boolean initiallyInTransaction = inTransaction();
       if (!initiallyInTransaction) {
           startTransaction();
       }
       try {
           closure.preExecute();
           final Q retVal = closure.execute();
           closure.onSuccess();
           if (!initiallyInTransaction) {
               endTransaction();
           }
           return retVal;
       } catch (final RuntimeException ex) {
           closure.onFailure();
           if (!initiallyInTransaction) {
               abortTransaction();
           }
           throw ex;
       }
   }


As my current ""closure"" implementation does not have any code on the ""onFailure()"" method:

@Programmatic
public <S extends AbstractXMSDomainObject> List<S> findByProp(
final Class<S> clazz, final String whereClause,
final Integer firstResult, final Integer maxResults,
final String orderClause) {
return IsisContext.getTransactionManager().executeWithinTransaction(
new TransactionalClosureWithReturnAbstract<List<S>>() {

@Override
public List<S> execute() {
return AbstractXMSDomainObjectRepositoryAndFactory.this
.doFindByProp(clazz, whereClause, firstResult,
maxResults, orderClause);
}
});

}
{code}


The ""closure.onFailure()"" does nothing, and the exception is shadowed. So no exception is thrown by the ""persist()"" method.

But for this to happen,  seems to imply that the object has not been validated before sending it to the persistence manager. I understand that it should be validated by Isis before sending to the database.


So basically, I have the following problems:

1. Domain Object not validated by Isis before being sent to the database (executed within a BDD test; perhaps that's relevant).

2. Not sure if I could/should throw an exception on the ""onFailure()"" closure (as the Isis transaction wouldn't be aborted).

3. I would expect to be able to know the Runtime Exception that has originated the failure.



And I would propose the following changes to current Isis implementation: 

- It would imply to change IsisTransactionManager current implementation.
- If no code should be broken for avoiding major version update if semantic versioning is followed, a descendant of TransactionalClosureWithReturn  could be defined with a new method ""onFailureWithReason(RuntimeException runtimeException)"".
- Also, if an exception can be raised on any ""onFailureXXX()"" implementation, protect the abortTransaction(); code inside a try - finally block). 
- I don't expect that any corrective action will need a transaction. If that can be expected in other use cases, the ""onFailure()"" method could return a Boolean parameter to indicate if the Isis transaction must also be aborted and the current IsisTransactionManager should be modify in accordance.

"
ISIS-486,Improvement,Closed,Show action dialogs in a modal dialog rather than new page (less context switching for user),depends on ISIS-537
ISIS-485,Improvement,Closed,Clearer messages for validation exceptions (specially MandatoryExceptions),"Move from validation exception messages like this one:

org.apache.isis.applib.services.wrapper.InvalidException: Mandatory
	at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.toException(DomainObjectInvocationHandler.java:584)
	at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.notifyListenersAndVetoIfRequired(DomainObjectInvocationHandler.java:556)
	at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.handleActionMethod(DomainObjectInvocationHandler.java:506)
	at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.invoke(DomainObjectInvocationHandler.java:236)
	at org.apache.isis.core.wrapper.internal.InvocationHandlerMethodInterceptor.intercept(InvocationHandlerMethodInterceptor.java:37)
	at ....


To clear messages like the following one that allow to better identify the source of the validation exception:

org.apache.isis.applib.services.wrapper.InvalidException: Source: com.xms.framework.risk.domain.model.RiskRegister@2012052f. Reason: Mandatory. Identifier: com.xms.framework.risk.domain.model.RiskRegister#addQuantitativeRiskToAsset(java.lang.String,java.lang.String,com.xms.framework.architecture.domain.model.Entity,com.xms.framework.risk.domain.model.threat.Threat,java.math.BigDecimal,java.math.BigDecimal). Position: 2. Proposed: null
	at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.toException(DomainObjectInvocationHandler.java:584)
	at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.notifyListenersAndVetoIfRequired(DomainObjectInvocationHandler.java:556)
	at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.handleActionMethod(DomainObjectInvocationHandler.java:506)
	at org.apache.isis.core.wrapper.internal.DomainObjectInvocationHandler.invoke(DomainObjectInvocationHandler.java:236)
	at org.apache.isis.core.wrapper.internal.InvocationHandlerMethodInterceptor.intercept(InvocationHandlerMethodInterceptor.java:37)
	at ...


}"
ISIS-484,New Feature,Closed,Contract test for ensuring that injectXxx methods are final and not overridable,To avoid potential null pointer exceptions if an injectXxx is accidentally overridden in a subclass.
ISIS-483,Bug,Closed,[WON'T FIX] Not properly recognizing Collections of generics as Action return type,"Create a repository that inherits from a ""generic"" one, which implements a ""generic"" function like this:


{code}
public abstract class MyAbstractDomainObjectRepositoryAndFactory<DO extends MyAbstractDomainObject>
		extends AbstractFactoryAndRepository {

	public List<DO> listAll() {
		return this.allInstances(this.domainObjectClass);
	}

	...
}
{code}

Create a concrete implementation of the previous repository like this one, which introduces a new action/method:

{code}
public class DomainEntityClassCustomRepository extends
		AbstractMultiTenantEntityRepositoryAndFactory<DomainEntityClass> {

	...

	public List<RiskRegister> listAllRiskRegisters() {
		return this.listAll();
	}
	...
}
{code}


And:
DomainEntityClass inherits from MyAbstractDomainObject.


If the ""listAllRiskRegisters"" action is invoked from the Wicket viewer it works perfectly, and a list of DomainEntityClass'es is shown.

And if the list only contains 1 element, the ""listAll"" action also shows that element.

But if the ""listAll"" action is invoked and the list contains more than 1 element the following exception is thrown:

{code}
org.apache.wicket.WicketRuntimeException
Can't instantiate page using constructor 'public org.apache.isis.viewer.wicket.ui.pages.action.ActionPage(org.apache.wicket.request.mapper.parameter.PageParameters)' and argument 'pageType=[ACTION], actionSingleResultsMode=[REDIRECT], objectOid=[com.company.DomainEntityClassCustomRepository:1], actionType=[USER], actionOwningSpec=[com.company.DomainEntityClassCustomRepository], actionId=[listAll()], pageTitle=[List All], actionMode=[RESULTS]'. Might be it doesn't exist, may be it is not visible (public).
org.apache.wicket.session.DefaultPageFactory#newPage(DefaultPageFactory.java:193)
org.apache.wicket.session.DefaultPageFactory#newPage(DefaultPageFactory.java:98)
org.apache.wicket.DefaultMapperContext#newPageInstance(DefaultMapperContext.java:137)
org.apache.wicket.core.request.handler.PageProvider#resolvePageInstance(PageProvider.java:268)
org.apache.wicket.core.request.handler.PageProvider#getPageInstance(PageProvider.java:166)
org.apache.wicket.request.handler.render.PageRenderer#getPage(PageRenderer.java:78)
org.apache.wicket.request.handler.render.WebPageRenderer#renderPage(WebPageRenderer.java:94)
org.apache.wicket.request.handler.render.WebPageRenderer#respond(WebPageRenderer.java:196)
org.apache.wicket.core.request.handler.RenderPageRequestHandler#respond(RenderPageRequestHandler.java:165)
org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:854)
org.apache.wicket.request.RequestHandlerStack#execute(RequestHandlerStack.java:64)
org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:254)
org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:211)
org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:282)
org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:259)
org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:201)
org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:282)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1326)
org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1326)
org.eclipse.jetty.servlet.ServletHandler#doHandle(ServletHandler.java:479)
org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:119)
org.eclipse.jetty.security.SecurityHandler#handle(SecurityHandler.java:520)
org.eclipse.jetty.server.session.SessionHandler#doHandle(SessionHandler.java:227)
org.eclipse.jetty.server.handler.ContextHandler#doHandle(ContextHandler.java:940)
org.eclipse.jetty.servlet.ServletHandler#doScope(ServletHandler.java:409)
org.eclipse.jetty.server.session.SessionHandler#doScope(SessionHandler.java:186)
org.eclipse.jetty.server.handler.ContextHandler#doScope(ContextHandler.java:874)
org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:117)
org.eclipse.jetty.server.handler.ContextHandlerCollection#handle(ContextHandlerCollection.java:250)
org.eclipse.jetty.server.handler.HandlerCollection#handle(HandlerCollection.java:149)
org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:110)
org.eclipse.jetty.server.Server#handle(Server.java:349)
org.eclipse.jetty.server.HttpConnection#handleRequest(HttpConnection.java:441)
org.eclipse.jetty.server.HttpConnection$RequestHandler#headerComplete(HttpConnection.java:904)
org.eclipse.jetty.http.HttpParser#parseNext(HttpParser.java:565)
org.eclipse.jetty.http.HttpParser#parseAvailable(HttpParser.java:217)
org.eclipse.jetty.server.AsyncHttpConnection#handle(AsyncHttpConnection.java:46)
org.eclipse.jetty.io.nio.SelectChannelEndPoint#handle(SelectChannelEndPoint.java:545)
org.eclipse.jetty.io.nio.SelectChannelEndPoint$1#run(SelectChannelEndPoint.java:43)
org.eclipse.jetty.util.thread.QueuedThreadPool#runJob(QueuedThreadPool.java:598)
org.eclipse.jetty.util.thread.QueuedThreadPool$3#run(QueuedThreadPool.java:533)
java.lang.Thread#run(Thread.java:680)
java.lang.reflect.InvocationTargetException
sun.reflect.NativeConstructorAccessorImpl#newInstance0(NativeConstructorAccessorImpl.java:-2)
sun.reflect.NativeConstructorAccessorImpl#newInstance(NativeConstructorAccessorImpl.java:39)
sun.reflect.DelegatingConstructorAccessorImpl#newInstance(DelegatingConstructorAccessorImpl.java:27)
java.lang.reflect.Constructor#newInstance(Constructor.java:513)
org.apache.wicket.session.DefaultPageFactory#newPage(DefaultPageFactory.java:170)
org.apache.wicket.session.DefaultPageFactory#newPage(DefaultPageFactory.java:98)
org.apache.wicket.DefaultMapperContext#newPageInstance(DefaultMapperContext.java:137)
org.apache.wicket.core.request.handler.PageProvider#resolvePageInstance(PageProvider.java:268)
org.apache.wicket.core.request.handler.PageProvider#getPageInstance(PageProvider.java:166)
org.apache.wicket.request.handler.render.PageRenderer#getPage(PageRenderer.java:78)
org.apache.wicket.request.handler.render.WebPageRenderer#renderPage(WebPageRenderer.java:94)
org.apache.wicket.request.handler.render.WebPageRenderer#respond(WebPageRenderer.java:196)
org.apache.wicket.core.request.handler.RenderPageRequestHandler#respond(RenderPageRequestHandler.java:165)
org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:854)
org.apache.wicket.request.RequestHandlerStack#execute(RequestHandlerStack.java:64)
org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:254)
org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:211)
org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:282)
org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:259)
org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:201)
org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:282)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1326)
org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1326)
org.eclipse.jetty.servlet.ServletHandler#doHandle(ServletHandler.java:479)
org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:119)
org.eclipse.jetty.security.SecurityHandler#handle(SecurityHandler.java:520)
org.eclipse.jetty.server.session.SessionHandler#doHandle(SessionHandler.java:227)
org.eclipse.jetty.server.handler.ContextHandler#doHandle(ContextHandler.java:940)
org.eclipse.jetty.servlet.ServletHandler#doScope(ServletHandler.java:409)
org.eclipse.jetty.server.session.SessionHandler#doScope(SessionHandler.java:186)
org.eclipse.jetty.server.handler.ContextHandler#doScope(ContextHandler.java:874)
org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:117)
org.eclipse.jetty.server.handler.ContextHandlerCollection#handle(ContextHandlerCollection.java:250)
org.eclipse.jetty.server.handler.HandlerCollection#handle(HandlerCollection.java:149)
org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:110)
org.eclipse.jetty.server.Server#handle(Server.java:349)
org.eclipse.jetty.server.HttpConnection#handleRequest(HttpConnection.java:441)
org.eclipse.jetty.server.HttpConnection$RequestHandler#headerComplete(HttpConnection.java:904)
org.eclipse.jetty.http.HttpParser#parseNext(HttpParser.java:565)
org.eclipse.jetty.http.HttpParser#parseAvailable(HttpParser.java:217)
org.eclipse.jetty.server.AsyncHttpConnection#handle(AsyncHttpConnection.java:46)
org.eclipse.jetty.io.nio.SelectChannelEndPoint#handle(SelectChannelEndPoint.java:545)
org.eclipse.jetty.io.nio.SelectChannelEndPoint$1#run(SelectChannelEndPoint.java:43)
org.eclipse.jetty.util.thread.QueuedThreadPool#runJob(QueuedThreadPool.java:598)
org.eclipse.jetty.util.thread.QueuedThreadPool$3#run(QueuedThreadPool.java:533)
java.lang.Thread#run(Thread.java:680)

java.lang.NullPointerException
org.apache.isis.viewer.wicket.model.models.EntityCollectionModel#createStandalone(EntityCollectionModel.java:152)
org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel$ResultType$2#addOrReplaceCollectionResultsPanel(ActionPanel.java:361)
org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel$ResultType$2#addResults(ActionPanel.java:357)
org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel#executeActionOnTargetAndProcessResults(ActionPanel.java:186)
org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel#executeActionAndProcessResults(ActionPanel.java:138)
org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel#buildGui(ActionPanel.java:96)
org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel#<init>(ActionPanel.java:89)
org.apache.isis.viewer.wicket.ui.components.actions.ActionPanelFactory#createComponent(ActionPanelFactory.java:49)
org.apache.isis.viewer.wicket.ui.ComponentFactoryAbstract#createComponent(ComponentFactoryAbstract.java:82)
org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault#createComponent(ComponentFactoryRegistryDefault.java:120)
org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault#addOrReplaceComponent(ComponentFactoryRegistryDefault.java:105)
org.apache.isis.viewer.wicket.ui.pages.PageAbstract#addComponent(PageAbstract.java:266)
org.apache.isis.viewer.wicket.ui.pages.PageAbstract#addChildComponents(PageAbstract.java:261)
org.apache.isis.viewer.wicket.ui.pages.action.ActionPage#<init>(ActionPage.java:54)
sun.reflect.NativeConstructorAccessorImpl#newInstance0(NativeConstructorAccessorImpl.java:-2)
sun.reflect.NativeConstructorAccessorImpl#newInstance(NativeConstructorAccessorImpl.java:39)
sun.reflect.DelegatingConstructorAccessorImpl#newInstance(DelegatingConstructorAccessorImpl.java:27)
java.lang.reflect.Constructor#newInstance(Constructor.java:513)
org.apache.wicket.session.DefaultPageFactory#newPage(DefaultPageFactory.java:170)
org.apache.wicket.session.DefaultPageFactory#newPage(DefaultPageFactory.java:98)
org.apache.wicket.DefaultMapperContext#newPageInstance(DefaultMapperContext.java:137)
org.apache.wicket.core.request.handler.PageProvider#resolvePageInstance(PageProvider.java:268)
org.apache.wicket.core.request.handler.PageProvider#getPageInstance(PageProvider.java:166)
org.apache.wicket.request.handler.render.PageRenderer#getPage(PageRenderer.java:78)
org.apache.wicket.request.handler.render.WebPageRenderer#renderPage(WebPageRenderer.java:94)
org.apache.wicket.request.handler.render.WebPageRenderer#respond(WebPageRenderer.java:196)
org.apache.wicket.core.request.handler.RenderPageRequestHandler#respond(RenderPageRequestHandler.java:165)
org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor#respond(RequestCycle.java:854)
org.apache.wicket.request.RequestHandlerStack#execute(RequestHandlerStack.java:64)
org.apache.wicket.request.cycle.RequestCycle#execute(RequestCycle.java:254)
org.apache.wicket.request.cycle.RequestCycle#processRequest(RequestCycle.java:211)
org.apache.wicket.request.cycle.RequestCycle#processRequestAndDetach(RequestCycle.java:282)
org.apache.wicket.protocol.http.WicketFilter#processRequestCycle(WicketFilter.java:259)
org.apache.wicket.protocol.http.WicketFilter#processRequest(WicketFilter.java:201)
org.apache.wicket.protocol.http.WicketFilter#doFilter(WicketFilter.java:282)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1326)
org.apache.shiro.web.servlet.AbstractShiroFilter#executeChain(AbstractShiroFilter.java:449)
org.apache.shiro.web.servlet.AbstractShiroFilter$1#call(AbstractShiroFilter.java:365)
org.apache.shiro.subject.support.SubjectCallable#doCall(SubjectCallable.java:90)
org.apache.shiro.subject.support.SubjectCallable#call(SubjectCallable.java:83)
org.apache.shiro.subject.support.DelegatingSubject#execute(DelegatingSubject.java:383)
org.apache.shiro.web.servlet.AbstractShiroFilter#doFilterInternal(AbstractShiroFilter.java:362)
org.apache.shiro.web.servlet.OncePerRequestFilter#doFilter(OncePerRequestFilter.java:125)
org.eclipse.jetty.servlet.ServletHandler$CachedChain#doFilter(ServletHandler.java:1326)
org.eclipse.jetty.servlet.ServletHandler#doHandle(ServletHandler.java:479)
org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:119)
org.eclipse.jetty.security.SecurityHandler#handle(SecurityHandler.java:520)
org.eclipse.jetty.server.session.SessionHandler#doHandle(SessionHandler.java:227)
org.eclipse.jetty.server.handler.ContextHandler#doHandle(ContextHandler.java:940)
org.eclipse.jetty.servlet.ServletHandler#doScope(ServletHandler.java:409)
org.eclipse.jetty.server.session.SessionHandler#doScope(SessionHandler.java:186)
org.eclipse.jetty.server.handler.ContextHandler#doScope(ContextHandler.java:874)
org.eclipse.jetty.server.handler.ScopedHandler#handle(ScopedHandler.java:117)
org.eclipse.jetty.server.handler.ContextHandlerCollection#handle(ContextHandlerCollection.java:250)
org.eclipse.jetty.server.handler.HandlerCollection#handle(HandlerCollection.java:149)
org.eclipse.jetty.server.handler.HandlerWrapper#handle(HandlerWrapper.java:110)
org.eclipse.jetty.server.Server#handle(Server.java:349)
org.eclipse.jetty.server.HttpConnection#handleRequest(HttpConnection.java:441)
org.eclipse.jetty.server.HttpConnection$RequestHandler#headerComplete(HttpConnection.java:904)
org.eclipse.jetty.http.HttpParser#parseNext(HttpParser.java:565)
org.eclipse.jetty.http.HttpParser#parseAvailable(HttpParser.java:217)
org.eclipse.jetty.server.AsyncHttpConnection#handle(AsyncHttpConnection.java:46)
org.eclipse.jetty.io.nio.SelectChannelEndPoint#handle(SelectChannelEndPoint.java:545)
org.eclipse.jetty.io.nio.SelectChannelEndPoint$1#run(SelectChannelEndPoint.java:43)
org.eclipse.jetty.util.thread.QueuedThreadPool#runJob(QueuedThreadPool.java:598)
org.eclipse.jetty.util.thread.QueuedThreadPool$3#run(QueuedThreadPool.java:533)
java.lang.Thread#run(Thread.java:680)
{code}



So it seems that Isis is not properly recognizing the type enclosed on the List represented by <DO>."
ISIS-482,Improvement,Closed,"Allow as ""choices"" return type any descendant of ""Collection""","Current implementation only allows to return a List with the choices for a given property, action or action parameter.

It should be improved to allow to return any descendant of java.util.Collection.

All these cases should be valid:

         class Customer {
             @SuppressWarnings(""unused"")
            public void someAction(final int x, final long y, final long z) {
            }
 
             @SuppressWarnings(""unused"")
            public Collection<Integer> choices0SomeAction() {
                 return Collections.emptyList();
             }
 
             @SuppressWarnings(""unused"")
             public List<Long> choices1SomeAction() {
                 return Collections.emptyList();
             }

            @SuppressWarnings(""unused"")
            public Set<Long> choices2SomeAction() {
                return Collections.emptySet();
            }
         }

"
ISIS-481,Bug,Closed,Quickstart RO viewer - some links are broken,"Couple of links of Quickstart RO viewer seems to be broken.

http://localhost:8080/restful/objects/TODO/L_11/properties/category
http://localhost:8080/restful/objects/TODO/L_11/collections/similarItems"
ISIS-480,Improvement,Closed,"With the new multiple columns for properties, should only be a single edit form, and should also allow collections to ""overflow"" underneath property columns if need be.",as it says on the tin...
ISIS-479,Bug,Closed,Properties not getting updated as per 14.2 in RO Spec," As per 14.2 in RO Spec, making a PUT request to /objects/{domainType}/{instanceId}, should update the properties values. I tried several different formats for the body [1], [2], [3], but got the same error in each case [4].

[1] this - which is valid according to the spec, I think - didn't work:
{
    ""cost"" : {
      ""value"" : 2.75
    },
    ""description"" : {
      ""value"" : ""An updated description""
    },
    ""category"" : {
      ""value"" : ""Professional""
    }
}

[2] nor did this:
{
  ""members:"" {
    ""cost"" : {
      ""memberType"": ""property"",
      ""value"" : 2.75
    },
    ""description"" : {
      ""memberType"": ""property"",
      ""value"" : ""An updated description""
    },
    ""category"" : {
      ""memberType"": ""property"",
      ""value"" : ""Professional""
    }
  }
}


[3] nor did this:
{
    ""cost"" : {
      ""memberType"": ""property"",
      ""value"" : 2.75
    },
    ""description"" : {
      ""memberType"": ""property"",
      ""value"" : ""An updated description""
    },
    ""category"" : {
      ""memberType"": ""property"",
      ""value"" : ""Professional""
    }
}


[4]Status Code: 400
Server: Jetty(6.1.26)
Content-Length: 0
Warning: 199 RestfulObjects Could not find properties list (no members[memberType=property]); got {""cost"":{""memberType"":""property"",""value"":2.75},""description"":{""memberType"":""property"",""value"":""An updated description""},""category"":{""memberType"":""property"",""value"":""Professional""}}
Content-Type: application/json"
ISIS-478,New Feature,Closed,"Provide conditional choices, defaults and validation between action parameters","For example, suppose there is an action to specify an address, where we specify the country, the state and the postcode.  We want the state to have choices and a default dependent on the country, and we want the postcode to be validated according to the rules of that country.

public Address enterAddress(Country c, State st, @Named(""Postcode"") String postcode) { ... }

Any dependent parameter must supply a param-specific validate [this is a new method prefix]:

public String validate1EnterAddress(Country c, State st, String postcode) {  ... }
public String validate2EnterAddress(Country c, State st, String postcode) {  ... }

The choices and defaults for State also accept all param types preceding:

public List<State> choices1EnterAddress(Country c) { ... }
public State default1EnterAddress(Country c) { ... }

When the user enters a value for the country, this is passed to these methods.  If the user tabs directly to the State param without entering the country, then these would return empty lists/value.

If the user enters a value for the country, then corresponding entries for the state and postcode, and then tabs back to the country and enters a different value, then the validateNXxx methods are called (for all N > 0, country being param 0).  If the validate methods indicate their current value is invalid, then the values are set to null or to the recomputed default (if a default method is available)."
ISIS-477,Task,Closed,Update JDO/DataNucleus objectstore to DN 3.2.6 and other latest dependencies,"NB:    [ http://issues.datanucleus.org/browse/NUCCORE-1037?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=21144#action_21144 ]

Andy Jefferson commented on NUCCORE-1037:
-----------------------------------------

Note that in datanucleus-core 3.2.6 RDBMS will default to using ReferentialJDOStateManager and non-RDBMS datastores will default to using JDOStateManager as per NUCCORE-675, so if you have extended an existing DN StateManager you may need to update this
"
ISIS-476,Bug,Closed,Update JDO/DN to allow for fact that invoking the Persisting callback may have resulted in the target object having already been updated.,"This issue was found while working on Estatio app:

public class CommunicationChannel {

    ....

    /**
     * Isis callback
     */
    public void persisting() {
        owner.addToCommunicationChannels(this);
    }
}

correctly generates the INSERT of the owner/CC tuple (eg into PARTY_COMMUNICATIONCHANNELS), but then Isis throws an exception.

The fix is to add a guard in DataNucleusSimplePersistAlgorithm:

    public void makePersistent(final ObjectAdapter adapter,
            final ToPersistObjectSet toPersistObjectSet) {
        ...
        CallbackUtils.callCallback(adapter, PersistingCallbackFacet.class);
        // the callback might have caused the adapter to become persistent.
        if (alreadyPersistedOrNotPersistable(adapter)) {
            return;
        }
        ...
    }

"
ISIS-475,New Feature,Closed,"Dynamic layout using JSON, using an Xxx.layout.json file","Load layout metadata from a .layout.json file (this is a successor to ISIS-469)

Also allow this .layout.json file to be downloaded (using DeveloperUtilitiesService), either for an individual class, or a zip of all the classes in the metamodel

Dynamically reload metadata; log any errors if does not parse etc.

~~~

The format of the Xxx.layout.json file (eg for ToDoItem example class) is:

{
    columns: [
    {
        span: 3,
        memberGroups: {
            General: {
                members: {
                    description: {},
                    category: {},
                    complete: {
                        actions: {
                            completed: {},
                            notYetCompleted: {}
                        }
                    }
                }
            },
            Misc: {
                members: {
                    versionSequence: {}
                }
            }
        }
    },
    {
        span: 4,
        memberGroups: {
            Detail: {
                members: {
                    dueBy: {},
                    cost: {
                        actions: {
                            updateCost:{}
                        }
                    },
                    notes: {},
                    attachment: {}
                }
            }
        }
    },
    {
        span: 0
    },
    {
        span: 5,
        collections: {
            dependencies: {
                actions: {
                    add:{},
                    delete: {}
                }
            },
            similarItems: {}
        }
    }
    ],
    actions: {
        delete: {},
        duplicate: {}
    }
}


~~~~~~~~~~~~~~~~~~~~
"
ISIS-474,Improvement,Closed,hide operation in the sevice menu that are not invoke-able due to user role permission mapping.,"The current behaviour displays an operation in the service menu even though the user does not have permission to invoke. While it is ""greyed"" and is not able to be invoked it can still cause confusion for users. If the users don't have the permission via their security mappings and role-permission mappings to invoke an operation it would be preferable to not display it."
ISIS-473,Improvement,Closed,"Allow operations to individually be specified for ""@bookmarkable"" behaviour.",The bookmarks tab gets filled up quickly with operations from an object that is marked as @bookmarkable. It would be better to have finer grained control over which operations (if any) are bookmarked. Maybe it is easier to overide the existing behaviour by a @bookmarkable parameter for an operation that effectively prevents the operation from becoming bookmarked.
ISIS-472,New Feature,Closed,Limit number of bookmarks,"Ability to limit the number of bookmarks. First in, first out when the limit is reached. If the user has ""pinned"" the bookmark then this remains at the top of the panel and is not removed until the user removes it or the users session is ended."
ISIS-471,New Feature,Closed,[WON'T FIX] Pinnable (for session) bookmarks,"Ability to ""pin"" a bookmark for the duration of the user session or until the user clears the bookmark."
ISIS-470,New Feature,Closed,"Provide the ability to rebuild the metamodel for individual classes, thus allowing dynamic layout capability...",... when used in conjunction with ISIS-469.
ISIS-469,New Feature,Closed,"Provide implementations of certain layout facets that read from a ""Xxx.layout.properties"" file","Specifically, the two layout facets to capture are MemberOrderFacet and MemberGroupLayoutFacet (see ISIS-468).

The idea of this ticket is that information is pulled in from a separate file, sitting alongside the domain class.  This makes it easier to see this layout information in one place.

And, in conjunction with ISIS-470, this would allow dynamic updates to the layout, without a recompile/redeploy.

This ticket defines the metadata informatino in an Xxx.layout.properties file.  (Note that  ISIS-475 takes this idea further and specifies a JSON file.  This latter idea is probably to be preferred in most cases).

The format of the property file (Xxx.layout.properties) is:

###########################################
# MemberGroupLayout
###########################################

memberGroupLayout.columnSpans=3,4,0,5
memberGroupLayout.left=General 
memberGroupLayout.middle=Detail
memberGroupLayout.right=


###########################################
# MemberOrder
###########################################

# Properties 
memberOrder.description.sequence=1
memberOrder.category.sequence=2
memberOrder.complete.sequence=3

# Properties (Detail)
memberOrder.dueBy.name=Detail
memberOrder.cost.name=Detail
memberOrder.notes.name=Detail
memberOrder.attachment.name=Detail

memberOrder.dueBy.sequence=1
memberOrder.cost.sequence=2
memberOrder.notes.sequence=3
memberOrder.attachment.sequence=4

# Properties (Misc)
memberOrder.versionSequence.name=Misc
memberOrder.versionSequence.sequence=99


#Collections
memberOrder.dependencies.sequence=1
memberOrder.similarItems.sequence=2


#Actions (freestanding)
memberOrder.delete.sequence=1
memberOrder.duplicate.sequence=2


#Actions (associated with properties)
memberOrder.completed.name=complete
memberOrder.notYetCompleted.name=complete

memberOrder.completed.sequence=1
memberOrder.notYetCompleted.sequence=2

memberOrder.updateCost.name=cost

#Actions (associated with collections)
memberOrder.add.name=dependencies

memberOrder.remove.name=dependencies
"
ISIS-468,New Feature,Closed,Provide better layout management of pages in the Wicket viewer.,"In the Wicket viewer, it can be difficult to distinguish different types of entities, moreover for some entities (with more properties than collections) there is a lot of real-estate wasted.

This ticket is to provide the ability for laying the properties out over up to three columns, and optionally suppressing the collections column.

Moreover it should be able to specify the relative width of those columns, and, ideally, the website should be responsive.

~~~
In the applib, introduce a new @MemberGroupLayout annotation, replacing the current @MemberGroups annotation, allowing this information to be specified, eg:


@MemberGroupLayout(
   columnSpans={3,3,0,6},
   left={""General"", ""Dates""}
   middle={""Notes""}
}

would place the properties in two columns taking up half the page, and collections (fourth column) to the far right. taking up the remaining 50%.

eg:

@MemberGroupLayout(
   columnSpans={4,4,4,0},
   left={""General"", ""Dates""}
   middle={""Notes""},
   right={""Other""}
}

would suppress the collections.

"
ISIS-467,Bug,Closed,timezone difference issue in date test in org.apache.isis.objectstore.sql.HsqlTest,"Test set: org.apache.isis.objectstore.sql.HsqlTest
-------------------------------------------------------------------------------
Tests run: 2, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 3.667 sec <<< FAILURE!
testTestAll(org.apache.isis.objectstore.sql.HsqlTest)  Time elapsed: 0.752 sec  <<< FAILURE!
java.lang.AssertionError: Applib date: Test '2010-3-5', expected 2010-03-05, but got 2010-03-06. Check log for more info.
	at org.junit.Assert.fail(Assert.java:88)
"
ISIS-466,Improvement,Closed,Simplify todo quickstart app.,"Remove objectstore-jdo module, move ToDoItemsJdo into dom package

Use FixtureInstallerDelegate to install fixtures (ISIS-465) ... means moving location of service.

Demonstrate use of @CssClass (ISIS-457)


"
ISIS-465,Improvement,Closed,Provide the ability to reuse FixtureInstallerDelegate to install demo fixtures (in running application).,"The API for fixtures is a bit counter-intuitive, but is at least ""understood"" by FixtureInstallerDelegate.  However, this installer class was originally designed only for the installation of fixtures during bootup, and won't allow fixtures to be installed after that (eg demo fixtures in a running application).

This ticket is simply to furnish the installer with an ""override"" flag so that it will always install the specified fixture(s)."
ISIS-464,Bug,Closed,Some trivial cleanup,
ISIS-463,New Feature,Closed,"Enhance unittestsupport and integtestsupport to enable Cucumber-JVM specs to be written (at  unit- or integration-scope, respectively)","Provide the concept of a ScenarioExecution... to provide access to domainservices and ""enlisted"" objects; applicable to both unit- and integration-scoped specs/step definitions.

Extend to be ScenarioExecutionForIntegration... for integration-scoped specs, but also for reuse by integration tests (access to domain services in particular are important here).

Also provide @XStreamConverters for built-in value types, for step definitions.

~~~

As result of this, should also retire the BDD viewer, update the site accordingly, and remove the BDD/JUnit example.

Should also update to the example/application to use this capability."
ISIS-462,Improvement,Closed,Improve ValueTypeContractTestAbstract to also test for value types that implement Comparable.,"Although not required, it is highly advisable that if two objects a and b are equal (a.equals(b) == true), then if their type implements Comparable then a.compareTo(b) == 0.

Conversely, if a.equals(b) == false, then a.compareTo(b) != 0, and a.compareTo(b) = -b.compareTo(a)"
ISIS-461,New Feature,Closed,Provide the ability to run arbitrary fixtures (implementing the applib's InstallableFixture) in integration tests ,"The InstallableFixture implementations can use an injected IsisJdoSupport to run arbitrary SQL, eg to truncate tables/delete objects.  They can then setup new data.

This follows on from ISIS-459 and ISIS-460."
ISIS-460,Improvement,Closed,JDO objectstore should sync adapters on bulk delete.,"Following on from ISIS-459, deleting directly through JDO can cause Isis's internal adapters to get out of whack.  Use the listeners and FrameworkSynchronizer to keep things in sync."
ISIS-459,New Feature,Closed,"Enhance IsisJdoSupport service to support integration testing (execute arbitrary SQL, delete all instances of an entity)",
ISIS-458,Improvement,Closed,Allow services to be rendered in a different order than listed in isis.properties.,"Currently services are rendered (eg in the Wicket viewer) in the order that they are listed in isis.properties.  A developer might want to list services in some other fashion, eg alphabetically, in order to ensure that all are present.

This ticket is to allow a numeric hint to be associated with each service; if present then is used to reorder the services as loaded into Isis.

For example:

isis.services = 94:org.estatio.api.Api, \
                20:org.estatio.dom.agreement.Agreements, \
                20:org.estatio.dom.agreement.AgreementRoles, \
                20:org.estatio.dom.agreement.AgreementRoleCommunicationChannels, \
                20:org.estatio.dom.agreement.AgreementRoleCommunicationChannelTypes, \
                20:org.estatio.dom.agreement.AgreementTypes, \
                20:org.estatio.dom.agreement.AgreementRoleTypes, \
                10:org.estatio.dom.asset.FixedAssets, \
                10:org.estatio.dom.asset.FixedAssetRoles, \
                10:org.estatio.dom.asset.Properties, \
                70:org.estatio.dom.charge.Charges, \
                70:org.estatio.dom.charge.ChargeGroups, \
                50:org.estatio.dom.communicationchannel.CommunicationChannels, \
                50:org.estatio.dom.communicationchannel.PostalAddresses, \
                70:org.estatio.dom.currency.Currencies, \
                30:org.estatio.dom.financial.FinancialAccounts, \
                30:org.estatio.dom.financial.BankMandates, \
                30:org.estatio.dom.financial.contributed.FinancialAccountContributedActions, \
                70:org.estatio.dom.geography.Countries, \
                70:org.estatio.dom.geography.States, \
                40:org.estatio.dom.invoice.Invoices, \
                45:org.estatio.dom.index.Indices, \
                45:org.estatio.dom.index.IndexBases, \
                45:org.estatio.dom.index.IndexValues, \
                30:org.estatio.dom.lease.Leases, \
                30:org.estatio.dom.lease.LeaseItems, \
                30:org.estatio.dom.lease.LeaseTerms, \
                30:org.estatio.dom.lease.LeaseUnits, \
                10:org.estatio.dom.lease.UnitsForLease, \
                40:org.estatio.dom.lease.invoicing.InvoiceItemsForLease, \
                40:org.estatio.dom.lease.invoicing.InvoiceCalculationService,\
                70:org.estatio.dom.numerator.Numerators, \
                15:org.estatio.dom.party.Parties, \
                15:org.estatio.dom.party.Persons, \
                15:org.estatio.dom.party.Organisations, \
                70:org.estatio.dom.tag.Tags, \
                70:org.estatio.dom.tax.Taxes, \
                70:org.estatio.dom.tax.TaxRates, \
                99:org.estatio.services.settings.EstatioSettingsServiceJdo,\
                99:org.estatio.services.settings.ApplicationSettingsServiceForEstatio,\
                82:org.estatio.services.settings.UserSettingsServiceForEstatio,\
                82:org.estatio.services.audit.AuditingServiceForEstatio, \
                92:org.estatio.services.publish.PublishingServiceForEstatio,\
                99:org.estatio.services.bookmarks.BookmarkServiceForEstatio, \
                99:org.estatio.services.clock.ClockService, \
"
ISIS-457,New Feature,Closed,"New annotation @CssClass for class member, should render in the HTML markup for that member.","for example:

@CssClass(""lock"")
public void lock() { ... }"
ISIS-456,Improvement,Closed,ResourceServlet should set the contentType for common file types.,
ISIS-455,Improvement,Closed,"In Wicket viewer, the links (rendered as buttons) for actions should include the identifier of the action, so that they can be targetted for application-specific CSS.","For example, the action ""unlock"" on the entity ""Lease"" should have a CSS class ""Lease-unlock""."
ISIS-454,New Feature,Closed,"New mechanism to disable members ""globally"".  However, any disablement rules applied on the member should overrule the policy defined on the type.","If done using a method, this would be something like:

public String disable(String memberName, MemberType memberType) {
    if(memberName.equals(""notes"")) { return null; }
    if(memberType == MemberType.PROPERTY) {
         WithStatus ws = (WithStatus)domainObject;
         return ws.isLocked()? ""cannot modify because locked"": null;
     }
    return null;
}


If done using an annotation, this would be something like:

@Disabled(policy=StateIsLockedPolicy.class)
public abstract class MyDomainObject<T extends EstatioDomainObject<T>, S extends Lockable> extends MyDomainObject<T> implements WithStatus<T,S> {

    public static StateIsLockedPolicy implements DisabledPolicy {
        public String disable(Object domainObject, String memberName, MemberType memberType) {
            if(memberName.equals(""notes"")) { return null; }
            if(memberType == MemberType.PROPERTY) {
                WithStatus ws = (WithStatus)domainObject;
                return ws.isLocked()? ""cannot modify because locked"": null;
            }
            return null;
        }
    }
    ...
}"
ISIS-453,Improvement,Closed,Extend @MemberGroups annotation so that it can provide a hint to lay out properties on either left or right hand side of the page (with respect to Wicket viewer's rendering),"eg:
@MemberGroups(left={""General"", ""Dates"", ""Values""}, right={""Related"", ""Invoice Items"", ""Indexable Rent""})

where ""Dates"", ""Values"", ""Related"" and ""Indexable Rent"" are the names of groups found in @MemberOrder (eg @MemberOrder(name=""Dates"", sequence=""1""))

Collections (eg ""Invoice Items"") may appear only on the right hand side, but can be intermixed among the property groups.  If omitted then they appear after the groups of properties."
ISIS-452,New Feature,Closed,New @PostsPropertyChangedEvent annotation to post a PropertyChangedEvent via EventBusService,Building on ISIS-450
ISIS-451,Bug,Closed,Abstract methods (and perhaps synthetic methods) not being filtered out of metamodel,"... leading to situation where two properties seemingly appear for the same method.

For example, declare:

public interface WithInterval<T> {
    /// other stuff
    T getNext();
    T getPrevious();
}

and then:

public class SomeEntity implements WithInterval<SomeEntity> {
    ...
}

... would find that there would be two ""next"" and two ""previous"" properties displayed.  One is for the impl within SomeEntity, and one is for the abstract definition of the method in WithInterval.

"
ISIS-450,New Feature,Closed,Provide an EventBusService (based on guava) for decoupled intra-session interaction between entities.,"Consisting of an EventBusService, with a JDO-specific implementation to ensure subscribing entities to an event can be easily loaded."
ISIS-449,Bug,Closed,Error handling when transaction aborted incorrect,"Situation was as follows:
- two edits made that would cause a unique index constraint violation in the database, and the other that (due to a programming bug) would cause a null pointer.

In IsisTransactionManager#endTransaction(), the abortCause gets set onto the IsisTransaction because of the unique constraint, causing Isis to attempt call abortTransaction().  However, there is no exception handling around this method, and a subsequent NPE is not captured for rendering.

In addition, in the wicket viewer, whenever an exception does occur and the transaction is aborted, the attempt to redirect to the error page will fail if the page requires a transaction.  A new transaction should therefore be started."
ISIS-448,Improvement,Closed,Fix example with the DN version workaround (so will have in the archetype).,
ISIS-447,New Feature,Closed,"In Wicket viewer, distinguish prototype/exploration actions in the app menu",
ISIS-446,New Feature,Closed,A new DeveloperUtilitiesService to download the metamodel as a CSV spreadsheet,"A utility to allow a development team to review the business logic in the domain model, eg to perform a code review or audit of unit test coverage.

The idea is that the Isis metamodel can be downloaded as a CSV file which  lists all the members of all classes in the metamodel.  For each, it indicates the important facets about that member: hidden, disabled, choices, autoComplete, validate.  Where a facet exists, it indicates if the facet is implemented declarative (eg through an annotation) or imperatively.  For imperative facets, it indicates the methods.

"
ISIS-445,New Feature,Closed,Actions returning blobs or clobs should download as a file.,
ISIS-444,Improvement,Closed,Autocomplete should allow minimum characters to be specified; choices should require no characters to be specified.,"Introduce @MinLength annotation to add on autoComplete action, eg:

public Foo someProperty() { ... }
public List<Foo> autoCompleteSomeProperty(@MinLength(3) String searchArg) { ... }

or

public void someAction(Foo a, int b) { ... }
public List<Foo> autoComplete0SomeAction(@MinLength(3) String searchArg) { ... }

The default, if not specified, is to enter a single character."
ISIS-443,New Feature,Closed,"Provide the ability to group domain services into logical menus, using @MemberOrder.","Suppose we have two closely related domain services, each servicing a different entity, eg:
Property and Unit.

We would like these actions to appear as a single menu, eg ""Assets"".

The idea is to use @MemberOrder for this, eg:

class Property {

@MemberOrder(name=""Assets"", sequence=""1"")
public Property findProperty( ... ) { ... }

@MemberOrder(name=""Assets"", sequence=""2"")
public Property newProperty( ... ) { ... }

}

and

class Unit {

@MemberOrder(name=""Assets"", sequence=""3"")
public Unit findUnit( ... ) { ... }

@MemberOrder(name=""Assets"", sequence=""4"")
public Unit newUnit( ... ) { ... }

}


These four actions would then appear under an ""Assets"" menu.
"
ISIS-442,Bug,Closed,Fix error handling flow in IsisTransaction,"as encountered when using Restful Objects viewer for migration of data...

have a transaction that hits the commit, but then fails (perhaps a constraint exception?)  But the transactionLevel is always decremented, which means that the attempt to abort the transaction later and handle the exception gets swallowed."
ISIS-441,New Feature,Closed,"Helper classes in the applib to implement common object contracts (toString, equals, hashCode, compareTo)",
ISIS-440,New Feature,Closed,Contributed collections to allow decoupling,
ISIS-439,Improvement,Closed,Remove concept of mutable collections from programming model.,"was: Wicket viewer should support mutable collections - ie with an implicit 'add' and 'remove' action.

but see comments underneath."
ISIS-438,Improvement,Closed,Upgrade to DN 3.2.3 and remove the workaround we had introduced ...,"... for dependency injection of services into entities.

The fix involves using the new capabilities of www.datanucleus.org/servlet/jira/browse/NUCCORE-1037."
ISIS-437,Task,Closed,Tidy-up tasks for Isis 1.3.0 and associated components.,
ISIS-436,Improvement,Closed,Extend the ApplicationSettings and UserSettings (read/write and listAll),
ISIS-435,Bug,Closed,Problems with Enums implementing methods on values,"Apache Isis must properly support methods on Enums and Enum values.

Steps to reproduce on the current Archetype:

1. On ""ToDoItem.java"", modify the ""Category"" enum, replacing its definition by this:

public static enum Category {
       Professional {
			@Override
			public Integer myIndex() {
				return 1;
			}
		}, Domestic {
			@Override
			public Integer myIndex() {
				return 2;
			}
		}, Other {
			@Override
			public Integer myIndex() {
				return 3;
			}
		};

       public abstract Integer myIndex();
   }


2. Try to run the project and the following Exception is thrown (while running the tests and installing the Fixture):

11:45:24,380  [Native               main       DEBUG]  SELECT 'dom.todo.ToDoItem' AS NUCLEUS_TYPE,A0.CATEGORY,A0.COMPLETE,A0.COST,A0.DESCRIPTION,A0.DUEBY,A0.NOTES,A0.OWNEDBY,A0.TODOITEM_ID,A0.VERSION FROM TODOITEM A0
11:45:24,381  [Native               main       DEBUG]  SELECT 'dom.todo.ToDoItem' AS NUCLEUS_TYPE,A0.CATEGORY,A0.COMPLETE,A0.COST,A0.DESCRIPTION,A0.DUEBY,A0.NOTES,A0.OWNEDBY,A0.TODOITEM_ID,A0.VERSION FROM TODOITEM A0
11:45:24,381  [Native               main       DEBUG]  SELECT 'dom.todo.ToDoItem' AS NUCLEUS_TYPE,A0.CATEGORY,A0.COMPLETE,A0.COST,A0.DESCRIPTION,A0.DUEBY,A0.NOTES,A0.OWNEDBY,A0.TODOITEM_ID,A0.VERSION FROM TODOITEM A0
11:45:24,381  [Native               main       DEBUG]  SELECT 'dom.todo.ToDoItem' AS NUCLEUS_TYPE,A0.CATEGORY,A0.COMPLETE,A0.COST,A0.DESCRIPTION,A0.DUEBY,A0.NOTES,A0.OWNEDBY,A0.TODOITEM_ID,A0.VERSION FROM TODOITEM A0
11:45:24,382  [FacetedMethodsBuilder main       INFO ]  introspecting dom.todo.ToDoItem$Category$1
11:45:24,382  [FixturesInstallerDelegate main       ERROR]  installing fixture fixture.todo.ToDoItemsFixture failed; aborting 
java.lang.IllegalArgumentException: illegal argument, expected: is a non empty string
	at org.apache.isis.core.commons.ensure.Ensure.ensureThatArg(Ensure.java:57)
	at org.apache.isis.core.metamodel.spec.ObjectSpecId.<init>(ObjectSpecId.java:47)
	at org.apache.isis.core.metamodel.spec.ObjectSpecId.of(ObjectSpecId.java:43)
	at org.apache.isis.core.progmodel.facets.object.objecttype.ObjectSpecIdFacetAbstract.<init>(ObjectSpecIdFacetAbstract.java:40)
	at org.apache.isis.core.progmodel.facets.object.objecttype.ObjectSpecIdFacetDerivedFromClassName.<init>(ObjectSpecIdFacetDerivedFromClassName.java:27)
	at org.apache.isis.core.progmodel.facets.object.objecttype.ObjectTypeDerivedFromClassNameFacetFactory.process(ObjectTypeDerivedFromClassNameFacetFactory.java:47)
	at org.apache.isis.core.metamodel.specloader.facetprocessor.FacetProcessor.process(FacetProcessor.java:283)
	at org.apache.isis.core.metamodel.specloader.specimpl.FacetedMethodsBuilder.introspectClass(FacetedMethodsBuilder.java:178)
	at org.apache.isis.core.metamodel.specloader.specimpl.dflt.ObjectSpecificationDefault.introspectTypeHierarchyAndMembers(ObjectSpecificationDefault.java:128)
	at org.apache.isis.core.metamodel.specloader.ObjectReflectorDefault.introspectIfRequired(ObjectReflectorDefault.java:572)
	at org.apache.isis.core.metamodel.specloader.ObjectReflectorDefault.loadSpecificationForSubstitutedClass(ObjectReflectorDefault.java:475)
	at org.apache.isis.core.metamodel.specloader.ObjectReflectorDefault.internalLoadSpecification(ObjectReflectorDefault.java:453)
	at org.apache.isis.core.metamodel.specloader.ObjectReflectorDefault.loadSpecification(ObjectReflectorDefault.java:448)
	at org.apache.isis.core.runtime.persistence.adaptermanager.AdapterManagerDefault.existingOrValueAdapter(AdapterManagerDefault.java:186)
	at org.apache.isis.core.runtime.persistence.adaptermanager.AdapterManagerDefault.adapterFor(AdapterManagerDefault.java:160)
	at org.apache.isis.core.runtime.persistence.internal.RuntimeContextFromSession$2.adapterFor(RuntimeContextFromSession.java:110)
	at org.apache.isis.core.progmodel.facets.properties.defaults.fromtype.PropertyDefaultFacetDerivedFromDefaultedFacet.getDefault(PropertyDefaultFacetDerivedFromDefaultedFacet.java:49)
	at org.apache.isis.core.metamodel.specloader.specimpl.OneToOneAssociationImpl.getDefault(OneToOneAssociationImpl.java:210)
	at org.apache.isis.core.metamodel.specloader.specimpl.OneToOneAssociationImpl.toDefault(OneToOneAssociationImpl.java:221)
	at org.apache.isis.core.metamodel.specloader.specimpl.dflt.ObjectSpecificationDefault.initialize(ObjectSpecificationDefault.java:456)
	at org.apache.isis.core.runtime.system.persistence.PersistenceSession.createTransientInstance(PersistenceSession.java:316)
	at org.apache.isis.core.runtime.persistence.internal.RuntimeContextFromSession$7.createTransientInstance(RuntimeContextFromSession.java:185)
	at org.apache.isis.core.metamodel.services.container.DomainObjectContainerDefault.doCreateTransientInstance(DomainObjectContainerDefault.java:148)
	at org.apache.isis.core.metamodel.services.container.DomainObjectContainerDefault.newTransientInstance(DomainObjectContainerDefault.java:100)
	at org.apache.isis.applib.AbstractContainedObject.newTransientInstance(AbstractContainedObject.java:41)
	at dom.todo.ToDoItems.newToDo(ToDoItems.java:150)
	at fixture.todo.ToDoItemsFixture.createToDoItemForUser(ToDoItemsFixture.java:76)
	at fixture.todo.ToDoItemsFixture.installFor(ToDoItemsFixture.java:50)
	at fixture.todo.ToDoItemsFixture.install(ToDoItemsFixture.java:41)
	at org.apache.isis.core.runtime.fixtures.FixturesInstallerDelegate.installFixture(FixturesInstallerDelegate.java:213)
	at org.apache.isis.core.runtime.fixtures.FixturesInstallerDelegate.installFixtureInTransaction(FixturesInstallerDelegate.java:175)
	at org.apache.isis.core.runtime.fixtures.FixturesInstallerDelegate.installFixtures(FixturesInstallerDelegate.java:162)
	at org.apache.isis.core.runtime.fixtures.FixturesInstallerDelegate.installFixtures(FixturesInstallerDelegate.java:142)
	at org.apache.isis.core.integtestsupport.IsisSystemForTest.wireAndInstallFixtures(IsisSystemForTest.java:292)
	at org.apache.isis.core.integtestsupport.IsisSystemForTest.setUpSystem(IsisSystemForTest.java:283)
	at org.apache.isis.core.integtestsupport.IsisSystemForTest.setUpSystem(IsisSystemForTest.java:256)
	at integtests.AbstractIntegTest$IsisSystemForTestRule$1.initialValue(AbstractIntegTest.java:131)
	at integtests.AbstractIntegTest$IsisSystemForTestRule$1.initialValue(AbstractIntegTest.java:128)
	at java.lang.ThreadLocal.setInitialValue(ThreadLocal.java:141)
	at java.lang.ThreadLocal.get(ThreadLocal.java:131)
	at integtests.AbstractIntegTest$IsisSystemForTestRule.getIsisSystemForTest(AbstractIntegTest.java:137)
	at integtests.AbstractIntegTest$IsisSystemForTestRule.apply(AbstractIntegTest.java:142)
	at org.junit.runners.BlockJUnit4ClassRunner.withMethodRules(BlockJUnit4ClassRunner.java:349)
	at org.junit.runners.BlockJUnit4ClassRunner.withRules(BlockJUnit4ClassRunner.java:339)
	at org.junit.runners.BlockJUnit4ClassRunner.methodBlock(BlockJUnit4ClassRunner.java:256)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:59)
	at org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.executeTestSet(AbstractDirectoryTestSuite.java:115)
	at org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.execute(AbstractDirectoryTestSuite.java:102)
	at org.apache.maven.surefire.Surefire.run(Surefire.java:180)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.maven.surefire.booter.SurefireBooter.runSuitesInProcess(SurefireBooter.java:350)
	at org.apache.maven.surefire.booter.SurefireBooter.main(SurefireBooter.java:1021)
11:45:24,382  [IsisTransaction      main       INFO ]  abort transaction IsisTransaction@7fbb6976[state=IN_PROGRESS,commands=0]
11:45:24,387  [IsisConfigurationDefault main       INFO ]  adding isis.persistor.datanucleus.RegisterEntities.packagePrefix=dom
11:45:24,388  [IsisConfigurationDefault main       INFO ]  adding isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionURL=jdbc:hsqldb:mem:test
11:45:24,388  [IsisConfigurationDefault main       INFO ]  adding isis.persistor.datanucleus.impl.datanucleus.defaultInheritanceStrategy=TABLE_PER_CLASS
11:45:24,388  [IsisConfigurationDefault main       INFO ]  adding isis.persistor.datanucleus.install-fixtures=true
11:45:24,388  [IsisConfigurationDefault main       INFO ]  adding isis.persistor.datanucleus.impl.datanucleus.cache.level2.type=none
11:45:24,388  [IsisSystemFixturesHookAbstract main       INFO ]  initialising Isis System
11:45:24,388  [IsisSystemFixturesHookAbstract main       INFO ]  working directory: /Users/oscarboubou/dev/test/myapp/integtests/.
11:45:24,388  [IsisSystemFixturesHookAbstract main       INFO ]  resource stream source: null
11:45:24,388  [TemplateImageLoaderAwt main       INFO ]  images to be loaded from images/
11:45:24,390  [TemplateImageLoaderAwt main       INFO ]  images to be loaded from images/

[....] more log here.



3. If we annotate all abstract method implementations with @Programmatic, the exception is still thrown:

public class ToDoItem implements Comparable<ToDoItem> /*, Locatable*/ { // GMAP3: uncomment to use https://github.com/danhaywood/isis-wicket-gmap3

	private static final long ONE_WEEK_IN_MILLIS = 7 * 24 * 60 * 60 * 1000L;

   public static enum Category {
       Professional {
			@Override
			@Programmatic
			public Integer myIndex() {
				return 1;
			}
		}, Domestic {
			@Override
			@Programmatic
			public Integer myIndex() {
				return 2;
			}
		}, Other {
			@Override
			@Programmatic
			public Integer myIndex() {
				return 3;
			}
		};

       public abstract Integer myIndex();
   }


4. The exception is still thrown if the Enum is annotated with @ObjectType:

	@ObjectType(""TODOCATEGORY"")
   public static enum Category {
       Professional {
			@Override
			public Integer myIndex() {
				return 1;
			}
		}, Domestic {
			@Override
			public Integer myIndex() {
				return 2;
			}
		}, Other {
			@Override
			public Integer myIndex() {
				return 3;
			}
		};

		@Programmatic
       public abstract Integer myIndex();
   }


5. But This works ok:

	@ObjectType(""TODOCATEGORY"")
   public static enum Category {
       Professional , Domestic, Other;

		@Programmatic
       public Integer myIndex() {
			return 1;
		};
   }

6. And this works ok also:

   public static enum Category {
       Professional , Domestic, Other;

		@Programmatic
       public Integer myIndex() {
			return 1;
		};
   }"
ISIS-434,New Feature,Closed,Provide context-specific autoComplete through prefixed methods on properties,"works very similar to choices, eg: 

Customer getCustomer() { ... }
List<Customer> autoCompleteCustomer(String searchArg) { ... }"
ISIS-433,New Feature,Closed,Provide context-specific autoComplete through prefixed methods on actions parameters (cf choices method).,"works very similar to choices, eg: 

Customer foo()
List<Customer> autoComplete0Foo(String searchArg)"
ISIS-432,New Feature,Closed,"In the wicket viewer, table columns should be sortable",
ISIS-431,Bug,Closed,A boolean atribute should never be mandatory,"A boolean attribute only has two states and when the @Optional annotation is omitted and the boolean is set to false, eg the checkbox is empty, it's impossible to save the object."
ISIS-430,New Feature,Closed,Allow the sort order for SortedSet parented collections to be overridden with a new @SortedBy annotation.,
ISIS-429,Bug,Closed,Hard-coded dependency to WicketSignInPage in PageAbstract...,"Meaning that the PageRegistry idea is broken, for the signin page at least.
"
ISIS-428,Improvement,Closed,JUnitMockery2 should automatically instantiate the @ClassUnderTest,... removes some boilerplate in tests.
ISIS-427,New Feature,Closed,"An application setting service (both global and user-specific), with JDO implementation.",
ISIS-426,New Feature,Closed,Provide abstract contract test to easily verify Comparable implementations.,
ISIS-425,Improvement,Closed,Factor out abstract contract test class to make it easier to write contract tests that apply to all entities.,
ISIS-424,Improvement,Closed,"Make rememberMe configurable on Wicket sign-in page, and make non-final so can be subclassed.","Make Wicket signin page non-final so can be subclassed.

"
ISIS-423,New Feature,Closed,Provide contract test utility for the automatic testing of 1:m and 1:1 bidirectional relationships,
ISIS-422,New Feature,Closed,Create Apache Isis API for custom Queries sent to the Objectstore by the PersistenceManager,"Current API does not support the option to define custom queries as SQL strings that will be resolved by the current Objectstore.

Proposed patch by Dan:

Take a copy of IsisJdoSupport and IsisJdoSupportImpl.

In IsisJdoSupport, add:

PersistenceManager getJdoPersistenceManager();


In IsisJdoSupportImpl, add:

public PersistenceManager getJdoPersistenceManager() {
   return getObjectStore().getPersistenceManager();
}

protected DataNucleusObjectStore getObjectStore() {
   return (DataNucleusObjectStore)
getPersistenceSession().getObjectStore();
} 

Then register this as a service and inject into your repositories etc.

There's a plan for integrating Lucene into Isis. Then a lot
of these adhoc queries may just disappear as a requirement."
ISIS-421,Improvement,Closed,Write TCK tests for Restful Objects viewer,"Implement TCK tests for RO viewer, as found in: https://github.com/apache/isis/tree/master/component/viewer/restfulobjects/tck/src/test/java/org/apache/isis/viewer/restfulobjects/tck"
ISIS-420,New Feature,Closed,Application-level settings service and a user-level settings service.,
ISIS-419,New Feature,Closed,Add an autoCompleteXxx() method for more context-sensitive lookups.,
ISIS-418,Task,Closed,Delete the isis site skin since we are no longer using Maven for our site.,
ISIS-417,New Feature,Closed,"In wicket viewer, provide a 'select all' checkbox on table (for invoking bulk actions)",
ISIS-416,Improvement,Closed,Make spinning icon image in Wicket pluggable,"At the moment the spinning image icon is hard-coded in Wicket; rendering of it also seems to be a bit unreliable (eg in 1.0.3 archetype).

Moving the img src= link to the WEB-INF/images directory will solve both these issues."
ISIS-415,New Feature,Closed,Automatic login through parameters in the url,"It would be useful to be able to login by specifying user/password in the URL

Example:
http://localhost:8080/MyIsisApplication?user=sven&password=pass

The application will then automatically try to login as user sven"
ISIS-414,Bug,Closed,"When a stack overflow kills thread, then HSQLDB in-memory session locks up on subsequent request.","The stack overflowing on a previous request means that the session is not closed properly.  This missing housekeeping breaks any subsequent request that uses the same connection.

Not sure if this is a problem with HSQLDB (2.2.9), or whether Isis should deal with the issue.  As things stand, a localized problem (stack overflow) becomes a global issue - need to recycle web server."
ISIS-413,Bug,Closed,RO representation of entities with a null LocalDate failing with an ClassCastException,
ISIS-412,Improvement,Closed,"Improve JDO publishing service, use varbinary for serialized form, and zip up the JSON.",
ISIS-411,Improvement,Closed,Enhance RO to allow EAGER rendering of properties (as well as collections),
ISIS-410,New Feature,Closed,RO viewer support @Render(EAGERLY) for collections,"primarily for supporting publishing service, also useful in general, though."
ISIS-409,New Feature,Closed,"Move the 'wrapper' progmodel component into core, reworked as an optional service","Most of the benefits of the junit viewer are actually provided by the WrapperFactory, a component of the progmodel-wrapper.

So, for those using the junit viewer, we could support it mostly just by moving wrapper into core.

Rather than characterizing this component as a ""progmodel"", it is really a service.  As such, the WrapperFactory interface can move to live in a subpackage of the applib's org.apache.isis.applib.service package."
ISIS-408,Bug,Closed,Auditing should ignore non-persistable properties (annotated with @NotPersisted).,... causing issues with (application-level) integration tests post a refactoring.
ISIS-407,New Feature,Closed,Annotation to automatically adjust end dates of ranges so that they are shown as inclusive vs exclusive.,"eg for an interval [1-apr-2013, 1-jul-2013), we want the end date to be rendered as 30-jun-2013.

Suggestion is @RenderedAdjusted.

The conversion is done within Wicket UI widget."
ISIS-406,Task,Closed,"Tidy-up tasks for release (Isis Core 1.2.0, Wicket 1.2.0, JDO 1.1.0, Restful 2.0.0, etc)",
ISIS-405,Improvement,Closed,Clearer messages for Validation exceptions including field or parameter name and class/action name,"The following exception message is shown when a mandatory field is not entered (trace shown generated from a JUnit viewer test):

org.apache.isis.progmodel.wrapper.applib.InvalidException: Mandatory
	at org.apache.isis.progmodel.wrapper.metamodel.internal.DomainObjectInvocationHandler.toException(DomainObjectInvocationHandler.java:561)
	at org.apache.isis.progmodel.wrapper.metamodel.internal.DomainObjectInvocationHandler.notifyListenersAndVetoIfRequired(DomainObjectInvocationHandler.java:533)
	at org.apache.isis.progmodel.wrapper.metamodel.internal.DomainObjectInvocationHandler.handleActionMethod(DomainObjectInvocationHandler.java:483)
	at org.apache.isis.progmodel.wrapper.metamodel.internal.DomainObjectInvocationHandler.invoke(DomainObjectInvocationHandler.java:225)
	at org.apache.isis.progmodel.wrapper.metamodel.internal.InvocationHandlerMethodInterceptor.intercept(InvocationHandlerMethodInterceptor.java:37)
	at com.xms.framework.architecture.domain.model.technology.NodeFactory$$EnhancerByCGLIB$$a0559340.createNode(<generated>)
	at com.xms.framework.architecture.domain.model.technology.tests.NodeTest.testDomainEntity_CreateWithEmptyString(NodeTest.java:295)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.junit.internal.runners.TestMethod.invoke(TestMethod.java:68)
	at org.apache.isis.viewer.junit.IsisTestRunner$1.invoke(IsisTestRunner.java:160)
	at org.junit.internal.runners.MethodRoadie.runTestMethod(MethodRoadie.java:107)
	at org.junit.internal.runners.MethodRoadie$2.run(MethodRoadie.java:88)
	at org.junit.internal.runners.MethodRoadie.runBeforesThenTestThenAfters(MethodRoadie.java:96)
	at org.junit.internal.runners.MethodRoadie.runTest(MethodRoadie.java:86)
	at org.junit.internal.runners.MethodRoadie.run(MethodRoadie.java:49)
	at org.apache.isis.viewer.junit.IsisTestRunner.invokeTestMethod(IsisTestRunner.java:124)
	at org.junit.internal.runners.JUnit4ClassRunner.runMethods(JUnit4ClassRunner.java:61)
	at org.junit.internal.runners.JUnit4ClassRunner$1.run(JUnit4ClassRunner.java:54)
	at org.junit.internal.runners.ClassRoadie.runUnprotected(ClassRoadie.java:33)
	at org.junit.internal.runners.ClassRoadie.runProtected(ClassRoadie.java:45)
	at org.junit.internal.runners.JUnit4ClassRunner.run(JUnit4ClassRunner.java:52)
	at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)




It will be a commonly found exception while testing and debugging. 
This exception will be raised , for example, if a programmer forget to annotate a field, or if he's migrating its source code from another framework (so by default none of the Domain class properties will be annotated as @Optional). 
Same will happen for non-mandatory parameters on actions placed on Entities or Services.

A clearer message for Domain Object property validations could be something similar to this :

""A Mandatory field (%s) has not been entered for an instance of Class: %s.""

And for action parameters something similar to:

""A mandatory parameter (%s) has not been entered while executing action '%s' on an instance of Class '%s'"""
ISIS-404,Bug,Closed,"Testing if a ""wrapped"" Domain Object has been persisted fails","While doing tests over factory actions, one assert would be to verify the object has been persisted through the DomainObjectContainer.isPersistent(domainObject) method. 

If the evaluation is done over a wrapped object, it returns false.

If it's done over the original object, it returns true.

As an example:

		// Test if the Domain Object has been persisted.
		assertTrue(domainObjectContainer
				.isPersistent(communicationPathAssociatedWithNode));

		// Node must be wrapped for the Apache Isis validators to be executed.
		communicationPathAssociatedWithNode = wrapped(communicationPathAssociatedWithNode);

		assertTrue(domainObjectContainer
				.isPersistent(communicationPathAssociatedWithNode));


The last assertion fails. The only difference I expected was the validation of the programming model."
ISIS-403,Improvement,Closed,Improve the bookmarks in the Wicket viewer.,"New @Bookmarkable annotation to indicate whether entities should be bookmarked or not.
Move Wicket bookmarks to the side, sort bookmarks by type.
Automatically organize bookmarks into parent/child relationships.."
ISIS-402,Bug,Closed,"Wicket viewer, show bulk actions for prototype or exploring modes.",
ISIS-401,Bug,Closed,"In wicket viewer, concurrency checking is currently disabled when invoke action on an entity.","It should be re-enabled, however the links should be recomputed if the object is changed as the result of an edit.  This might simply be a matter of changing from using Ajax to forcing a re-render."
ISIS-400,New Feature,Closed,"In the wicket viewer, allow actions to be associated with properties (similar to how this can be done with collections)",
ISIS-399,Bug,Closed,[WON'T FIX] Remove LogonFixture,"was:  LogonFixture does not work in wicket viewer

detail: Adding LogonAsSvenFixture to isis.properties does not log on Sven.

 

Rationale: can use sudoService instead."
ISIS-398,Improvement,Closed,Extend applib's Clock interface to also return time as Joda LocalDate or LocalDateTime,
ISIS-397,Improvement,Closed,"Change default AuditingService impl to write to stderr, not stdout",Just so is easier to see in console (if running within an IDE).
ISIS-396,Improvement,Closed,Wicket/JDO handling of BigDecimal properties should honour the @Column's scale attribute.,"Extend the BigDecimalValueFacet to also capture the length and scale.

Provide an implementation of BigDecimalFacetFactory from JDO to infer from @Column

Update the BigDecimalPanel in Wicket viewer to honour this new semantic."
ISIS-395,Improvement,Closed,Allow Wicket viewer's date pattern to be globally configurable,"This does *not* cover patterns that are dependent on the users' locale. 

Rather, this is about using configuration properties (in WEB-INF/viewer_wicket.properties) to specify a default for the application."
ISIS-394,Improvement,Closed,Use JQuery UI date picker rather than the YUI picker.,"... to provide better styling, simplify dependencies, provide additional features."
ISIS-393,Improvement,Closed,Upgrade to Wicket 6.7.0,
ISIS-392,Improvement,Closed,"In Wicket, provide a datepicker for all of the date/datetime value types.","This JIRA is to bring a bit of consistency to the implementation.

One particular improvement is that joda LocalDate is no longer converted to a java.util.Date internally (which might lead to timezone issues).

Another improvement is to use the same dateformat when rendered in compact form (as in tables) as in the regular form (as in property form).

A final improvement is to make the datepicker honour the specified datePattern/dateTimePatterns.  This is a stepping stone to making this configurable externally (either application-level, or per-user).

There are still some issues, even with this JIRA tackled.  In particular, handling of date/time values doesn't work obviously for non-UTC timezones if specified with a truncated date.  Not sure what the solution is here, other than to (perhaps) require that a time is always specified."
ISIS-391,Improvement,Closed,Upgrade JDO objectstore to Datanucleus 3.2.1,"Version 3.2.1 of Datanucleus contains various bug fixes and improvements

http://www.datanucleus.org/news/access_platform_3_2_1.html"
ISIS-390,Bug,Closed,Fix NPE in Wicket viewer if tries to render an action that is invisible.,"Impacts not-yet-released code in HEAD, hence no version number."
ISIS-389,Improvement,Closed,Ensure that objects lazily loaded by JDO/DataNucleus get domain services injected into them consistently.,"Previously our approach was to use the LoadedLifecycleListener and inject services at that point.  However, it turns out that this callback is only called when *all* of the fields/properties in the default fetch group have been loaded; in other words it is indeterminate as to when it is called.  The consequence of this is that any attempt to invoke an action on the domain object may result in a NPE if it tries to use a not-yet-injeted service or the container.

This ticket is to hook into JDO/DataNucleus' SPI in order to do the necessary injection.
"
ISIS-388,Bug,Closed,Bulk actions in Wicket viewer not correctly redirecting to error page if an unexpected error occurs,Change from AjaxLink to regular non-ajax Link.
ISIS-387,Improvement,Closed,Enhance PublishingService and AuditingService for created and deleted objects (as well as just updated objects).,Extend EventType enum in applib.services.publish; update JDO objectstore so that detects creations and deletions and enlists into the IsisTransaction; add guards so that the event serializers are never handed deleted objects (which would cause JDO objectstore to throw an exception)
ISIS-386,Improvement,Closed,"Provide the ability to force a reload of an object by the JDO objectstore, and provide a domain service for clients.","This is needed because, it would seem, DataNucleus does not maintain 1:m bidirectional relationships for us, and so we need to be able to re-retrieve the parent object when a child object has just been persisted.

While we are at it, promote the JDO facet factories that set up the ignore of ""jdo"" prefix (we are already half-way there in ignoring the PersistenceCapable interface)."
ISIS-385,Bug,Closed,"In the wicket viewer, actions rendered by collections are never shown as disabled.",
ISIS-384,New Feature,Closed,Provide automatic totalling of collections.,
ISIS-383,New Feature,Closed,[OUT OF SCOPE] Integrate Apache Lucene or ElasticSearch,"Isis is most often used with its JDO integration, a fairly conventional ORM.  Searching for existing domain objects therefore requires a query to be defined.  But sometimes users want to just search for any object (like searching the web).  This ticket is to integrate Isis so that its domain objects can be indexed by Lucene and thus provide a generic search capability.

As of 1.10.0 this could be implemented using a subscriber:

{code}
@DomainService(nature=DOMAIN)
public class LuceneSubscriber extends AbstractSubscriber {
    @Subscribe public void on(ObjectPersistingEvent ev) { ... }
    @Subscribe public void on(ObjectUpdatingEvent ev) { ... }
    @Subscribe public void on(ObjectRemovingEvent ev) { ... }
}
{code}

Then one would also provide some sort of repository to query the Lucene datastore:

{code}
@DomainService(nature=DOMAIN)
public class LuceneRepository {
    @Action(semantics=SAFE)
    List<Object> find(String text) { ... }
}
{code}


There is also an attachment to this ticket, based on an earlier spike by Maurizio.  Note that that was done before the subscribers were available."
ISIS-382,Bug,Closed,Quickly pressing enter multiple times on an object form creates multiple instances.,Quickly pressing enter multiple times on an object form submits creates multiple instances. To prevent this the submit/ok action should be disabled once it being send to the server.
ISIS-381,Task,Closed,"Mothball HTML viewer, SQL Security, LDAP security, SQL Profile Store.",
ISIS-380,New Feature,Closed,Enhance BookmarkService API to allow objects to be looked up directly (rather than by dint of a BookmarkHolder),
ISIS-379,New Feature,Closed,Move AuditingService out of the ToDo app demo and into JDO objectstore as a service impl.,
ISIS-378,New Feature,Closed,IsisServices - a service for prototyping that allows access into the internals of the Isis runtime,"Intended to expose only @Prototyping / @Exploration actions, eg to reset the reflector (SpecificationLoader)."
ISIS-377,New Feature,Closed,Publishing Service implementation that writes to a queue (using JDO).,"Have also:
* extended so that EventMetadata contains EventType, making it easier to distinguish between event types.
* renamed ""ChangedObject"" to ""ObjectChanged"" (more consistent with ""ActionInvocation"")

and have also:
* extended ObjectChanged event so that also exposes the className of the changed object, for routing in pubsub (eg Camel)
* injected the ObjectStringifier (and extended to support derivation of classname) so that is done for custom payload events as well as regular

"
ISIS-376,Improvement,Closed,Enhance JDO objectstore to also support IdentityType.APPLICATION (as well as DATASTORE),
ISIS-375,Improvement,Closed,Prepare NoSQL store for release,Restructure code to remove dependencies and get working with MongoDB.
ISIS-374,New Feature,Closed,"[GSOC2013] A generic Naked Objects app written using Javascript/Coffeescript (optionally using Apache Cordova), running against Isis' Restful Objects interface.","From our website (http://isis.apache.org): 

Apache Isis™ software is a framework for rapidly developing domain-driven apps in Java. Write your business logic in entities, domain services and repositories, and the framework dynamically generates a representation of that domain model as a webapp or a RESTful API. Use for prototyping or production. 

~~~ 

Isis works by building a metamodel from the domain object models, from which a generic user interface is generated dynamically at runtime.  There are several implementations of the generic UI, one based on Wicket, one based on Servlet/JSPs, and one based on jax-rs and serving up a Restful API over http and json.  This API is fully documented in the Restful Objects spec (http://restfulobjects.org) ... there is also a (non-Apache) open source implementation on .NET.

This GSOC suggestion is to develop a Javascript/Coffeescript app that will provide a generic (naked objects) viewer by consuming the RESTful API provided by Isis.  Optionally the app can be deployed on top of Apache Cordova.  Optionally this generic viewer could be extensible to allow mashups (as is supported by Isis' own Wicket-based viewer)."
ISIS-373,New Feature,Closed,"[Mentored?] A generic Naked Objects app written using Apache Flex, running against Isis' Restful Objects interface.","From our website (http://isis.apache.org): 

Apache Isis™ software is a framework for rapidly developing domain-driven apps in Java. Write your business logic in entities, domain services and repositories, and the framework dynamically generates a representation of that domain model as a webapp or a RESTful API. Use for prototyping or production. 

~~~ 

Isis works by building a metamodel from the domain object models, from which a generic user interface is generated dynamically at runtime.  There are several implementations of the generic UI, one based on Wicket, one based on Servlet/JSPs, and one based on jax-rs and serving up a Restful API over http and json.  This API is fully documented in the Restful Objects spec (http://restfulobjects.org) ... there is also a (non-Apache) open source implementation on .NET.

This GSOC suggestion is to develop a generic viewer using Apache Flex that will consume the RESTful API provided by Isis.  Optionally this generic viewer could be extensible to allow mashups (as is supported by Isis' own Wicket-based viewer)."
ISIS-372,New Feature,Closed,"[Mentored?] A generic Naked Objects app, implemented in JavaFX,  to run against Isis' Restful Objects interface.","From our website (http://isis.apache.org): 

Apache Isis™ software is a framework for rapidly developing domain-driven apps in Java. Write your business logic in entities, domain services and repositories, and the framework dynamically generates a representation of that domain model as a webapp or a RESTful API. Use for prototyping or production. 

~~~ 

Isis works by building a metamodel from the domain object models, from which a generic user interface is generated dynamically at runtime.  There are several implementations of the generic UI, one based on Wicket, one based on Servlet/JSPs, and one based on jax-rs and serving up a Restful API over http and json.  This API is fully documented in the Restful Objects spec (http://restfulobjects.org) ... there is also a (non-Apache) open source implementation on .NET.

This GSOC suggestion is to develop a generic (naked objects) viewer using JavaFX that will consume the RESTful API provided by Isis.  Optionally this generic viewer could be extensible to allow mashups (as is supported by Isis' own Wicket-based viewer)."
ISIS-371,New Feature,Closed,"[GSOC2013] A generic (Naked Objects) Android app, to run against Isis' Restful Objects interface.","From our website (http://isis.apache.org): 

Apache Isis™ software is a framework for rapidly developing domain-driven apps in Java. Write your business logic in entities, domain services and repositories, and the framework dynamically generates a representation of that domain model as a webapp or a RESTful API. Use for prototyping or production. 

~~~ 

Isis works by building a metamodel from the domain object models, from which a generic user interface is generated dynamically at runtime.  There are several implementations of the generic UI, one based on Wicket, one based on Servlet/JSPs, and one based on jax-rs and serving up a Restful API over http and json.  This API is fully documented in the Restful Objects spec (http://restfulobjects.org) ... there is also a (non-Apache) open source implementation on .NET.

This GSOC suggestion is to develop a native Android app that will consume the RESTful API provided by Isis to provide a generic (naked objects) viewer for use either from a smartphone or tablet.  Optionally this generic viewer could be extensible to allow mashups (as is supported by Isis' own Wicket-based viewer)."
ISIS-370,New Feature,Closed,Provide a service to allow all @PersistenceCapable entities to be eagerly registered with Isis (and therefore with DataNucleus),"On several occasions we've hit issues with the JDO/DataNucleus objectstore (eg tests that just hang) that turned out to be a deadlock in the HSQLDB JDBC driver caused by it attempting to run DDL (for the metamodel) intermixed within DML.  We surmised that the problem was that DataNucleus's metamodel was not fully created initially ... this is because Isis tells DN what the entities are by walking the graph from the repositories, and subtypes of entities are not always present in the interface of the action methods of those entities.

This ticket is to provide a service that can be registered in isis.properties and that will eagerly register all entities with Isis, and thus JDO, so that this sort of problem does not occur."
ISIS-369,New Feature,Closed,For GSOC: Kemble: A domain-specific language aligned with the Apache Isis programming conventions.,"The obvious technology to use is Eclipse's XText [http://www.eclipse.org/Xtext/].  The grammar can be based on Xbase, which provides full Java type compatibility and extended language constructs (in common with in XTend, [http://www.eclipse.org/xtend/]).

NB: xtext now has an FX-based UML integration; see: http://vimeo.com/104115680

~~~


grammar org.apache.isis.kemble.Kemble 
   with org.eclipse.xtext.xbase.annotations.XbaseWithAnnotations


Below is a sketch of what that DSL might look like.


 For entities:

@... // Isis and selected JDO annotations here
entity Customer {
   ...
   
  inject ProductRepository products;
  inject OrderRepository orders;
}


where:
- the products, orders imply an instance variable and a setter to allow services to be injected into
- DomainObjectContainer container is provided automatically as a field


For entity properties:

entity Customer {

  @ ... // annotations here
  [derived] property String firstName {
    modify;
    clear;
    default;
    choices;
    hide;
    disable;
    validate;
  }
}


where
- property is a keyword
- String firstName 
  - implies the instance variable and the getter
  - annotations can be specified, apply to the getter
- derived is an optional keyword
  - if present, then only the hide keyword may be used
  - if present, then the getter is in the business logic interface, not structural.
- modify;
  - is optional
  - if present, implies the modifyXxx(String value) method
- clear;
  - is optional
  - if present, implies the void clearXxx() method
- default;
  - is optional
  - if present, implies the String defaultXxx() method
- choices;
  - is optional
  - if present, implies the Collection<String> choicesXxx() method
- hide;
  - is optional
  - if present, implies the boolean hideXxx() method
- disable;
  - is optional
  - if present, implies the String disableXxx() method
- validate;
  - is optional
  - if present, implies the String validateXxx(String value) method


  
similarly for entity collections:

entity Customer {

  @ ... // annotations here
  [derived] collection List<Order> orders {
    addTo;
    removeFrom;
    hide;
    disable;
    validateAddTo;
    validateRemoveFrom;
  }
}

where
- collection is a keyword
- derived is an optional keyword
  - if present, then only the hide keyword may be used
  - if present, then the getter is in the business logic interface, not structural.
- addTo;
  - is optional
  - if present ,implies void addTo(Order o) { }
- removeFrom;
  - is optional
  - if present ,implies void removeFrom(Order o) { }
- hide;
   - as properties
- disable;
   - as properties
- validateAddTo;
  - is optional
  - if present ,implies String validateAddToXxx(Order o) { ... }
- validateRemoveFrom;
  - is optional
  - if present ,implies String validateRemoveFromXxx(Order o) { ... }
  

and similarly for entity actions:

entity Customer {

  @... // annotations here
  action Order placeOrder {
      param Product product {
        default;
        choices;
        autoComplete;
        validate;
      }, 
      param int quantity {
        default;
        choices;
        autoComplete;
        validate;
      },
      param String description {
        default;
        choices;
        autoComplete;
        validate;
      }
    }
    hide;
    disable;
    validate;
  }
}


where
- the name of the parameter would imply @Named(...)
- param's default:
  - is optional
  - corresponds to:   Product default0PlaceOrder() { ... }
                            or: int default1PlaceOrder() { ... }
                            or: String default2PlaceOrder() { ... }
- param's choices
  - is optional
  - corresponds to:   Collection<Product> default0PlaceOrder() { ... } 
                            or: Collection<Integer> choices1PlaceOrder(Product p) { ... }
                            or: Collection<String> choices2PlaceOrder(Product p, int quantity) { ... }
  - note how the Nth method has N-1 params
  - ALSO: cannot have both choices and autoComplete
- param's autoComplete
  - is optional
  - corresponds to Collection<Product> autoComplete0PlaceOrder(String search) { ... }
                            or: Collection<Integer> autoComplete1PlaceOrder(Product p, String search) { ... }          
                            or: Collection<String> autoComplete2PlaceOrder(Product p, int quantity, String search) { ... }          
  - note how the Nth method has N-1 params + search arg
  - ALSO: cannot have both choices and autoComplete
validate for the parameters apply to that parameter
  - is optional
  - corresponds to String validate0PlaceOrder(Product p) { ... }
                            or: String validate1PlaceOrder(int quantity) { ... }          
                            or: String validate2PlaceOrder(String search) { ... }          
- hide
  - is optional
  - corresponds to boolean hidePlaceOrder() { ... }
- disable
  - is optional
  - corresponds to String disablePlaceOrder() { ... }
- validate (at action level)
  - corresponds to validateXxx(...)
  - to validate the set of arguments rather than an individual parameter
  
  
~~~~~~~~~~~~
THIS STUFF OUT OF SCOPE/NOT NECESSARY

For values:

value FractionalNumber {
  int numerator;
  int denominator;
}


is basically the same as Lombok @Data
requires information in @ValueSemanticsProvider to be specified (somehow, not sure exactly how)


~~~~~~~~~~~~
THIS STUFF OUT OF SCOPE/NOT NECESSARY

For services/repositories:

service ProductRepository {

}

where:
- any services are injected into as for entities
- DomainObjectContainer container is provided for free, again as for entities
- actions as for entities
- properties and collections are disallowed"
ISIS-368,Bug,Closed,[WON'T FIX] Parser for java.util.Date should respect the configuration settings.,"""Putting the isis.value.format.date=dd-MM-yyyy in the configuration, my expectation is that the parser accept a  string like ""13-03-2013""   as a valid date. I got exception, so I feel I miss something."""
ISIS-367,New Feature,Closed,Refactor to support JTA transactions,"This is a pretty big refactoring, and touch most of the released modules, if not all.

In particular, the responsibility for creating the transaction manager must move out of the object store, and instead be a standalone component (with its own Installer impl etc).

It might make sense to rename the existing IsisTransactionManager to IsisSimpleTranasctionManager or equivalent, and to have a JTA-specific implementation that delegates as much as possible to the underlying JEE runtime."
ISIS-366,Improvement,Closed,Core unit testing support JUnitRuleMockery2 does not support autoinjection of setters,
ISIS-365,Improvement,Closed,Should not add same object to bookmarks (breadcrumbs) twice if its title has changed.,"... and in fact, should update the title in the existing bookmark if the object is already there."
ISIS-364,Improvement,Closed,Suppress components of title when rendered in a parented collection.,Provide a context adapter to the TitleFacet so that implementations (in particular the TitleFacetViaTitleAnnotation) can exclude components that are the context adapter.
ISIS-363,New Feature,Closed,Wicket viewer should abbreviate title to different lengths for parented vs standalone collections.,"specify using new properties.

In web.xml, add:

    <context-param>
        <param-name>isis.viewers</param-name>
        <param-value>wicket,restfulobjects</param-value>
    </context-param>

this determines which additional configuration files to search for 

In viewer_wicket.properties, can specify:
isis.viewer.wicket.maxTitleLengthInStandaloneTables=12
isis.viewer.wicket.maxTitleLengthInParentedTables=9

~~~
if not specified but the existing property ""isis.viewer.wicket.maxTitleLengthInTables"" is present, then this value will be used as a fallback in both cases (ie to preserve backward compatibility).

"
ISIS-362,Improvement,Closed,Upgrade to JMock 2.6.0,
ISIS-361,Improvement,Closed,Validation of individual action parameters - if not parseable - is a no-op.,There's no reason that I can see why we cannot also do validation of action parameters on non-parseable (ie non-string) parameters.
ISIS-360,New Feature,Closed,"About page on wicket viewer should show version, build number and other details.","Search for the META-INF/MANIFEST.MF of the war (if available) and look for attribute keys to represent the version.  For example, use ""Implementation-Version"" if present, else use ""Build-Time"" and so forth.  Print out all other attributes in detail.

If the MANIFEST.MF is not available (as would be the case if running from an IDE), then omit.

In addition, dump  out the manifest attribute of all other JAR files on the manifest, as detail.
"
ISIS-359,Bug,Closed,Bulk actions being shown even if action is not a no-arg...,"... contrary to the documentation of @Bulk annotation.

The action, as rendered in the Wicket viewer, does nothing."
ISIS-358,Improvement,Closed,Should be able to delete objects even if they are not versioned.,"Currently there seems to be a check that objects must be versioned (ObjectAdapter#getVersion() != null).  This check doesn't make sense for domain objects, eg reference data, that have no versioning."
ISIS-357,Improvement,Closed,Gracefully handle objects that have been deleted.,
ISIS-356,New Feature,Closed,"Allow 'inject' to be used as a prefix for injecting services into entities, fixtures or other services.",
ISIS-355,New Feature,Closed,Adding Wicket viewer to Claims example,Wicket viewer is missing from the Claim example.
ISIS-354,Bug,Closed,Issues with Wicket viewer and tck examples,I had issues launching the tdk viewer - it needs a few minor things updated.
ISIS-353,Improvement,Closed,compareTo methods (when implement Comparable) should be automatically hidden,
ISIS-352,Improvement,Closed,Add a README.md for those browsing the github mirror,
ISIS-351,New Feature,Closed,"Provide the ability for certain runtime exceptions to be recognized as non-fatal, for rendering to the user.","For example, if a low-level exception thrown as a result of a unique index constraint is thrown, then this isn't really a problem, so should be rendered appropriately for the user.

The JDO object store throws a stack trace whose causal chain contains both:

javax.jdo.JDODataStoreException
Insert of object ""dom.todo.ToDoItem@5a538af7"" using statement ""INSERT INTO TODOITEM (ATTACHMENT,COMPLETE,OWNEDBY,DESCRIPTION,CATEGORY,NOTES,DUEBY,VERSION) VALUES (?,?,?,?,?,?,?,?)"" failed : integrity constraint violation: unique constraint or index violation; TODOITEM_U1 table: TODOITEM

and even more low level below it:

java.sql.SQLIntegrityConstraintViolationException
integrity constraint violation: unique constraint or index violation; TODOITEM_U1 table: TODOITEM

It ought to be possible to render to the user as ""Sorry, a ToDoItem already exists"" or something similar.
"
ISIS-350,Improvement,Closed,Provide a fallback error page in case of runtime exception being thrown.,
ISIS-349,Improvement,Closed,"Show notifications, warning messages and error messages in Wicket","in other words, if using domainObjectContainer.informUser(...), or warnUser(...), or raiseError()"
ISIS-348,Improvement,Closed,Update Wicket viewer to support @Aggregated domain objects,"Conversation started on mailing list[1] about getting @Aggregated objects to render properly in the Wicket viewer. There is not a clear plan yet about how they should appear when rendered but Dan gave a good overview of what is need for Wicket to recognize them as different from normal entities. Original plan is to render the aggregated fields in a panel below the ""General"" panel with a title representing the relationship name.

[1] http://mail-archives.apache.org/mod_mbox/isis-users/201302.mbox/%3CCAN5Lg045c0qH0gy8WsyQAzptbCXLFSVLZ9+4WwapvVKdDqzA5A@mail.gmail.com%3E"
ISIS-347,Wish,Closed,Add the possibility to have dependend drop down boxes,"Something like this:

addPhone(@Named(""Company"") Company company,
           @Named(""Model"") PhoneModel model){
    Phone p = container.newInstance......
    ...
    return p;
}

choices0AddPhone(){
  return all Phone Companies
}

choices1AddPhone(Company company){
   return models(company)
}
"
ISIS-346,Improvement,Closed,Get HTML viewer ready for developers,"A cleanup of properties, etc, to at least let developers be able to run the HTML viewer examples."
ISIS-345,Improvement,Closed,Move the Bookmark service in the applib to a different package,"The classes and interfaces supporting the newly introduced BookmarkService are in org.apache.isis.applib.bookmarks.  Since we now also have an AuditingService and a PublishingService, defined as subpackages of org.apache.isis.applib.services, it makes sense to move the BookmarkService also.

NB: this breaks binary compatibility, and thus strictly speaking warrants an bump of the major version (from 1.x.x to 2.0.0).  However, since this BookmarkService is only very recently introduced and is an optional, I propose making an exception to the rule and make this a documented breaking change.
"
ISIS-344,New Feature,Closed,"Automatically exclude ""parent references"" from parented collections.","Suppose we have a bidirectional many:many, eg Customer <->* CustomerAddress *<-> Address.

The CustomerAddress ""link"" entity has references back to both Customer and Address.

When viewing the Customer, would like the parented table showing the addresses collection (of CustomerAddress) to show the Address property of the CustomerAddress but not to show the parent Customer property.

Conversely, when viewing the Address, would like the parented table showing the customers collection (of CustomerAddress) to show the Customer property of the CustomerAddress but not to show the parent Address property.

In other words, what is shown in the table takes into account the context in which it is shown.

Proposal to do this is to extend the @Hidden annotation's Where enum:

public class CustomerAddress {

    @Hidden(where = Where.REFERENCES_PARENT)
    private Customer customer;

    @Hidden(where = Where.REFERENCES_PARENT)
    private Address address;

    ...
}
"
ISIS-343,Improvement,Closed,Introduce @Render annotation and deprecate @Resolve,"The @Resolve annotation is misnamed... really its an indication that a collection or property should be rendered eagerly/lazily.  There will often be some corresponding annotation for the objectstore to resolve/load the data eagerly too, but that's a separate concern."
ISIS-342,Bug,Closed,Bootstrapping Wicket application should load supplementary config files for viewers.,"If bootstrapping using IsisWebAppBootstrapper (eg html, scimpi, restfulobjects), then the ""isis.viewers"" context param is read and is used to ensure that config files such as viewer_html.properties are also read.

This doesn't happen when bootstrapping via the wicket viewer's IsisWicketApplication."
ISIS-341,Bug,Closed,"if search and get no results, then click on the OK, then get a stack trace",
ISIS-340,Improvement,Closed,Wicket viewer bookmarks should show icon as well as title,
ISIS-339,Improvement,Closed,Wicket Autocomplete should only fire if at least 1 character has been entered.,also update the archetype to demonstrate usage
ISIS-338,Improvement,Closed,"Right align number fields (byte, short, int, long, float, double, BigInteger, BigDecimal)",
ISIS-337,Improvement,Closed,Reduce size of font in breadcrumbs,
ISIS-336,Bug,Closed,Fix CSS for Wicket viewer so that disabled application actions (on menu bar) are shown greyed out.,
ISIS-335,Improvement,Closed,Don't include (or perhaps abbreviate) the title text in collections,
ISIS-334,Bug,Closed,method String iconName() is never called in entities,"In ToDoItem.java

    // {{ Identification on the UI
    public String title() {
        final TitleBuffer buf = new TitleBuffer();
        buf.append(getDescription());
        if (isComplete()) {
            buf.append("" - Completed!"");
        } else {
            if (getDueBy() != null) {
                buf.append("" due by "", getDueBy());
            }
        }
        return buf.toString();
    }

    // }}

    public String iconName(){
       return ""SomeIcon"";
    }

title() is called, but iconName() is not.


"
ISIS-333,Bug,Closed,HTML Viewer is unable to save an object if one of the properties still contains a transient,"As discussed in the mail thread [1], there is an issue with the HTML viewer that when you trying to edit an existing, persisted, object and one of the properties is unpersisted (transient), the EditTask dies with an exception.

[1] http://isis.markmail.org/message/k4szznni5ycn4h4v"
ISIS-332,Task,Closed,update scm url in root pom so that Sonar works.,
ISIS-331,Improvement,Closed,Explicitly specify project.build.sourceEncoding for both Isis and the quickstart archetype,
ISIS-330,Improvement,Closed,Wicket viewer calls choices method while figuring out how to render properties.  Should call less often (if not at all).,
ISIS-329,Bug,Closed,Wicket drop-down possibly broken in Deployment mode,"The application works fine on the development server, on the live environment[2] we still have an issue with the wicket drop down list.
[ moved to new ticket]

On development the ajax call returns:

{""results"":[{""id"":""Professional"",""text"":""Professional""},{""id"":""Domestic"",""text"":""Domestic""},{""id"":""Other"",""text"":""Other""}],""more"":null}

On live the ajax call returns:

<ajax-response><redirect><![CDATA[../page?58]]></redirect></ajax-response>
"
ISIS-328,New Feature,Closed,Wicket viewer should shutdown Isis core on completion,"The scheduler service causes a memory leak because it is not shutdown gracefully.

Note: this JIRA issue is closely related and depends on ISIS-327."
ISIS-327,New Feature,Closed,Initialize and shutdown domain services,"Allow domain services to be initialized by invoking all methods annotated with @javax.annotation.PostConstruct annotation (optionally accepting a Map<String,String> corresponding to the IsisConfiguration), and in addition allow domain services to be shutdown by invoking all methods annotated with a @javax.annotation.PreDestroy annotation (accepting no args)."
ISIS-326,Improvement,Closed,Make Datanucleus JNDI aware,"Currently Isis manages it's own JDBC connectivity. As a result you have to include all JDBC drivers in the build. It's more elegant to have Isis use a JNDI resource. But maybe there are even better options?

[1] http://stackoverflow.com/questions/9991550/tomcat-jndi-resource-for-datanucleus-jdo

"
ISIS-325,Bug,Closed,Field validation annotations should be on setters or fields instead of on the getters.,"Below is the discussion on the mailing list

On 2 February 2013 15:29, Minto van der Sluis wrote:
In the quickstart ToDo application I just noticed the following:

    @RegEx( validation = ""\\w[@&:\\-\\,\\.\\+ \\w]*"" )
    // words, spaces and selected punctuation
    @MemberOrder( sequence = ""2"" )
    public String getDescription() {
    ...

To me it seems like validation is specified on the getter method. Is
this correct? Shouldn't this be specified on the setter or the member
field instead?

On 3 February 2013 16:04, Dan Haywoord wrote:

I agree that it might seem a bit confusing, but at the moment all the
FacetFactory's only ever read the getter method for properties.

I don't see anything in principal for extending the FacetFactory's to also
look at fields and setters; in this particular case I could well imagine
that someone might expect the annotation to live on the setter.  The same
is true for annotations such as @MaxLength.

Another benefit of having the FacetFactory's look at the fields is that
then Lombok [1] could be configured.  This would save a lot of boilerplate,
as I know you know.

Making the change is relative straightforward, it's just a matter of doing
a lot ""grunt"" work to quite a lot of existing FacetFactory's.  I wouldn't
have any objection to applying any patches received, though.

And if you want to raise a ticket for this idea, please go ahead.

Cheers
Dan

[1] http://projectlombok.org/"
ISIS-324,Bug,Closed,ToDoItem.compare compares against itself.,"final statements in the compare method compares with itself:

        if (getDueBy() == null && other.getDueBy() == null || getDueBy().equals(this.getDueBy())) {
            return getDescription().compareTo(other.getDescription());
        }
        return getDueBy().compareTo(getDueBy());

Should be:

        if (getDueBy() == null && other.getDueBy() == null || getDueBy().equals(other.getDueBy())) {
            return getDescription().compareTo(other.getDescription());
        }
        return getDueBy().compareTo(other.getDueBy());
"
ISIS-323,New Feature,Closed,"Provide the capability to publish events, either changed objects or invoked actions",
ISIS-322,New Feature,Closed,Allow JDO objectstore to run on the Google App Engine,"Following info provided by Maurizio Taverna...

We have (with some provisos) successfully deployed a version of the quickstart_wicket_restful_jdo on GAE. 
Below the information collected : 

1. DataNucleusApplicationComponents.java
61:persistenceManagerFactory = JDOHelper.getPersistenceManagerFactory(props);
replaced with : 
61:persistenceManagerFactory = JDOHelper.getPersistenceManagerFactory(""transactions-optional"");

See official Google documentation :
 https://developers.google.com/appengine/docs/java/datastore/jdo/overview-dn2#Getting_a_PersistenceManager_Instance

66:createSchema(props, classesToBePersisted);
replace with : 
// 66:createSchema(props, classesToBePersisted);
This feature is for RDBMS, it raise exception using DN Google implementation.


2.  PersistenceSession.java
894:if (adapter.getVersion() == null) {
895:  throw new ObjectPersistenceException(""Object to be ... "" + adapter);
896:}
replaced with:
     894://if (adapter.getVersion() == null) {
     895://  throw new ObjectPersistenceException(""Object to be ... "" + adapter);
     896://}
We could not understand why the version is null, during the fixture installation ( removeAllToDosForCurrentUser ).


3. jdoconfig.xml
The Google App Engine keep the Jdo configuration in /WEB-INF/classes/META-INF/jdoconfig.xml.
We changed  : 

 <property name=""datanucleus.appengine.autoCreateDatastoreTxns"" value=""false""/> 

This is a workaround, more information available here: 
https://developers.google.com/appengine/docs/java/datastore/jdo/overview-dn2#Disabling_Transactions_and_Porting_Existing_JDO_Apps


With the changes above, the quickstart_wicket_restful_jdo is possible install the fixtures and list the items,
but there are still errors accessing to an item.
At  https://docs.google.com/file/d/0B-Ekm92XLvTAcGxHNTJyRDA3bkk/edit?usp=sharing please find the zip of the project, including the ant build  script , a live version is available here: http://isis-gae.appspot.com/. 
In order to run the example you need to install the GAE SDK and point the appengine.sdk property
to the GAE SDK installation path. 
In addition please check in {gae.sdk}lib/tools/orm contains the datanucleos 3.1.1 jars. If not remove all the jar files (in  default installation I found  datanucleus 1.5 jars) and replace with jars available in {gae.sdk}/lib/opt/user/datanucleus/v2.


Stack trace obtained when trying to access object:

Unexpected RuntimeException

Last cause: null
WicketMessage: Can't instantiate page using constructor 'public org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage(org.apache.wicket.request.mapper.parameter.PageParameters)' and argument 'objectOid=[TODO:L_1003], pageType=[ENTITY], pageTitle=[Write blog post]'. Might be it doesn't exist, may be it is not visible (public).

Stacktrace

Root cause:

java.lang.NullPointerException
     at com.google.appengine.datanucleus.EntityUtils.idToInternalKey(EntityUtils.java:204)
     at com.google.appengine.datanucleus.DatastoreIdentityKeyTranslator.getKey(DatastoreIdentityKeyTranslator.java:32)
     at org.datanucleus.ObjectManagerImpl.newObjectId(ObjectManagerImpl.java:3439)
     at org.datanucleus.api.jdo.JDOPersistenceManager.newObjectIdInstance(JDOPersistenceManager.java:1618)
     at org.datanucleus.api.jdo.JDOPersistenceManager.getObjectById(JDOPersistenceManager.java:1740)
     at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.loadPojo(DataNucleusObjectStore.java:380)
     at org.apache.isis.objectstore.jdo.datanucleus.persistence.adaptermanager.DataNucleusPojoRecreator.recreatePojo(DataNucleusPojoRecreator.java:38)
     at org.apache.isis.core.runtime.persistence.adaptermanager.AdapterManagerDefault.adapterFor(AdapterManagerDefault.java:300)
     at org.apache.isis.viewer.wicket.model.mementos.ObjectAdapterMemento$Type$2.recreateAdapter(ObjectAdapterMemento.java:104)
     at org.apache.isis.viewer.wicket.model.mementos.ObjectAdapterMemento$Type.getAdapter(ObjectAdapterMemento.java:170)
     at org.apache.isis.viewer.wicket.model.mementos.ObjectAdapterMemento.getObjectAdapter(ObjectAdapterMemento.java:288)
     at org.apache.isis.viewer.wicket.model.models.EntityModel.load(EntityModel.java:193)
     at org.apache.isis.viewer.wicket.model.models.EntityModel.load(EntityModel.java:202)
     at org.apache.isis.viewer.wicket.model.models.EntityModel.load(EntityModel.java:52)
     at org.apache.wicket.model.LoadableDetachableModel.getObject(LoadableDetachableModel.java:121)
     at org.apache.isis.viewer.wicket.ui.components.entity.EntityComponentFactoryAbstract.appliesTo(EntityComponentFactoryAbstract.java:55)
     at org.apache.isis.viewer.wicket.ui.ComponentFactoryAbstract.appliesTo(ComponentFactoryAbstract.java:61)
     at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.findComponentFactories(ComponentFactoryRegistryDefault.java:136)
     at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.findComponentFactory(ComponentFactoryRegistryDefault.java:153)
     at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.findComponentFactoryElseFailFast(ComponentFactoryRegistryDefault.java:159)
     at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.createComponent(ComponentFactoryRegistryDefault.java:119)
     at org.apache.isis.viewer.wicket.viewer.registries.components.ComponentFactoryRegistryDefault.addOrReplaceComponent(ComponentFactoryRegistryDefault.java:105)
     at org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addComponent(PageAbstract.java:201)
     at org.apache.isis.viewer.wicket.ui.pages.PageAbstract.addChildComponents(PageAbstract.java:196)
     at org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage.<init>(EntityPage.java:50)
     at java.lang.reflect.Constructor.newInstance(Constructor.java:33)
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:170)
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:98)
     at org.apache.wicket.DefaultMapperContext.newPageInstance(DefaultMapperContext.java:137)
     at org.apache.wicket.core.request.handler.PageProvider.resolvePageInstance(PageProvider.java:278)
     at org.apache.wicket.core.request.handler.PageProvider.getPageInstance(PageProvider.java:166)
     at org.apache.wicket.request.handler.render.PageRenderer.getPage(PageRenderer.java:78)
     at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:94)
     at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:196)
     at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:165)
     at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:830)
     at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
     at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:253)
     at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:210)
     at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:281)
     at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:188)
     at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:245)
     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
     at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
     at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
     at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
     at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
     at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
     at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
     at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
     at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
     at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
     at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
     at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
     at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
     at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
     at org.mortbay.jetty.Server.handle(Server.java:326)
     at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
     at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
     at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
     at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:454)
     at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:461)
     at com.google.tracing.TraceContext.runInContext(TraceContext.java:703)
     at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:338)
     at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:330)
     at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:458)
     at java.lang.Thread.run(Thread.java:679)

Complete stack:

org.apache.wicket.WicketRuntimeException: Can't instantiate page using constructor 'public org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage(org.apache.wicket.request.mapper.parameter.PageParameters)' and argument 'objectOid=[TODO:L_1003], pageType=[ENTITY], pageTitle=[Write blog post]'. Might be it doesn't exist, may be it is not visible (public).
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:193)
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:98)
     at org.apache.wicket.DefaultMapperContext.newPageInstance(DefaultMapperContext.java:137)
     at org.apache.wicket.core.request.handler.PageProvider.resolvePageInstance(PageProvider.java:278)
     at org.apache.wicket.core.request.handler.PageProvider.getPageInstance(PageProvider.java:166)
     at org.apache.wicket.request.handler.render.PageRenderer.getPage(PageRenderer.java:78)
     at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:94)
     at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:196)
     at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:165)
     at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:830)
     at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
     at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:253)
     at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:210)
     at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:281)
     at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:188)

java.lang.reflect.InvocationTargetException
     at com.google.appengine.runtime.Request.process-d3177901ba10f473(Request.java)
     at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
     at java.lang.reflect.Constructor.newInstance(Constructor.java:33)
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:170)
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:98)
     at org.apache.wicket.DefaultMapperContext.newPageInstance(DefaultMapperContext.java:137)
     at org.apache.wicket.core.request.handler.PageProvider.resolvePageInstance(PageProvider.java:278)
     at org.apache.wicket.core.request.handler.PageProvider.getPageInstance(PageProvider.java:166)
     at org.apache.wicket.request.handler.render.PageRenderer.getPage(PageRenderer.java:78)
     at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:94)
     at org.apache.wicket.request.handler.render.WebPageRenderer.respond(WebPageRenderer.java:196)
     at org.apache.wicket.core.request.handler.RenderPageRequestHandler.respond(RenderPageRequestHandler.java:165)
     at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:830)
     at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
     at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:253)
     at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:210)
     at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:281)
     at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:188)
"
ISIS-321,Bug,Closed,gracefully handle any constraint violation thrown by the DataNucleus persistence mechanism (to be handled by JDO ObjectStore & Wicket),"eg: if add the @Unique annotation to a field, should get back a user-friendly message in the action panel (or equally, in the edit object entity page).

Instead, at the moment going straight to a 500 stack trace (see below as to what we get).

What we want:
- need to catch a runtimeexception in the actionPage and the EntityPage in the wicket viewer, and to render in a feedback panel

Ideas on how to accomplish this:
- in this particular case, we'd've expected there to be a validate on the action, which (barring a race condition) would have detected the error
- nevertheless, occasionally race conditions will occur, and/or the domain programmer just forgot to implement the validation
- in these cases, we'd still like a user friendly message, but perhaps should also log so that the programmer knows about it and can decide if it was a real problem or not
- thus, could provide some sort of ""ErrorHandlingService"" that would take an exception and try to generate a sensible message to display; would be a knowledge base of lookup codes, regexs etc.  If none available, then would just use the ex.getMessage()
- in all cases, the exception would be logged and the progammer/administrator would use a tool such as Nagios/Zabbix etc to do the actual monitoring of the health of the app


Here's an example of the kind of stack trace that such a service would need to handle:

javax.jdo.JDODataStoreException: Insert of object ""org.estatio.dom.asset.Property@45d0e784"" using statement ""INSERT INTO PROPERTY (DISPOSALDATE,OPENINGDATE,AREA,""NAME"",ACQUIREDATE,""TYPE"",REFERENCE) VALUES (?,?,?,?,?,?,?)"" failed : integrity constraint violation: unique constraint or index violation; REFERENCE_IDX table: PROPERTY
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:421)
	at org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.java:736)
	at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistent(JDOPersistenceManager.java:756)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.commands.DataNucleusCreateObjectCommand.execute(DataNucleusCreateObjectCommand.java:53)
	at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.executeCommands(DataNucleusObjectStore.java:346)
	at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.execute(DataNucleusObjectStore.java:340)
	at org.apache.isis.core.runtime.system.transaction.IsisTransaction.doFlush(IsisTransaction.java:350)
	at org.apache.isis.core.runtime.system.transaction.IsisTransaction.flush(IsisTransaction.java:314)
	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel$ResultType$1.addResultsAccordingToSingleResultsMode(ActionPanel.java:194)
	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel$ResultType$1.addResults(ActionPanel.java:164)
	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.executeActionAndProcessResults(ActionPanel.java:133)
	at org.apache.isis.viewer.wicket.ui.actions.params.ActionParametersFormPanel$ActionParameterForm$1.onSubmit(ActionParametersFormPanel.java:121)
	at org.apache.wicket.markup.html.form.Form.delegateSubmit(Form.java:1235)
	at org.apache.wicket.markup.html.form.Form.process(Form.java:921)
	at org.apache.wicket.markup.html.form.Form.onFormSubmitted(Form.java:767)
	at org.apache.wicket.markup.html.form.Form.onFormSubmitted(Form.java:700)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
	at java.lang.reflect.Method.invoke(Unknown Source)
	at org.apache.wicket.RequestListenerInterface.internalInvoke(RequestListenerInterface.java:258)
	at org.apache.wicket.RequestListenerInterface.invoke(RequestListenerInterface.java:216)
	at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.invokeListener(ListenerInterfaceRequestHandler.java:240)
	at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.respond(ListenerInterfaceRequestHandler.java:226)
	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:830)
	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:253)
	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:210)
	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:281)
	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:188)
	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:245)
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
	at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)
	at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
	at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
	at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)
	at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)
	at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
	at org.mortbay.jetty.Server.handle(Server.java:326)
	at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
	at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:945)
	at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:756)
	at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)
	at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
	at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)
	at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
NestedThrowablesStackTrace:
java.sql.SQLIntegrityConstraintViolationException: integrity constraint violation: unique constraint or index violation; REFERENCE_IDX table: PROPERTY
	at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
	at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
	at org.hsqldb.jdbc.JDBCPreparedStatement.fetchResult(Unknown Source)
	at org.hsqldb.jdbc.JDBCPreparedStatement.executeUpdate(Unknown Source)
	at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeUpdate(NewProxyPreparedStatement.java:105)
	at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:419)
	at org.datanucleus.store.rdbms.request.InsertRequest.execute(InsertRequest.java:411)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertTable(RDBMSPersistenceHandler.java:166)
	at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertObject(RDBMSPersistenceHandler.java:142)
	at org.datanucleus.state.JDOStateManager.internalMakePersistent(JDOStateManager.java:2381)
	at org.datanucleus.state.JDOStateManager.makePersistent(JDOStateManager.java:2357)
	at org.datanucleus.ObjectManagerImpl.persistObjectInternal(ObjectManagerImpl.java:1896)
	at org.datanucleus.ObjectManagerImpl.persistObjectWork(ObjectManagerImpl.java:1745)
	at org.datanucleus.ObjectManagerImpl.persistObject(ObjectManagerImpl.java:1593)
	at org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.java:731)
	at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistent(JDOPersistenceManager.java:756)
	at org.apache.isis.objectstore.jdo.datanucleus.persistence.commands.DataNucleusCreateObjectCommand.execute(DataNucleusCreateObjectCommand.java:53)
	at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.executeCommands(DataNucleusObjectStore.java:346)
	at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.execute(DataNucleusObjectStore.java:340)
	at org.apache.isis.core.runtime.system.transaction.IsisTransaction.doFlush(IsisTransaction.java:350)
	at org.apache.isis.core.runtime.system.transaction.IsisTransaction.flush(IsisTransaction.java:314)
	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel$ResultType$1.addResultsAccordingToSingleResultsMode(ActionPanel.java:194)
	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel$ResultType$1.addResults(ActionPanel.java:164)
	at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.executeActionAndProcessResults(ActionPanel.java:133)
	at org.apache.isis.viewer.wicket.ui.actions.params.ActionParametersFormPanel$ActionParameterForm$1.onSubmit(ActionParametersFormPanel.java:121)
	at org.apache.wicket.markup.html.form.Form.delegateSubmit(Form.java:1235)
	at org.apache.wicket.markup.html.form.Form.process(Form.java:921)
	at org.apache.wicket.markup.html.form.Form.onFormSubmitted(Form.java:767)
	at org.apache.wicket.markup.html.form.Form.onFormSubmitted(Form.java:700)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
	at java.lang.reflect.Method.invoke(Unknown Source)
	at org.apache.wicket.RequestListenerInterface.internalInvoke(RequestListenerInterface.java:258)
	at org.apache.wicket.RequestListenerInterface.invoke(RequestListenerInterface.java:216)
	at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.invokeListener(ListenerInterfaceRequestHandler.java:240)
	at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.respond(ListenerInterfaceRequestHandler.java:226)
	at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:830)
	at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
	at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:253)
	at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:210)
	at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:281)
	at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:188)
	at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:245)
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
	at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)
	at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
	at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
	at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)
	at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)
	at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
	at org.mortbay.jetty.Server.handle(Server.java:326)
	at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
	at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:945)
	at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:756)
	at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)
	at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
	at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)
	at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
Caused by: org.hsqldb.HsqlException: integrity constraint violation: unique constraint or index violation; REFERENCE_IDX table: PROPERTY
	at org.hsqldb.error.Error.error(Unknown Source)
	at org.hsqldb.Constraint.getException(Unknown Source)
	at org.hsqldb.index.IndexAVLMemory.insert(Unknown Source)
	at org.hsqldb.persist.RowStoreAVL.indexRow(Unknown Source)
	at org.hsqldb.TransactionManager2PL.addInsertAction(Unknown Source)
	at org.hsqldb.Session.addInsertAction(Unknown Source)
	at org.hsqldb.Table.insertSingleRow(Unknown Source)
	at org.hsqldb.StatementDML.insertSingleRow(Unknown Source)
	at org.hsqldb.StatementInsert.getResult(Unknown Source)
	at org.hsqldb.StatementDMQL.execute(Unknown Source)
	at org.hsqldb.Session.executeCompiledStatement(Unknown Source)
	at org.hsqldb.Session.execute(Unknown Source)
	... 65 more

and also

org.hsqldb.HsqlException: integrity constraint violation: unique constraint or index violation; REFERENCE_IDX table: PROPERTY
     at org.hsqldb.error.Error.error(Unknown Source)
     at org.hsqldb.Constraint.getException(Unknown Source)
     at org.hsqldb.index.IndexAVLMemory.insert(Unknown Source)
     at org.hsqldb.persist.RowStoreAVL.indexRow(Unknown Source)
     at org.hsqldb.TransactionManager2PL.addInsertAction(Unknown Source)
     at org.hsqldb.Session.addInsertAction(Unknown Source)
     at org.hsqldb.Table.insertSingleRow(Unknown Source)
     at org.hsqldb.StatementDML.insertSingleRow(Unknown Source)
     at org.hsqldb.StatementInsert.getResult(Unknown Source)
     at org.hsqldb.StatementDMQL.execute(Unknown Source)
     at org.hsqldb.Session.executeCompiledStatement(Unknown Source)
     at org.hsqldb.Session.execute(Unknown Source)
     at org.hsqldb.jdbc.JDBCPreparedStatement.fetchResult(Unknown Source)
     at org.hsqldb.jdbc.JDBCPreparedStatement.executeUpdate(Unknown Source)
     at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeUpdate(NewProxyPreparedStatement.java:105)
     at org.datanucleus.store.rdbms.SQLController.executeStatementUpdate(SQLController.java:419)
     at org.datanucleus.store.rdbms.request.InsertRequest.execute(InsertRequest.java:411)
     at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertTable(RDBMSPersistenceHandler.java:166)
     at org.datanucleus.store.rdbms.RDBMSPersistenceHandler.insertObject(RDBMSPersistenceHandler.java:142)
     at org.datanucleus.state.JDOStateManager.internalMakePersistent(JDOStateManager.java:2381)
     at org.datanucleus.state.JDOStateManager.makePersistent(JDOStateManager.java:2357)
     at org.datanucleus.ObjectManagerImpl.persistObjectInternal(ObjectManagerImpl.java:1896)
     at org.datanucleus.ObjectManagerImpl.persistObjectWork(ObjectManagerImpl.java:1745)
     at org.datanucleus.ObjectManagerImpl.persistObject(ObjectManagerImpl.java:1593)
     at org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.java:731)
     at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistent(JDOPersistenceManager.java:756)
     at org.apache.isis.objectstore.jdo.datanucleus.persistence.commands.DataNucleusCreateObjectCommand.execute(DataNucleusCreateObjectCommand.java:53)
     at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.executeCommands(DataNucleusObjectStore.java:346)
     at org.apache.isis.objectstore.jdo.datanucleus.DataNucleusObjectStore.execute(DataNucleusObjectStore.java:340)
     at org.apache.isis.core.runtime.system.transaction.IsisTransaction.doFlush(IsisTransaction.java:350)
     at org.apache.isis.core.runtime.system.transaction.IsisTransaction.flush(IsisTransaction.java:314)
     at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel$ResultType$1.addResultsAccordingToSingleResultsMode(ActionPanel.java:194)
     at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel$ResultType$1.addResults(ActionPanel.java:164)
     at org.apache.isis.viewer.wicket.ui.components.actions.ActionPanel.executeActionAndProcessResults(ActionPanel.java:133)
     at org.apache.isis.viewer.wicket.ui.actions.params.ActionParametersFormPanel$ActionParameterForm$1.onSubmit(ActionParametersFormPanel.java:121)
     at org.apache.wicket.markup.html.form.Form.delegateSubmit(Form.java:1235)
     at org.apache.wicket.markup.html.form.Form.process(Form.java:921)
     at org.apache.wicket.markup.html.form.Form.onFormSubmitted(Form.java:767)
     at org.apache.wicket.markup.html.form.Form.onFormSubmitted(Form.java:700)
     at java.lang.reflect.Method.invoke(Unknown Source)
     at org.apache.wicket.RequestListenerInterface.internalInvoke(RequestListenerInterface.java:258)
     at org.apache.wicket.RequestListenerInterface.invoke(RequestListenerInterface.java:216)
     at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.invokeListener(ListenerInterfaceRequestHandler.java:240)
     at org.apache.wicket.core.request.handler.ListenerInterfaceRequestHandler.respond(ListenerInterfaceRequestHandler.java:226)
     at org.apache.wicket.request.cycle.RequestCycle$HandlerExecutor.respond(RequestCycle.java:830)
     at org.apache.wicket.request.RequestHandlerStack.execute(RequestHandlerStack.java:64)
     at org.apache.wicket.request.cycle.RequestCycle.execute(RequestCycle.java:253)
     at org.apache.wicket.request.cycle.RequestCycle.processRequest(RequestCycle.java:210)
     at org.apache.wicket.request.cycle.RequestCycle.processRequestAndDetach(RequestCycle.java:281)
     at org.apache.wicket.protocol.http.WicketFilter.processRequest(WicketFilter.java:188)
     at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:245)
     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
     at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
     at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
     at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
     at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
     at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)
     at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
     at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
     at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)
     at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
     at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)"
ISIS-320,Improvement,Closed,Be more verbose when wicket page fails to render,"A runtime exception generated by the domain object model was being swallowed in PageAbstract, causing a simple redirect back to the sign in page with nothing to go on in the logs."
ISIS-319,Task,Closed,"Preparation for release of isis-core 1.1.0, wicket 1.1.0, shiro 1.1.0, archetype-wrj 1.0.2",
ISIS-318,Bug,Closed,Restful Objects viewer returning 500 instead of 400 when given bad input,"For example, this invalid input:

{
    ""description"": ""Eat Seaweed"",
    ""category"": ""OTHER"",
    ""dueBy"": ""Jan 23, 2013""
}

using URL:   http://localhost:8080/restful/services/toDoItems/actions/newToDo/invoke

returns a 500 instead of 400 (the problem is both value formatting and the missing ""value"" key for each arg).

This erroneous input:
{
    ""description"": {""value"":  ""Eat Seaweed""},
    ""category"": {""value"": ""OTHER""},
    ""subcategory"": {""value"": ""OTHER""},
    ""dueBy"": {""value"": ""Jan 23, 2013""},
    ""cost"": {""value"": ""123.45""}
}

(still) produces the stacktrace [A] below

This erroneous input:
{
    ""description"": {""value"":  ""Eat Seaweed""},
    ""category"": {""value"": ""Other""},
    ""subcategory"": {""value"": ""Other""},
    ""dueBy"": {""value"": ""Jan 23, 2013""},
    ""cost"": {""value"": ""123.45""}
}

produces the stacktrace [B] below


fyi the correct input is 

{
    ""description"": {""value"":  ""Eat Seaweed""},
    ""category"": {""value"": ""Other""},
    ""subcategory"": {""value"": ""Other""},
    ""dueBy"": {""value"": ""20130123T000000000""},
    ""cost"": {""value"": ""123.45""}
}

... which works.

stacktrace [A] :

{
  ""message"": ""Unknown enum constant 'OTHER'"",
  ""stackTrace"": [
    ""org.apache.isis.core.progmodel.facets.object.choices.enums.EnumValueSemanticsProvider.doParse(EnumValueSemanticsProvider.java:63)"",
    ""org.apache.isis.core.progmodel.facets.object.choices.enums.EnumValueSemanticsProvider.doRestore(EnumValueSemanticsProvider.java:73)"",
    ""org.apache.isis.core.progmodel.facets.object.choices.enums.EnumValueSemanticsProvider.doRestore(EnumValueSemanticsProvider.java:32)"",
    ""org.apache.isis.core.progmodel.facets.object.value.ValueSemanticsProviderAndFacetAbstract.fromEncodedString(ValueSemanticsProviderAndFacetAbstract.java:261)"",
    ""org.apache.isis.core.progmodel.facets.object.encodeable.EncodableFacetUsingEncoderDecoder.fromEncodedString(EncodableFacetUsingEncoderDecoder.java:60)"",
    ""org.apache.isis.viewer.restfulobjects.viewer.resources.domainobjects.JsonValueEncoder.asAdapter(JsonValueEncoder.java:163)"",
    ""org.apache.isis.viewer.restfulobjects.viewer.resources.domainobjects.DomainResourceHelper.objectAdapterFor(DomainResourceHelper.java:332)"",
    ""org.apache.isis.viewer.restfulobjects.viewer.resources.domainobjects.DomainResourceHelper.parseArguments(DomainResourceHelper.java:476)"",
    ""org.apache.isis.viewer.restfulobjects.viewer.resources.domainobjects.DomainResourceHelper.parseArguments(DomainResourceHelper.java:463)"",
    ""org.apache.isis.viewer.restfulobjects.viewer.resources.domainobjects.DomainResourceHelper.invokeActionUsingAdapters(DomainResourceHelper.java:270)"",
    ""org.apache.isis.viewer.restfulobjects.viewer.resources.domainobjects.DomainResourceHelper.invokeAction(DomainResourceHelper.java:265)"",
    ""org.apache.isis.viewer.restfulobjects.viewer.resources.domainobjects.DomainObjectResourceServerside.invokeAction(DomainObjectResourceServerside.java:407)"",
    ""sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)"",
    ""sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)"",
    ""sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)"",
    ""java.lang.reflect.Method.invoke(Method.java:601)"",
    ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:155)"",
    ""org.jboss.resteasy.core.ResourceMethod.invokeOnTarget(ResourceMethod.java:257)"",
    ""org.jboss.resteasy.core.ResourceMethod.invoke(ResourceMethod.java:222)"",
    ""org.jboss.resteasy.core.ResourceMethod.invoke(ResourceMethod.java:211)"",
    ""org.jboss.resteasy.core.SynchronousDispatcher.getResponse(SynchronousDispatcher.java:525)"",
    ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:502)"",
    ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:119)"",
    ""org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:208)"",


stacktrace [B] :

{
  ""message"" : ""java.text.ParseException: Unparseable date: \""Jan 23, 2013\"""",
  ""stackTrace"" : [ ""org.apache.isis.core.progmodel.facets.value.ValueSemanticsProviderAbstractTemporal.doRestore(ValueSemanticsProviderAbstractTemporal.java:313)"", ""org.apache.isis.core.progmodel.facets.object.value.ValueSemanticsProviderAndFacetAbstract.fromEncodedString(ValueSemanticsProviderAndFacetAbstract.java:261)"", ""org.apache.isis.core.progmodel.facets.object.encodeable.EncodableFacetUsingEncoderDecoder.fromEncodedString(EncodableFacetUsingEncoderDecoder.java:60)"", ""org.apache.isis.viewer.restfulobjects.rendering.domainobjects.JsonValueEncoder.asAdapter(JsonValueEncoder.java:395)"", ""org.apache.isis.viewer.restfulobjects.server.resources.DomainResourceHelper.objectAdapterFor(DomainResourceHelper.java:313)"", ""org.apache.isis.viewer.restfulobjects.server.resources.DomainResourceHelper.parseAndValidateArguments(DomainResourceHelper.java:476)"", ""org.apache.isis.viewer.restfulobjects.server.resources.DomainResourceHelper.invokeActionUsingAdapters(DomainResourceHelper.java:277)"", ""org.apache.isis.viewer.restfulobjects.server.resources.DomainResourceHelper.invokeAction(DomainResourceHelper.java:272)"", ""org.apache.isis.viewer.restfulobjects.server.resources.DomainServiceResourceServerside.invokeAction(DomainServiceResourceServerside.java:173)"", ""sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)"", ""sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)"", ""sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)"", ""java.lang.reflect.Method.invoke(Unknown Source)"", ""org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:167)"", ""org.jboss.resteasy.core.ResourceMethod.invokeOnTarget(ResourceMethod.java:269)"", ""org.jboss.resteasy.core.ResourceMethod.invoke(ResourceMethod.java:227)"", ""org.jboss.resteasy.core.ResourceMethod.invoke(ResourceMethod.java:216)"", ""org.jboss.resteasy.core.SynchronousDispatcher.getResponse(SynchronousDispatcher.java:542)"", ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:524)"", ""org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:126)"", ""org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:208)"", ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55)"", ""org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:50)"", ""javax.servlet.http.HttpServlet.service(HttpServlet.java:806)"", ""org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)"", ""org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1221)"", ""org.apache.isis.core.webapp.IsisSessionFilter$SessionState$1.handle(IsisSessionFilter.java:315)"", ""org.apache.isis.core.webapp.IsisSessionFilter.doFilter(IsisSessionFilter.java:404)"", ""org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)"", ""org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)"", ""org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)"", ""org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)"", ""org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)"", ""org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)"", ""org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)"", ""org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)"", ""org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)"", ""org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)"", ""org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)"", ""org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)"", ""org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)"", ""org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)"", ""org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)"", ""org.mortbay.jetty.Server.handle(Server.java:326)"", ""org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)"", ""org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:945)"", ""org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:756)"", ""org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)"", ""org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)"", ""org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)"", ""org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)"" ],
  ""causedBy"" : {
    ""message"" : ""Unparseable date: \""Jan 23, 2013\"""",
    ""stackTrace"" : [ ""java.text.DateFormat.parse(Unknown Source)"", ""org.apache.isis.core.progmodel.facets.value.ValueSemanticsProviderAbstractTemporal.parse(ValueSemanticsProviderAbstractTemporal.java:319)"", ""org.apache.isis.core.progmodel.facets.value.ValueSemanticsProviderAbstractTemporal.doRestore(ValueSemanticsProviderAbstractTemporal.java:303)"", ""org.apache.isis.core.progmodel.facets.object.value.ValueSemanticsProviderAndFacetAbstract.fromEncodedString(ValueSemanticsProviderAndFacetAbstract.java:261)"", ""org.apache.isis.core.progmodel.facets.object.encodeable.EncodableFacetUsingEncoderDecoder.fromEncodedString(EncodableFacetUsingEncoderDecoder.java:60)"", ""org.apache.isis.viewer.restfulobjects.rendering.domainobjects.JsonValueEncoder.asAdapter(JsonValueEncoder.java:395)"", ""org.apache.isis.viewer.restfulobjects.server.resources.DomainResourceHelper.objectAdapterFor(DomainResourceHelper.java:313)"", ""org.apache.isis.viewer.restfulobjects.server.resources.DomainResourceHelper.parseAndValidateArguments(DomainResourceHelper.java:476)"", ""org.apache.isis.viewer.restfulobjects.server.resources.DomainResourceHelper.invokeActionUsingAdapters(DomainResourceHelper.java:277)"", }"
ISIS-317,Bug,Closed,Require @Named annotation for category in the quickstart's ToDoItem's duplicate(...) method,"... otherwise the label is shown as ""ToDoItem$Category"" (because Category is defined as a nested enum)."
ISIS-316,Bug,Closed,After graduation tasks,"Per: ASF Graduation Guide: http://incubator.apache.org/guides/graduation.html#life-after-graduation

1. Update PMC Chair details (under https://svn.apache.org/repos/private , requires karma to have been granted to PMC Chair or an ASF member):
- foundation/officers/affiliations.txt
  - DONE
- foundation/officers/irs-disclosures.txt
  - DONE
- committers/board/committee-info.txt
  - Section 1: Change chair
  - Section 2: selected Jan/Apr/Jul/Oct as 3 monthly schedule Feb/March/April will be monthly for first 3 months
  - Section 3: Update old chair, update new chair
  - DONE

Updated PMC details on project website
TODO


2. PMC Chair to subscribe to:
- board@apache.org (via board-subscribe@apache.org) DONE
- infrastructure@apache.org (via infrastructure-subscribe@apache.org) TODO

DONE, subscriptions approved by the moderators of both lists.


3. Infra transfer tasks

as per: http://incubator.apache.org/guides/graduation.html#transfer, (1)
  - INFRA-???? created as an umbrella (top-level task can be cloned from INFRA-4069, umbrella for JMeter TPL)

TODO

3a. root tasks

subtask INFRA-???? (cf INFRA-4070 from JMeter)
- create a DNS entry ""openmeetings.apache.org"".
- create:
  - the LDAP unix group ""openmeetings""
  - the LDAP committee group ""openmeetings""

TODO


3b. add the OpenMeetings PMC/committers list as initial members of both:

EXAMPLE:
ssh -l danhaywood people.apache.org

modify_committee.pl isis --add=danhaywood,rmatthews,kevin,themalkolm,dslaughter,jcvanderwal,mnour,struberg
modify_unix_group.pl isis --add=danhaywood,rmatthews,kevin,themalkolm,dslaughter,jcvanderwal,mnour,struberg

TODO


3c. Move source code

subtask INFRA-????

EXAMPLE
from: https://svn.apache.org/repos/asf/incubator/isis
to: https://svn.apache.org/repos/asf/isis

TODO


3d. Move mailing lists 

EXAMPLE
subtask INFRA-???? (cf INFRA-4071 from JMeter)
- Please create new mailing lists
  - isis-users@incubator.apache.org -> users@isis.apache.org
  - isis-dev@incubator.apache.org -> dev@isis.apache.org
  - isis-private@incubator.apache.org -> private@isis.apache.org
  - isis-commits@incubator.apache.org -> commits@isis.apache.org

- migrate existing subscribers

TODO.
(EXAMPLE
 Confirmed existing subscribers by sending an email to users-list@isis.apache.org and dev-list@isis.apache.org.)


3e. Create website (our prereqs)

per http://www.apache.org/dev/cmsref.html#svn

committed to https://svn.apache.org/repos/asf/incubator/isis/site

other refs:
[1] http://www.apache.org/dev/#web
[2] http://www.apache.org/dev/cms.html#layout
[3] http://www.apache.org/dev/cmsref.html#walkthrough
[4] http://www.apache.org/dev/project-site.html

TODO


3f. Move website

EXAMPLE
The Isis website must be moved to http://incubator.apache.org/isis to http://isis.apache.org

subtask INFRA-????
Please set up for CMS.

<danielsh> danhaywood: +| Create a **CMS-based site** | URL of the [layout-compliant](cmsref#layout) site source, and what build system to use | Build system types include: path.pm, build_cms.sh, maven/ant/forrest. |

Specified https://svn.apache.org/repos/asf/incubator/isis/site (but will be https://svn.apache.org/repos/asf/isis/site after INFRA-5484)

TODO


3g. Wiki and JIRA

EXAMPLE
- these do not need any changes (cf JMeter examplar INFRA-4069 which did require subtasks)

TODO

3h. Update builds.apache.org for new SVN directory

TODO


4. Mailing list tidy up tasks

EXAMPLE
- When podling lists have been transferred to their new home (by infrastructure), post an announcement to user and development lists. 
- When using Maven: update pom.xml for the new mailing list address(es).
- Update any documents on your website that show how to subscribe to the lists and/or find archives. 
- Send notice to Markmail.org and Nabble.com that the address has changed, and the location of the project 
- Update website: replace links to old archives with links to new ones and add new links to historic archives from incubation. 
- Check project-private mailing list membership. Mentors should be allowed to remain if they wish to do so. The subscriber list should otherwise match that on the resolution. See this and the EZMLM ""Moderator's and Administrator's Manual"". 
- Update mail addresses including: 
svn commit messages (see infrastructure/trunk/subversion/authorization/asf-mailer.conf ) 
- change svn commit hook to mail the new commits@isis.apache.org mailing list
confluence commit messages (see adminstration documentation) 
issue tracking messages (see administration documentation) 
- The existing mailing lists should then be removed/cancelled (whatever is normally done...)

TODO

5. Update incubator's podling status page

EXAMPLE
- http://incubator.apache.org/projects/isis.html
(by updating https://svn.apache.org/repos/asf/incubator/public/trunk/content/projects/isis.xml, and published as per http://incubator.apache.org/guides/website.html)

TODO

6. Checked/updated Apache branding on site

as per:
* http://www.apache.org/foundation/marks/pmcs.html#attributions
* http://www.apache.org/foundation/marks/pmcs.html#navigation

specifically: make sure have (TM) in banner; make sure description of project on home page and on download page; make sure have standard links to top-level Apache pages.

TODO


7. Update infra build tools, DOAP files

checkout https://svn.apache.org/repos/asf/infrastructure/site-tools/trunk/projects
as per the README_NEWTLP:
- create RDF in data_files/
- update files.xml with location of DOAP file
- update xdocs/create.xml

TODO "
ISIS-315,Improvement,Closed,Allow Wicket applications to bootstrap from a config directory outside of WEB-INF,
ISIS-314,Improvement,Closed,The wicket viewer should honour precision and scale when rendering BigDecimal values.,
ISIS-313,Bug,Closed,Quickstart app's ToDoItem does not allow an item to be a dependency of more than one item.,"In other words, it's a 1:m instead of a m:n."
ISIS-312,Bug,Closed,Guard in BaseFixture to allow fixtures to load in production mode was faulty,"     public BaseFixture(final FixtureType fixtureType) {
         this.fixtureType = fixtureType;
         try {
             clock = FixtureClock.initialize();
-        } catch (final IllegalStateException ex) {
+        } catch (final ApplicationException ex) {
             clock = null;
             System.err.println(ex.getMessage());
             System.err.println(""calls to change date or time will be ignored"");
         }
     }"
ISIS-311,Improvement,Closed,Minor fixes for branding in distributed code (eg quickstart archetype),
ISIS-310,Improvement,Closed,Update pom.xml for example metamodel namefile,Explicitly specify the maven compiler plugin configuration.
ISIS-309,Improvement,Closed,Minor fixes to support extensions to Wicket viewer.,Extending the API in a few places to enable third-party components (eg gmap2) to be supported.
ISIS-308,Improvement,Closed,Don't show (null) for a property or a parameter that has no reference (instead show an empty string),
ISIS-307,New Feature,Closed,Allow groups to be mapped to roles (eg AD groups to logically internal application roles),
ISIS-306,Bug,Closed,Parsing permission strings should trim both before and after.,
ISIS-305,Improvement,Closed,compareTo methods (when implement Comparable) should be automatically hidden,
ISIS-304,New Feature,Closed,"Contributed actions for collections (1-arg, no business rules) do not appear.",Introduce @Bulk annotation for either contributed or entity actions that can be invoked for standalone collections.
ISIS-303,Task,Closed,Migration of DataNucleus (DN) type support to use DN v3.2 standard,"In the development of DN3.2 it was necessary to move the ""org.datanucleus.store.mapped"" classes from datanucleus-core into datanucleus-rdbms in package ""org.datanucleus.store.rdbms.mapping.java"" (since they were only used there). This will impact on support for ""applib.value.DateTime"", ""applib.value.Date"" where you'll have to update the package names of what class is being extended for the RDBMS mappings."
ISIS-302,Bug,Closed,Ensure related items are mapped into pojo (possible eager loading of parent/child relationship),"Example was LeaseItem / LeaseTerm; the LeaseTerms were not mapped; not sure why, but seems to be sufficient to map in a just-in-time fashion.


Thread [560514446@qtp-1758293396-4] (Suspended (breakpoint at line 163 in FrameworkSynchronizer$3))	
	FrameworkSynchronizer$3.run() line: 163	
	FrameworkSynchronizer$5.call() line: 220	
	FrameworkSynchronizer$5.call() line: 1	
	FrameworkSynchronizer.withLogging(PersistenceCapable, Callable<T>, CalledFrom) line: 205	
	FrameworkSynchronizer.withLogging(PersistenceCapable, Runnable, FrameworkSynchronizer$CalledFrom) line: 216	
	FrameworkSynchronizer.preDirtyProcessingFor(PersistenceCapable, FrameworkSynchronizer$CalledFrom) line: 157	
	IsisLifecycleListener$3.doRun() line: 105	
	IsisLifecycleListener$3(IsisLifecycleListener$RunnableAbstract).run() line: 187	
	IsisLifecycleListener.withLogging(IsisLifecycleListener$Phase, InstanceLifecycleEvent, Runnable) line: 166	
	IsisLifecycleListener.preDirty(InstanceLifecycleEvent) line: 101	
	JDOCallbackHandler.preDirty(Object) line: 262	
	JDOStateManager.preWriteField(int) line: 3572	
	JDOStateManager(AbstractStateManager).setObjectField(PersistenceCapable, int, Object, Object) line: 2116	
	LeaseTermForIndexableRent(LeaseTerm).setEndDate(LocalDate) line: not available	
	Api.putLeaseTerm(String, String, BigInteger, String, LocalDate, LocalDate, LocalDate, BigInteger) line: 535	
	Api.putLeaseTermForIndexableRent(String, String, String, BigInteger, String, LocalDate, BigInteger, LocalDate, LocalDate, String, BigDecimal, LocalDate, LocalDate, BigDecimal, BigDecimal, BigDecimal, BigDecimal, BigDecimal, String, LocalDate, LocalDate, BigDecimal, String, LocalDate, LocalDate, BigDecimal) line: 431	
	GeneratedMethodAccessor93.invoke(Object, Object[]) line: not available	
	DelegatingMethodAccessorImpl.invoke(Object, Object[]) line: not available	
	Method.invoke(Object, Object...) line: not available	
	ActionInvocationFacetViaMethod.invoke(ObjectAdapter, ObjectAdapter[]) line: 92	
	ActionInvocationFacetWrapTransaction$1.execute() line: 55	
	ActionInvocationFacetWrapTransaction$1.execute() line: 1	
	DataNucleusTransactionManager(IsisTransactionManager).executeWithinTransaction(TransactionalClosureWithReturn<Q>) line: 193	
	ActionInvocationFacetWrapTransaction.invoke(ObjectAdapter, ObjectAdapter[]) line: 52	
	ObjectActionImpl.execute(ObjectAdapter, ObjectAdapter[]) line: 415	
	DomainResourceHelper.invokeActionUsingAdapters(ObjectAction, JsonRepresentation) line: 299	
	DomainResourceHelper.invokeAction(String, InputStream, Where) line: 265	
	DomainServiceResourceServerside.invokeAction(String, String, InputStream) line: 165	
	NativeMethodAccessorImpl.invoke0(Method, Object, Object[]) line: not available [native method]	
	NativeMethodAccessorImpl.invoke(Object, Object[]) line: not available	
	DelegatingMethodAccessorImpl.invoke(Object, Object[]) line: not available	
	Method.invoke(Object, Object...) line: not available	
	MethodInjectorImpl.invoke(HttpRequest, HttpResponse, Object) line: 155	
	ResourceMethod.invokeOnTarget(HttpRequest, HttpResponse, Object) line: 257	
	ResourceMethod.invoke(HttpRequest, HttpResponse, Object) line: 222	
	ResourceMethod.invoke(HttpRequest, HttpResponse) line: 211	
	SynchronousDispatcher.getResponse(HttpRequest, HttpResponse, ResourceInvoker) line: 525	
	SynchronousDispatcher.invoke(HttpRequest, HttpResponse, ResourceInvoker) line: 502	
	SynchronousDispatcher.invoke(HttpRequest, HttpResponse) line: 119	
	ServletContainerDispatcher.service(String, HttpServletRequest, HttpServletResponse, boolean) line: 208	
	HttpServletDispatcher.service(String, HttpServletRequest, HttpServletResponse) line: 55	
	HttpServletDispatcher.service(HttpServletRequest, HttpServletResponse) line: 50	
	HttpServletDispatcher(HttpServlet).service(ServletRequest, ServletResponse) line: 806	
	ServletHolder.handle(ServletRequest, ServletResponse) line: 511	
	ServletHandler$CachedChain.doFilter(ServletRequest, ServletResponse) line: 1221	
	IsisSessionFilter$SessionState$1.handle(IsisSessionFilter, ServletRequest, ServletResponse, FilterChain) line: 315	
	IsisSessionFilter.doFilter(ServletRequest, ServletResponse, FilterChain) line: 404	
	ServletHandler$CachedChain.doFilter(ServletRequest, ServletResponse) line: 1212	
	ShiroFilter(AbstractShiroFilter).executeChain(ServletRequest, ServletResponse, FilterChain) line: 449	
	AbstractShiroFilter$1.call() line: 365	
	SubjectCallable<V>.doCall(Callable<V>) line: 90	
	SubjectCallable<V>.call() line: 83	
	WebDelegatingSubject(DelegatingSubject).execute(Callable<V>) line: 383	
	ShiroFilter(AbstractShiroFilter).doFilterInternal(ServletRequest, ServletResponse, FilterChain) line: 362	
	ShiroFilter(OncePerRequestFilter).doFilter(ServletRequest, ServletResponse, FilterChain) line: 125	
	ServletHandler$CachedChain.doFilter(ServletRequest, ServletResponse) line: 1212	
	ServletHandler.handle(String, HttpServletRequest, HttpServletResponse, int) line: 399	
	SecurityHandler.handle(String, HttpServletRequest, HttpServletResponse, int) line: 216	
	SessionHandler.handle(String, HttpServletRequest, HttpServletResponse, int) line: 182	
	WebAppContext(ContextHandler).handle(String, HttpServletRequest, HttpServletResponse, int) line: 766	
	WebAppContext.handle(String, HttpServletRequest, HttpServletResponse, int) line: 450	
	Server(HandlerWrapper).handle(String, HttpServletRequest, HttpServletResponse, int) line: 152	
	Server.handle(HttpConnection) line: 326	
	HttpConnection.handleRequest() line: 542	
	HttpConnection$RequestHandler.content(Buffer) line: 945	
	HttpParser.parseNext() line: 756	
	HttpParser.parseAvailable() line: 218	
	HttpConnection.handle() line: 404	
	SocketConnector$Connection.run() line: 228	
	QueuedThreadPool$PoolThread.run() line: 582	
"
ISIS-301,Bug,Closed,Error when using class name as discriminator strategy,
ISIS-300,Bug,Closed,"The home page link in Wicket viewer goes to root context ""/"", rather than to the base of the webapp.",
ISIS-299,Improvement,Closed,Document the logout action.  (Was: Extend the authentication API so that can explicitly logout session.),"Andi addressed this in M5, but it isn't documented yet.

At any rate, we now have an actual action that will logout the session; this is our formal API.

 

~~~~~~~~

Currently the wicket viewer's logout button merely invalidates the wicket session, but does not invalidate the shiro session because there is no API to do so.

This ticket is to provide API for this, and implement in both shiro and wicket.

Should explore the 55minutes' ShiroWicketPlugin to see how it works..."
ISIS-298,Improvement,Closed,Provide a shiro Realm implementation that supports looking up roles from an LDAP server.,
ISIS-297,Task,Closed,Support JSR-303 bean validation API,
ISIS-296,Bug,Closed,wicket viewer display ??? ENTITYMODEL OBJECTADAPTER OID: NULL when view a root entity's  collection member which data type is primitive String.,"wicket viewer display ??? ENTITYMODEL OBJECTADAPTER OID: NULL when view a root entity's  collection member which data type is primitive String.

The problem is demoed in a isis-demo project which located at: git://github.com/alainzhang/isis-demo.git The cllection menber I have defined as following:

	// {{ ContactTelephones (contact telephones )
	@Element
	private List<String> contactTelephones = new ArrayList<String>();

	@MemberOrder(sequence = ""3"")
	@Optional
	@Named(""Contact Telephones"")
	public List<String> getContactTelephones() {
		return contactTelephones;
	}

	public void setContactTelephones(final List<String> contactTelephones) {
		this.contactTelephones = contactTelephones;
	}
	// }}
"
ISIS-295,Bug,Closed,NullPointerException when view aggregated entity using Wicket viewer,"I have tried the isis 1.0.0,and there is a problem with wicket viewer. The wicket viewer provide a view link for an aggregated entity,and I caught exception such as:
Caused by: java.lang.NullPointerException
	at java.util.regex.Matcher.getTextLength(Unknown Source)
	at java.util.regex.Matcher.reset(Unknown Source)
	at java.util.regex.Matcher.<init>(Unknown Source)
	at java.util.regex.Pattern.matcher(Unknown Source)
	at org.apache.isis.core.metamodel.adapter.oid.OidMarshaller.unmarshal(OidMarshaller.java:125)
	at org.apache.isis.viewer.wicket.model.models.EntityModel.rootOidFrom(EntityModel.java:142)
	at org.apache.isis.viewer.wicket.model.models.EntityModel.<init>(EntityModel.java:124)
	at org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage.<init>(EntityPage.java:49)
	... 35 more

I created a demo project on github for the problem,the repository located at:https://github.com/alainzhang/isis-demo.git

"
ISIS-294,Task,Closed,Remove the old archetype (from 0.2.0) since is stale,"The example/archetype/quickstart archetype is out-of-date (from 0.2.0) and is liable to cause confusion.

NB: the released example/archetype/quickstart_wicket_restful_jdo archetype should remain."
ISIS-293,Improvement,Closed,Combine restful objects and wicket viewer into a single webapp,
ISIS-292,New Feature,Closed,Remove Authenticator#isValid method; should not be defined as part of API.,"This method is only ever called from a method within AuthenticatorAbstract.  It is therefore not part of the API, but rather an implementation detail of AuthenticatorAbstract.

As this is a breaking API change, required to be released in a major x.0.0 release."
ISIS-291,Improvement,Closed,Enhance the quickstart_wicket_restful_jdo-archetype to run wicket viewer and restfulobjects viewer in same webapp,
ISIS-290,New Feature,Closed,Use shiro for security (implementation of Authentication and Authorization Manager),
ISIS-289,Improvement,Closed,Tidy up the applib documentation,"Restructure, improve flow."
ISIS-288,Bug,Closed,During start up the configuration files are read in repeatedly making it confusing to track down configuration issues,"This was obfuscating a problem where the deployment type was not being changed when specified on either the command line or in the configuration file.

Work is being done to more methodically read and process the configuration files."
ISIS-287,Bug,Closed,BigInteger types throw error in Wicket viewer,BigInteger types throw error in Wicket viewer
ISIS-286,Improvement,Closed,Make sure pending changes are stored before issuing a query,"Make sure pending changes are stored before issuing a query by execting a flush() on allMatches() and firstMatch().

"
ISIS-285,Improvement,Closed,Add additional MetaModelValidators so that orphaned prefixes are treated as a validation error.,"Suggested appraoch is to have the FacetFactorys optionally implement the MetaModelRefiner interface, so that they can add a validator if required."
ISIS-284,New Feature,Closed,Maven plugin to validate domain object model w.r.t. Isis programming conventions,"The idea being to bind to the 'test' phase, and fail build if find, for example, an orphaned validateXxx() or disableXxx() method."
ISIS-283,Improvement,Closed,"Provide the ability to use fixtures as domain objects, eg within demo apps",
ISIS-282,New Feature,Closed,Add support for file uploads and downloads to Wicket viewer and JDO objectstore,"* Introduce new Blob and Clob value types into the applib, wrapping a byte[] or char[] along with a MimeType.
* enhance core metamodel/progmodel, adding facets
* teach JDO objectstore how to persist these types
* add new components in wicket viewer to allow a file to be uploaded / persisted (eg a property of type Blob/Clob)
* add new facility in wicket viewer to download blob/clobs (eg an action returning a Blob/Clob)"
ISIS-281,Improvement,Closed,Provide support for integration testing using a JUnit rule.,... so can bootstrap Isis with backend stuff in an end-to-end integration test (a la Arquillian).
ISIS-280,Improvement,Closed,"More consistent support for @Prototype and @Exploration, by utilizing the existing HidingInteractionAdvisor API","Currently all viewers must explicitly test for the presence of PrototypeFacet and ExplorationFacet and then hide actinos if not consistent with the current deployment type.

It would be better if instead PrototypeFacet and ExplorationFacet could implement HidingInteractionAdvisor, and so determine for themselves that an action should be hidden if required.

To do this the DeploymentType (more precisely... the DeploymentCategory) would need to be part of the InteractionContext."
ISIS-279,Task,Closed,Move mailinglists,"From the ASF guide:
- Request that podlings lists be transferred to their new home. Any new mailing lists should be requested at the same time.
- When this has been executed by infrastructure, post an announcement to user and development lists.
- When using Maven: update pom.xml for the new mailing list address(es). Also update any documents on your website that show how to subscribe to the lists and/or find archives.
- Send notice to Markmail.org and Nabble.com that the address has changed, and the location of the project 
- Update website: replace links to old archives with links to new ones and add new links to historic archives from incubation.
- Check project-private mailing list membership. Mentors should be allowed to remain if they wish to do so. The subscriber list should otherwise match that on the resolution. See this and the EZMLM ""Moderator's and Administrator's Manual"".
- Update mail addresses including:
svn commit messages (see infrastructure/trunk/subversion/authorization/asf-mailer.conf )
confluence commit messages (see adminstration documentation)
issue tracking messages (see administration documentation)
The chair should have karma to perform these tasks."
ISIS-278,Task,Closed,Move source code,The Isis source code must be moved outside the incubator domain. This is a good moment to switch from SVN to Git. In that case we can set up a new Git repository and phase out the existing SVN repo. It is not clear if ASF provides read/write Git repositories.
ISIS-277,Task,Closed,Move website,The Isis website must be moved to http://incubator.apache.org/isis to http://isis.apache.org
ISIS-276,Task,Closed,After graduation tasks,"Per: ASF Graduation Guide:  http://incubator.apache.org/guides/graduation.html#life-after-graduation

1. Update PMC Chair details (under https://svn.apache.org/repos/private , requires karma to have been granted to PMC Chair or an ASF member):
- foundation/officers/affiliations.txt
  - DONE
- foundation/officers/irs-disclosures.txt
  - DONE
- committers/board/committee-info.txt
  - Section 1: Change chair
  - Section 2: selected Jan/Apr/Jul/Oct as 3 monthly schedule (since will do Nov/Dec/Jan for first 3 months post grad)
  - Section 3: Update old chair, update new chair
  - DONE

Updated PMC details on project website
- updated framework/pom.xml
  - DONE


2. PMC Chair to subscribe to:
- board@apache.org  (via board-subscribe@apache.org)
- infrastructure@apache.org (via infrastructure-subscribe@apache.org)

DONE, subscriptions approved by the moderators of both lists.


3. Infra transfer tasks

as per: http://incubator.apache.org/guides/graduation.html#transfer, (1)
  -  INFRA-5480 created as an umbrella, top-level task cloned from INFRA-4069, umbrella for JMeter TPL


3a. root tasks

subtask INFRA-5481 (cf INFRA-4070 from JMeter)
- create a DNS entry ""isis.apache.org"". 
- create:
  - the LDAP unix group ""isis""
  - the LDAP committee group ""isis""

DONE


3b.  add the Isis PMC/committers list as initial members of both:

ssh -l danhaywood people.apache.org

modify_committee.pl isis --add=danhaywood,rmatthews,kevin,themalkolm,dslaughter,jcvanderwal,mnour,struberg
modify_unix_group.pl isis --add=danhaywood,rmatthews,kevin,themalkolm,dslaughter,jcvanderwal,mnour,struberg

DONE


3c. Move source code (was previously ISIS-278, has been inlined here)

subtask INFRA-5484

from: https://svn.apache.org/repos/asf/incubator/isis
to: https://svn.apache.org/repos/asf/isis

DONE


3d. Move mailing lists  (was previously ISIS-279, has been inlined here)

subtask INFRA-5482  (cf INFRA-4071 from JMeter)
- Please create new mailing lists
  - isis-users@incubator.apache.org   ->  users@isis.apache.org
  - isis-dev@incubator.apache.org   -> dev@isis.apache.org
  - isis-private@incubator.apache.org -> private@isis.apache.org
  - isis-commits@incubator.apache.org -> commits@isis.apache.org

- migrate existing subscribers

DONE.  Confirmed existing subscribers by sending an email to users-list@isis.apache.org and dev-list@isis.apache.org.


3e. Create CMS website (our prereqs)

per http://www.apache.org/dev/cmsref.html#svn

committed to https://svn.apache.org/repos/asf/incubator/isis/site

other refs:
[1] http://www.apache.org/dev/#web
[2] http://www.apache.org/dev/cms.html#layout
[3] http://www.apache.org/dev/cmsref.html#walkthrough
[4] http://www.apache.org/dev/project-site.html

DONE


3f. Move website  (was previously ISIS-277, has been inlined here)

The Isis website must be moved to http://incubator.apache.org/isis to http://isis.apache.org

subtask INFRA-5483
Please set up for CMS.

<danielsh> danhaywood: +| Create a **CMS-based site** | URL of the [layout-compliant](cmsref#layout) site source, and what build system to use | Build system types include: path.pm, build_cms.sh, maven/ant/forrest. |

Specified https://svn.apache.org/repos/asf/incubator/isis/site (but will be https://svn.apache.org/repos/asf/isis/site after INFRA-5484)

DONE


3g. Wiki and JIRA
- these do not need any changes (cf JMeter examplar INFRA-4069 which did require subtasks)


3h. Update builds.apache.org for new SVN directory

DONE


4. Mailing list tidy up tasks

- When podling lists have been transferred to their new home (by infrastructure), post an announcement to user and development lists. 
- When using Maven: update pom.xml for the new mailing list address(es).
- Update any documents on your website that show how to subscribe to the lists and/or find archives. 
- Send notice to Markmail.org and Nabble.com that the address has changed, and the location of the project 
- Update website: replace links to old archives with links to new ones and add new links to historic archives from incubation. 
- Check project-private mailing list membership. Mentors should be allowed to remain if they wish to do so. The subscriber list should otherwise match that on the resolution. See this and the EZMLM ""Moderator's and Administrator's Manual"". 
- Update mail addresses including: 
svn commit messages (see infrastructure/trunk/subversion/authorization/asf-mailer.conf ) 
- change svn commit hook to mail the new commits@isis.apache.org mailing list
confluence commit messages (see adminstration documentation) 
issue tracking messages (see administration documentation) 
- The existing mailing lists should then be removed/cancelled (whatever is normally done...)

DONE

5. Update incubator's podling status page

- http://incubator.apache.org/projects/isis.html
(by updating https://svn.apache.org/repos/asf/incubator/public/trunk/content/projects/isis.xml, and published as per http://incubator.apache.org/guides/website.html)

DONE

6. Checked/updated Apache branding on site

as per:
* http://www.apache.org/foundation/marks/pmcs.html#attributions
* http://www.apache.org/foundation/marks/pmcs.html#navigation

specifically: make sure have (TM) in banner; make sure description of project on home page and on download page; make sure have standard links to top-level Apache pages.

DONE


7. Update infra build tools, DOAP files

checkout https://svn.apache.org/repos/asf/infrastructure/site-tools/trunk/projects
as per the README_NEWTLP:
- create RDF in data_files/
- update files.xml with location of DOAP file
- update xdocs/create.xml 

DONE"
ISIS-275,Bug,Closed,html viewer encoding,It seems that there is bug in Html Viewer about encoding.The encoding configuration can not work when I changed it into UTF-8.( isis.viewer.html.encoding=UTF-8). Html Viewer will display ??? where the content is chinese character.
ISIS-274,Improvement,Closed,Simplify the bootstrapping of Isis so that there are fewer configuration properties to set in isis.properties,"Currently there is a number of settings in isis.properties whose values is pretty much determined by the configured persistor/object store.  Most notable examples included the class substitutor and the object factory, where cglib versions are configured for most persistors (for lazy loading), but is not configured for the JDO object store (that leverages the built-in lazy loading of DataNucleus).

This ticket is to remove some of these configuration settings, and instead arrange things such that selecting the persistor automatically configures these components.

In particular, that means removing:

1. isis.reflector.class-substitutor
(with the default being org.apache.isis.runtimes.dflt.bytecode.dflt.classsubstitutor.CglibClassSubstitutor for most object stores, overridden by the JDO object store)

2. isis.persistor.identifier-generator
(with the default already being overridden by all object stores)

3. isis.persistor.object-factory
(with the default being
org.apache.isis.runtimes.dflt.bytecode.dflt.objectfactory.CglibObjectFactory for most object stores, overridden by the JDO object store)

4. isis.persistor.services-injector
(with the default being ServicesInjectorDefault; there are no other implementations.)

5. isis.persistor.adapter-factory
(with the default being PojoAdapterFactory; there are no other implementations.)

At the same time, persistor/object stores sometimes have a requirement to install their own FacetFactories and/or MetaModelValidators.  So this ticket is also to provide a mechanism such that a persistor can ""refine"" the metamodel.

"
ISIS-273,Improvement,Closed,"Update annotation-based facet factories to read from fields, such that tools like Lombok can be supported","since 1.8.0, we only really need to handle a small number of the annotations:

@Property, @PropertyLayout, @Collection, @CollectionLayout

also:

@javax.jdo.annotations.Column"
ISIS-272,Improvement,Closed,Adding ValueSemanticProviders for UUID and URI,Currently the programming model has no support for the standard java types UUID and URI
ISIS-271,Wish,Closed,the option to overrule properties distributed as part of the application (read external properties),"Currently property files can be read from a few sources. However in the current situation the property files are mostly read from inside the deployed application (insde the war file). In an enterprise situation it is practically never the case that the properties are the same in DTAP (Development, Test, Acceptance, Production) environment. For instance the database most likely is different in any of these environment.

To support this it should be possible to override a minor subset of all the available properties. In this situation external (outside war) and internal (inside war) are merged together in one set of property files used by Isis. (see also ISIS-262).

It is possible to achieve this using the classpath but that is quite a burden. Using a special context parameter (in web applications) is the easiest and most transparent solution."
ISIS-270,Improvement,Closed,NotYetImplementedException in JDO objectstore when debug logging enabled,"When using JDO object store with debugging enabled I get the following stack trace  

...
Caused by:  
org.apache.isis.core.commons.exceptions.NotYetImplementedException:  
This method is not implemented yet
         at  
org.apache.isis.runtimes.dflt.objectstores.jdo.datanucleus.DataNucleusObjectStore.debugData(DataNucleusObjectStore.java:620)
         at  
org.apache.isis.runtimes.dflt.runtime.system.persistence.PersistenceSession.debugData(PersistenceSession.java:1065)
         at  
org.apache.isis.runtimes.dflt.runtime.system.session.IsisSessionDefault.debug(IsisSessionDefault.java:309)
         at  
org.apache.isis.runtimes.dflt.runtime.system.session.IsisSessionDefault.takeSnapshot(IsisSessionDefault.java:295)
         at  
org.apache.isis.runtimes.dflt.runtime.system.session.IsisSessionDefault.close(IsisSessionDefault.java:110)
         at  
org.apache.isis.runtimes.dflt.runtime.system.context.IsisContext.closeSessionInstance(IsisContext.java:209)
         at  
org.apache.isis.runtimes.dflt.runtime.system.context.IsisContext.closeSession(IsisContext.java:275)
..."
ISIS-269,Bug,Closed,"The XML object store cannot handle all ""char"" values","The XML object store relies on ""facet.toEncodedString(associatedObject)"" to return an XML compatible representation of the property value.
For ""char"", this encoded string is the raw character.
Which for values < 32, kills the XML decoder with ""invalid unicode character .."" exceptions.
e.g. for character value (char) (20):
The exception is:
[Fatal Error] :6:31: An invalid XML character (Unicode: 0x14) was found in the element content of the document.

The XML file contains:
  <value field=""charProperty"">|</value>
(The actual character did not survive ""copy&paste"")



If I use (char) 255:
The XML file contains:
  <value field=""charProperty"">ÿ</value>

Whether this is a problem with the char encoder or XML, is perhaps up for debate."
ISIS-268,Improvement,Closed,Catch-up: get SQL-OS running against isis-1.0.0 core,There have been several major changes to the Objectstore internals. This ticket is to catch the changes required to bring the SQL-OS back in line.
ISIS-267,Improvement,Closed,"Handle ""recreating"" object adapters which are already resolved","Currently the Memento design (as used by wicket viewer and others) assumes that any object adapter being recreated has a resolve state of GHOST.  

However, in some cases (at least as performed by wicket), the object adapter may already have been resolved.  

This ticket is to generalize the behaviour so that, if the object adapter is RESOLVED, then it it switched into UPDATING in order to push new values onto the object adapter from the memento."
ISIS-266,Bug,Closed,BoundedFacetAbstract was invalidating using disabledReason(),"The BoundedFacet indicates that the permissible values are taken from a bounded set; eg an enum or similar.  This is used by viewers to render drop-downs.

The BoundedFacetAbstract does validate values, but should only check the type of the instance.   The current implementation was incorrectly preventing any change to the value at all."
ISIS-265,Bug,Closed,NullPointerException when storing new objects,"After switching from 0.2.0 to trunk creating new objects resulted into a NPE with the following output to the screen:

java.lang.NullPointerException
	at  
org.apache.isis.core.metamodel.adapter.version.ConcurrencyException.buildMessage(ConcurrencyException.java:36)
	at  
org.apache.isis.core.metamodel.adapter.version.ConcurrencyException.(ConcurrencyException.java:50)
	at  
org.apache.isis.runtimes.dflt.runtime.persistence.adapter.PojoAdapter.checkLock(PojoAdapter.java:337)
	at  
org.apache.isis.viewer.html.context.PersistentRootAdapterMapping.checkVersion(PersistentRootAdapterMapping.java:56)
	at  
org.apache.isis.viewer.html.context.Context.getMappedObject(Context.java:284)
....

See also mailing list messages:
1) http://mail-archives.apache.org/mod_mbox/incubator-isis-dev/201209.mbox/%3C20120904162634.498360cc2mehz2ca%40webmail.xup.nl%3E
2) http://mail-archives.apache.org/mod_mbox/incubator-isis-dev/201209.mbox/%3C20120905105456.3062774yn2htlylc%40webmail.xup.nl%3E"
ISIS-264,New Feature,Closed,Add @Paged annotation (for use by viewer-side paging as a minimum).  Implement in Wicket as a minimum,"@Paged(25) on the type indicates the page size for standalone collections.
@Paged(12) on a collection indicates the page size for parented collections.
"
ISIS-263,New Feature,Closed,Introduce a new @CommonlyUsed annotation as a hint for the UI.  To be implemented by Wicket viewer (as a minimum),"The @CommonlyUsed annotation iIndicates that a class member is commonly used and so should
 be presented in the viewer in an appropriate manner.

For example, an Order#lineItems collection might be ""opened"" automatically so that the user could see a list of line items immediately when the order is rendered.

Or, a property containing an <tt>Address</tt> might show the referenced address as an embeddded property.

Or, an action <tt>Submit</tt> might be rendered as a button rather than buried inside a submenu somewhere.

For properties and collections there is some similarity between this concept and that of eager-loading as supported by some object stores.  Indeed, some object stores may choose use their own specific annotations (eg a JDO default fetch group) in order to infer this semantic.
"
ISIS-262,Improvement,Closed,Real composite for ResourceSourceStream,"Previously ResourceSourceStreamComposite turned out to be a ""chain of responsibility"". As a result the name of the class was changed into ResourceSourceStreamChainOfResponsibility.

Implementating a real composite is actually straight forward (see attached patch) and might be useful for others too."
ISIS-261,Improvement,Closed,"Remove obsolete code (Enumeration interface, AnnotationBasedFacetFactory)",
ISIS-260,Improvement,Closed,"If a property is annotated as @Title, then by default it should not appear as a column in tables.",... but allow this to be overridden using @Hidden(where=Where.NOWHERE).
ISIS-259,Improvement,Closed,Replace @QueryOnly and @Idempotent with a new @ActionSemantics annotation.,"... enumerating the semantics as either SAFE (aka query only), IDEMPOTENT, or NON_IDEMPOTENT.

The @QueryOnly and @Idempotent annotations should be deprecated (in the future, will remove).  

If the @QueryOnly and @ActionSemantics both are defined, then the latter overrides the former.
If the @Idempotent and @ActionSemantics both are defined, then the latter overrides the former."
ISIS-258,Improvement,Closed,Extend @Hidden and @Disabled to specify Where the object member should be hidden/disabled.,"Coming from a desire to hide property members within tables.

@Hidden(Where.COLLECTION_TABLE)
public String getSomeNotVeryInterestingProperty() { ... }

NB: as a result of this change, will slightly break the applib annotation for both @Hidden and @Disabled.

For example, previously we had @Hidden(When.UNTIL_PERSISTED), with the value() attribute being set.  value() has now been renamed to when(), in order to allow where() to also be added.

This will now be @Hidden(when=When.UNTIL_PERSISTED).

Note that @Hidden and @Disabled (by itself, with value() not specified) will continue to work with no changes to application code.

"
ISIS-257,Improvement,Closed,Remove the @Executed annotation from the applib (and corresponding metadata stuff) since remoting no longer supported.,"The @Executed annotation was originally intended to indicate whether an action should be executed remotely (server side) or locally (client side).

With the removal of client/server remoting support, this annotation is defunct and so should be removed."
ISIS-256,Bug,Closed,NullPointerReference exceptions when attempting to persist an object,"NullPointerReference exceptions when attempting to persist an object. This occurs under two scenarios:

1. Omitting the json for a field annotated as @Optional in the pojo

2. Attempting to persist an object that has getter only fields"
ISIS-255,Bug,Closed,Test in Runtime TestSupport component fails due to TimeZone,"Error in the build of the testsupport component as follows:
 
loadInstance(org.apache.isis.runtimes.dflt.runtime.fixturedomainservice.ObjectFixtureFilePersistorTest): expected:<Mon Mar 08 06:30:00 IST 2010> but was:<Mon Mar 08 01:00:00 IST 2010>

This is because my Time Zone is IST. If I set my Time Zone to GMT then the test passes
 
The error comes at this line in the class ObjectFixtureFilePersistorTest and method loadInstance():

Assert.assertEquals(dateFormat.parse(""08-Mar-2010 01:00 GMT""), epv.getDate());

Here the epv.getData() returns date in IST and the code getting executed is from the SimpleEntity getDate() method"
ISIS-254,New Feature,Closed,Add support for blob type.,"Per mailing list threads:

* http://isis.markmail.org/message/bfgrdyq727m5s3jk (Kevin Meyer)
* http://isis.markmail.org/message/znug37rnygcyh5ys (Giedrius Graževičius)

~~~~~
This requirement  was in fact previously raised as ISIS-115 (now marked as a duplicate of this) by Kevin Meyer, who wrote:

Need to be able to support byte stream or byte array as a value type. 
This should grow into supporting documents, images, etc. 
See discussion on mailing list [link to be provided - I can't find it right now]."
ISIS-253,Improvement,Closed,"Get rid of DateValueFacet#getLevel(), since unused","This method seemed to be used to distinguish date vs time vs timestamp (using a mask design).  However, it no longer seems to be used, so should be removed."
ISIS-252,Improvement,Closed,Use enums instead of booleans in FacetFactory's/Facets/ValueSemanticsProvider,"...  for immutability, equalByContent, derived"
ISIS-251,Improvement,Closed,Implement concurrency exception handling in Wicket viewer,"Using the new AdapterManager#createAdapterFor(TypedOid, ConcurrencyChecking) API."
ISIS-250,New Feature,Closed,Change MetaModelValidator such that multiple validation errors can be reported in a single shot....,... by using the collecting parameter pattern
ISIS-249,Improvement,Closed,[WON'T FIX] Validation failure for properties of type enum that have no default and are mandatory.,"... such that this would be an error, showing up as a ValidationFailure in the MetaModelValidator:

    // {{ Gender (attribute)
    private PersonGenderType gender;

    @MemberOrder(sequence = ""4"")
    public PersonGenderType getGender() {
        return gender;
    }

    public void setGender(final PersonGenderType gender) {
        this.gender = gender;
    }
    
    // }}
	
	
	
	
but this would be ok, because the programmer has provided an explicit default method:	
	
	    // {{ Gender (attribute)
    private PersonGenderType gender;

    @MemberOrder(sequence = ""4"")
    public PersonGenderType getGender() {
        return gender;
    }

    public void setGender(final PersonGenderType gender) {
        this.gender = gender;
    }
    
    public PersonGenderType defaultGender() {
        return PersonGenderType.UNKNOWN;
    }
    // }}
	
	
	

and this would be ok, because the property is optional
	
	    // {{ Gender (attribute)
    private PersonGenderType gender;

    @MemberOrder(sequence = ""4"")
    @Optional
    public PersonGenderType getGender() {
        return gender;
    }

    public void setGender(final PersonGenderType gender) {
        this.gender = gender;
    }
    // }}	"
ISIS-248,Improvement,Closed,Perform concurrency checking within the persistor (rather than rely on every viewer/client to do the check),"Currently it is the responsibility of each viewer to check whether a domain object has been updated prior to completing an edit.  

For example, if an object is displayed, the viewer renders the OID (usually in the HTML) and also caches the version of the object somewhere (either in the HTML, or possibly in a http session).  If the user then invokes an action, then the viewer resolves the object and checks that the version has not changed.

This ticket is to move this check into the persistor so that, when an object is resolved, the version is also supplied.  The persistor then throws a concurrency check if there is a mismatch.

The intention is for the API of the Persistor to remain unchanged, accepting only an Oid to resolve the object, but to use the version details that can now be stored in the Oid (see ISIS-245)."
ISIS-247,Improvement,Closed,Add support for Joda-Time values,"Currently Isis doesn't support Joda-Time values[1]. It would be nice to have support for at least the following fields:

With timezone:
- org.joda.time.Date
- org.joda.time.DateTime
Without timezone:
- org.joda.time.LocalDate
- org.joda.time.LocalDateTime

The DataNucleus persistence layer supports these values and it might be worth investigating if the Isis Date and DataTime values could be deprecated in the future since these are merely wrappers around Joda-Time.

[1] http://joda-time.sourceforge.net/index.html"
ISIS-246,Improvement,Closed,applib.value.DateTime support in JDO-DataNucleus,The JDO-DataNucleus implementation currently only supports applib.value.Date values. The patch adds support for applib.value.DateTime values.
ISIS-245,Improvement,Closed,Collapse the Version hierarchy,"ongoing simplification of framework.

Prereq to a future improvement whereby version info moves into the Oid, thus allowing optimistic locking to be wholly encapsulated in persistor component."
ISIS-244,Improvement,Closed,Hide properties in tables that are statically invisible within the Wicket viewer,
ISIS-243,Improvement,Closed,Remove the Maybe type from the Isis applib.,"This is used only in the framework implementation, isn't really a concern of the Isis applib.

An alternative is guava's Optional class."
ISIS-242,New Feature,Closed,Provide support for JODA LocalDate and LocalDateTime as value types.,"Currently Isis doesn't support Joda-Time values[1]. It would be nice to have support for at least the following fields: 

With timezone: 
- org.joda.time.Date 
- org.joda.time.DateTime 
Without timezone: 
- org.joda.time.LocalDate 
- org.joda.time.LocalDateTime 

The DataNucleus persistence layer supports these values and it might be worth investigating if the Isis Date and DataTime values could be deprecated in the future since these are merely wrappers around Joda-Time. 

[1] http://joda-time.sourceforge.net/index.html"
ISIS-241,New Feature,Closed,Extend the Isis programming model to recognize certain of the jsr-305 annotations.,"@javax.annotation.MatchesPattern
@javax.annotation.Nonnegative
@javax.annotation.Nullable
@javax.annotation.concurrent.Immutable
@javax.annotation.meta.Exhaustive   (equivalent to @Bounded)

note that jsr305 is part of Isis' dependencies because of the dependency we take on google guava."
ISIS-240,New Feature,Closed,Provide a bookmark service in order to lookup any object,"In Isis, we have a RootOid class which constitutes the object type (ObjectSpecId, a wrapper around a string) and a string identifier.  These two strings can be used to locate any entity; in a sense they are like a URI into an Isis system.

This ticket is to expose this functionality to the application more generally, through the concept of a ""Bookmark"".  A Bookmark is basically just these two strings values; the system-provided BookmarkService can contribute a lookup capability to any object that identifies itself as a BookmarkHolder."
ISIS-239,Improvement,Closed,Add support for MultiLine facet in Wicket viewer,Currently Wicket viewer does not support MultiLineFacet. Properties that are annotated with @MultiLine are still rendered as single line input fields.
ISIS-238,Bug,Closed,reverse navigation is not functioning on facebook.,"1.click on browser .
2. enter www.facebook.com in adress bar.
3. Facebook login page displayed.
4.enter user name and password in the desired fields.
5. click on login.
6.home page is displayed.
7.click on find friends .
8.friends page opend.
9.click on back navigation button.
"
ISIS-237,Bug,Closed,compose mail button is not working..,"1. enter www.gmail.com in web adress bar.
2. click on go.
3. gmail page is opened.
4. enter valid user name and password.
5.click on login button.
6 page redirected to home page o account.
7.click on compose mail button. "
ISIS-236,Bug,Closed,Classes that are not referenced in the DOM aren't found by the specification loader,"For example: if you have a field that uses an interface (eg Address) and it returns a concrete type (eg EmailAddress) but that type is not explicitly referred to elsewhere (as a return type or parameter) then the SpecificationLoader will never see it. Hence, if that class gets used (eg an EmailAddress is retrieved from persistent memory)  then an exception will occur.

The best long term solution is to load all classes from the Jar(s) that contain the DOM code.  This could be indicated by placing a marker, such as a file, in the metadata.of the Jar.

In the meantime a simple workaround is to add a method, typically to a service, that uses the concrete class and mark it as hidden. Give the method a name that makes it clear what the method is there for so nobody tries to use it."
ISIS-235,Improvement,Closed,Remove dependency on @Named to return parameter name,"Parameter names have to be annotated with @Named to have the Isis show the parameter name of an action in the viewers and restful api. Implementing Paranamer [1] in Isis solves the problem that currently Java reflection does not return parameter names. The current behaviour of @Named should not change and will override the parameter name.

[1] http://paranamer.codehaus.org/"
ISIS-234,Bug,Closed,Persistence by reachability of aggregated instances fails.,as per http://mail-archives.apache.org/mod_mbox/incubator-isis-dev/201206.mbox/%3C4FE3BAC2.8040001%40nakedobjects.org%3E
ISIS-233,Improvement,Closed,implement restfulobjects-viewer up to RO spec 1.0.0,
ISIS-232,New Feature,Closed,General improvements to the Wicket viewer,"Moving the entity collections to the right hand side, and other improvements."
ISIS-231,Improvement,Closed,Use Apache Shiro as security framework,"Apache Shiro [1] is a powerful and easy-to-use Java security framework that performs authentication, authorization, cryptography, and session management. Shiro provides out-of-the-box realms for popular data sources like LDAP, Active Directory, Kerberos, and JDBC and can be extended to make use of domain objects too. Replacing the custom security classes with Shiro would increase functionality with less code to maintain.

[1] http://shiro.apache.org"
ISIS-230,Bug,Closed,"SQL-OS issue using ""Today"" in date field","Using the date class org.apache.isis.applib.value.Date

Using the HTML viewer and entering ""Today"" my dom date was saved using yesterday's date.

* My dom field ""shift_date"" was set to: 2012-05-08
** it should have been set as: 2012-05-09 (today's date)
* Isis did set its ""modified_on"" field correctly: 2012-05-09 14:52:09.265
* I am in Central Time Zone in the U.S.A. 
"
ISIS-229,Bug,Closed,SQL-OS java.util.Date value not correctly detected,"java.util.Date cannot be cast to org.apache.isis.applib.value.DateTime
java.lang.ClassCastException: java.util.Date cannot be cast to 
org.apache.isis.applib.value.DateTime
at org.apache.isis.runtimes.dflt.objectstores.sql.jdbc.JdbcDateTimeMapper.preparedStatementObject(JdbcDateTimeMapper.java:51)
at org.apache.isis.runtimes.dflt.objectstores.sql.jdbc.AbstractJdbcFieldMapping.appendInsertValues(AbstractJdbcFieldMapping.java:59)

* I was using the HTML viewer.
"
ISIS-228,Improvement,Closed,Use JUnit categories to distinguish between tests that can be run on CI server and those that cannot.,eg using technique as described in http://johndobie.blogspot.co.uk/2012/04/unit-and-integration-tests-with-maven.html
ISIS-227,Improvement,Closed,"Separate out Eclipse (m2e) target classes from Maven cli,so co-exist better.","Use the m2e.version property to activate a profile such that Eclipse/M2E builds into ""target-ide/..."" while the Maven command line continues to build into the regular ""target/..."""
ISIS-226,New Feature,Closed,Expose override-able methods to allow users to alter HTML UI,"As per discussions in the isis-users mailing list[1], there is a need to alter the behaviour of the ControllerServlet so that alternate WebControllers and HtmlComponentFactory's can be provided.

[1] http://www.mail-archive.com/isis-users@incubator.apache.org/msg00070.html"
ISIS-225,Task,Closed,Isis Online Demo - Source Code URL not working.,"The url for the Online Demo Source Code doesn't show any information.
http://mmyco.co.uk:8180/isis-onlinedemo/doc/xref/index.html
"
ISIS-224,Wish,Closed,Allow WIKI Mark Up for Certain JIRA Fields.,"Can you have the Apache JIRA admin change the ISIS Field Configuration  to use Wiki Style Renderers for the following JIRA Fields.

* Description
* Comments

It would make for a lot easier formatting of complex text, for example posting code snippets, or ordered lists.
See ISIS-223 as an example where I had to do some ugly formatting"
ISIS-223,Wish,Closed,Additional Configuration Documentation for using SQL ObjectStore and usage for Quick Start Archetype.,"Please Add additional documentation to the ISIS website or ISIS guides that details what POM entries and isis.properties need to be updated to use the SQL Ojbjefrom the archetype quick start documentation 

I did this using the ISIS quickstart version: 0.2.0-incubating

** This is a PostgreSQL example

** In order to use the SQL ObjectStore the following things need to be done once the user has created their new ISIS Application.

# comment postgresql url base example for (isis.persistor.sql.jdbc.connection):  jdbc:postgresql://host:port/database

=================================
1.  Add the following entry in your projectname-objstore-dflt POM file
		<dependency>
			<groupId>org.apache.isis.runtimes.dflt.objectstores</groupId>
			<artifactId>sql-impl</artifactId>
		</dependency>
=================================
2.  Add the maven dependencies for your Database Drivers entry in your projectname-objstore-dflt POM file
		<dependency>
			<groupId>postgresql</groupId>
			<artifactId>postgresql</artifactId>
			<version>9.0-801.jdbc3</version>
		</dependency>
=================================
2. In the projectname-webapp project in the isis.properties file change the isis.persistor property
isis.persistor=sql

=================================
3. In the projectname-webapp project add the following properties (suitable for your Database Platform)
3a. You will need to change the connection entry and driver entry to be specific for your database platform drivers and database server location and port.
3b. -if you want ISIS to create your DB tables you will need to use an ID/Password that has table creation rights.

isis.persistor.sql.jdbc.driver=org.postgresql.Driver
isis.persistor.sql.jdbc.connection=jdbc:postgresql://127.0.0.1:5432/assignments 
isis.persistor.sql.jdbc.user=postgres
isis.persistor.sql.jdbc.password=TheDatabasePassword

# PostgreSQL ISIS specific data type overides
isis.persistor.sql.datatypes.timestamp=TIMESTAMP
isis.persistor.sql.datatypes.datetime=TIMESTAMP
isis.persistor.sql.datatypes.double=DOUBLE PRECISION

=================================
4.  Do a maven clean and install on your main project and run it.
4b.  You should see new table(s) created in your database.
"
ISIS-222,New Feature,Closed,Integration with Apache EmpireDB,"- It would be nice to EmpireDB to abstract different objectsore operations
- How exactly should that be not yet defined
- More details later"
ISIS-221,Sub-task,Closed,Add Paging support to the SQL object store,"As per ISIS-220, all object stores are affected. This ticket is for the SQL-OS.
The solution requires helpers to compute the different SQL statements for the major databases: MySQL, PostgreSQL, MS-SQL Server.
Initial support will be restricted to MySQL and PostgreSQL."
ISIS-220,New Feature,Closed,"Add ""Paging"" support to Objectstore API","The org.apache.isis.runtimes.dflt.runtime.persistence.objectstore.ObjectStorePersistence method ""boolean hasInstances(ObjectSpecification specification);"" could do with a ""boolean hasInstances(ObjectSpecification specification, final int start, final int count);"" method to support paging through results.

This impacts all object stores. 

The ""org.apache.isis.applib.AbstractContainedObject"" and ""org.apache.isis.applib.DomainObjectContainer"" methods ""protected <T> List<T> allInstances(final Class<T> ofType)"" and all the ""allMatches(*)"" should also get paging equivalents. This will expose paging to services and all POJOs via the inject DomainObjectContainer container."
ISIS-219,New Feature,Closed,Allow Password's to be stored in database as encoded strings,"At the moment, the SQL OS does not encode the Isis Password value type password values when writing to the database.
This enhancement implements a simple encoding / decoding system that allows the Isis Password value type to be stored in a simply encoded value in the database table, while remaining in plain text when in memory.
The conversion is done by the database layer when storing (encoding) and retrieving (decoding) values.

Enable by adding the following to the isis.properties:
isis.persistor.sql.password.seed=<some random text>
isis.persistor.sql.password.length=<length of encoded string>

All strings will be stored in the database field as strings of length ""isis.persistor.sql.password.length"", which defaults to 120.

If isis.persistor.sql.password.seed is undefined (null), the default behaviour (of not encoding the string) will apply.

The ""isis.persistor.sql.password.seed"" is a custom value that is used to encode the password.

NOTE: This is not secure nor unbreakable, it just prevents a casual observer of your database from being able to read your stored passwords."
ISIS-218,New Feature,Closed,"Allow file authorizor whitelist to default to ""allowed""","As it stands, the file authorizer (FileAuthorizor) requires that a service/class/action explicitly be listed in the white list for it to be allowed.
If the same service/class/action is also listed on the black list, then it is disallowed.

I am adding the following property, which defaults to false:
isis.authorization.file.whitelist.empty.isallowed=true
to allow the white list to allow all by default, if the whitelist file is empty.

This allows you to specify only those roles that are *disallowed* in the black list, while leaving the whitelist empty."
ISIS-217,Improvement,Closed,"Various changes (full transaction support, fix table name conversion bug, example properties files)","Some modifications to fix issues as I came across them:
*) the objectstore transactions: beginTransaction / endTransaction did not use database commands (e.g. ""BEGIN TRANSACTION"" and ""COMMIT"")
*) there was a table name that was not being created via proper mapping rules (for the database driver)
*) incuding example properties files for use with MS SQL Server and Oracle DB2. "
ISIS-216,Improvement,Closed,"Make OIDs immutable and self-describing (ie make OidWithSpecification the norm, using an ObjectTypeFacet as a way of determining the type).","Introduce ObjectTypeFacet
Add a cache of these in the spec
...
... and other steps yet to be fully identified...
"
ISIS-215,Improvement,Closed,Change way that SQL objectstore determines the properties of an object to be persisted,"Noticed that in some circumstances the database table that SQL object store attempts to create had duplicate column names.  Tracked this behaviour down to the logic within org.apache.isis.runtimes.dflt.objectstores.sql.auto.AbstractAutoMapper - the setUpFieldMappers() method can be called into recursively, meaning that the simple aggregation of columns into a list (as then used by the setUpFullMapping method is not sufficient).

Although I don't understand everything that is going on here, it seems that a safer way to proceed is to use a Map and to key the elements by the ObjectAssociation (ie property); that way there can only ever be one ""thing"" added per processed field."
ISIS-214,Improvement,Closed,Change site so that it explicitly lists the archetypeVersion to use.,"For some reason, I found that running the documented archetype from the quick-start page brought back an earlier version of the archetype (0.1.2-incubating rather than 0.2.0-incubating).  No idea why.  Explicitly specifying the archetypeVersion caused Maven to do the right thing.

In case this happens to others, suggest that our quickstart page documents the current version, ie includes an ""-DarchetypeVersion=0.x.x-incubating"".  This can be automatically calculated using ${project.version} and renaming to an .apt.vm."
ISIS-213,Bug,Closed,"Incorrect value rendered for ""other"" parameters for contributed action (when those other parameters do not have defaults).","Tries to guess the value, but gets it wrong... in MethodTask constructor:

[snip]

            if (defaultParameterValues[i] == null) {
                if (action.isContributed()) {                      <<< problem is here, ends up applying the target value for all parameters.
                    initialState[i] = target;
                } else {
                    initialState[i] = null;
                }
            } else {
                initialState[i] = defaultParameterValues[i];
            }
[/snip]"
ISIS-212,Dependency upgrade,Closed,Domain-lib: email (org.apache.isis.service.email) depends on Isis 0.2.0-incubating,"Old dependency for domain-lib: email

    <name>Email service</name>
    <groupId>org.apache.isis.service</groupId>
    <artifactId>email</artifactId>
    <version>0.2.0-incubating-SNAPSHOT</version>"
ISIS-211,Bug,Closed,org.apache.isis.security.file.authorization.FileAuthorizor does not work,"Even with the following in isis.properties:
isis.authorization=file
isis.authorization.file.whitelist=allow.properties
isis.authorization.file.blacklist=disallow.properties

the file authorizor is picked up:
13:41:06,268  [FileAuthorizor       main       INFO ]  loading authorization details from allow.properties
13:41:06,269  [FileAuthorizor       main       INFO ]  loading authorization details from allow.properties
13:41:06,269  [JmxBeanServer        main       INFO ]  JMX bean server created
13:41:06,299  [JmxBeanServer        main       INFO ]  file-authorizer JMX mbean registered: org.apache.isis.security.file.authorization.FileAuthorizor@34a083f2

But it does not work - services that are listed in the disallow.properties and services not listed in the allow.properties are still available."
ISIS-210,Improvement,Closed,Support parameter choices on contributed actions,"Currently, choices on actions parameters are picked up by looking for no-arg actions following the naming convention:

List<T> choicesNActionName()

However, for a contributed action the action belongs on a service, with the contributee being a parameter of the action.  In order to be able to meaningfully provide choices that are specific to the contributee, we need the ChoiceFacetFactory to be able to detect:

List<T> choicesNActionName(Contributee c)

also."
ISIS-209,Improvement,Closed,Make HTML viewer be able to cope with back-button navigation,"obviously, there still needs to be optimistic locking checking.  But that is the only time, ideally, that we should get a warning message.

I think part of this will come down to getting rid of, or minimizing, the Context object and the ObjectMapping/CollectionMapping/ActionMapping."
ISIS-208,Improvement,Closed,"If two services accidentally have the same Id, then should throw an exception.","eg, using the MetaModelValidator or similar.

Think it should be a runtime exception, ie Isis fails to boot."
ISIS-207,Bug,Closed,Improve the message given when a field is too long (exceeds its @MaxLength value),"The value is repeated stating it is too long.  This is particularly bad for a long entry, and the value itself is probably not needed anyway.

Problem is in MaxLengthFacetAbstract.java in the return statement.


    @Override
    public String invalidates(final ValidityContext<? extends ValidityEvent> context) {
        if (!(context instanceof ProposedHolder)) {
            return null;
        }
        final ProposedHolder proposedHolder = (ProposedHolder) context;
        final ObjectAdapter proposedArgument = proposedHolder.getProposed();
        if (!exceeds(proposedArgument)) {
            return null;
        }
        return ""Proposed value '"" + proposedArgument.titleString() + ""' exceeds the maximum length of "" + value();
    }
"
ISIS-206,Improvement,Closed,"Split the NoSQL object store module into submodules to separate the base API from the various SPI implementations (simple, mongo, and - when it is added - couch).",
ISIS-205,Improvement,Closed,"SQL OS to use javax.sql.DataSource's built-in pooling, rather than home-grown around DriverManager.getConnection()",
ISIS-204,Improvement,Closed,Allow SQL Object store to attempt to connect without credentials if none are provided,To support Ingres running locally.
ISIS-203,Improvement,Closed,Improve the logging at startup,So that only get to see which property files were found/not found once in the log.
ISIS-202,Improvement,Closed,Rename @Stable to @ViewModel,In line with latest thinking for json viewer (and the Restful Objects spec)
ISIS-201,Improvement,Closed,NoSQL Object Store to provide some sort of API for writing repositories (rather than the simple pattern match currently),Rather than the simple pattern match (= and AND) as currently.
ISIS-200,Improvement,Closed,SQL Object Store to provide some sort of API for writing repositories (rather than the simple pattern match currently),"At the moment, can basically do ""="" and AND matching, but nothing else."
ISIS-199,Bug,Closed,NoSQL object store does not support recursive trees,"For example, in the archetype app, having a derived property getSimilarItems() causes a ""can't change ResolveState from RESOLVING to RESOLVING"""
ISIS-198,Bug,Closed,SQL object store does not support recursive trees,"For example, in the archetype app, having a derived property getSimilarItems() causes an infinite loop..."
ISIS-197,Improvement,Closed,"Make OidWithSpecification the default, with the object type optionally specified via an annotation.","So that special case handling of SerialOid (as used by the in-memory object store and as the Scimpi viewer has special case handling for could be removed, and so that there would be a pleasant enString'ed representation of (at least the classname portion of) and OidWithSpecification.

for example:

@ObjectType(""CUS"")
public class Customer {
   private int id;
}

would correspond to ""CUS~123"" as the serialized form of its OidWithSpecification, and ""CUS"" being used as an alias for the fully qualified class name com.mycompany.myapp.Customer.

If the annotation was missing, eg:

public class Order {
   private int id;
}

then the OidWithSpecification would be more like ""com.mycompany.myapp.Order~456"""
ISIS-196,Improvement,Closed,Enhance Scimpi viewer so that it can be used with object stores that use an OidWithSpecification.,"Currently Scimpi is hard-coded to only support object stores that use a SerialOid.  Prior to ISIS-195, this meant the in-memory object store and also the nosql (mongodb) object store, but as of ISIS-195 would render the mongodb object store incompatible with Scimpi.

This ticket is therefore to enhance Scimpi so that, like the json viewer, it is able to use any object store that uses an OidWithSpecification as its Oid type."
ISIS-195,Improvement,Closed,Make mongo object store work with json viewer (by having it use an Oid that is an OidWithSpecification),"Following on from ISIS-194, the nosql (mongodb) objectstore works with SerialOid, that is not an OidWithSpecification.  This means that it cannot be used with the json viewer.

Enhance the nosql object store by introducing a NoSqlOid (similar to the SqlOid used by SQL object store) that implements OidWithSpecification.  This will allow the json viewer and mongo object store to be coupled together."
ISIS-194,Improvement,Closed,Allow JSON viewer to work with object stores other than the in-memory objectstore.,"In attempting to get the json viewer to run with the SQL object store, discovered that it makes the wrong call to the AdapterManager and so fails to load objects via its OID.

Exploring further, realized that the SqlOid impl *does* include the relevant information to call the right API of AdapterManager / PersistenceSession, namely that the className (=> objectSpec) is also included.

This change is therefore to introduce a new subtype of Oid, namely OidWithSpecification, that is a self-contained Oid, and have the json viewer depend only on object stores that support OidWithSpecification.  (Note: it isn't practicable to do what the html and scimpi viewers do, which is to cache the spec per Oid in session state, since the idea is that the json viewer is entirely stateless).

Also retrofit SqlOid to implement this new interface."
ISIS-193,Improvement,Closed,Enhance file-based authentication mechanism so that the passwords config file can be changed via configuration.,"Comparing with the file-based authorization mechanism, which reads the location of its ""whitelist"" file, however the file-based authentication mechanism doesn't allow its passwords file name to be overridden.config"
ISIS-192,Improvement,Closed,Change the default config files for file-based authentication and file-based authorization,"Currently to file-based authentication mechanism has a default to read from security_file.passwords, while the file-based authorization mechanism reads from security_file.allow.

Think it would be better for these to have defaults that are in line with the component-specific config files (authentication_file.properties and authorization_file.properties respectively).

Therefore change defaults so that:
* security_file.passwords is instead authentication_file.passwords 
and
* security_file.allow is instead authorization_file.allow
"
ISIS-191,Improvement,Closed,Expose IsisConfiguration via JMX,Ought to be fairly easy?  There is one bean already exposed via JMX - FileAuthoriser.
ISIS-190,New Feature,Closed,A domain Service (in domain-libs) to allow domain object entities to create calendar events in iCal or google calendar etc.,
ISIS-189,Improvement,Closed,"Add Scimpi viewer into the archetype, and add an index.html and links between the viewers to improve the overall 'getting started' experience.",
ISIS-188,Improvement,Closed,Stabilization for isis-1.0.0 release.,
ISIS-187,New Feature,Closed,"A (low-level, technical) domain Service (in domain-libs) to allow domain object entities to submit messages to a publish/subscribe bus.","For example, as might be implemented via Camel on top of ActiveMQ.

There would probably need to be some higher level abstractions too; this service might end up being injected into a higher-level service."
ISIS-186,New Feature,Closed,"A (low-level, technical) domain Service (in domain-libs) to allow domain object entities to be able to encrypt data","There could be various times that a domain service needs to hand off information to some other party in a secure fashion, so that it can either not be encrypted or can be known to have been tampered with.  One possible approach is using HMAC (eg to make cookies tamper proof.)"
ISIS-185,New Feature,Closed,"A (low-level, technical) domain Service (in domain-libs) to allow domain object entities to interact with a rules engine",I envisage that domain object would have some behavioural responsibility (eg some sort of strategy) but implement it by delegating off to a rules engine.  The domain object's state might hold parameters that are used to invoke specific rules within the rules service.
ISIS-184,Bug,Closed,PasswordValueSemanticsProvider.doEncode threw exception when I provided a defaultXXX method,"The encoder threw an exception in password(Object object) called by doEncode, when I provided a ""Password defaultPassword()"" method.
The passed in Object object was a PojoAdapter, not a Password object."
ISIS-183,New Feature,Closed,Add-on module to allow domain entities to be able to post twitter messages,"Similar to being able to send emails ISIS-171, or sending SMS ISIS-182."
ISIS-182,New Feature,Closed,Add-on module to allow domain entities to send text (SMS) messages,Similar to the service for sending emails ISIS-171.
ISIS-181,New Feature,Closed,"A (low-level, technical) domain Service (in domain-libs) to allow domain object entities to perform XSLT transformations.","Isis provides the ability to create XML snapshots of domain object graphs, eg:

 XmlSnapshot snapshot = new XmlSnapshot(customer); // where customer is a reference to an ObjectAdapter
 Element customerAsXml = snapshot.toXml(); // returns customer's fields, titles of simple references, number of items in collections
 snapshot.include(""placeOfBirth""); // navigates to another object represented by simple reference ""placeOfBirth""
 snapshot.include(""orders/product""); // navigates to all Orders of Customer, and from them for their Products

This service is to allow that XML snapshot to be converted into other formats (eg as might be used as an input to services that generate documents, eg ISIS-173, ISIS-177, ISIS-178)
 
"
ISIS-180,New Feature,Closed,Domain Service (in domain-libs) to allow domain object entities to transform ODFs to PDF,"similar to the DOCX->PDF service (ISIS-173), but to convert an ODF (eg as generated by a domain service ISIS-178) rather than a DOCX"
ISIS-179,New Feature,Closed,Domain Service (in domain-libs) to allow domain object entities to transform RTFs to PDF,"similar to the DOCX->PDF service (ISIS-173), but to convert an RTF (eg as generated by a domain service ISIS-177) rather than a DOCX"
ISIS-178,New Feature,Closed,"Domain Service (in domain-libs) to allow domain object entities to build ODF documents from a template doc, merging in against an XML (or perhaps JSON) input format.","Similar to ISIS-177 or ISIS-172, but generating ODF (as supported by OpenOffice/LibreOffice, for example)."
ISIS-177,New Feature,Closed,"Domain Service (in domain-libs) to allow domain object entities to allow communications to be created as RTFs, using a mail merge.  Input data could be XML (or perhaps JSON).","Similar to ISIS-172, but merging using an RTF template and search-and-replace on the fields."
ISIS-176,Improvement,Closed,Reinstate MongoDB backend for NOSql Object Store,
ISIS-175,Bug,Closed,Fix TCK site links,"per email by Kevin Meyer to isis-dev:

link check:

There is something funny with the URLs in the TCK modules. I'm
getting numerous ""No such file"" errors in all TCK modules - it looks
like the URL (siteBaseDir?) goes too far above the correct parent:

""file:///tmp/applib/index.html

   [Errno 2] No such file or directory: '/tmp/applib/index.html'

referenced from:

   Scimpi Viewer for TCK - CPD Results
   Scimpi Viewer for TCK - Generated Reports
   Scimpi Viewer for TCK - JDepend Report Metrics
   Scimpi Viewer for TCK - PMD Results
   Scimpi Viewer for TCK - Sitemap
   Scimpi Viewer for TCK - Surefire Report""

The proper path for
""file:///tmp/applib/index.html""
should be
""file:///tmp/m2-sites/isis/applib/index.html"".
"
ISIS-174,New Feature,Closed,Domain Service (in domain-libs) to allow domain object entities to add barcodes to PDF representations.,"Provide a standalone implementation of a service that allows barcodes to be added to PDFs.

Background: Some organizations use barcodes (or qcodes) to automate the processing of forms that have been sent out to a customer to be completed.  The domain object could previously have obtained a PDF representation of itself using, eg the service described in ISIS-173.


The interface for such a service could be something like:

[Hidden]
public interface BarcodeService {

    byte[] addBarcode(byte[] pdf, String data, BarcodeFormat format);
}

where BarcodeType might be an enum to indicate which barcode encoding type to use (there are various that could be supported)."
ISIS-173,New Feature,Closed,Domain Service (in domain-libs) to allow domain object entities to convert OpenXml (.docx) to PDFs.,"Provide a standalone implementation of a service to generate PDFs from OpenXML (.docx) that can be registered as a hidden service, and injected into domain objects so that they are able to convert their draft OpenXML (.docx) format (eg as obtained via ISIS-172) into an immutable PDF format.

NB: OpenXML .docx are flow-based format, and is generally considered mutable format, whereas PDF is a page-based format, and as such may be preferred as the ""canonical"" way to store outbound correspondence from an organization.

The interface for such a service could be something like:

[Hidden]
public interface FormatConversionService {

    byte[] openXmlToPdf(byte[] openXml);

}

"
ISIS-172,New Feature,Closed,"Domain Service (in domain-libs) to allow domain object entities to build .docx (OpenXML) documents against a template .docx, merging in an XML (or perhaps JSON) input format.","Provide a standalone implementation of a document builder  service that can be registered as a hidden service, and injected into domain objects so that they are able to send build OpenXml documents.  The input could be an XML-based notation (or perhaps JSON) along with a template .docx document.

The signature of the interface would be something like:

[Hidden]
public interface OpenXmlDocumentBuilder {
    byte[] build(byte[] documentTemplate, org.w3c.Document xmlDoc);
}

eg where the XML format is something like:

<input>
  <LetterDate type=""date"">2012-01-30</LetterDate>
  <CustomerTitle type=""rich"">Dear Mrs. Jenkins</CustomerTitle>
  <Blurb>As requested, here are the recent payments made from your account</Blurb>
  <Payments type=""rich-table"">
     <row>
       <Date>2012-01-20</Date>
       <Merchant>Walmart</Merchant>
       <Amount>123.45</Date>
    </row>
     <row>
       <Date>2012-01-21</Date>
       <Merchant>Esso</Merchant>
       <Amount>45.23</Date>
    </row>
     <row>
       <Date>2012-01-22</Date>
       <Merchant>Starbucks</Merchant>
       <Amount>12.01</Date>
    </row>
     <row>
       <Date>2012-01-22</Date>
       <Merchant>Amazon</Merchant>
       <Amount>89.99</Date>
    </row>
  </Payments>
</input>

so that the information is used to merge into fields within the OpenXml.   (NB: if using MS Word, this would correspond to ""Content Controls"", as per the Developer tab).

~~~~~~~~~~~~~
In terms of how a domain object would use this service, one design is to have a CommunicationTemplate domain object, which holds the .docx (or .odf) (eg as a base 64 encoded string).  The CommunicationTemplate acts as a factory for Communication objects, requiring that the appropriate XML be provided to it.  The template then calls the DocumentBuilderService and gets back a mail-merged version; this is stored in the resultant Communication (eg again base 64 encoded).

The sequence diagram below shows how this service could be used by a CommunicationTemplate and Communication domain object:

http://www.websequencediagrams.com/cgi-bin/cdraw?lz=dGl0bGUgY3JlYXRlIENvbW11bmljYXRpb24KCkN1c3RvbWVyLT4rAA0NVGVtcGxhdGVSZXBvc2l0b3J5OiBsb29rdXAodAAUB0NvZGUpCgAXHy0tPi0AXAg6IABkDAAMCmJ1aWxkIHhtbABtIjoAgUAHKHhtbCkKAGcWLT4rRG9jdW1lbnRCdWlsZGVyU2VydmljZTogbWFpbE1lcmdlKHRoaXMub2RmAIFgCCwgAE0FACMWAIFABQB5Fm1lcmdlZE9kZgB0GQCCZA06IGluc3RhbnRpYXRlKAA0CQCBMhkAgi8PCg&s=qsd

~~~~~~~~~~~~
generated at http://www.websequencediagrams.com/ using the following script:

title create Communication

Customer->+CommunicationTemplateRepository: lookup(templateCode)
CommunicationTemplateRepository-->-Customer: 

Customer->Customer: build xml

Customer->+CommunicationTemplate: create(xml)

CommunicationTemplate->+DocumentBuilderService: mailMerge(this.odfTemplate, xml)
DocumentBuilderService-->-CommunicationTemplate: mergedOdf

CommunicationTemplate->Communication: instantiate(mergedOdf)

CommunicationTemplate-->-Customer: "
ISIS-171,New Feature,Closed,Add-on module to allow domain entities to send emails.,"Provide a standalone implementation of an email service that can be registered as a hidden service, and injected into domain objects so that they are able to send emails.

The signature of the interface would be something like:

[Hidden]
public interface EmailService {
    void sendEmail(MessageDetails details) throws MessageException;
}

where MessageDetails holds the from, to, cc, bcc, the subject, the content, any attachments etc....

"
ISIS-170,Improvement,Closed,Add a custom jqmobile app to the onlinedemo.,See http://danhaywood.com/2012/02/01/jquerymobile-demo-app-walkthr/
ISIS-169,Bug,Closed,New collection fields prevent objects from being reloaded into NoSql store.,
ISIS-168,Sub-task,Closed,Update archetype for Isis 0.2.0,Combine html viewer and json viewer into single webapp...
ISIS-167,Improvement,Closed,update Isis contributors guide re: using mvn-version-plugin,"update Isis contributors guide re: using mvn-version-plugin <a href=""http://weblogs.java.net/blog/johnsmart/archive/2010/08/18/managing-version-numbers-maven-maven-version-plugin"" target=""_blank"">http://weblogs.java.net/blog/johnsmart/archive/2010/08"
ISIS-166,Task,Closed,Auto publish of snapshots from within Jenkins CI,"h5. References
# http://cwiki.apache.org/confluence/display/ISIS/ManualDeployProcessForSnapshots
# http://www.apache.org/dev/publishing-maven-artifacts.html"
ISIS-165,Umbrella,Closed,0.2.0 release (umbrella),Just to aggregate the various issues pertaining to getting the 0.2.0 release out of the door.
ISIS-164,Improvement,Closed,[WON'T FIX] The validate() method should apply for updates as well as for objects being initially persisted.,"see also ISIS-487
~~~
Currently the validate() method - used to check the overall state of an object, eg fromDate < toDate  - only applies for an object that has just been created but not yet persisted.

If an object is pulled back from the object store and then updated, the object-level validation is not re-run.  For example that the fromDate could be modified > toDate; if there were no check in the modifyFromDate(), then the update would be allowed."
ISIS-163,Improvement,Closed,"The progmodel wrapper (specifically, DomainObjectInvocationHandler) has hard-coded assumptions about the programming model",
ISIS-162,Improvement,Closed,Prepare Scimpi for use developers,Reviewing tags and updating documentation to reflect it state.
ISIS-161,Improvement,Closed,Example to show how the embedded runtime can be bootstrapped within Spring framework.,
ISIS-160,New Feature,Closed,"Allow users to override ""isis_"" table prefix","SQL Objectstore currently automatically inserts ""isis_"" as a prefix to all table names. Allow users to override this via a setting in the properties file."
ISIS-159,New Feature,Closed,"Create an archetype showing how the embedded runtime works with ""bog-standard"" JEE frameworks (using CDI)",
ISIS-158,Improvement,Closed,"Remove test fixture adapters for JMock2 (was too complicated), and bring in JMock 2.6RC2's JUnit4 support.",
ISIS-157,Bug,Closed,[WON'T FIX] parseTextEntry fix.,"from email on isis-dev mailing list:


> The issue with ""T parseTextEntry(Object contextPojo, String entry)"" is that
> I went through the code making some previously raw types into generic ones.
>  Doing that caused a runtime class-cast exception with some code, where the
> owning pojo was being passed in (eg Employee) for the context rather than
> the value (eg the String representing the Employee's firstName, say).

So it sounds like I should reinstate the generic parameter (ie back to ""T
parseTextEntry(T context, String entry)"" ), and then fix that place where
the wrong object is being passed in.
"
ISIS-156,Improvement,Closed,[WON'T FIX] Renaming getName() and other methods in metamodel,"from email exchange on mailing list:


>
> Just completing change for spec names.  To confirm that name == singular
> name, what we have at the moment is:
>
>    getFullName - fully qualified class name
>    getShortName - class name only
>    getName - singular name with spacing
>    getPluralName - the pluralised version with spacing
>
> It seems we have redundancy all along.
>
Yup, that's what we have.  Did mean to rename 'getName' to
'getSingularName', but I guess I forgot.  I'll go ahead and do that.


> They are two types of name though which isn't obvious from the method
> names. The first two are actually identifiers and won't change, whereas the
> other two are dynamic and will change, especially on a localised client.
> We might want to reflect this with getFullIdentifier and
> getShortIdentifier.
>;
That's a good idea.  I'll make that change too.


"
ISIS-155,New Feature,Closed,"If all actions in a service are hidden, then the service should be hidden also.","This relates to a requirement of Kevin's to hide a service icon (in the HTML viewer) if a user of a particular role had no actions visible.

I kind-a want that this is a metamodel change, but that would introduce a new concept of hidden objects, which we don't have.  And every viewer would need to change in order to check if an object was hidden.

So probably it's easier to simply add a check in each one of the viewers such that, if it notices that the service has actions that are all (declaratively) hidden, then it shouldn't render that service.

If we do decide to go this way, then it probably makes sense for this issue to be an umbrella, and to have subtasks for each of the viewers."
ISIS-154,Bug,Closed,JdbcBinaryValueMapper fails if value is null,"If a property has a null value, the JdbcBinaryValueMapper fails."
ISIS-153,Bug,Closed,SQL Objectstore was not ignoring fields that were marked @NotPersisted,"If you mark a property as @NotPersisted, the SQL Objectstore does not notice this annotation."
ISIS-152,New Feature,Closed,Provide support for Cayenne as an objectstore,"Create an Isis objectstore that uses Cayenne[1] as the storage.

[1] http://cayenne.apache.org/"
ISIS-151,Test,Closed,Need tests to check that FileAuthorizor is working,"As per email[1], it seems that the file authorizer FileAuthorizor class is not being picked up. Need to write tests to check this behaviour.

[1] http://isis.markmail.org/message/t52dmt7m6v4gzy36"
ISIS-150,Improvement,Closed,Update IsisTestRunner to use JUnit MethodRule API,"As per email[1], update the JUnit-viewer's IsisTestRunner to use the JUnit MethodRule API [2]

[1] http://isis.markmail.org/message/pr235ntut3qsfj5a
[2] http://kentbeck.github.com/junit/javadoc/latest/org/junit/rules/MethodRule.html"
ISIS-149,New Feature,Closed,Update IsisTestRunner to accept annotations to override Persister and Authenticator,"As per email[1], update IsisTestRunner

The @Persistor annotation needs to specify an installer that overrides the desired installer:

public class SqlPersistorInstallerWithinJunit extends SqlPersistorInstaller {
    /**
     * Returns a {@link DomainObjectContainerHeadlessViewer}.
     */
    @Override
    protected DomainObjectContainer createContainer(final IsisConfiguration configuration) {
        return new DomainObjectContainerWrapperFactory();
    }

}

This ensures that any created objects get the junit viewer wrapped container.


[1] http://isis.markmail.org/message/yqaxwv62n7fhbqqi"
ISIS-148,Improvement,Closed,Remove the hack in HTML viewer's ObjectView#execute() w.r.t. ImmutableFacet,"        if (isEditable) {
            // TODO: this test should be done by the ImmutableFacetFactory installing an immutableFacet on every
            // member
            final boolean immutable =
                ImmutableFacetUtils.isAlwaysImmutable(specification)
                    || (adapter.isPersistent() && ImmutableFacetUtils.isImmutableOncePersisted(specification));

            boolean allFieldUneditable = true;
            final List<ObjectAssociation> flds = specification.getAssociations();
            for (int i = 0; i < flds.size(); i++) {
                if (flds.get(i).isVisible(authenticationSession, adapter).isAllowed() && flds.get(i).isUsable(authenticationSession, adapter).isAllowed()) {
                    allFieldUneditable = false;
                    break;
                }
            }
            if (!immutable && !allFieldUneditable) {
                content.add(context.getComponentFactory().createEditOption(id));
            }
        }
"
ISIS-147,New Feature,Closed,Adding new features to the SQL objectstore,"* Provide several changes to current behaviour via the properties files (defaults shown):

** Determine the maximum number of instances returned by a query
isis.persistor.sql.maxinstances=100

** Ability to disable version checking
isis.persistor.sql.versioning=true

** Ability to disable version checking on certain tables
isis.persistor.sql.versioning.<tablename>=true

* Cleanup on JdbcBinaryValueMapper failing when the value was null

* Ability to override the default SQL storage type on a field
isis.persistor.sql.automapper.type.<fieldname>=<new type>

* Added more FieldMapping lookups to the installer. (e.g. both double.class and Double.class)
** if only one is specified, the other is handled by JdbcGeneralValueMapper as a VARCHAR(65)!
"
ISIS-146,Bug,Closed,ImmutableFacet logic seems too keen to disable,"Looking at the ""disables"" logic in the ImmutableFacetAbstract, the facet disable for any reason.
I reduced the reason to when the target interaction type is one of:
modify, collection add to, collection remove from.
i.e. mutators."
ISIS-145,Bug,Closed,links to NO books is broken,"Isis main page has a supposed link to books on Naked Objects, which currently is a 404:

http://incubator.apache.org/isis/books.html"
ISIS-144,Task,Closed,"Update applib documentation to reflect new functionality provided by entity-level ""boolean hidden()"" and ""String disabled""","See ISIS-142 and ISIS-143.
Update the applib documentation to reflect the new capabilities."
ISIS-143,New Feature,Closed,"Provide ""Boolean hidden()"" method on objects to hide the entire object at runtime.","Just as there is a hideXXX() method to hide individual properties or actions, provide a hidden() method to hide the entire object at runtime.
Renders all properties non-visible. "
ISIS-142,New Feature,Closed,"Provide ""String disabled()"" method on objects to disable the entire object at runtime.","Just as there is a disableXXX() method to disable individual properties or actions, provide a disable() method to disable the entire object at runtime.
Renders all properties ""read only""."
ISIS-141,Improvement,Closed,"In HTML viewer, read-only boolean properties shown as ""True"" or ""False"" rather than as a disabled checkbox when edit object",
ISIS-140,Improvement,Closed,Make the HTML viewer's message pane a little prettier...,"... by moving it down the page, and using a little jQuery to fade it out."
ISIS-139,Improvement,Closed,Add latest version of jQuery (1.7.1) in core.webapp,"Since jQuery team don't bundle their Javascript library in Maven, we ship our own copy in the core.webapp module.  This is to update the versions to the latest."
ISIS-138,Improvement,Closed,FacetFactory to automatically ignore Comparable#compareTo(Object) method (similar to the one that ignores the methods of java.lang.Object.,"If a domain object  implements Comparable<T>, then the compiler also generates a compareTo(Object) method.  The intention of this facet factory is to automatically remove such methods.

NB: the implemented compareTo(DomainObject) must still be marked as @Hidden."
ISIS-137,New Feature,Closed,Provide the ability to allow new users to register through the HTML viewer.,
ISIS-136,New Feature,Closed,Allow json viewer to coexist with other viewers (by introducing new authentication session lookup strategy to read from headers and enhancing IsisSessionFilter),
ISIS-135,New Feature,Closed,"Allow HTML viewer to co-exist with other viewers, (by supporting a user-defined suffix for its links; eg "".htmlviewer"" rather than "".app"")",
ISIS-134,Task,Closed,"Remove scimpi, dnd, wicket from archetype and from equivalent examples.",
ISIS-133,Task,Closed,Move the examples that don't match the quickstart archetype and don't demonstrate any particular feature off to ~/isis/retired.,
ISIS-132,Improvement,Closed,Archive off (and no longer support) the xhtml viewer (since superceded by the json viewer),"The json viewer is a much more complete implementation of a RESTful viewer.  If XHTML support is needed, it would make more sense to add back into the json viewer (renaming json viewer in the process to something like ""restful viewer"")."
ISIS-131,Improvement,Closed,Archive off (and no longer support) the default runtime's client/server remoting,
ISIS-130,New Feature,Closed,"New ""onlinedemo"" example to demonstrate combined html and json viewers as live example.",
ISIS-129,Improvement,Closed,Multiple persistence updates are executed when editing multiple fields within an entity in HTML viewer..,"The HTML viewer does not execute it's ""save"" within a transaction. p"
ISIS-128,New Feature,Closed,Add DomainObjectContainer#titleOf(pojo) to allow domain objects to programmatically obtain the title of other domain objects.,
ISIS-127,Bug,Closed,Some Facets (eg ActionChoicesFacetViaMethod) have an AdapterMap (ie AdapterManager) injected into them.  I think this is a mistake...,"... because each time a PersistenceSession is created, a new AdapterManagerDefault is instantiated.

Instead, we should inject an AdapterManagerProvider into the facet that obtains the currently-scoped AdapterManager as required."
ISIS-126,Bug,Closed,Service contributed actions (with parameters) are not picking up the current object as parameter,"In the quick-start archetype:

Adding the following method to the ToDoItemRepository:

public ToDoItem showToDo(ToDoItem item);

with an implementation that just returns the current item, when you're viewing a ToDoItem, the ""Show To Do"" action is available, 
but when you invoke it, it does not use the current ToDoItem as the parameter (item is null). "
ISIS-125,Sub-task,Closed,0.2.0 release - release process dry run & edits,Changes required to support 0.2.0-incubating release. Dry run currently in progress.
ISIS-124,New Feature,Closed,Add a @Stable annotation in the applib (along with StableFacet and StableAnnotationFacetFactory in the metamodel),This is to support a feature of the json-viewer where a @Stable entity is one that the developer guarantees will remain backwardly compatible with itself.  The json-viewer uses this in order to return an application-defined media type derived from the fully qualified class name.
ISIS-123,Improvement,Closed,Metamodel specload specimpl could not handle only some parameters having @Named,"If a (contributed) action has a @Named annotation on only 1 parameter of a multi-parameter method, the ObjectActionParameterAbstract.getName() method fails with a Null Pointer Access Violation."
ISIS-122,Bug,Closed,"BooleanValueSemanticsProviderAbstract can not handle fields of type Boolean, when value string is ""TRUE""/""FALSE"" from the SQL OS","BooleanValueSemanticsProviderAbstract currently can only handle string values of ""T"" / ""F"". I'm currently running into problems with the SQL-OS, which is returning column values of ""True"" and ""False"" when the field is of type ""Boolean"", instead of ""boolean""."
ISIS-121,Umbrella,Closed,"General updates to the SQL ObjectStore, not related to any specific issue",For minor or non-specific updates to the SQL Objectstore.
ISIS-120,Sub-task,Closed,"Reworking Isis site, and examples.",
ISIS-119,Sub-task,Closed,"Collections were marked as ""resolved"", even if a collection has an unresolved collection.","Until now, when an object is loaded, if it has a collection, then that collection is loaded and marked as ""Resolved"".
However, if *that* collection had an item with a field that was a collection, then the field collection is not loaded.
The current implementation tries to resolve recursively. This is probably also not desirable. I think the best is for the parent to leave collection items as ""partially resolved"" or whatever is most appropriate."
ISIS-118,Bug,Closed,Persist and restore polymorphic classes,"Currently, the SQL OS does not persist properties of super-classes when a polymorphic class is persisted. Additionally, abstract classes and interfaces are treated the same as concrete classes.
There are two obvious options:
1) The persisted polymorphic class creates a row in an uber-table of concatenated properties of all super-classes.
2) The persisted polymorphic class creates rows in each table that corresponds to a super-class (the concrete sub-class is contained in multiple tables, 1 per super-class)."
ISIS-117,Bug,Closed,Infinite recursion in JDBC objectstore,"Infinite recursion is happening during the mapping of a class that contains a one to many association (collection) of the same class (i.e. when defining a hierarchy). This occurs in method AbstractAutoMapper.setupFullMapping when object MultiColumnCombinedCollectionMapper is created.
MultiColumnCombinedCollectionMapper -extends> CollectionMapper -extends> AbstractAutoMapper.

"
ISIS-116,Bug,Closed,Obsolete directory on incubator web-site,"Appears to be an obsolete directory under /www/incubator.apache.org/:

drwxrwsr-x  18 danhaywood  incubator  57 Jul 14 05:46 isis
drwxrwsr-x  17 danhaywood  incubator  59 May  3 10:21 isis-0.1.2-incubating-SNAPSHOT

The SNAPSHOT directory looks as though it was accidentally created."
ISIS-115,New Feature,Closed,Provide support for documents/images/byte stream as a value type,"Need to be able to support byte stream or byte array as a value type. 
This should grow into supporting documents, images, etc.
See discussion on mailing list [link to be provided - I can't find it right now]."
ISIS-114,Bug,Closed,json viewer applib could not fetch json-lib-2.4,"None of the repositories contained this resource.
Changed project listed repo to http://repo1.maven.org/maven2"
ISIS-113,Sub-task,Closed,Get acquainted with Tapestry5 ,- http://tapestry.apache.org/
ISIS-112,New Feature,Closed,Tapestry Viewer Support,"- Add support for a Tapestry Viewer.
-* http://tapestry.apache.org/"
ISIS-111,New Feature,Closed,Title Facet Via Method Annotation,- Implement the Title Facet to be used via method annotations.
ISIS-110,Sub-task,Closed,Minor edits to pom.xml's to improve operation,"Minor changes to Isis pom.xml files to improve behaviour. Overall behaviour is unaffected by these changes, e.g. moving a dependency version definition higher up the build path, etc."
ISIS-109,New Feature,Closed,"JSON viewer (for Restful Objects, up to v0.56).","Implement a fully-tested version of the JSON viewer, to support the Restful Objects spec (http://restfulobjects.org).

NB: 0.1.2-incubating included an initial version only."
ISIS-108,Improvement,Closed,"Develop a ""TCK"" example application that exhibits/uses most Isis features in order to facilitate automated integration testing of viewers/objectstores etc.","It'd be useful to have a standard application that can be used as part of ""TCKs"" (technology compatibility kit) automated testing, ie to ensure that new components such as viewers or objectstores are correctly able to handle the standard Isis programming conventions.

For example, viewers should be able to handle/render booleans as checkboxes, or dates with date pickers.

For example, object stores should be able to persist custom value types."
ISIS-107,Sub-task,Closed,"For Isis 0.2.0 release: Miscellaneous minor changes (eg fix spelling typos in code, minor site/documentation updates) ","Please only use for small stuff.

see thread on isis-dev for background: http://mail-archives.apache.org/mod_mbox/incubator-isis-dev/201107.mbox/%3C4E230C92.7020006@gmail.com%3E"
ISIS-106,Bug,Closed,The IsisPasswordPanel threw an exception when used to edit a password value type.,The wicket engine complained that the password type was inappropriate for the text type used.
ISIS-105,New Feature,Closed,"Implement support for value parameter choices, defaults, etc.","Currently the Wicket viewer only supports Entity choice support (i.e. if a choicesXXXX() method exists, it is only used if the item is an entity, not a value).

This should be extended to include support for values.

This also extends to defaultXXX(), etc, if it isn't already supported.

I have added ""ValueCollectionFactory"" and a ""ValueCollection"" skeleton classes, and included a ""addComponentFactoriesForValueChoices"" to ""ComponentFactoryListDefault"". I have also added a ""VALUE_COLLECTION"" to the ComponentType enum.

But I can't quite see where to go from here!"
ISIS-104,Improvement,Closed,Implement logout for Wicket,
ISIS-103,New Feature,Closed,Add a SqlAuthenticator user authentication class.,"Create a BaseSqlAuthenticator class that implements most of the core functionality required to support Sql database-based authentication. The class might have to be abstract (or at least, easily extendible), to support various application domains."
ISIS-102,Task,Closed,Flesh out body of SqlUserProfile,"I have created a SqlUserProfileStoreInstaller and an empty SqlUserProfileStore. 

The SqlUserProfileStore needs to interact with sql database tables to store and restore the user's profile. See XmlUserProfileStore or InMemoryUserProfileStore for examples."
ISIS-101,Bug,Closed,Missing SVN properties,"The SVN properties don't seem to have been set correctly for most files.
Script to follow can be used to fix these; please review before applying.
Also ensure that committers have set up SVN defaults properly:

http://www.apache.org/dev/version-control.html#https-svn-config"
ISIS-100,Improvement,Closed,Update RestEasy version from 1.0.2 to latest (2.2.0); the old version is LGPL but latest version is ALv2.,
ISIS-99,Bug,Closed,website bug - http://incubator.apache.org/isis/quickstart-app.html does not give the demo username and password,"I run into a problem running through the instructions on http://incubator.apache.org/isis/quickstart-app.html - there was no mention of demo username and password.

I have since found it in other documentation (sven/pass)."
ISIS-98,Improvement,Closed,Remove dependencies on XOM (an LGPL licensed library).,"1. [oai.viewer:restful] uses xom extensively ... replace with jdom.

2. [oai.viewer:scimpi]'s pom.xml references org.owasp.esapi:esapi, which in turn has a transitive dependency on xom.  However, the esapi is not (does not seem to be) used, so can safely remove

3. [oai.viewer:bdd-concordion] uses org.concordion:concordion, which in turn has a transitive dependency on xom.  For this, mark the dependency as excluded, and require end-users to explicitly include the reference to XOM in their own pom files.  Also update the archetype source so that it has this direct dependency set up for users."
ISIS-97,Improvement,Closed,Replace dependency on Sergey Ilinksy's XmlHttpRequest with JQuery's ajax() method instead.,"Although we've had an email [1] from the developer agreeing to cross-license this code as both ASLv2 and LGPL, the main website [2] still refers only to LGPL.

The preference of the Isis community is to replace this dependency with one that is unambiguous compatible with ASLv2.  I've decided to use JQuery's ajax() function.

[1] http://markmail.org/message/6j4jgckcct72ot3f
[2] http://code.google.com/p/xmlhttprequest/"
ISIS-96,Bug,Closed,"JUnit viewer does not always detect ""hideXXX""","I have a method ""public void registerVoteFor(Member member) "". 

In the HTML viewer, ""public boolean hideRegisterVoteFor()"" is called, but not in the JUnit viewer - I am expecting a HiddenException, but it is not thrown.

""public boolean hideRegisterVoteFor(Member member)"" is never called, but this is known, and was previously discussed.

For clarity, other ""hideXXX()"" methods are called, for properties (e.g. Member#getInitials()), and HiddenException is thrown."
ISIS-95,Sub-task,Closed,Create runtime.dflt:remoting docbook guide,May not be needed if we decide to retire remoting ISIS-131
ISIS-94,Sub-task,Closed,Create profilestores:xml docbook guide,"Need to create a new docbook guide for the XML profilestore.  (Want this to be symmetrical with objectstores if possible, ie document the in-memory implementation as part of runtimes:dflt documentation, but document other implementations in their own guides)."
ISIS-93,Improvement,Closed,Update security docbook guide,Deferred from first release.
ISIS-92,Sub-task,Closed,Update runtimes:dflt docbook guide,"A docbook with all material available from NOF4 exists, but needs to be tidied up."
ISIS-91,Sub-task,Closed,Update progmodels docbook guide,"Update docbook guide

Supercedes ISIS-23 (1), ISIS-31 (1), ISIS-32 (1)."
ISIS-90,Sub-task,Closed,"Remove cyclic dependencies in oai.runtimes,dflt:runtime",
ISIS-89,Improvement,Closed,Finish off updating documentation post the first (pre 1.0) release of Isis.,"We've decided to put out an initial release of Isis, and not to wait for the documentation to be completed.  This is the issue to act as a placeholder for the documentation that still needs to be updated.

* oai:progmodels (new subtask ISIS-91 raised)
* oai:security (new subtask ISIS-93 raised)
* oai.runtimes:dflt (new subtask ISIS-92 raised)
* oai.runtimes:embedded (moved subtask ISIS-25 from ISIS-20 to here)
* oai.runtimes.dflt.objectstores:nosql  (moved subtask ISIS-26 from ISIS-20 to here)
* oai.runtimes.dflt.objectstores:xml (moved subtask ISIS-28 from ISIS-20 to here)
* oai.runtimes.dflt.profilestores:xml (new subtask ISIS-94 raised)
* oai.runtimes.dflt:remoting (new subtask ISIS-95 raised)
* oai.viewers:dnd  (moved subtask ISIS-36 from ISIS-20 to here)
* oai.viewers:html  (moved subtask ISIS-37 from ISIS-20 to here)
* oai.viewers.junit (moved subtask ISIS-38 from ISIS-20 to here)
* oai.viewers:scimpi  (moved subtask ISIS-40 from ISIS-20 moved)
"
ISIS-88,New Feature,Closed,Enhance I18nFacetDecorator to allow descriptions and help text to be looked up for action parameters.,"The I18nFacetDecorator allows name, description and help text to be looked up for properties, collections and actions, but only supports names for parameters.  It should be enhanced to support description and help text for action parameters also."
ISIS-87,Bug,Closed,move javax.* dependencies over to org.apache.geronimo.specs pendanta,"we currently use dependencies like javax.servlet. We should move these over to the corresponding dependencies from org.apache.geronimo.specs:

http://repo1.maven.org/maven2/org/apache/geronimo/specs/"
ISIS-86,Improvement,Closed,"I18n should be performed with respect to the user's Locale, not the location of the server.","Looking through the I18nFacetDecorator, it seems to do its localization with respect to the locale of the server (for a webapp).  Rob recently introduced the Localization interface in the applib, available in the default runtime's UserProfile interface, and so it would be better to have the i18n done with respect to that interface instead.

At the same time, I think we ought to have Localization NOT be dependent on the default runtime, ie it ought to be available from the UserMemento, rather than in UserProfile."
ISIS-85,Improvement,Closed,Convert HelpFacetDecorator into a HelpFacetFactory,"Looking at the code, it seems that we never create HelpFacets through FacetFactory.  So neither the HelpFacetDecorator nor the I18NFacetDecorator looks like they will ever install help, because both require there to be an underlying HelpFacet to decorate.

Moreover, there is a duplication between the I18 facet decorator and the help decorator, in that they both install help facets.  

I think a good first step would be to make the HelpFacetDecorator into a regular HelpFacetFactory.  At least then the role of i18nFacetDecorator will be well-defined."
ISIS-84,Improvement,Closed,Add object identifiers in links,"Change the rev attribute value to ""object"" in hyper-links that point to Isis objects."
ISIS-83,Bug,Closed,Broken Links,Links in the resources section appear to work in the main page (localhost:8080) but appear broken when clicked on from other pages like http://localhost:8080/object/OID:1.
ISIS-82,Question,Closed,@MaxLength and other validators don't work in the archetype-generated project,"Generate project as below.  Import into Eclipse.  Annotate ToDoItem.getDescription with @MaxLength(10).  Run DnD viewer.  Observe that the Description ignores the MaxLength validation.  Same problem with validateDescription method.  Same problem with HTML viewer.

Unless I'm doing something wrong, this is a bug.

$ mvn -U archetype:generate -D archetypeCatalog=http://incubator.apache.org/isis -D archetypeGroupId=org.apache.isis.support -D archetypeArtifactId=quickstart-archetype
[INFO] Scanning for projects...
[INFO] Searching repository for plugin with prefix: 'archetype'.
[INFO] org.apache.maven.plugins: checking for updates from central
[INFO] org.codehaus.mojo: checking for updates from central
[INFO] artifact org.apache.maven.plugins:maven-archetype-plugin: checking for updates from central
[INFO] ------------------------------------------------------------------------
[INFO] Building Maven Default Project
[INFO]    task-segment: [archetype:generate] (aggregator-style)
[INFO] ------------------------------------------------------------------------
[INFO] Preparing archetype:generate
[INFO] No goals needed for project - skipping
[INFO] [archetype:generate {execution: default-cli}]
[INFO] Generating project in Interactive mode
[INFO] Archetype [org.apache.isis.support:quickstart-archetype:0.1.0-incubating-SNAPSHOT -> https://repository.apache.org/content/groups/snapshots-group/] found in catalog http://incubator.apache.org/isis
[INFO] snapshot org.apache.isis.support:quickstart-archetype:0.1.0-incubating-SNAPSHOT: checking for updates from quickstart-archetype-repo
Define value for property 'groupId': : com.mycompany.mygroup
Define value for property 'artifactId': : myapp
Define value for property 'version': 1.0-SNAPSHOT:
Define value for property 'package': com.mycompany.mygroup:
Confirm properties configuration:
groupId: com.mycompany.mygroup
artifactId: myapp
version: 1.0-SNAPSHOT
package: com.mycompany.mygroup
Y: y
[INFO] Parent element not overwritten in D:\x\myapp\dom\pom.xml
[INFO] Parent element not overwritten in D:\x\myapp\fixture\pom.xml
[INFO] Parent element not overwritten in D:\x\myapp\objstore-default\pom.xml
[INFO] Parent element not overwritten in D:\x\myapp\quickrun\pom.xml
[INFO] Parent element not overwritten in D:\x\myapp\viewer-html\pom.xml
[INFO] Parent element not overwritten in D:\x\myapp\viewer-wicket\pom.xml
[INFO] Parent element not overwritten in D:\x\myapp\viewer-restful\pom.xml
[INFO] Parent element not overwritten in D:\x\myapp\viewer-scimpi\pom.xml
[INFO] Parent element not overwritten in D:\x\myapp\tests-junit\pom.xml
[INFO] Parent element not overwritten in D:\x\myapp\tests-bdd\pom.xml
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESSFUL
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 25 seconds
[INFO] Finished at: Thu Mar 17 00:14:39 EST 2011
[INFO] Final Memory: 16M/175M
[INFO] ------------------------------------------------------------------------
"
ISIS-81,Task,Closed,Fixes contributed on XHTML viewer.,
ISIS-80,Test,Closed,Re-enable testDate and testSqlDate tests in the common object store test suite,"The Hudson build failed the applib Date and java.sql.date SqlDate with:
Error Message

SQL date 2010-04-09 is not equal to 2010-04-08

Stacktrace

junit.framework.AssertionFailedError: SQL date 2010-04-09 is not equal to 2010-04-08
	at junit.framework.Assert.fail(Assert.java:47)
	at junit.framework.Assert.assertTrue(Assert.java:20)
	at org.apache.isis.alternatives.objectstore.sql.common.SqlIntegrationTestCommon.testSqlDate(SqlIntegrationTestCommon.java:321)

and

Error Message

2010-3-5 is not equal to 2010-3-4

Stacktrace

junit.framework.AssertionFailedError: 2010-3-5 is not equal to 2010-3-4
	at junit.framework.Assert.fail(Assert.java:47)
	at junit.framework.Assert.assertTrue(Assert.java:20)
	at org.apache.isis.alternatives.objectstore.sql.common.SqlIntegrationTestCommon.testDate(SqlIntegrationTestCommon.java:308)

It smacks of regional issues (stored and retrieved dates straddle midnight, when one side of the persistance uses one time-zone while the other side uses another).

Test used to pass."
ISIS-79,Improvement,Closed,"Fix ""additional business logic"" hooks in collection templates","The code generated by Eclipse templates such as noc does not ensure consistent execution of the ""additional business logic"" hook methods.
See email with patch for contribs/MutualRegistration sample

May also impact existing examples, and ducumentation"
ISIS-78,Improvement,Closed,Xhtml file restructuring for easier parsing,"Current Xhtml responses make it difficult to adapt a general parsing pattern on them. Additional information included in attributes would be very helpful. 
Suggested changes:
- Encapsulate object information inside a div tag with a class = ""nof-object""
- Add additional attributes in form tags to provide enough information for constructing a full HTTP request, so it is not necessary for the parser to go as deep as the input tags which are implementation dependent. "
ISIS-77,Improvement,Closed,"Add a downloadable ""cheat-sheet"" to the site.","In the spirit of DZone's refcardz,  a 1-pager cheat sheet of the most important conventions supported by Isis."
ISIS-76,Sub-task,Closed,Remove cyclic dependencies within progmodel.,
ISIS-75,Improvement,Closed,"Remove FieldOrderFacet and ActionOrderFacet, replace instead with MemberOrderFacet","There are currently two mechanisms for specifying member order, and which install different Facets on different elements of the metamodel (FieldOrderFacet/ActionOrderFacet on the ObjectSpecification, vs MemberOrderFacet on the ObjectMember).  Instead, we should have a FacetFactory that just installs MemberOrderFacets on the ObjectMembers)."
ISIS-74,Improvement,Closed,Get rid of BoundedFacet (or keep only for information); instead replace with ChoicesFacetBecauseBounded.,"Currently if a type is annotated as @Bounded, then we install a BoundedFacet and the viewers are expected to render a drop-down list.  It would be more straightforward to simply have @Bounded imply a ChoicesFacet, and therefore get rid of this special-case processing."
ISIS-73,Improvement,Closed,"[WON'T FIX] Get rid of ActionChoicesFacet and ActionDefaultsFacet, replace with ActionParameterChoicesFacet / ActionParameterDefaultFacet","Currently viewers are required to search both for ActionChoicesFacet on an action and also ActionParameterChoicesFacet on each parameter.  There's no real need; we could do everything with just ActionParameterChoicesFacet.

The same also applies for ActionDefaultsFacet."
ISIS-72,Improvement,Closed,Break out {Property/Collection/Action}MethodsFacetFactory into more fine-grained FacetFactory's.,"These FacetFactorys do too much, making it harder to define custom programming models.  This ticket is to break them out."
ISIS-71,Sub-task,Closed,Identifier (in the applib),
ISIS-70,Bug,Closed,ResourceBasedI18nManager - resolving the resource key name uses two dots for action addressing - should be one,"The ResourceBasedI18nManager resolves I18N resource bundle keys by requesting wether it is an action or property and constructs the following addressing:

[Prototype example] Would like to define a german name of the employee's approver name:

class: org.apache.isis.support.prototype.dom.employee.Employee
kind of element: property
property: approver
type: name

to address this within the i18n_de.properties - here is the key:
org.apache.isis.support.prototype.dom.employee.Employee.property.approver.name=XXX

Implementation [org.apache.isis.core.runtime.i18n.resourcebundle.ResourceBasedI18nManager#text]
  final String form = identifier.isPropertyOrCollection() ? PROPERTY : ACTION;
  final String key = identifier.getClassName() + ""."" + form + ""."" + identifier.getMemberName() + ""."" + type;
           
Requesting an action results in a double dot (in some cases of class level actions?) because the identifier.getMemberName() returns """":
eq the name of the employee class:
org.apache.isis.support.prototype.dom.employee.Employee.action..name=XXX

I will attach a patch for this - checking the above return value and constructing keys always with ""one dot"" seperator. This might be checked from the runtime team. thx"
ISIS-69,Improvement,Closed,"Get rid of some (and ideally all) of the FacetDecorators, and reimplement as FacetFactory and composable ProgrammingModel","Facet decorators are a left over from the pre-facet factory design (when they were called ""ReflectionPeers""); whatever.. it ought to be possible to get rid of them, perhaps in conjunction with the ProgrammingModel API.

"
ISIS-68,Improvement,Closed,"Combine JavaSpecification and JavaIntrospector, and make the mechanism for ordering members more explicit.","There is no real separation of responsibilities between JavaSpecification and JavaIntrospector... the responsibility for introspecting is really a responsibility of the FacetFactories that make up the programming model in action.  These two classes should therefore be combined.

In addition, the JavaIntrospector currently takes responsibility for applying the ordering of members.  In the future we might want to make this a ""post-processing"" operation, in effect overlaying a UI ""schema"" for the layout of object members.  (The MetaWidget library does something like this, to good effect).

As a first step, we should make clear the raw set of associations/actions; and then make clear the transformation of these sets into ordered/laid out sets.
"
ISIS-67,Improvement,Closed,Move JavaReflector and JavaSpecification back from default.progmodel and core.progmodel and back into metamodel,"Previously we had JavaReflector and JavaSpecification all within metamodel.  These were moved out into core.progmodel and defaults.progmodel.  This was a mistake though.  
- The FacetFactory implementations should live in core.progmodel
- the default set of FacetFactorys should be defined in defaults.progmodel.
- However, the JavaReflector represents a system component that defines a mechanism for building the metamodel; this won't vary by programming model
- the JavaSpecification represents a system type (cf java.lang.Class); this won't vary by programming model either."
ISIS-66,Improvement,Closed,"[WON'T FIX] Remove ObjectSpecificationOnStandaloneList, replace with appropriate FacetFactory's that install relevant facets for ObjectList type.","The framework currently has special purpose code to deal with ObjectList type (ObjectList representing the result of an action that returns a collection).  Predominantly this is the InstancesCollectionSpecification.

This design could be improved by doing away with this ""special"" subtype, and instead having FacetFactory's that look specifically for pojos of type ObjectList and install the required facets."
ISIS-65,Improvement,Closed,Simplify code: improve the subclasses under IntrospectableSpecificationAbstract (InstancesCollection and JavaSpecification),The two subclasses under IntrospectableSpecificationAbstract (JavaSpecification and InstancesCollectionAbstract) are a bit of a mess and need sorting out.
ISIS-64,Sub-task,Closed,Remove (at least some of the) cyclic dependencies within metamodel,"Improving the code quality within the metamodel module.
"
ISIS-63,Umbrella,Closed,Remove cyclic dependencies between packages (in core framework and runtimes:dflt),"This is an ongoing ""umbrella"" issue for removing cyclic dependencies between packages within each module."
ISIS-62,Improvement,Closed,"Split out RuntimeContext into separate sub-interfaces, for testability and understanding (ie, the interface separation principle).","The org.apache.isis.core.metamodel.runtimecontext.RuntimeContext interface is used to decouple the metamodel from the runtime implementations.

There are a lot of methods in this interface, and it is passed into multiple classes within the metamodel.  This makes it hard to understand which methods are used by which classes.

This issue is to split the interface out so that dependencies are narrower (interface separation principle).  This should make it easier to write tests, and the codebase easier to understand (I hope).

This principally impacts the metamodel, but also the progmodel."
ISIS-61,Sub-task,Closed,ObjectSpecification's superinterface: Hierarchical,"Hierarchical#interfaces()
Hierarchical#subclasses()"
ISIS-60,Sub-task,Closed,ObjectSpecification's superinterfaces: ObjectActionContainer and ObjectAssociationContainer.,"ObjectActionContainer#getServiceActions()
ObjectActionContainer#getObjectActions() 

ObjectAssociationContainer#getAssociations()
ObjectAssociationContainer#getProperties()   - was called #getOneToOneAssociations()
ObjectAssociationContainer#getCollections()   - was called #getOneToManyAssociations()"
ISIS-59,Improvement,Closed,Combine the ObjectMember and ObjectMemberPeer hierarchies.,"The reason for these being separated out is historical.  The FacetFactory design now gives us everything that this earlier design gave us, so we should merge the two hierarchies back together."
ISIS-58,Sub-task,Closed,Change FacetFactory#getFeatureTypes to return List<ObjectFeatureType> instead of ObjectFeatureType[],
ISIS-57,Improvement,Closed,"Remove arrays from all public APIs, replace with (immutable) lists of elements.","This is an umbrella JIRA to steadily improve our API.  If you find a change you want to make, create a subtask under this one and action on it.

This umbrella JIRA won't get a fix version until all APIs have been impacted, which could take some time.  Individual subtasks can be assigned fix versions as they are done."
ISIS-56,New Feature,Closed,Revive the Eclipse RCP viewer.,"Another mothballed codebase (like ISIS-54 and ISIS-55 written around the time of NOF 3.0) is the Eclipse RCP viewer.  There's a screenshot of this in Dan Haywood's book, and also here [1].

The codebase for this resides in sourceforge project, [2].  All of it was developed by Dan Haywood, so could be uploaded into Isis under his ICLA.


[1] https://sourceforge.net/project/screenshots.php?group_id=167340
[2]https://sourceforge.net/projects/nakedrcp."
ISIS-55,New Feature,Closed,Revive the Eclipse IDE plugins,"At around the time of NOF 3.0 a good deal of work was done by Dan on developing some features and plugins for Eclipse.  This work was subsequently mothballed (while he went to work on his book...)

Some of the codebase was donated in the NOF initial contribution, in contrib/initial/nof/incubator/ide/trunk/.

However, there is additional code available on SourceForge in the https://sourceforge.net/projects/nakedide project.  This would make a better starting place because none of the code has been edited so it should in theory still build (it was built against Eclipse 3.3).

There's quite a lot of code and features here (see http://nakedide.svn.sourceforge.net/viewvc/nakedide/ide), so definitely worth salvaging.

All the code was developed by Dan Haywood, so could be uploaded under his ICLA."
ISIS-54,New Feature,Closed,Revive the CLI viewer.,"The CLI (command line interface) viewer was intended to allow blind users to interact with an Isis application.  A version was got working against the NOF codebase (prior to 3.0), but was subsequently mothballed.

This codebase has been contributed as part of the NOF framework, in contrib/initial/nof/incubator/cli/.

This ticket is for someone to pick this up if they are interested, and develop it further."
ISIS-53,New Feature,Closed,Extend the NoSQL Object Store to properly support CouchDB.,"As of 0.1 the NoSQL object store only really supports a proprietary JSON file store.  The intention is for this file store to be replaceable with CouchDB (or other stores such as MongoDB, see ISIS-52).

This ticket is the vessel for that further work."
ISIS-52,New Feature,Closed,Extend the NoSQL Object Store to properly support MongoDB.,"As of 0.1 the NoSQL object store only really supports a proprietary JSON file store.  The intention is for this file store to be replaceable with MongoDB.  Some work has been done in this direction, but further work will be required.  This ticket is the vessel for that further work."
ISIS-51,Improvement,Closed,Standardize on just one collections API (either google-collections/guava or Apache collections),"Currently we use both.

For what it's worth, my vote is for google-collections (which is now a subset of guava) rather than the Apache commons collections.  Two reasons:
1. I think it's better quality
2. the guava library is likely to give us some further general language utilities, meaning we can may be able to delete some stuff in org.apache.isis.core.commons."
ISIS-50,Umbrella,Closed,"write contract tests for all major plugin APIs (object stores, authentication, authorization, remoting). ","As per our original proposal, see http://wiki.apache.org/incubator/IsisProposal."
ISIS-49,Umbrella,Closed,[WON'T FIX] Provide JMX support for runtime management,"Integrate with JMX for runtime management; provide profiling of client/server and webapps (eg serialization vs domain logic vs domain services vs object store timings).

As per our original proposal, see http://wiki.apache.org/incubator/IsisProposal.

"
ISIS-48,Sub-task,Closed,Port JPA object store from Hibernate to OpenJPA,"As per our original proposal, http://wiki.apache.org/incubator/IsisProposal.

NB: since then, ISIS-14 has been raised, suggesting that we instead write a JDO 3.0 object store.  If we decide to go that way, then this ticket might be obsolete."
ISIS-47,Improvement,Closed,"Refactor components to JSR-299, while maintaining backwards compatibility for bootstrapping.","As per our original proposal, see http://wiki.apache.org/incubator/IsisProposal."
ISIS-46,Task,Closed,Create page on site to list all the DocBooks PDFs we have available.,"It'd be nice to have a new page from the main site that has hyperlinks to all the DocBook guides that are available.

I'm thinking of something like the table shown in Seam's documentation (per http://seamframework.org/Weld/Documentation).

However, we do have many more guides, because of all our modules.  The contributors guide has a full list of the DocBook guides that we have (chapter 8).

"
ISIS-45,Improvement,Closed,Improve the look-n-feel of our generated DocBook; output also in single page HTML and in Eclipse HTML format (as well as current chunked HTML and PDF),"The OpenWebBeans project (Mark Struberg, our champion, is on its PMC) have a nice looking, formal stylesheet.

The src for their userguide can be found at http://openwebbeans.apache.org/1.0.0-SNAPSHOT/documents/userguide.pdf.

This docbook also generates single HTML.

For inspiration on generating Eclipse-style output, see http://agile-reflections.opnworks.com/2010/09/agile-documentation-with-eclipse-maven.html."
ISIS-44,Sub-task,Closed,screencasts (linked from top-level site in isis-parent),"There's a page on the wiki [1] with our thoughts so far on this.

[1] https://cwiki.apache.org/confluence/display/ISIS/ScreencastIdeas"
ISIS-43,Sub-task,Closed,contributors guide (in isis-parent),
ISIS-42,Sub-task,Closed,rebuild archetypes from support/quickstart,"There is a page on the wiki [1] with some earlier thoughts... support/prototype is acting as the prototype for this archetype, the idea being to reverse engineer it using mvn archetype:create-from-project.

This ticket therefore depends on the support/prototype being ready, which makes it dependent on most of the other subtasks living under ISIS-20.

[1] https://cwiki.apache.org/confluence/display/ISIS/MavenArchetypeDesign"
ISIS-41,Sub-task,Closed,prepare viewer:wicket for 0.1 release,"Ensure that:

1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates"
ISIS-40,Sub-task,Closed,Update viewer:scimpi docbook guide,"Ensure that the following are addressed:

1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates"
ISIS-39,Sub-task,Closed,prepare viewer:restful for 0.1 release,"Ensure that:

1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates"
ISIS-38,Sub-task,Closed,Update viewer:junit docbook guide for 0.2 release,"1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates
"
ISIS-37,Improvement,Closed,Update viewer:html docbook guide,"Ensure that the following are addressed:

1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates"
ISIS-36,Sub-task,Closed,Update viewer:dnd docbook guide,"Ensure that:

1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates"
ISIS-35,Sub-task,Closed,prepare viewer:bdd for 0.1 release,"1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates
"
ISIS-34,Sub-task,Closed,prepare security:ldap for 0.1 release,"1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates
"
ISIS-33,Sub-task,Closed,prepare security:file for 0.1 release,
ISIS-32,Sub-task,Closed,prepare progmodels:wrapper for 0.1 release,"Ensure that:

1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates"
ISIS-31,Sub-task,Closed,prepare progmodels:groovy for 0.1 release,"Ensure that:

1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates"
ISIS-30,Sub-task,Closed,prepare profilestores for 0.1 release,"Ensure that:

1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates"
ISIS-29,Task,Closed,prepare objectstore:jpa,"INITIALLY:
- still need to copy over from the sister projects
- need to update package names
- make sure that the reference to hibernate is marked optional
- make sure that the documentation is clear about this.

Ensure that the following are addressed:
1 - docbook PDF is coherent
2 - site APT is complete (can be brief)
3 - copyright notices are in place
4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates
"
ISIS-28,Sub-task,Closed,Update objectstores:xml docbook guide for 0.2 release,"Ensure that the following are addressed:

1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates"
ISIS-27,Sub-task,Closed,prepare objectstore:sql for 0.1 release,"Ensure that:

1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates"
ISIS-26,Improvement,Closed,Update runtimes.dflt.objectstores:nosql docbook guide,"Ensure that the following are addressed:

1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates"
ISIS-25,Improvement,Closed,Update runtimes:embedded docbook guide,"Ensure that:

1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates
"
ISIS-24,Sub-task,Closed,prepare runtimes.dflt:bytecode for 0.1 release,"Ensure that:

1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates"
ISIS-23,Sub-task,Closed,prepare progmodels:dflt for 0.1 release,"Ensure that:

1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)

2 - site APT is complete (can be brief)

3 - copyright notices are in place

4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates"
ISIS-22,Sub-task,Closed,prepare core for 0.1 release,
ISIS-21,Sub-task,Closed,prepare applib for 0.1 release,
ISIS-20,Task,Closed,Get all components ready for a 0.1 release,"This is an umbrella JIRA ticket to get all modules relating to getting 0.1 ready for release.

For all code modules, we have a single subtask to address all of the following:
1 - docbook PDF is coherent (can have placeholders, but what is there should be correct or with notes to indicate in what way it might not be)
2 - site APT is complete (can be brief)
3 - copyright notices are in place
4 - Isis code formatting applied to all code, per standard Eclipse IDE settings (in particular: brace location, spaces instead of tabs, indent size)
   - in trunk/src/site/resources/ide/eclipse/templates

There are also some miscellaneous other modules that require work; each of these has its own subtask also.  Specifically:
- isis-parent (site, contributors guide, screencasts)
- archetype (to be reverse engineered from support/quickstart)
- version Id should be set to: 0.1.1-incubating-SNAPSHOT
- screencasts linked from site

NB, the following have been addressed already for code modules, so haven't included in the above list:
- all package names and Maven artifact IDs (should now be correct)
- all license dependencies (have all been checked)
- all code contributions (have IP has been accounted for, ICLAs on file or equivalent direct email confirmation for minor patches to NOF)
"
ISIS-19,Bug,Closed,"i18n issue with date parsing for BDD viewer (new CheckList, VerifyRows functionality)","Raised on Sabine's behalf.

Sabine has informally provided a patch for one of the defects impacted by this (DateParser), but this needs to be submitted formally as a patch on via this ticket in order to provide IP clearance."
ISIS-18,Bug,Closed,DateParser error under de_DE.,"Originally this ticket was to cover the issue now described by ISIS-164.  However, fixes were made under this ticket that addressed a related problem (see commit messages), but didn't actually address the original problem in ISIS-164.  So have decided to update this issue to describe the issue that was addressed there.

"
ISIS-17,Improvement,Closed,Update to use org.apache:apache:8 as our parent.,the corporate POM was recently updated to v8; we currently reference v7.  We should keep up-to-date.
ISIS-16,Bug,Closed,Concordian test fails:  NewClaimDefaultsOkStory,"mvn test fails with:
/tmp/concordion/org/apache/isis/support/prototype/stories/NewClaimDefaultsOkStory.html
Successes: 17, Failures: 1
Localisation issue?"
ISIS-15,Sub-task,Closed,our release numbers need to reflect the 'incubating' status,so we should move all versions from 0.1-SNAPSHOT to 0.1.0-incubating-SNAPSHOT
ISIS-14,New Feature,Closed,Add JDO 3.1 object store in order to support any datastore,"Given that JDO's charter is to be datastore-agnostic, a JDO object store should be high on the list.  It supports both relational and non-relational databases, including object databases, NoSQL data stores and **literally** anything else.

By leveraging the plugins of DataNucleus, the Apache-licensed open source JDO reference implementation, the following object stores below can be supported out of the box.

RDBMS (all major vendors)
DB4O
LDAP
Excel
XML
Neodatis
JSON
ODF
HBase

See http://www.datanucleus.org/plugins/ for more info.

Google's BigTable could also be supported thanks to their Google AppEngine for Java persistence solution, which is a DataNucleus plugin, enabling Isis- & JDO-based apps to run on GAEJ.

Note that DN also supports Joda & javax.time datetime types as well."
ISIS-13,Improvement,Closed,"add ""image map"" functionality to the main page image HexagonalArchitectureOverview.png",image map: http://en.wikipedia.org/wiki/Image_map
ISIS-12,Improvement,Closed,"The maven project-info-reports on the root site show all reports, instead of just the relevant reports.","Need someone with a little more Maven kung-fu than me to take a look at this...

in trunk/pom.xml, I've configured <reportSets> for the maven-project-info-reports to exclude dependencies, dependency-convergence, summary, but for some reason they are all generated.  "
ISIS-11,Bug,Closed,Build errors under maven 3.0,"The project won't build under Maven 3.0. It will produce errors related to the pom.xml files. 
When tried on Maven 2.2.1 it was built successfully. 
I believe it's a compatibility issue."
ISIS-10,Improvement,Closed,"Properly use prepared statements instead of injecting values into ""insert"" and ""update"" SQL statements","At the moment, all ""insert"" and ""update"" commands use a fully formed SQL string with embedded values:
""insert into SQLDATACLASS (PK_ID, color,date_time) values (2252, '0','2010-03-05 22:23:000000')"".

This should be updated to ""insert into SQLDATACLASS (PK_ID, color,date_time) values (?,?,?)"".

This should also solve issues with quoting values such as (especially affecting DB2) quoting integer, float, etc, non-string values. DB2 is throwing an exception when integers and floats are quoted ('1') instead of (1).
"
ISIS-9,Improvement,Closed,Fixes to the Eclipse templates,"This was an email chain from Jul 2010 timeframe, against NOF 4.0.0.  Kevin had the proposed changes, I've assigned to him.

~~~~~~~~~~~
Sounds like those are the right templates then (there hasn't been any updates to em). I'll check it out, but if you reckon there's a bug and you have a fix, then go ahead and commit the changes (somewhere under trunk/distribution, if i remember right).

Thanks,
Dan

Sent from my iPhone

On 28 Jul 2010, at 11:28, ""Kevin Meyer"" <kevin@kmz.co.za> wrote:

> > Hi Dan,
> > 
>> >> Yes, the parent should do the work, and the child delegate to it. It's
>> >> called the mutual registration pattern.
> > 
> > That is what I understood. I wanted to confirm with you as I was seeing
> > some funny behaviour.
> > 
>> >> In your email you talk about the 'template' in the singular, but actually
>> >> there are several templates available (I'm assuming you are using the ones
>> >> I describe in my book?).
> > 
> > I'm using the templates I fetched from the NOF
> > ""/distribution/tarball/.../ide/eclipse/templates"" directory.
> > I should compare them to the ones in your book...
> > 
>> >> I don't think that there are any bugs in them; rob says he's been using
>> >> them ok (though I think he trimmed them down a bit).
> > 
> > The issue that I have with the 'noc-1m' ""1:m parent"" association
> > template is that following two lines are the wrong way around?:
> >    // associate arg
> >    childElementName.setParentPropertyNameInChild(this);
> >    getChildCollectionName().add(childElementName);
> > 
> > Since, if the child method ""setParentPropertyNameInChild(this)""
> > delegates to the parent (e.g. contains
> > ""parentObject.addToChildCollectionName(this)"") then you've got
> > an infinite recursion taking place - the child item is not yet
> > in the parent collection, when the parent calls the child... :-o
> > 
> > AFAIK, There is no equivalent child template ('nocmod' assumes no
> > parent?).
> > 
> > 
> > 
> > Regards,
> > Kevin
"
ISIS-8,Task,Closed,Update the DOCBOOK URLs to reference local files instead of online DTDs,"As per emails (+- Thu, 28 Oct 2010 11:01:46 +0100) on the isis-dev mailing list, update the various docbook URLs to use a ""local"" docbookx.dtd resources.

This requires  adding the 4.5 docbooks dtd and resources to the project, and changing all ""docbkx/*.xml"" docbook xml sources so that they use ""file://"" relative paths.

It probably also requires edits to the DTD resources (e.g. docbookx.dtd and ""@"" included files)."
ISIS-7,Brainstorming,Closed,Distinguish different types of services (a la NO.Net) ?,"The Naked Objects for .NET has made a change to their API, in that they now distinguish:
- MenuServices  -  services registered here show up on the UI as menus (but may still be selected and deselected within a Profile). Actions on these services will also be contributed unless marked [NotContributed]. They will also be injected into objects as needed.
- ContributedActions  -  Services registered here will contribute actions but will not show up as menus, nor be selectable within a profile. They will also be injected into objects (though I think it not very likely that you would want to).
- SystemServices  -  These services (e.g. SMTPMailSender) are registered for purposes of dependency injection but do not have any user visibility.

These are currently specified through different overridden methods in their bootstrap class.  They did explore ways to achieve the same distinctions entirely by annotation, but eventually concluded that this was a simpler approach.

This ticket is a marker for a similar discussion with respect to Isis."
ISIS-6,Umbrella,Closed,Support actions on collections,"Naked Objects for .NET now supports the ability to invoke an action on a collection of objects of the same type.  This is probably something that Isis should support also.

The following screencasts show what this looks like in .NET product:

MVC viewer: http://www.screencast.com/t/5qEFjVja

WPF viewer: http://www.screencast.com/t/y130DjUC

"
ISIS-5,Improvement,Closed,"Reinstate DerivedFacet (to distinguish from NonPersistableFacet, which is also unmodifiable).","Previously we had a DerivedFacet, which implied non-persistence but could still be edited.

At some point after NOF 4.0.0, Dan got rid of this, combining with NonPersistableFacet.

This was a mistake, and should be backed out.

The mailing list thread that refers to this is: http://mail-archives.apache.org/mod_mbox/incubator-isis-dev/201010.mbox/%3C4CB2FA43.7030206@nakedobjects.org%3E"
ISIS-4,Improvement,Closed,"Should warn or fail early if there is another attribute than ""id"" annotated with ""@Id"".","It seems to be that the ""Save/Discard"" buttons will not be rendered on an editor of a transient object, when there is another attribute than ""id"" annotated with ""@Id""... what unfortunately I did :-

Raised on behalf of Dr. Christian Mann."
ISIS-3,Task,Closed,Import Naked Objects and Sister Projects code into the Apache repo,"The data from the existing code repositories (created using svnadmin dump) needs to be imported into /incubator/isis/contrib/initial.

See the infra tickets for the details, because the actual work of doing the uploads must be performed by infra, not by members of Isis."
ISIS-2,Task,Closed,Add all active committers in the STATUS file,- Add all active committers in the STATUS file.
ISIS-1,Task,Closed,Check and make sure that the files that have been donated have been updated to reflect the new ASF copyright,All files that have been donated must be updated to reflect the new ASF copyright.
